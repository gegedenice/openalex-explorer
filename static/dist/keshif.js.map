{"version":3,"file":"keshif.js","sources":["../src/Base.ts","../src/d3_select.ts","../src/i18n_EN.ts","../src/i18n.ts","../src/Filter.ts","../src/UI/Modal.ts","../src/Aggregate.ts","../src/Aggregate_NoValue.ts","../src/TimeSeriesData.ts","../src/AttribTemplate.ts","../src/Attrib.ts","../src/Config.ts","../src/Util.ts","../src/Aggregate_Interval.ts","../src/Filter_Interval.ts","../src/Record.ts","../src/Attrib_Interval.ts","../src/Block.ts","../src/Block_Interval.ts","../src/Block_Numeric.ts","../src/Attrib_Numeric.ts","../src/UI/AttribDropdown.ts","../src/UI/ConfigPanel.ts","../src/Filter_Geo.ts","../src/Attrib_RecordGeo.ts","../src/Attrib_Timeseries.ts","../src/Block_Categorical.ts","../src/Aggregate_Category.ts","../src/Aggregate_SetPair.ts","../src/Block_Set.ts","../src/Attrib_Set.ts","../src/Filter_Categorical.ts","../src/Attrib_Categorical.ts","../src/RecordView.ts","../src/RecordView_Timeseries.ts","../src/RecordView_Map.ts","../src/RecordView_Scatter.ts","../src/Block_Timestamp.ts","../src/Aggregate_Interval_Date.ts","../src/Attrib_Timestamp.ts","../src/RecordView_List.ts","../src/RecordDisplay.ts","../src/MapData.ts","../src/MapStandards.ts","../src/UI/Breadcrumb.ts","../src/UI/MenuOpts.ts","../src/UI/Panel.ts","../src/DataLoader/FetchURL.ts","../src/DataLoader/GoogleSheets.ts","../src/DataTable.ts","../src/Block_Content.ts","../src/Attrib_Content.ts","../src/UI/RecordDetailsPopup.ts","../src/Browser.ts"],"sourcesContent":["import \"tippy.js/animations/scale.css\";\r\nimport \"tippy.js/dist/svg-arrow.css\";\r\nimport \"tippy.js/dist/tippy.css\";\r\n\r\nimport \"./assets/font-awesome/css/all.min.css\";\r\n\r\nimport { CompareType, MeasureType, MetricFunc } from \"./Types\";\r\n\r\nimport \"./keshif.less\";\r\nimport { MapData } from \"./MapData\";\r\nimport { Browser } from \"./Browser\";\r\nimport { DataTable } from \"./DataTable\";\r\n\r\n\r\nclass kshfBase {\r\n  // active browser\r\n  browser: Browser = null;\r\n\r\n  // all browsers in window\r\n  browsers: { [key: string]: Browser } = {};\r\n\r\n  // update to support google api loading\r\n  gapi = {\r\n    gKey: null,\r\n    clientId: null,\r\n    scope: null,\r\n  };\r\n\r\n  // point to where geojson files are hosted\r\n  geoFileDir = \"\";\r\n  geoFileExt = \"topojson\";\r\n\r\n  // external service configuration parameters\r\n  helpscoutBeacon: \"\"; // to set helpscout beacon ID\r\n\r\n  // dt: any = [];\r\n  // dt_id: any = {};\r\n\r\n  // Number of maximum visible records (items)\r\n  maxVisibleItems_Default = 100;\r\n  // how many rows (records) to look at to auto-detect attributes\r\n  autoDetect_RowCount = 10;\r\n\r\n  // **************************************************************\r\n  // BASIC CONFIGURATIONS\r\n\r\n  timeKeyHeight = 35; //\r\n  recordRankWidth = 45; //\r\n\r\n  maxRecordPointSize = 30;\r\n  defaultRecordPointSize = 4.5;\r\n\r\n  // Categorical chart size settings\r\n  height_CatBottom = 36; //\r\n  defaultBarHeight = 32; //\r\n  width_CatLabelMin = 110; //\r\n\r\n  width_scatter_margin_left = 85;\r\n  height_scatter_margin_bottom = 95; //\r\n\r\n  // Interval chart size settings\r\n  width_HistBarGap = 2; // Width (pixels) between neighboring histogram bars\r\n  width_HistBinDefault = 45;\r\n  width_measureDescrLabel = 20; //\r\n  height_MaxRatioDefault = 0.3; //\r\n  height_HistMin = 40; //\r\n  height_HistBottomGap = 12; // Height (pixels) for histogram gap on top.\r\n  height_Percentile = 34; // Height (pixels) of percentile chart\r\n\r\n  // Other size settings\r\n  width_PanelGap = 8; //\r\n  width_ScrollBar = 19; // scroll bar width\r\n  width_AttribPanelDefault = 250; //\r\n\r\n  percentDecimal = true; // set to false to not use a decimal point when presenting % labels\r\n\r\n  defaultDOM = \"#kshfDashboard\";\r\n\r\n  Panel_List = [\"left\", \"right\", \"middle\", \"bottom\"];\r\n\r\n  defaultMetricFuncs: MetricFunc[] = [\"Sum\", \"Avg\"];\r\n\r\n  Compare_List: CompareType[] = [\r\n    \"Compare_A\",\r\n    \"Compare_B\",\r\n    \"Compare_C\",\r\n    \"Compare_D\",\r\n    \"Compare_E\",\r\n  ];\r\n\r\n  maps = new Map<string, MapData>();\r\n\r\n  tables = new Map<string, DataTable>();\r\n\r\n  get Active_Compare_List(): MeasureType[] {\r\n    let m: MeasureType[] = [\"Active\"];\r\n    return m.concat(this.Compare_List);\r\n  }\r\n\r\n  get Total_Active_Compare_List(): MeasureType[] {\r\n    let m: MeasureType[] = [\"Total\", \"Active\"];\r\n    return m.concat(this.Compare_List);\r\n  }\r\n\r\n  map = {\r\n    tileTemplate: \"\", // point to the tileserver\r\n    leafConfig: {\r\n      maxBoundsViscosity: 1,\r\n      worldCopyJump: false,\r\n      // zoom settings\r\n      zoomControl: false,\r\n      boxZoom: false,\r\n      doubleClickZoom: false,\r\n      touchZoom: false,\r\n      zoomSnap: 0.5,\r\n      zoomDelta: 0.5,\r\n      maxZoom: 18,\r\n      minZoom: 1,\r\n      //crs: L.CRS.EPSG3857\r\n      //crs: L.CRS.Simple\r\n    },\r\n    tileConfig: {\r\n      attribution:\r\n        '&copy; <a href=\"https://openstreetmap.org/about/\" target=\"_blank\">OpenStreetMap</a><br><a href=\"https://www.mapbox.com/about/maps/\" target=\"_blank\">Mapbox</a> &amp; <a href=\"https://keshif.me\" target=\"_blank\">Keshif</a>',\r\n      subdomains: \"abcd\",\r\n      id: \"mapbox.light\",\r\n      //noWrap: true\r\n    },\r\n    flyConfig: {\r\n      padding: [0, 0],\r\n      pan: { animate: true, duration: 1.2 },\r\n      zoom: { animate: true },\r\n    },\r\n\r\n    pinGlyphPath: `M-0.025 -18 C-4.106 -18 -7.427 -14.751 -7.427 -10.757 -7.427 -5.8 \r\n      -0.803 1.476 -0.521 1.784 -0.256 2.072 0.207 2.072 0.471 1.784 0.753 1.476 7.377 -5.8 \r\n      7.377 -10.757 7.377 -14.751 4.057 -18 -0.025 -18 Z M-0.025 -7.112 C-2.078 -7.112 -3.749 \r\n      -8.747 -3.749 -10.757 -3.749 -12.766 -2.078 -14.401 -0.025 -14.401 2.029 -14.401 3.699 \r\n      -12.766 3.699 -10.757 3.699 -8.747 2.029 -7.112 -0.025 -7.112 Z`,\r\n  };\r\n\r\n  DOM: any = {};\r\n  popupInstance: any; // temp\r\n\r\n  custom_icons = {\r\n    trails: `<svg class=\"custom_icon custom_icon_trails\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 600 500\" xml:space=\"preserve\">\r\n        <g>\r\n          <path d=\"M489.2,65.25c0-35.7-28.5-65.2-64.2-65.2s-64.2,29.6-64.2,65.2c0,28.1,17.7,52.3,42.6,61.4l-28.2,232.3\r\n            c-6.6,0.5-12.9,2-18.7,4.4l-97.1-99.6c1.6-5.8,2.5-11.8,2.5-18.1c0-35.7-28.5-65.2-64.2-65.2s-64.2,29.6-64.2,65.2\r\n            c0,15.6,5.4,29.9,14.5,41.2l-62.3,75.7c-6.7-2.4-14-3.8-21.5-3.8c-35.7,0-64.2,29.6-64.2,65.2c0,35.7,28.5,65.2,64.2,65.2\r\n            c36.7,0,64.2-29.6,64.2-65.2c0-13.3-4-25.8-10.9-36.2l64.8-78.8c4.9,1.2,10,1.9,15.3,1.9c14.5,0,27.8-4.9,38.5-13.1l89.4,91.8\r\n            c-6.2,10-9.7,21.8-9.7,34.4c0,35.7,28.5,65.2,64.2,65.2s64.2-29.6,64.2-65.2c0-23.1-12-43.6-30.1-55.2l29.5-241\r\n            C470.1,119.55,489.2,94.45,489.2,65.25z M425,40.85c12.2,0,23.4,11.2,23.4,24.5s-11.2,24.5-23.4,24.5s-23.4-11.2-23.4-24.5\r\n            S411.7,40.85,425,40.85z M64.2,448.45c-12.2,0-23.4-11.2-23.4-24.5c0-13.2,10.2-24.5,23.4-24.5s23.4,11.2,23.4,24.5\r\n            C87.7,437.25,76.4,448.45,64.2,448.45z M197.7,270.15c-12.2,0-23.4-11.2-23.4-24.5c0-13.2,10.2-24.5,23.4-24.5\r\n            s23.4,11.2,23.4,24.5C221.2,258.95,209.9,270.15,197.7,270.15z M380.1,448.45c-12.2,0-23.4-11.2-23.4-24.5\r\n            c0-13.2,10.2-24.5,23.4-24.5c13.2,0,23.4,11.2,23.4,24.5C403.6,437.25,392.4,448.45,380.1,448.45z\"/>\r\n        </g>\r\n      </svg>`,\r\n  };\r\n\r\n  reloadWithNewConfig(dashboard: Browser, newConfig) {\r\n    this.tables.delete(dashboard.primaryTableName);\r\n    return new Browser(newConfig);\r\n  };\r\n\r\n  WebFontConfig = {\r\n    google: {\r\n      families: [\r\n        \"Roboto:100,300,400,500,700:latin\",\r\n        \"Roboto+Slab:300,400,700\",\r\n        \"Roboto+Condensed:300,400\",\r\n      ],\r\n    },\r\n  };\r\n\r\n  loadResources = async function () {\r\n    if (this._resourcesLoaded === true) return;\r\n\r\n    // Load common fonts\r\n    window[\"WebFontConfig\"] = this.WebFontConfig;\r\n    await import(\r\n      \"https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js\"\r\n    );\r\n    //window.WebFont.load(this.WebFontConfig); // or, after loading the script\r\n\r\n    window.addEventListener(\r\n      \"resize\",\r\n      () => {\r\n        for (var id in this.browsers) {\r\n          this.browsers[id].setNoAnim(true);\r\n          this.browsers[id].updateLayout();\r\n        }\r\n        if (this._resizeTimeout) {\r\n          window.clearTimeout(this._resizeTimeout);\r\n        }\r\n        this._resizeTimeout = window.setTimeout(() => {\r\n          for (var id in this.browsers) this.browsers[id].setNoAnim(false);\r\n        }, 500);\r\n      },\r\n      false\r\n    );\r\n\r\n    this._resourcesLoaded = true;\r\n\r\n    return true;\r\n  };\r\n}\r\n\r\nexport var Base = new kshfBase();\r\n\r\nwindow[\"kshf\"] = Base;\r\n\r\n","import DOMPurify from \"dompurify/dist/purify.es\";\r\n\r\nimport tippy, { roundArrow} from \"tippy.js\";\r\n\r\nimport { select, pointer, selection } from \"d3-selection\";\r\n\r\n// We need to import transition module\r\n// It is used by other sections, but not explicitly initialized as d3.transition...\r\n// export * as transition from \"d3-transition\";\r\nimport { Base } from \"./Base\";\r\n\r\nDOMPurify.setConfig({\r\n  USE_PROFILES: { html: true, svg: true },\r\n  ALLOWED_ATTR: [\"target\"],\r\n  //'FORBID_ATTR': ['rel'],\r\n  //'ALLOW_DATA_ATTR': false\r\n});\r\n\r\n// Open links in new window\r\nDOMPurify.addHook(\"afterSanitizeAttributes\", function (node) {\r\n  if (\"target\" in node) {\r\n    node.setAttribute(\"target\", \"_blank\");\r\n  }\r\n});\r\n\r\nfunction isObject(item) {\r\n  return item && typeof item === \"object\" && !Array.isArray(item);\r\n}\r\n\r\nfunction mergeDeep(target, ...sources) {\r\n  if (!sources.length) return target;\r\n  const source = sources.shift();\r\n\r\n  if (isObject(target) && isObject(source)) {\r\n    for (const key in source) {\r\n      if (isObject(source[key]) && !(source[key] instanceof HTMLElement)) {\r\n        if (!target[key]) Object.assign(target, { [key]: {} });\r\n        mergeDeep(target[key], source[key]);\r\n      } else {\r\n        Object.assign(target, { [key]: source[key] });\r\n      }\r\n    }\r\n  }\r\n\r\n  return mergeDeep(target, ...sources);\r\n}\r\n\r\nselection.tippyDefaultConfig = {\r\n  allowHTML: true,\r\n  animation: \"scale\", //'fade', 'shift-away', 'scale',\r\n  animateFill: false,\r\n  theme: \"dark kshf-tooltip\",\r\n  arrow: roundArrow,\r\n  delay: [500, 50],\r\n  duration: [350, 250],\r\n  maxWidth: 350, // max-width of the tippy box\r\n  placement: \"auto\",\r\n  popperOptions: {\r\n    modifiers: [\r\n      {\r\n        name: \"flip\",\r\n        enabled: true,\r\n        options: {\r\n          padding: 10,\r\n        },\r\n      },\r\n    ],\r\n  },\r\n};\r\n\r\nselection.prototype.tooltip = function (param1, param2) {\r\n  var config = param2 ? param2 : typeof param1 === \"object\" ? param1 : null;\r\n  var title = param2 ? param1 : typeof param1 === \"object\" ? null : param1;\r\n\r\n  // this ensures that tooltips are visible if the dashboard is made full-screen\r\n  var appendTo = Base.browser ? Base.browser.DOM.root.node() : document.body;\r\n\r\n  var tippyConfig = Object.assign(\r\n    { appendTo: appendTo },\r\n    selection.tippyDefaultConfig\r\n  );\r\n  mergeDeep(tippyConfig, config);\r\n  tippyConfig.popperOptions.modifiers[0].options.boundariesElement =\r\n    tippyConfig.appendTo;\r\n\r\n  if (title) {\r\n    if (typeof title === \"string\") {\r\n      title = DOMPurify.sanitize(title);\r\n      //\r\n    } else if (typeof title === \"function\") {\r\n      tippyConfig.onShow = (instance) => {\r\n        instance.reference.tippy.setContent(\r\n          DOMPurify.sanitize(title(instance.reference.__data__))\r\n        );\r\n        return true;\r\n      };\r\n    }\r\n  }\r\n\r\n  this.each(function () {\r\n    if (this.tippy) {\r\n      this.tippy.destroy();\r\n    }\r\n    this.tippy = tippy(this, tippyConfig);\r\n    if (typeof title === \"string\") {\r\n      this.tippy.setContent(title);\r\n    }\r\n  });\r\n\r\n  return this;\r\n};\r\n\r\nfunction htmlRemove() {\r\n  this.innerHTML = \"\";\r\n}\r\nfunction htmlConstant(value) {\r\n  return function () {\r\n    this.innerHTML = DOMPurify.sanitize(value);\r\n  };\r\n}\r\nfunction htmlFunction(value) {\r\n  return function () {\r\n    var v = value.apply(this, arguments);\r\n    this.innerHTML = v == null ? \"\" : DOMPurify.sanitize(v);\r\n  };\r\n}\r\nselection.prototype.html = function (value) {\r\n  return arguments.length\r\n    ? this.each(\r\n        value == null\r\n          ? htmlRemove\r\n          : (typeof value === \"function\" ? htmlFunction : htmlConstant)(value)\r\n      )\r\n    : this.node().innerHTML;\r\n};\r\n\r\nexport { select, selection, pointer };\r\n","import { Attrib } from \"./Attrib\";\r\nimport { Base } from \"./Base\";\r\nimport { Browser } from \"./Browser\";\r\n\r\nexport class i18n_EN {\r\n  [x: string]: string | ((...args: any) => string) | any;\r\n\r\n  constructor() {\r\n    this.LANG_NAME = \"English\";\r\n\r\n    this.LoadingData = \"Loading data...\";\r\n    this.CreatingBrowser = \"Creating Dashboard...\";\r\n    this.Close = \"Close\";\r\n    this.Help = \"Help\";\r\n\r\n    this.RemoveFilter = \"Remove filter\";\r\n    this.RemoveHighlight = \"Remove highlight\";\r\n    this.RemoveAllFilters = \"Remove all filters\";\r\n    this.LockToCompare = \"Compare\";\r\n    this.Unlock = \"Remove comparison\";\r\n    this.CompareTopCategories = \"Compare top categories\";\r\n    this.Compare = \"Compare\";\r\n\r\n    (this.LockCrumbMode = (stacked: any) =>\r\n      `<b>${\r\n        stacked ? \"Stacked\" : \"Side-by-side\"\r\n      } charts</b><br> are used for comparison.<br><br>\r\n        Click to switch to ${stacked ? \"side-by-side\" : \"stacked\"} charts.`),\r\n      (this.SideBySide = \"Side-by-Side\");\r\n    this.Stacked = \"Stacked\";\r\n    this.GroupView = \"Group-View\";\r\n\r\n    this.CollapseSummary = \"Close\";\r\n    this.OpenSummary = \"Open\";\r\n    this.ExpandSummary = \"Maximize\";\r\n    this.RemoveSummary = \"Remove\";\r\n\r\n    this.Confirm = \"Confirm\";\r\n    this.Cancel = \"Cancel\";\r\n    this.OK = \"OK\";\r\n    this.Delete = \"Delete\";\r\n\r\n    this.NoAttribute = \"(None)\";\r\n\r\n    this[\"No [Record]\"] = \"No\";\r\n\r\n    this[\"Absolute (Breakdown)\"] = \"Absolute\";\r\n\r\n    this.SetPairTitle = (v: string) => `${v}->Relations`;\r\n\r\n    this.DialogSideBySideCharts =\r\n      \"<u class='learnIcon' data-helparticle='5e88ff692c7d3a7e9aea6475'>Stacked charts</u>\";\r\n    this.DialogStackedCharts =\r\n      \"<u class='learnIcon' data-helparticle='5e88ff692c7d3a7e9aea6475'>Stacked charts</u>\";\r\n    this.DialogComparisonSelection =\r\n      \"<u class='learnIcon' data-helparticle='5e8905262c7d3a7e9aea6483'>Compare-selection</u>\";\r\n    this.DialogRelativeBreakdown =\r\n      \"<u class='learnIcon' data-helparticle='5e8944932c7d3a7e9aea659c'>%-of-groups breakdown</u>\";\r\n    this.DialogDependentBreakdown =\r\n      \"<u class='learnIcon' data-helparticle='5e8944812c7d3a7e9aea659b'>%-of-compared breakdown</u>\";\r\n\r\n    (this.DialogEmptyResultSet =\r\n      \"Removing this category will create an empty result list.\"),\r\n      (this.DialogChangeCompare = (_to, _from) =>\r\n        `To compare by <i>${_to}</i>,<br> we need to remove the current comparison on <i>${_from}</i>.`);\r\n    this.DialogStackedMultiValue = (_name) =>\r\n      this.DialogStackedCharts +\r\n      ` cannot be enabled while comparing on<br> multi-valued categorical attribute:<br><i>${_name}</i>.`;\r\n    this.DialogSideBySideSingleValue = (_name) =>\r\n      this.DialogSideBySideCharts +\r\n      ` cannot be enabled while comparing on<br> single-valued categorical attribute:<br><i>${_name}</i><br>using ${this.DialogRelativeBreakdown}.`;\r\n    this.DialogCompareForRelative = `Apply ${this.DialogComparisonSelection} first before switching to ${this.DialogRelativeBreakdown}.`;\r\n    this.ComparedSelectionsLimit =\r\n      \"You cannot compare across more than five data groups.\";\r\n\r\n    this.ZoomLevelWarning =\r\n      \"\" +\r\n      \"Your current browser zoom level may not be optimal for charting.<br>\" +\r\n      \"For best results, \" +\r\n      \"<span class='link attemptToFix'><i class='fa fa-magic'></i>click here to fix and refresh</span>, or<br>\" +\r\n      \"if issue persists, manually reset your browser zoom and refresh the page.<br>\" +\r\n      \"<a class='link' style='font-weight: 300' href='https://help.keshif.me/article/49-resolving-chart-display-issues'>\" +\r\n      \"More info</a>\";\r\n\r\n    this.MeasureDescrLabel = (dashboard: Browser, summary: Attrib): string => {\r\n      const measureText_simple = dashboard.measureFunc_Count\r\n        ? \"\"\r\n        : `${dashboard.measureFunc} of ${dashboard.measureSummary.get().printName}`;\r\n\r\n      const comparedBy = dashboard.comparedAttrib?.printName ?? null;\r\n\r\n      const breakdown = dashboard.breakdownMode.get();\r\n\r\n      if (breakdown == \"absolute\") {\r\n        return (measureText_simple || dashboard.recordName) + (comparedBy ? ` by ${comparedBy}` : ``);\r\n      }\r\n\r\n      // PERCENTAGE-BASED BREAKDOWN\r\n\r\n      const measureText_all = measureText_simple || `${dashboard.isFiltered() ? \"filtered\" : \"all\"} ${dashboard.recordName}`;\r\n\r\n      if (!comparedBy) {\r\n        return `% of ${measureText_all}`;\r\n      }\r\n\r\n      switch(breakdown){\r\n        case \"dependent\": return `${summary.printName} % , out of ${comparedBy} ${measureText_simple}`;\r\n        case \"relative\": return `${comparedBy} % , out of ${summary.printName} ${measureText_simple}`;\r\n        case \"total\": return `Combined % , out of ${measureText_all}`;\r\n      }\r\n    };\r\n\r\n    this.measureText = (dashboard: Browser) => (dashboard.measureFunc_Count) \r\n        ? dashboard.recordName\r\n        : `${dashboard.measureFunc} of ${dashboard.measureSummary.get().printName}`;\r\n\r\n    this.measureText_2 = (dashboard: Browser) => (dashboard.measureFunc_Count)\r\n        ? \"\"\r\n        : `${dashboard.measureFunc} of ${dashboard.measureSummary.get().printName} of `;\r\n\r\n    this.ListButton = \"List\";\r\n    this.MapButton = \"Map\";\r\n    this.NodeButton = \"Node-Link\";\r\n    this.TimeSeriesButton = \"Time\";\r\n    this.ScatterButton = \"Scatter\";\r\n    this.RecordViewTypeTooltip = (v: string) =>\r\n      `View ${Base.browser.recordName} on <br><b>${v}</b> chart`;\r\n\r\n    this.Boost_NoSuggestions = \"No suggested changes. Explore on!\";\r\n\r\n    this.TooltipOne = (_v, dashboard: Browser) => `${dashboard.getValueLabel(\r\n      _v,\r\n      false,\r\n      1,\r\n      true\r\n    )} of\r\n        ${dashboard.isFiltered() ? dashboard.getFilteredSummaryText() : \"all\"}\r\n        ${dashboard.recordName}`;\r\n\r\n    this.Tooltip_OutOf = (_v, dashboard: Browser) => {\r\n      var str = \"\";\r\n      if (dashboard.absoluteBreakdown) return str;\r\n\r\n      str += \"<div class='percentageExplainer'>\";\r\n      if (dashboard.relativeBreakdown) {\r\n        str += \"% out of <i>\" + _v + \"</i>\";\r\n      } else if (dashboard.dependentBreakdown) {\r\n        str += \"% out of <i>\" + dashboard.comparedAttrib?.printName + \"</i>\";\r\n      } else {\r\n        str += \"% out of all\";\r\n      }\r\n      str += \"</div>\";\r\n      return str;\r\n    };\r\n\r\n    this.Size = \"Size\";\r\n    this.Larger = \"Larger\";\r\n    this.Smaller = \"Smaller\";\r\n    this.Pairs = \"Pairs\";\r\n\r\n    this.Color = \"Color\";\r\n    this.InvertColorTheme = \"Invert color theme\";\r\n    this.ChangeColorTheme = \"Change color theme\";\r\n\r\n    this.ReverseOrder = \"Reverse order\";\r\n    this.Reorder = \"Reorder\";\r\n    this.SwapAxis = \"Swap axis\";\r\n    this.Percentiles = \"Percentiles\";\r\n\r\n    this.OpenDataSource = \"Open Data Source\";\r\n    this.ShowInfoCredits = \"Info\";\r\n    this.ShowFullscreen = \"Fullscreen\";\r\n    this.PrintButton =\r\n      \"Click to activate print style<br><b>Shift+click</b> to print.\";\r\n\r\n    this.Search = \"Search\";\r\n    (this.TextSearchForRecords = `Type to search and highlight.<br><br>+\r\n        <b><u>Enter</u></b> to filter <i class=\"fa fa-filter\"></i>`),\r\n      (this.ClearTextSearch = \"Clear\");\r\n    this.Rows = \"Rows\";\r\n    this.More = \"More\";\r\n    this.ScrollToTop = \"Top\";\r\n    this.Percent = \"Percent\";\r\n    this.Absolute = \"Absolute\";\r\n    this.Relative = \"Relative\";\r\n    this.Dependent = \"Dependent\";\r\n    this.Breakdown = \"Breakdown\";\r\n    this.BreakdownBy = \"Breakdown by\";\r\n    this.Total = \"Prozentuale\";\r\n    this.SeeBreakdown = (v) =>\r\n      `See <b>${this[v.charAt(0).toUpperCase() + v.slice(1)]}</b> Breakdown`;\r\n    this.DragToFilter = \"Drag\";\r\n    this.And = \"And\";\r\n    this.Or = \"Or\";\r\n    this.Not = \"Not\";\r\n    this.NoData = \"Missing data\";\r\n    this.ValidData = \"Valid data\";\r\n    this.KeepNoData = \"Keep missing data\";\r\n    this.KeepValidData = \"Keep valid data\";\r\n\r\n    this.ZoomToFit = \"Zoom to fit\";\r\n    this.ZoomIn = \"Zoom In\";\r\n    this.ZoomOut = \"Zoom Out\";\r\n\r\n    this.MeasureScale = \"Scale\";\r\n    this.RowHeight = \"Bar Height\";\r\n    this.RowOrder = \"Order\";\r\n\r\n    this.Charts = \"Charts\";\r\n    this.Charts_Histogram = \"Histogram\";\r\n    this.Charts_Percentiles = \"Percentiles\";\r\n\r\n    this.BinScale = \"Value Axis Scale\";\r\n\r\n    this.BinWidth = \"Bin Width\";\r\n    this.BinWidth_Narrow = \"Narrow\";\r\n    this.BinWidth_Medium = \"Medium\";\r\n    this.BinWidth_Wide = \"Wide\";\r\n\r\n    this.BinHeight = \"Height\";\r\n    this.BinHeight_Compact = \"Compact\";\r\n    this.BinHeight_Short = \"Short\";\r\n    this.BinHeight_Medium = \"Medium\";\r\n    this.BinHeight_Tall = \"Tall\";\r\n\r\n    this.DashboardAnalyticsConfig = \"Dashboard Configuration\";\r\n    this.ViewAsMap = \"View as Map\";\r\n    this.ViewAsList = \"View as List\";\r\n    this.ViewSetMatrix = \"Show/Hide pair-wise relations\";\r\n\r\n    this.MissingLocations = \"Missing<br>Locations\";\r\n    this.Reset = \"Reset\";\r\n\r\n    this.measure_Sum = \"Sum\";\r\n    this.measure_Avg = \"Average\";\r\n    this.measure_Count = \"Count\";\r\n\r\n    this.Of_NumberRecord = \"of\";\r\n\r\n    this.AutoPlay = \"Autoplay\";\r\n    this.StopAutoPlay = \"Stop Autoplay\";\r\n\r\n    this.SaveSelection = \"Save selection\";\r\n    this.EditFormula = \"Edit formula\";\r\n\r\n    this.Attributes = \"Attributes\";\r\n    this.DatasetButton = \"Attributes\";\r\n    this.AdjustButton = \"Adjust\";\r\n\r\n    this.SaveShareButton = \"Save\";\r\n\r\n    this.CategoricalAttribute = \"Categorical\";\r\n    this.NumericAttribute = \"Numeric\";\r\n    this.TimestampAttribute = \"Timestamp\";\r\n    this.TimeseriesAttribute = \"Timeseries\";\r\n    this.LocationAttribute = \"Geographic\";\r\n    this.UnknownAttribute = \"Unknown\";\r\n    this.UniqueAttribute = \"Unique\";\r\n    this.MultiValuedAttribute = \"Multi-valued\";\r\n    this.FunctionAttribute = \"Uses Custom Function\";\r\n    this.ContentAttribute = \"Content\";\r\n\r\n    this.Configure = \"Configure\";\r\n    this.Derive = \"Derive\";\r\n\r\n    // Adjust\r\n    this.EditTitle = \"Rename\";\r\n    this.RemoveRecordPanel = \"Remove record panel\";\r\n\r\n    this.EmptyDashboardNotice = `To add data into the dashboard : <br><br>\r\n          <i class='fa fa-angle-double-down'></i> switch to <span style='font-weight: bolder'>Author</span> mode,<br>and <br>\r\n          <i class='fa fa-angle-double-left'></i> double-click, or\r\n          click+drag an attribute into this canvas.\r\n          <br> <img class='kshfLogo_K'>`;\r\n\r\n    this.LinearSequence =\r\n      \"<span style='font-size:0.8em; opacity: 0.75'>(1,2,3,4)</span>\";\r\n    this.Log2Sequence =\r\n      \"<span style='font-size:0.8em; opacity: 0.75'>(1,2,4,8)</span>\";\r\n    this.Log10Sequence =\r\n      \"<span style='font-size:0.8em; opacity: 0.75'>(1,10,100)</span>\";\r\n\r\n    this.Error_CannotFindMap = (mapName) => `<i class='fa fa-frown'></i> We could not find the map [${mapName}].`;\r\n    this.Error_CannotLoadMap = (mapName) => `<i class='fa fa-frown'></i> We could not load the map [${mapName}].`;\r\n    this.Error_CannotMatchMap = (mapName) => `<i class='fa fa-frown'></i> We could not match any location name with the map [${mapName}].`;\r\n\r\n    // Platform-specific\r\n    this.RemoveDataset = \"Remove Dataset\";\r\n    this.Bookmark = \"Bookmark<br><i>Shift+Click to delete</i>\";\r\n    // Keeping these because they are referenced from lang table to create derived summaries\r\n    this.Lookup_Months = {\r\n      0: \"January\",\r\n      1: \"February\",\r\n      2: \"March\",\r\n      3: \"April\",\r\n      4: \"May\",\r\n      5: \"June\",\r\n      6: \"July\",\r\n      7: \"August\",\r\n      8: \"September\",\r\n      9: \"October\",\r\n      10: \"November\",\r\n      11: \"December\",\r\n    };\r\n    this.Lookup_DaysOfWeek = {\r\n      0: \"Sunday\",\r\n      1: \"Monday\",\r\n      2: \"Tuesday\",\r\n      3: \"Wednesday\",\r\n      4: \"Thursday\",\r\n      5: \"Friday\",\r\n      6: \"Saturday\",\r\n    };\r\n  }\r\n}\r\n","import { i18n_EN } from \"./i18n_EN.js\";\r\n\r\ninterface i18nI {\r\n  //[index: string]: (string | (()=>string) );\r\n  [index: string]: any;\r\n}\r\n\r\nlet ActiveLanguage = null; // internal variable (singleton, always created);\r\n\r\nexport let LoadLanguage = function (langSpec) {\r\n  ActiveLanguage = new Proxy(langSpec, {\r\n    // returns the value in indexed position if it exists. Otherwise, returns the key.\r\n    get: function (obj, prop) {\r\n      return prop in obj ? obj[prop] : prop;\r\n    },\r\n  });\r\n};\r\n\r\n// Main object used to index translation keys.\r\n// Loads the default language (i18n_EN) if it's not defined yet.\r\nexport var i18n: i18nI = new Proxy(\r\n  {},\r\n  {\r\n    // using proxy feature to adjust return values...\r\n    get: function (obj, prop) {\r\n      // if not defined, load English\r\n      if (!ActiveLanguage) LoadLanguage(new i18n_EN());\r\n      return ActiveLanguage[prop];\r\n    },\r\n  }\r\n);\r\n","import { BreadCrumb } from \"./UI/Breadcrumb\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Base } from \"./Base\";\r\nimport { Record } from \"./Record\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { i18n } from \"./i18n\";\r\n\r\n/** -- */\r\nexport abstract class Filter_Base {\r\n  protected readonly browser: Browser;\r\n  protected readonly filterID: number;\r\n\r\n  // Each filter has its own breadcrumb\r\n  public breadcrumb: BreadCrumb = null;\r\n\r\n  private _isFiltered: boolean = false;\r\n  get isFiltered() {\r\n    return this._isFiltered;\r\n  }\r\n\r\n  public how: \"All\" | \"LessResults\" | \"MoreResults\" = \"All\";\r\n\r\n  /** -- */\r\n  constructor(_browser: Browser) {\r\n    this.browser = _browser;\r\n    this.filterID = this.browser.filterCounter++;\r\n\r\n    // Initialize all records to true (Not filtered) for current filter ID\r\n    this.browser.records.forEach((record) =>\r\n      record.setFilterCache(this.filterID, true)\r\n    );\r\n\r\n    this.browser.filters.push(this);\r\n  }\r\n\r\n  abstract get title(): string;\r\n  abstract filterView_Detail(): string;\r\n  abstract onClear(forceUpdate: boolean): void;\r\n  abstract onFilter(): void;\r\n  abstract importFilter(config: any): void;\r\n  abstract exportFilter(): any;\r\n\r\n  /** -- */\r\n  setFiltered(update = true) {\r\n    if (this.browser.singleFiltering) {\r\n      // TODO check logic\r\n      return;\r\n    }\r\n\r\n    this._isFiltered = true;\r\n\r\n    if (!update) return;\r\n\r\n    this.browser.refresh_filterClearAll();\r\n\r\n    this.applyFilter();\r\n\r\n    var stateChanged = false;\r\n\r\n    var how = 0;\r\n    if (this.how === \"LessResults\") how = -1;\r\n    if (this.how === \"MoreResults\") how = 1;\r\n    this.browser.records.forEach((record) => {\r\n      if (how < 0 && record.filteredOut) return;\r\n      if (how > 0 && !record.filteredOut) return;\r\n      stateChanged = record.refreshFilterCache() || stateChanged;\r\n    });\r\n\r\n    if (stateChanged) {\r\n      this.browser.updateRecordCount_Active();\r\n      this.browser.updateAfterFilter();\r\n    }\r\n  }\r\n\r\n  /* -- */\r\n  applyFilter() {\r\n    if(!this.breadcrumb){\r\n      this.breadcrumb = this.browser.createNewCrumb();\r\n    }\r\n\r\n    this.onFilter();\r\n    \r\n    this.breadcrumb.showCrumb(\"Filter\", this);\r\n  }\r\n\r\n  /** -- */\r\n  getRichText() {\r\n    return `${this.title}: ${this.filterView_Detail()}`;\r\n  }\r\n  /** -- */\r\n  getRichText_flipped() {\r\n    return `${this.filterView_Detail()} [${this.title}]`;\r\n  }\r\n\r\n  /** -- */\r\n  clearFilter(forceUpdate = true) {\r\n    if (!this._isFiltered) return false; // TO-DO: Does this break anything?\r\n    this._isFiltered = false;\r\n\r\n    this.browser.records.forEach((rec) =>\r\n      rec.setFilterCache(this.filterID, true)\r\n    );\r\n\r\n    this.breadcrumb?.removeCrumb();\r\n    this.breadcrumb = null;\r\n\r\n    this.onClear(forceUpdate);\r\n\r\n    if (forceUpdate !== false) {\r\n      this.browser.records.forEach(\r\n        (rec) => rec.filteredOut && rec.refreshFilterCache()\r\n      );\r\n      this.browser.updateRecordCount_Active();\r\n      this.browser.updateAfterFilter(true);\r\n    }\r\n\r\n    if (!this.browser.isFiltered()) {\r\n      this.browser.filters_wrap_letItWrap = false;\r\n      this.browser.DOM.breadCrumbs_Filter.classed(\"collapsed\", false);\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n\r\n/** adds this attribute - these filters work on an individual attribute */\r\nexport abstract class Filter extends Filter_Base {\r\n  public abstract readonly attrib: Attrib;\r\n\r\n  public get noValueAggr(){\r\n    return this.attrib.noValueAggr;\r\n  }\r\n\r\n  /** -- */\r\n  constructor(_browser: Browser) {\r\n    super(_browser);\r\n  }\r\n\r\n  /** -- */\r\n  onFilter(): void {\r\n    this.attrib.block?.refreshUIFiltered(true);\r\n\r\n    // clear compare selections - these items cannot be within the filtered area\r\n    if (this.attrib.isComparedAttrib()) {\r\n      Base.Compare_List.forEach((cT) => {\r\n        if (this.browser.selectedAggrs[cT]) {\r\n          this.browser.clearSelect_Compare(cT, true, true);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  /** -- */\r\n  onClear(forceUpdate = false) {\r\n    this.attrib.block?.refreshUIFiltered(false);\r\n    this.attrib.block?.onClearFilter(forceUpdate);\r\n  }\r\n}\r\n\r\n/**\r\n * @constructor\r\n */\r\nexport class Filter_Record extends Filter_Base {\r\n  private removedRecords: Record[];\r\n\r\n  /** -- */\r\n  constructor(browser: Browser) {\r\n    super(browser);\r\n    this.removedRecords = [];\r\n  }\r\n\r\n  /** -- */\r\n  removeRecord(_record: Record) {\r\n    _record.setFilterCache(this.filterID, false);\r\n    this.removedRecords.push(_record);\r\n    this.setFiltered();\r\n  }\r\n\r\n  /** -- */\r\n  get title(): string {\r\n    return `<i class='fa fa-times-circle></i> ${i18n.Removed}`;\r\n  }\r\n  /** -- */\r\n  onClear() {\r\n    this.removedRecords = [];\r\n  }\r\n  /** -- */\r\n  filterView_Detail() {\r\n    return this.removedRecords.length + \" \" + this.browser.recordName;\r\n  }\r\n  /** -- */\r\n  onFilter(): void {}\r\n\r\n  /** -- */\r\n  exportFilter(): string[] {\r\n    return this.removedRecords.map((r) => r.id);\r\n  }\r\n\r\n  /** -- */\r\n  importFilter(_: string[]): void {\r\n    var recordIndex = Base.tables.get(this.browser.primaryTableName);\r\n    if (!recordIndex) return;\r\n\r\n    this.removedRecords = [];\r\n\r\n    _.forEach((recID) => {\r\n      var record = recordIndex[recID];\r\n      if (record) {\r\n        this.removedRecords.push(record);\r\n        record.setFilterCache(this.filterID, false);\r\n      }\r\n    });\r\n\r\n    if (this.removedRecords.length > 0) {\r\n      this.setFiltered(false);\r\n      this.applyFilter();\r\n    }\r\n  }\r\n}\r\n\r\n/** -- */\r\nexport class Filter_Text extends Filter_Base {\r\n  private multiMode: \"and\" | \"or\" = \"and\";\r\n  // This is the text query string, populated by user input\r\n  private _queryString: string = null;\r\n  // This is the parsed string (multiple components to match)\r\n  private filterQuery: string[];\r\n\r\n  /** -- */\r\n  constructor(browser: Browser) {\r\n    super(browser);\r\n    this._queryString = null;\r\n  }\r\n\r\n  /** -- */\r\n  get title(): string {\r\n    return this.browser.recordDisplay.textAttrib_Brief.attribName;\r\n  }\r\n  /** -- */\r\n  filterView_Detail() {\r\n    return this._queryString;\r\n  }\r\n\r\n  /** -- */\r\n  onClear() {\r\n    this.browser.recordDisplay.DOM.recordTextSearch.classed(\"showClear\", false);\r\n    this.browser.recordDisplay.DOM.recordTextSearch\r\n      .select(\"input\")\r\n      .node().value = \"\";\r\n  }\r\n\r\n  /** -- */\r\n  onFilter(): void {\r\n    this.browser.recordDisplay.DOM.recordTextSearch.classed(\"showClear\", true);\r\n\r\n    // go over all the records in the list, search each keyword separately\r\n    var _summary = this.browser.recordDisplay.textAttrib_Brief;\r\n    this.browser.records.forEach((record) => {\r\n      var v = _summary.getRecordValue(record);\r\n      var f = false;\r\n      if (v) {\r\n        let v2 = v.join(\" \").toLowerCase();\r\n        if (this.multiMode === \"or\") {\r\n          f = !this.filterQuery.every((v_i) => v2.indexOf(v_i) === -1);\r\n        } else if (this.multiMode === \"and\") {\r\n          f = this.filterQuery.every((v_i) => v2.indexOf(v_i) !== -1);\r\n        }\r\n      }\r\n      record.setFilterCache(this.filterID, f);\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  set queryString(v) {\r\n    this._queryString = v.toLowerCase();\r\n    // convert string to query pieces\r\n    this.filterQuery = [];\r\n    if (this._queryString !== \"\") {\r\n      // split the input by \" character\r\n      this._queryString.split('\"').forEach((block, i) => {\r\n        if (i % 2 === 0) {\r\n          block.split(/\\s+/).forEach((q) => this.filterQuery.push(q));\r\n        } else {\r\n          this.filterQuery.push(block);\r\n        }\r\n      });\r\n      // Remove the empty strings\r\n      this.filterQuery = this.filterQuery.filter((v) => v !== \"\");\r\n    }\r\n  }\r\n  get queryString(){\r\n    return this._queryString;\r\n  }\r\n\r\n  /** -- */\r\n  importFilter(_) {\r\n    if (typeof _ === \"string\") _ = { query: _ };\r\n    if (!_.query) return;\r\n    this.queryString = _.query;\r\n    if (_.multiMode) this.multiMode = _.multiMode;\r\n    if (this.isFiltered) {\r\n      this.browser.recordDisplay.DOM.recordTextSearch\r\n        .select(\".textSearchInput\")\r\n        .node().value = _.query;\r\n      this.applyFilter();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  exportFilter() {\r\n    return {\r\n      query: this._queryString,\r\n      multiMode: this.multiMode,\r\n    };\r\n  }\r\n}\r\n","import * as Popper from \"@popperjs/core\";\r\nimport { select } from \"../d3_select\";\r\n\r\nimport { Base } from \"../Base\";\r\nimport { i18n } from \"../i18n\";\r\n\r\nconst d3 = { select };\r\n\r\ndeclare let window: any;\r\n\r\nexport class Modal {\r\n  /** -- */\r\n  static alert(message, header = \"\") {\r\n    return new Promise((resolve, reject) => {\r\n      var _wrapper;\r\n      if (Base.browser) {\r\n        _wrapper = Base.browser.DOM.overlay_wrapper;\r\n      } else {\r\n        Base.DOM.Modal = d3\r\n          .select(\"body\")\r\n          .append(\"div\")\r\n          .attr(\"class\", \"kshf kshf_Modal\");\r\n        _wrapper = Base.DOM.Modal.append(\"div\").attr(\r\n          \"class\",\r\n          \"overlay_wrapper\"\r\n        );\r\n      }\r\n      var _root = _wrapper\r\n        .append(\"div\")\r\n        .attr(\"class\", \"overlay_content overlay_modal\")\r\n        .html(`<div class='overlay_Header'>${header}<i class='fa fa-warning'></i></div>\r\n          <div class='overlay_Content'>${message}</div>\r\n          <div class='ModalButtons'>\r\n            <div class='modalButton confirmButton'>${i18n.OK}</div>\r\n          </div>`);\r\n\r\n      Modal.createHelpScoutLinks(_root, true);\r\n\r\n      _wrapper.attr(\"show\", \"modal\");\r\n\r\n      _root.select(\".confirmButton\").on(\"click\", (event) => {\r\n        Modal._removeModal(_wrapper);\r\n        if (resolve) resolve(true);\r\n      });\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  static confirm(message, okText, cancelText = null) {\r\n    return new Promise((resolve, reject) => {\r\n      var _wrapper;\r\n      if (Base.browser) {\r\n        _wrapper = Base.browser.DOM.overlay_wrapper;\r\n      } else {\r\n        // there's no keshif browser, attach to main body of the page.\r\n        Base.DOM.Modal = d3\r\n          .select(\"body\")\r\n          .append(\"div\")\r\n          .attr(\"class\", \"kshf kshf_Modal\");\r\n        _wrapper = Base.DOM.Modal.append(\"div\").attr(\r\n          \"class\",\r\n          \"overlay_wrapper\"\r\n        );\r\n      }\r\n\r\n      _wrapper.attr(\"show\", \"modal\");\r\n\r\n      var _root = _wrapper\r\n        .append(\"div\")\r\n        .attr(\"class\", \"overlay_content overlay_modal\")\r\n        .html(`<div class='overlay_Header'><i class='fa fa-question-circle'></i></div>\r\n          <div class='overlay_Content'>${message}</div>\r\n          <div class='ModalButtons'>\r\n            <div class='modalButton confirmButton'>${okText || i18n.OK}</div>\r\n            <div class='modalButton rejectButton'>${\r\n              cancelText || i18n.Cancel\r\n            }</div>\r\n          </div>\r\n          `);\r\n\r\n      _root.select(\".confirmButton\").on(\"click\", (event) => {\r\n        Modal._removeModal(_wrapper);\r\n        resolve(new MouseEvent(event.type, event));\r\n      });\r\n      _root.select(\".rejectButton\").on(\"click\", () => {\r\n        Modal._removeModal(_wrapper);\r\n        if (reject) reject(false);\r\n      });\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  static prompt(message: string, _default?: any) {\r\n    return window.prompt(message, _default);\r\n    // TO-DO: Make it a promise & modal dialogue box\r\n  }\r\n\r\n  /** -- */\r\n  static autoChanges(_changes) {\r\n    return new Promise(function (resolve, reject) {\r\n      var _wrapper;\r\n      if (Base.browser) {\r\n        _wrapper = Base.browser.DOM.overlay_wrapper;\r\n        _wrapper.selectAll(\".overlay_modal\").remove();\r\n      } else {\r\n        Base.DOM.Modal = d3\r\n          .select(\"body\")\r\n          .append(\"div\")\r\n          .attr(\"class\", \"kshf kshf_Modal\");\r\n        _wrapper = Base.DOM.Modal.append(\"div\").attr(\r\n          \"class\",\r\n          \"overlay_wrapper\"\r\n        );\r\n      }\r\n      var _root = _wrapper\r\n        .append(\"div\")\r\n        .attr(\"class\", \"overlay_content overlay_modal\").html(`\r\n          <div class='overlay_Header'>Review Changes <i class='fa fa-question-circle'></i></div>\r\n          <div class='overlay_Content'></div>\r\n          <div class='ModalButtons'>\r\n            <div class='modalButton confirmButton'>OK</div>\r\n            <div class='modalButton rejectButton'>Cancel</div>\r\n          </div>\r\n          `);\r\n\r\n      _wrapper.attr(\"show\", \"modal\");\r\n      var _ = _root.select(\".overlay_Content\");\r\n\r\n      _.html(\"\").style(\"text-align\", \"left\"); // clear content\r\n\r\n      _.append(\"div\").html(\"We identified the following potential changes: \");\r\n\r\n      var changeList = _.append(\"table\").attr(\"class\", \"changeList\");\r\n      var __ = changeList\r\n        .selectAll(\".changeRow\")\r\n        .data(_changes)\r\n        .enter()\r\n        .append(\"tr\")\r\n        .attr(\"class\", \"changeRow\");\r\n\r\n      __.append(\"td\")\r\n        .attr(\"class\", \"changeIcon\")\r\n        .html((d) => d.i);\r\n      __.append(\"td\")\r\n        .attr(\"class\", \"changeText\")\r\n        .html((d) => d.q);\r\n      var _t = __.append(\"td\").attr(\"class\", \"changeToggle\");\r\n      _t.append(\"input\")\r\n        .attr(\"class\", \"theToggleInput\")\r\n        .attr(\"type\", \"checkbox\")\r\n        .attr(\"checked\", (d) => {\r\n          return d.change ? true : null;\r\n        })\r\n        .attr(\"id\", (_, i) => {\r\n          return \"toggle_\" + i;\r\n        })\r\n        .on(\"change\", (event, d) => {\r\n          d.change = !d.change;\r\n        });\r\n      _t.append(\"label\")\r\n        .attr(\"class\", \"theToggleLabel\")\r\n        .attr(\"for\", (_, i) => {\r\n          return \"toggle_\" + i;\r\n        });\r\n\r\n      _root.select(\".confirmButton\").on(\"click\", () => {\r\n        _wrapper.attr(\"show\", \"none\");\r\n        _root.classed(\"modalAlert\", false);\r\n        if (Base.DOM.Modal) Base.DOM.Modal.remove();\r\n        if (resolve) resolve(_changes);\r\n      });\r\n      _root.select(\".rejectButton\").on(\"click\", () => {\r\n        _wrapper.attr(\"show\", \"none\");\r\n        _root.remove();\r\n        if (Base.DOM.Modal) Base.DOM.Modal.remove();\r\n        if (reject) reject(false);\r\n      });\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  static _removeModal(_wrapper) {\r\n    _wrapper.select(\".overlay_modal\").remove();\r\n    // Keshif-dashboard\r\n    if (_wrapper.selectAll(\".overlay_modal\").nodes().length === 0) {\r\n      _wrapper.attr(\"show\", \"none\");\r\n    }\r\n    // Non-Keshif modal window\r\n    Base.DOM.Modal?.remove();\r\n  }\r\n\r\n  /** -- */\r\n  static popupMenu(event, template, param, opts: {placement} = null) {\r\n    var dashRootDOM = Base.browser.DOM.root;\r\n\r\n    if (\r\n      Base.popupInstance &&\r\n      Base.popupInstance.state.elements.reference === event.target\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    // remove existing popup menu\r\n    if (dashRootDOM.select(\".contextMenu\")) {\r\n      dashRootDOM.select(\".contextMenu\").remove();\r\n    }\r\n\r\n    var contextMenu = dashRootDOM.append(\"div\").attr(\"class\", \"contextMenu\");\r\n\r\n    var contextArrow = contextMenu.append(\"div\").attr(\"class\", \"popperArrow\");\r\n\r\n    var removePopper = () => {\r\n      contextMenu.remove();\r\n      if (Base.popupInstance) {\r\n        var t = Base.popupInstance.state.elements.reference;\r\n        while (t && t.classList) {\r\n          t.classList.remove(\"popupVisible\");\r\n          t = t.parentNode;\r\n        }\r\n      }\r\n      Base.popupInstance = null;\r\n    };\r\n\r\n    Base.popupInstance = Popper.createPopper(\r\n      event.currentTarget, // reference\r\n      contextMenu.node(), // popper\r\n      {\r\n        placement: opts?.placement ?? \"right-start\",\r\n        strategy: \"absolute\",\r\n        modifiers: [\r\n          {\r\n            name: \"flip\",\r\n            enabled: true,\r\n          },\r\n          {\r\n            name: \"offset\",\r\n            options: {\r\n              offset: [0, 8],\r\n            },\r\n          },\r\n          {\r\n            name: \"arrow\",\r\n            options: {\r\n              element: contextArrow.node(),\r\n              padding: 4,\r\n            },\r\n          },\r\n        ],\r\n      }\r\n    );\r\n\r\n    contextMenu\r\n      .append(\"div\")\r\n      .attr(\"class\", \"popupMenu_Close\")\r\n      .tooltip(i18n.Close)\r\n      .html(\"<i class='fa fa-window-close'></i>\")\r\n      .on(\"click\", () => removePopper());\r\n\r\n    contextMenu\r\n      .append(\"div\")\r\n      .attr(\"class\", \"contextMenu_Header\")\r\n      .html(i18n[template.name]);\r\n\r\n    var contextMenu_Items = contextMenu\r\n      .append(\"div\")\r\n      .attr(\"class\", \"contextMenu_Items\");\r\n\r\n    contextMenu_Items.selectAll(\".popupMenuItem\").remove();\r\n\r\n    var isWhen = (item) => !item.when || item.when(param);\r\n\r\n    var isApplicable = (item) => {\r\n      // we know it's not applicable\r\n      if (item.when && !item.when(param)) return false;\r\n\r\n      // no options, just check current item\r\n      if (!item.options) return isWhen(item);\r\n\r\n      // convert from function to proper list\r\n      var _options = item.options;\r\n      if (typeof item.options === \"function\") {\r\n        if (!isWhen(item)) return false;\r\n        _options = item.options(param);\r\n      }\r\n\r\n      return _options.some(isApplicable) && isWhen(item);\r\n    };\r\n\r\n    var addTitleText = (_) => {\r\n      _.filter((item) => item.iconClass)\r\n        .append(\"span\")\r\n        .attr(\"class\", \"popupMenuItem_Header_Icon\")\r\n        .append(\"span\")\r\n        .attr(\"class\", (item) => item.iconClass);\r\n\r\n      _.filter((item) => item.iconXML)\r\n        .append(\"span\")\r\n        .attr(\"class\", \"popupMenuItem_Header_Icon\")\r\n        .html((item) => item.iconXML);\r\n\r\n      _.append(\"span\")\r\n        .attr(\"class\", \"popupMenuItem_Header_Text\")\r\n        .call((header) => {\r\n          header\r\n            .append(\"div\")\r\n            .attr(\"class\", \"mainText\")\r\n            .html((item) => i18n[item.name]);\r\n          header\r\n            .filter((item) => item.sampleValue)\r\n            .append(\"div\")\r\n            .attr(\"class\", \"sampleValue\")\r\n            .html((item) => i18n[item.sampleValue]);\r\n        });\r\n\r\n      _.filter((item) => item.helparticle)\r\n        .append(\"span\")\r\n        .attr(\"class\", \"helparticle fa fa-question-circle\")\r\n        .attr(\"data-helparticle\", (item) => item.helparticle)\r\n        .tooltip(i18n[\"Learn more\"], { placement: \"bottom\" })\r\n        .on(\"click\", (event, item) => {\r\n          Modal.attachHelpScout().then(() =>\r\n            window.Beacon(\"article\", item.helparticle, { type: \"modal\" })\r\n          );\r\n          event.stopPropagation();\r\n          event.preventDefault();\r\n        });\r\n\r\n      _.filter((item) => item.options)\r\n        .append(\"i\")\r\n        .attr(\"class\", \"expandCollapseIcon fa fa-caret-down\");\r\n\r\n      _.each((item, i, nodes) => {\r\n        if (item.onName) item.onName(nodes[i]);\r\n      });\r\n    };\r\n\r\n    function insertChildItems(DOM, items, parentD = null) {\r\n      DOM.selectAll(\".popupMenuItem\")\r\n        .data(items.filter(isApplicable))\r\n        .enter()\r\n        .append(\"div\")\r\n        .attr(\"class\", \"popupMenuItem\")\r\n        .classed(\"expanded\", (item) => item.expanded)\r\n        .attr(\"data-itemID\", (item) => item.id || null)\r\n        .call((_) => {\r\n          _.append(\"div\")\r\n            .attr(\"class\", \"popupMenuItem_Header\")\r\n            .classed(\"active\", (item) => {\r\n              if (item.active) {\r\n                if (typeof item.active === \"function\") {\r\n                  return item.active(param);\r\n                } else {\r\n                  return !!item.active;\r\n                }\r\n              }\r\n            })\r\n            .each((d2) => {\r\n              d2.parentD = parentD;\r\n            })\r\n            .on(\"click\", processItem)\r\n            .call(addTitleText);\r\n          _.append(\"div\")\r\n            .attr(\"class\", \"popupMenuItem_Children\")\r\n            .each((item, i, nodes) => {\r\n              if (item.expanded) {\r\n                // do not over-write this.\r\n                // the options function, if there is, need to be dynamically evaluated every time.\r\n                var _options = item.options;\r\n                if (typeof item.options === \"function\" && isWhen(item))\r\n                  _options = item.options(param);\r\n\r\n                insertChildItems(d3.select(nodes[i]), _options, item);\r\n              }\r\n            });\r\n        });\r\n    }\r\n\r\n    function processItem(_event, item) {\r\n      var _path = [],\r\n        t;\r\n      for (t = item.parentD; t; t = t.parentD) {\r\n        _path = [t.name].concat(_path);\r\n      }\r\n\r\n      if (!item.options) {\r\n        // find the \"do\" function in hierarchy, and execute it\r\n        for (var curNode = item; curNode; curNode = curNode.parentD) {\r\n          if (curNode.do) {\r\n            curNode.do(param, item.value, _path);\r\n            break;\r\n          }\r\n        }\r\n        removePopper();\r\n        return;\r\n      }\r\n\r\n      // has options\r\n      _path.push(item.name);\r\n\r\n      // swap expanded setting\r\n      this.parentNode.classList.toggle(\"expanded\");\r\n\r\n      var _ = d3.select(this.parentNode);\r\n      if (_.classed(\"expanded\")) {\r\n        // close all items\r\n        //contextMenu_Items.selectAll(\".popupMenuItem\").classed(\"expanded\",false);\r\n        // but, enable current item\r\n        var children = d3.select(this.parentNode.childNodes[1]);\r\n        children.selectAll(\".popupMenuItem\").remove();\r\n\r\n        // do not over-write this.\r\n        // the options function, if there is, need to be dynamically evaluated every time.\r\n        var _options = item.options;\r\n        if (typeof item.options === \"function\" && isWhen(item))\r\n          _options = item.options(param);\r\n\r\n        insertChildItems(children, _options, item);\r\n      }\r\n\r\n      Base.popupInstance.update();\r\n    }\r\n\r\n    insertChildItems(contextMenu_Items, template.items);\r\n\r\n    Base.popupInstance.update();\r\n\r\n    setTimeout(() => contextMenu.classed(\"visible\", true), 10);\r\n  }\r\n\r\n  /** -- */\r\n  static helpUI() {\r\n    return Modal.attachHelpScout().then(() => window.Beacon(\"open\"));\r\n  }\r\n\r\n  /** -- */\r\n  static createHelpScoutLinks(dom, withTooltip = false) {\r\n    dom = dom.selectAll(\"[data-helparticle]\");\r\n\r\n    dom.on(\"click\", (event) => {\r\n      var articleID = event.currentTarget.dataset.helparticle;\r\n      if (!articleID) return;\r\n      Modal.attachHelpScout().then(() =>\r\n        window.Beacon(\"article\", articleID, { type: \"modal\" })\r\n      );\r\n    });\r\n\r\n    if (withTooltip) {\r\n      dom.tooltip(i18n[\"Learn more\"]);\r\n    }\r\n  }\r\n  /** -- */\r\n  static attachHelpScout() {\r\n    if (!window.Beacon) {\r\n      (window.Beacon = function (t, n, a) {\r\n        window.Beacon.readyQueue.push({ method: t, options: n, data: a });\r\n      }),\r\n        (window.Beacon.readyQueue = []);\r\n    }\r\n\r\n    return import(\"https://beacon-v2.helpscout.net/\")\r\n      .then(() => {\r\n        if (!window.Beacon.readyQueue) return;\r\n        window.Beacon(\"init\", Base.helpscoutBeacon);\r\n\r\n        if (window.firebase && window.firebase.auth) {\r\n          var user = window.firebase.auth().currentUser;\r\n          if (user) {\r\n            window.Beacon(\"identify\", {\r\n              name: user.displayName || user.email,\r\n              email: user.email,\r\n              avatar: user.photoURL,\r\n              uid: user.uid,\r\n              portal_name: \"TODO\",\r\n            });\r\n          }\r\n        }\r\n      })\r\n      .catch(() => {\r\n        Modal.alert(\r\n          \"Script blocking extensions (Adblock, NoScript, uBlock, ...)<br>\" +\r\n            \"may be blocking our embedded help system. \" +\r\n            \"<a href='https://docs.helpscout.net/article/911-beacon-ad-blockers' target='_blank'>Learn more</a>\",\r\n          \"<i class='fa fa-frown'></i> Cannot display the help.\"\r\n        );\r\n        throw new Error();\r\n      });\r\n  }\r\n}\r\n","import DOMPurify from \"dompurify/dist/purify.es\";\r\n\r\nimport { Record } from \"./Record\";\r\nimport { Base } from \"./Base\";\r\nimport { i18n } from \"./i18n\";\r\n\r\nimport { CompareType, MeasureType } from \"./Types\";\r\nimport { Attrib } from \"./Attrib\";\r\n\r\ntype AggrMeasure = {\r\n  recCnt: number;\r\n  measure: number;\r\n  // used for visualization\r\n  scale?: number;\r\n  offset?: number;\r\n};\r\n\r\n/** -- */\r\nexport class Aggregate {\r\n  // Records which are mapped to this aggregate\r\n  public records: Record[] = [];\r\n\r\n  // the attribute which this aggregate is attached to\r\n  // may not be attached to an attribute\r\n  public readonly attrib?: Attrib;\r\n\r\n  /** -- */\r\n  constructor(attrib: Attrib) {\r\n    this.attrib = attrib;\r\n    this.resetAggregateMeasures();\r\n  }\r\n\r\n  /** -- */\r\n  get label(): string {\r\n    return \"\";\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Selection (comparison) status\r\n  // ********************************************************************\r\n\r\n  // comparison status of the aggregate (comparisons may not be locked (highlighted))\r\n  private _compared?: CompareType;\r\n  get compared() {\r\n    return this._compared;\r\n  }\r\n\r\n  // locked selection status: true if compared and locked (not highlighting)\r\n  protected _locked: boolean = false;\r\n  get locked(): boolean {\r\n    return this._locked;\r\n  }\r\n\r\n  private Active: AggrMeasure;\r\n  private Total: AggrMeasure;\r\n  private Compare_A: AggrMeasure;\r\n  private Compare_B: AggrMeasure;\r\n  private Compare_C: AggrMeasure;\r\n  private Compare_D: AggrMeasure;\r\n  private Compare_E: AggrMeasure;\r\n  private Other: AggrMeasure; // non-compared\r\n\r\n  // ********************************************************************\r\n  // Visual status\r\n  // ********************************************************************\r\n\r\n  public isVisible: boolean;\r\n  public isVisibleBefore: boolean;\r\n\r\n  // Set false to signal that this aggregate should not be rendered\r\n  public usedAggr: boolean = true;\r\n\r\n  // DOM elements\r\n  public DOM: {\r\n    aggrGlyph?: Element;\r\n  } = { aggrGlyph: undefined };\r\n\r\n  /** -- */\r\n  setAggrGlyph(v: Element) {\r\n    this.DOM.aggrGlyph = v;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Access to key data\r\n  // ********************************************************************\r\n\r\n  measure(m: MeasureType): number {\r\n    if (Base.browser.measureFunc.is(\"Avg\")) {\r\n      var r = this[m].recCnt;\r\n      return r === 0 ? 0 : this[m].measure / r; // avoids division by zero\r\n    }\r\n    return this[m].measure;\r\n  }\r\n  recCnt(m: MeasureType): number {\r\n    return this[m].recCnt;\r\n  }\r\n  scale(m: MeasureType): number {\r\n    return this[m].scale;\r\n  }\r\n  offset(m: MeasureType): number {\r\n    return this[m].offset;\r\n  }\r\n\r\n  ratioToActive(t: MeasureType) {\r\n    return this.Active.measure ? this[t].measure / this.Active.measure : 0;\r\n  }\r\n\r\n  sumOffsetScale(m: MeasureType): number {\r\n    return this[m].offset + this[m].scale;\r\n  }\r\n\r\n  setOffset(m: MeasureType, v: number): void {\r\n    this[m].offset = v;\r\n  }\r\n  setScale(m: MeasureType, v: number): void {\r\n    this[m].scale = v;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Add/remove records and update data\r\n  // ********************************************************************\r\n\r\n  /** Adds the given record to the aggregate */\r\n  addRecord(record) {\r\n    this.records.push(record);\r\n    record._aggrCache.push(this);\r\n    this._processRecord(record);\r\n  }\r\n\r\n  /** Internal method to update (insert) measure/record count caches with data from the given record */\r\n  private _processRecord(record: Record) {\r\n    if (record.measure_Self == null) return;\r\n    [\"Total\"]\r\n      .concat(\r\n        record.filteredOut\r\n          ? []\r\n          : [\"Active\"].concat(\r\n              Base.Compare_List.filter((cT) => record.isSelected(cT))\r\n            )\r\n      )\r\n      .forEach((cT) => {\r\n        this[cT].measure += record.measure_Self;\r\n        this[cT].recCnt++;\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  clearRecords() {\r\n    this.records.forEach((record) => {\r\n      record.removeAggrFromCache(this);\r\n    });\r\n    this.records = [];\r\n    this.resetAggregateMeasures();\r\n  }\r\n\r\n  /** -- */\r\n  removeRecord(record: Record) {\r\n    this.records.splice(this.records.indexOf(record), 1);\r\n    record.removeAggrFromCache(this);\r\n    if (record.measure_Self == null) return;\r\n    [\"Total\"]\r\n      .concat(record.filteredOut ? [] : [\"Active\"])\r\n      .concat(Base.Compare_List.filter((cT) => record.isSelected(cT)))\r\n      .forEach((cT) => {\r\n        this[cT].measure -= record.measure_Self;\r\n        this[cT].recCnt--;\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  resetMeasure(t: MeasureType) {\r\n    this[t] = { measure: 0, recCnt: 0 };\r\n  }\r\n  resetAggregateMeasures() {\r\n    Base.Total_Active_Compare_List.forEach((cT) => this.resetMeasure(cT));\r\n    this.records.forEach((record) => this._processRecord(record));\r\n  }\r\n\r\n  addToActive(measureToAdd: number, cntToAdd: number) {\r\n    this.Active.measure += measureToAdd;\r\n    this.Active.recCnt += cntToAdd;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Select / unselect\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  unselectAggregate() {\r\n    if (this._locked) return;\r\n    this.DOM.aggrGlyph?.classList.remove(\"showLock\");\r\n  }\r\n\r\n  /** -- */\r\n  selectCompare(cT) {\r\n    this._compared = cT;\r\n\r\n    this.records.forEach((record) => record.setCompared(cT));\r\n\r\n    this.DOM.aggrGlyph?.classList.add(\"showLock\");\r\n    this.DOM.aggrGlyph?.classList.add(this._compared);\r\n  }\r\n\r\n  /** -- */\r\n  clearCompare(cT) {\r\n    this.DOM.aggrGlyph?.classList.remove(\"showLock\");\r\n    this.DOM.aggrGlyph?.classList.remove(this._compared);\r\n\r\n    if (this._locked) {\r\n      this.unlockSelection();\r\n    }\r\n    this._compared = null;\r\n    this.records.forEach((record) => record.unsetCompared(cT));\r\n  }\r\n\r\n  /** -- */\r\n  lockSelection() {\r\n    this._locked = true;\r\n    this.DOM.aggrGlyph?.classList.add(\"locked\");\r\n  }\r\n  /** -- */\r\n  unlockSelection() {\r\n    this._locked = false;\r\n    this.DOM.aggrGlyph?.classList.remove(\"locked\");\r\n  }\r\n\r\n  // no info by default\r\n  exportAggregateInfo() {\r\n    return null;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Tooltip\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  get tooltipTitle(): string {\r\n    return \"\";\r\n  }\r\n  protected get tooltipSkip1(): boolean {\r\n    return false;\r\n  }\r\n\r\n  private printCompared(cT: CompareType | \"Other\", details: string) {\r\n    return (\r\n      `<tr>` +\r\n      `<td class='measureDetail'>${details}</td>` +\r\n      `<td><span class='colorBox bg_${cT}'></span></td> ` +\r\n      `<td class='measureValue'>${Base.browser.getMeasureFormattedValue(\r\n        this.measure(cT).toLocaleString()\r\n      )}</td>` +\r\n      (Base.browser.absoluteBreakdown\r\n        ? \"\"\r\n        : `<td class='percentValue'>(${Base.browser.getValueLabel(\r\n            Base.browser.getChartValue(this, cT)\r\n          )})</td>`) +\r\n      `</tr>`\r\n    );\r\n  }\r\n\r\n  /** Returns the html content of the tooltip as a string */\r\n  getTooltipHTML(): string {\r\n    var str = \"\";\r\n    var browser = Base.browser;\r\n\r\n    var newLine = true;\r\n\r\n    str += `<div class='tooltipSummaryName'>${this.tooltipTitle}</div>`;\r\n\r\n    if (this.label) {\r\n      str += `<span class='mapItemName ${\r\n        this._compared ? \"bg_\" + this._compared : \"\"\r\n      }'>${this.label}</span>`;\r\n    }\r\n\r\n    str += \"<div class='aggrTooltip'>\";\r\n\r\n    str += \"<div class='aggrRecordCount'>\";\r\n\r\n    if (browser.measureFunc.is(\"Sum\")) {\r\n      newLine = false;\r\n      str +=\r\n        browser.getValueLabel(\r\n          browser.getMeasureValue(this, \"Active\", \"absolute\"),\r\n          false,\r\n          1,\r\n          false\r\n        ) +\r\n        \" \" +\r\n        i18n.measureText(browser);\r\n      str += `<span class='percentBlock percentage_metricSumOutOf'> (${i18n.TooltipOne(\r\n        browser.getMeasureValue(this, \"Active\", \"dependent\"),\r\n        browser\r\n      )}) </span>`;\r\n      str += `<div style='font-size: 0.8em;' class='tooltipAmong'>among</div>`;\r\n    }\r\n\r\n    str += `<span class=\"recordNumberInfo\">${this.recCnt(\r\n      \"Active\"\r\n    ).toLocaleString()} ${browser.recordName}`;\r\n\r\n    // show the %-of value if there are active records inside\r\n    if (\r\n      this.recCnt(\"Active\") > 0 &&\r\n      (this.recCnt(\"Active\") != browser.allRecordsAggr.recCnt(\"Active\") ||\r\n        this.tooltipSkip1)\r\n    ) {\r\n      str += `${newLine ? \"<br>\" : \"\"}\r\n          <span class='percentBlock percentage_recordOutOf'> \r\n          (${i18n.TooltipOne(\r\n            (100 * this.recCnt(\"Active\")) /\r\n              browser.allRecordsAggr.recCnt(\"Active\"),\r\n            browser\r\n          )})\r\n        </span>`;\r\n    }\r\n\r\n    str += `</span>`; // recordNumberInfo\r\n\r\n    str += `</div>`; // aggrRecordCount\r\n\r\n    if (\r\n      browser.isCompared() &&\r\n      this.attrib &&\r\n      this.recCnt(\"Active\") > 0 &&\r\n      (!this.attrib.isComparedAttrib() ||\r\n        (this.attrib.isMultiValued && browser.activeComparisonsCount > 1))\r\n    ) {\r\n      str += `<div class='tooltipBreakdownHeader'> \r\n            <span class='BreakdownText'>${i18n.BreakdownBy}</span>\r\n            ${browser.comparedAttrib.attribNameHTML}\r\n          </div>`;\r\n\r\n      this.Other = {\r\n        measure: this.measure(\"Active\"),\r\n        recCnt: this.recCnt(\"Active\"),\r\n      };\r\n\r\n      browser.activeComparisons.forEach((cT) => {\r\n        this.Other.measure -= this.measure(cT);\r\n        this.Other.recCnt -= this.recCnt(cT);\r\n      });\r\n\r\n      str += \"<table class='tooltipBreakdownTable'>\";\r\n\r\n      // sort active comparisons from large to small measure value\r\n      var _ = browser.activeComparisons\r\n        .slice()\r\n        .sort((a, b) => this[b].measure - this[a].measure);\r\n\r\n      // render each compared label and its value\r\n      _.forEach((cT: CompareType) => {\r\n        var comparedLabel = browser.selectedAggrs[cT].label;\r\n        if (\r\n          this.attrib?.attribID === browser.comparedAttrib.attribID &&\r\n          comparedLabel === this.label\r\n        ) {\r\n          // same summary, and same category\r\n          return;\r\n        }\r\n        str += this.printCompared(cT, comparedLabel);\r\n      });\r\n\r\n      let c = browser.comparedAttrib;\r\n      if (\r\n        this.Other.measure &&\r\n        !c.isMultiValued &&\r\n        this.attrib.browser.breakdownMode.get() !== \"dependent\"\r\n      ) {\r\n        str += this.printCompared(\"Other\", `(${browser.otherNameInCompare})`);\r\n      }\r\n\r\n      str += \"</table>\";\r\n\r\n      str += i18n.Tooltip_OutOf(this.label, browser);\r\n    }\r\n\r\n    str += \"</div>\"; // aggrTooltip\r\n\r\n    return DOMPurify.sanitize(str);\r\n  }\r\n}\r\n","import { Aggregate } from \"./Aggregate\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { i18n } from \"./i18n\";\r\n\r\n// Filtering can be disabled (false), in, or out\r\ntype NoValueSelection = false | \"in\" | \"out\";\r\n\r\n/** -- */\r\nexport class Aggregate_NoValue extends Aggregate {\r\n  private filterSelection: NoValueSelection = false;\r\n\r\n  constructor(attrib: Attrib) {\r\n    super(attrib);\r\n  }\r\n\r\n  get label(): string {\r\n    return i18n.NoData;\r\n  }\r\n\r\n  get filtered(): NoValueSelection {\r\n    return this.filterSelection;\r\n  }\r\n\r\n  set filtered(v: NoValueSelection) {\r\n    this.filterSelection = v;\r\n\r\n    if(this.records.length===0) return;\r\n    \r\n    if (this.filterSelection === false) {\r\n      this.DOM.aggrGlyph?.classList.remove(\"filtered\");\r\n    } else {\r\n      this.DOM.aggrGlyph?.classList.add(\"filtered\");\r\n    }\r\n  }\r\n\r\n  exportAggregateInfo() {\r\n    return {};\r\n  }\r\n}\r\n","import { extent } from \"d3-array\";\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\n\r\nconst d3 = { extent };\r\n\r\nexport type TimeKey = {\r\n  _time: Date;\r\n  _time_src: string;\r\n  _histogram?: Attrib_Numeric;\r\n  _index?: number;\r\n};\r\n\r\nexport type TimeData = {\r\n  // Date representation of date\r\n  _time: Date;\r\n  // String representation of date\r\n  _time_src: string;\r\n  // Observed value in that time\r\n  _value: number;\r\n  // Ranking of the value within that time (dynamic)\r\n  _rank?: number;\r\n  // The graphical representation / Used by timeseries view (dot)\r\n  DOM?: Element;\r\n};\r\n\r\nexport class TimeSeriesData {\r\n  // timedata indexed by string representations of date\r\n  _keyIndex: { [index: string]: TimeData } = {};\r\n  // a (sorted) list of timedata\r\n  _timeseries_: TimeData[] = [];\r\n  // Range of date (cache)\r\n  extent_Time?: [Date, Date] = null;\r\n  // Range of values - may be adjusted to show different analytics\r\n  extent_Value?: [number, number] = null;\r\n  // Range of values - based on raw values, not dynamic\r\n  extent_Value_raw?: [number, number] = null;\r\n\r\n  addTimeData(t: TimeData) {\r\n    this._keyIndex[t._time_src] = t;\r\n    this._timeseries_.push(t);\r\n  }\r\n\r\n  isEmpty() {\r\n    return this._timeseries_.length === 0;\r\n  }\r\n\r\n  hasTimeData() {\r\n    return this._timeseries_.length > 0;\r\n  }\r\n\r\n  computeCaches() {\r\n    this.extent_Time = d3.extent(this._timeseries_, (k) => k._time);\r\n    this.extent_Value = d3.extent(this._timeseries_, (k) => k._value);\r\n    this.extent_Value_raw = [...this.extent_Value];\r\n  }\r\n\r\n  sortTimeseries() {\r\n    this._timeseries_.sort(\r\n      (a: TimeData, b: TimeData) => a._time.getTime() - b._time.getTime()\r\n    );\r\n  }\r\n}\r\n","import { BlockType } from \"./Types\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { TimeSeriesData } from \"./TimeSeriesData\";\r\nimport { Browser } from \"./Browser\";\r\n\r\ntype SpecialKey =\r\n  | \"Degree\"\r\n  | \"Year\"\r\n  | \"Month\"\r\n  | \"DayOfMonth\"\r\n  | \"WeekDay\"\r\n  | \"Hour\"\r\n  | \"TimeseriesChange-#\"\r\n  | \"TimeseriesChange-%\"\r\n  | \"TimePoint\";\r\n\r\n/**\r\n  ->Degree(), Year(), ....\r\n  ->[UPPERCASE(*.)]\r\n  ->[*.]\r\n  ->...->...\r\n  ->2010 (timekey)\r\n  ->Change(%)\r\n  ->Change(#)\r\n*/\r\nexport class AttribTemplate {\r\n  // the string representation of the template\r\n  str: string = null;\r\n  // used for easy serialization\r\n  toString() {\r\n    return this.str;\r\n  }\r\n\r\n  // the function to call to access values from records\r\n  func: Function = null;\r\n\r\n  // path of the access\r\n  path: string[] = [];\r\n  get pathStr() {\r\n    return this.path.join(\"->\");\r\n  }\r\n  // special access to last information\r\n  special: SpecialKey = null;\r\n  // parent attribute\r\n  parent: Attrib = null;\r\n  // type of the attribute\r\n  blockType: BlockType = null;\r\n  lastKey: string = null;\r\n  vFrom: string[];\r\n\r\n  constructor(input: string | Function, dashboard: Browser) {\r\n    if (typeof input === \"function\") {\r\n      this.func = input;\r\n      this.str = \"\" + this.func;\r\n      return;\r\n    }\r\n\r\n    this.str = input;\r\n\r\n    var path = input.split(\"->\");\r\n    this.lastKey = path[path.length - 1];\r\n    this.path = path.slice(0, -1);\r\n    this.parent = dashboard.attribWithName(this.path.join(\"->\")) || null;\r\n\r\n    if (this.path.length === 0) {\r\n      // direct index in the object\r\n      this.func = function () {\r\n        return this[input];\r\n      };\r\n    } else {\r\n      // closure variable - it is updated later depending on special type\r\n      var lastAccess = (v) => v[this.lastKey];\r\n\r\n      switch (this.lastKey) {\r\n        case \"Degree()\":\r\n          lastAccess = (v) => v.length;\r\n          this.special = \"Degree\";\r\n          this.blockType = \"numeric\";\r\n          break;\r\n\r\n        case \"Year()\":\r\n          lastAccess = (v) =>\r\n            v && !isNaN(v.getTime()) ? v.getUTCFullYear() : null;\r\n          this.special = \"Year\";\r\n          this.blockType = \"categorical\";\r\n          break;\r\n\r\n        case \"Month()\":\r\n          lastAccess = (v) =>\r\n            v && !isNaN(v.getTime()) ? v.getUTCMonth() : null;\r\n          this.special = \"Month\";\r\n          this.blockType = \"categorical\";\r\n          break;\r\n\r\n        case \"DayOfMonth()\":\r\n          lastAccess = (v) =>\r\n            v && !isNaN(v.getTime()) ? v.getUTCDate() : null;\r\n          this.special = \"DayOfMonth\";\r\n          this.blockType = \"numeric\";\r\n          break;\r\n\r\n        case \"WeekDay()\":\r\n          lastAccess = (v) => (v && !isNaN(v.getTime()) ? v.getUTCDay() : null);\r\n          this.special = \"WeekDay\";\r\n          this.blockType = \"categorical\";\r\n          break;\r\n\r\n        case \"Hour()\":\r\n          lastAccess = (v) =>\r\n            v && !isNaN(v.getTime()) ? v.getUTCHours() : null;\r\n          this.special = \"Hour\";\r\n          this.blockType = \"numeric\";\r\n          break;\r\n\r\n        case \"Change(#)\":\r\n          lastAccess = (v) => {\r\n            let _ts = new TimeSeriesData();\r\n\r\n            v._timeseries_.forEach((k, i) => {\r\n              if (i == 0) return;\r\n\r\n              var cur = v._timeseries_[i];\r\n              var prev = v._timeseries_[i - 1];\r\n              if (!cur || !prev) return;\r\n\r\n              _ts.addTimeData({\r\n                _time: k._time,\r\n                _time_src: k._time_src,\r\n                _value: cur._value - prev._value,\r\n              });\r\n            });\r\n            return _ts;\r\n          };\r\n          this.special = \"TimeseriesChange-#\";\r\n          this.blockType = \"timeseries\";\r\n          break;\r\n\r\n        case \"Change(%)\":\r\n          lastAccess = (v) => {\r\n            let _ts = new TimeSeriesData();\r\n\r\n            v._timeseries_.forEach((k, i) => {\r\n              if (i == 0) return;\r\n\r\n              var cur = v._timeseries_[i];\r\n              var prev = v._timeseries_[i - 1];\r\n              if (!cur || !prev) return;\r\n\r\n              _ts.addTimeData({\r\n                _time: k._time,\r\n                _time_src: k._time_src,\r\n                _value: (100 * (cur._value - prev._value)) / (prev._value || 1),\r\n              });\r\n            });\r\n            return _ts;\r\n          };\r\n          this.special = \"TimeseriesChange-%\";\r\n          this.blockType = \"timeseries\";\r\n          break;\r\n      }\r\n\r\n      // TimePoint of a TimeSeries variable\r\n      if (!this.special && this.parent?.type === \"timeseries\") {\r\n        this.special = \"TimePoint\";\r\n        this.blockType = \"numeric\";\r\n\r\n        if (\r\n          [\"TimeseriesChange-%\", \"TimeseriesChange-#\"].includes(\r\n            this.parent.template.special\r\n          )\r\n        ) {\r\n          // anonymous function, has access to this context in this scope.\r\n          this.func = (record) => {\r\n            var v = this.parent.getRecordValue(record);\r\n            if (!v || v.length != null || v.length === 0) return null;\r\n            if (v) v = lastAccess.call(this, v._keyIndex);\r\n            return v ? v._value : v;\r\n          };\r\n          return;\r\n        } else {\r\n          lastAccess = (v: TimeSeriesData) => v._keyIndex[this.lastKey]._value;\r\n        }\r\n      }\r\n\r\n      this.func = function () {\r\n        var v = this;\r\n        for (var i = 0; i < path.length - 1; i++) {\r\n          v = v[path[i]];\r\n          if (v == null) return null; // hit a null key in the object path. Abort! Abort!\r\n        }\r\n        return v ? lastAccess.call(this, v) : v;\r\n      };\r\n    }\r\n  }\r\n\r\n}\r\n","import DOMPurify from \"dompurify/dist/purify.es\";\r\nimport { scaleLinear, scaleLog } from \"d3-scale\";\r\nimport { min, max } from \"d3-array\";\r\n\r\nimport { Browser } from \"./Browser\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Config } from \"./Config\";\r\n\r\nimport { Block } from \"./Block\";\r\nimport { Record } from \"./Record\";\r\nimport { Base } from \"./Base\";\r\nimport { Filter } from \"./Filter\";\r\n\r\nimport { Aggregate } from \"./Aggregate\";\r\nimport { Aggregate_NoValue } from \"./Aggregate_NoValue\";\r\n\r\nimport { AttribTemplate } from \"./AttribTemplate\";\r\n\r\nimport {\r\n  BlockSpec,\r\n  BlockType as AttribType,\r\n  CompareType,\r\n  LinearOrLog,\r\n  MeasurableConfig,\r\n  MeasureType,\r\n  MetricFunc,\r\n  RecordVisCoding,\r\n  SummaryConfig,\r\n  SummarySpec,\r\n} from \"./Types\";\r\n\r\nconst d3 = {\r\n  scaleLinear,\r\n  scaleLog,\r\n  min,\r\n  max,\r\n};\r\n\r\n/** -- */\r\nexport abstract class Attrib {\r\n  // ********************************************************************\r\n  // Basic\r\n  // ********************************************************************\r\n  public readonly browser: Browser;\r\n  public readonly type: AttribType;\r\n\r\n  // Each attribute is assigned a unique number.\r\n  // This number is not stable - any browser config change may change this.\r\n  public readonly attribID: number;\r\n\r\n  // The associated block (view) - null by default\r\n  protected _block: Block = null;\r\n  public get block(): Block {\r\n    return this._block;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Template system\r\n  // ********************************************************************\r\n\r\n  public template: AttribTemplate = null;\r\n  applyTemplateSpecial(): void {}\r\n\r\n  // ********************************************************************\r\n  // Aggregation\r\n  // ********************************************************************\r\n\r\n  public _aggrs: Aggregate[] = [];\r\n  public readonly noValueAggr: Aggregate_NoValue;\r\n  public aggr_initialized: boolean = false;\r\n\r\n  abstract initializeAggregates(): void;\r\n\r\n  isEmpty() {\r\n    return this._aggrs.length === 0;\r\n  }\r\n\r\n  // TODO: review/remove, as we should not check for a specific type here.\r\n  uniqueCategories() {\r\n    return (\r\n      this.type === \"categorical\" &&\r\n      !this.isEmpty() &&\r\n      this._aggrs.length === this.browser.records.length\r\n    );\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering\r\n  // ********************************************************************\r\n\r\n  // The filter used to filter records. May be null\r\n  public summaryFilter: Filter | null = null;\r\n  isFiltered(): boolean {\r\n    return this.summaryFilter?.isFiltered ?? false;\r\n  }\r\n  // cen be extended by sub-classes\r\n  createSummaryFilter(): void {}\r\n\r\n  // ********************************************************************\r\n  // Other attributes (parent/derivative/child)\r\n  // ********************************************************************\r\n\r\n  // may have multiple derivatives, indexed by string keys\r\n  public derivatives?: { [index: string]: Attrib } = {};\r\n\r\n  // may have a single parent attribute\r\n  protected _parent: Attrib = null;\r\n  get parent(): Attrib {\r\n    return this._parent || this.template?.parent;\r\n  }\r\n\r\n  // overwritten by numeric summary\r\n  hasTimeSeriesParent(): boolean {\r\n    return false;\r\n  }\r\n\r\n  createDerivedAttrib(_special: string, name: string = null) {\r\n    if (this.derivatives[_special]) return;\r\n    this.derivatives[_special] = this.browser.createAttrib(\r\n      name || `${this.attribName}->${_special.replace(\"()\", \"\")}`,\r\n      `${this.template}->${_special}`\r\n    );\r\n    this.browser.refreshAttribList();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Name (path, html formatted strings, etc.)\r\n  // ********************************************************************\r\n\r\n  // the string representation of the name. May include a path/group\r\n  private _attribName: string = null;\r\n  // aka blockName\r\n  get attribName(): string {\r\n    return this._attribName;\r\n  }\r\n  get printName(): string {\r\n    return this._attribName.split(\"->\").pop();\r\n  }\r\n  // name without last key item\r\n  get pathName(): string[] {\r\n    return this._attribName.split(\"->\").slice(0, -1); // removes last item\r\n  }\r\n  // specialized method to consider/change behavior if with timeseries parent\r\n  get groupPath() {\r\n    return this.pathName;\r\n  }\r\n  get attribNameHTML() {\r\n    return `<span class='blockName_Path ${\r\n      this.pathName.length ? \"visible\" : \"\"\r\n    }'>${this.pathName\r\n      .map(\r\n        (_) =>\r\n          `<span class='groupName'>${_}</span><span class='fa fa-caret-right'></span>`\r\n      )\r\n      .join(\"\")}</span><span class='blockName_Print'>${this.printName}</span>`;\r\n  }\r\n  set attribName(newName: string) {\r\n    let curName = this._attribName;\r\n\r\n    if (curName === newName) return;\r\n\r\n    if(this.browser.attribWithName(newName)) return;\r\n\r\n    this.browser.removeAttribFromGroupIndex(this); // remove it from previous newName index\r\n\r\n    this._attribName = newName;\r\n\r\n    this.browser.insertAttribIntoGroupIndex(this);\r\n\r\n    this.browser.refreshAttribList();\r\n\r\n    this.block?.refreshSummaryName_DOM();\r\n\r\n    if (this.summaryFilter?.breadcrumb?.DOM) {\r\n      this.addDOMBlockName(\r\n        this.summaryFilter.breadcrumb.DOM.select(\".crumbHeader\")\r\n      );\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Description\r\n  // ********************************************************************\r\n\r\n  // The description of the variable or content block\r\n  private _description: string = \"\";\r\n  get description(): string {\r\n    if (!this._description && this._parent) return this._parent.description;\r\n    return this._description;\r\n  }\r\n  set description(v: string) {\r\n    this._description = DOMPurify.sanitize(v, {}) || null;\r\n    this.block?.updateDescription();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Configuration objects TODO review\r\n  // ********************************************************************\r\n\r\n  public configs: { [key: string]: Config<any> } = {};\r\n  refreshConfigs() {\r\n    Object.values(this.configs).forEach((cfg) => cfg.refresh());\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  public readonly isComparable: Config<boolean>;\r\n\r\n  /** -- */\r\n  isIDAttrib() {\r\n    return this.browser.idSummaryName === this.attribName;\r\n  }\r\n  isComparedAttrib() {\r\n    return this === this.browser.comparedAttrib;\r\n  }\r\n  autoCompare(): void {}\r\n\r\n  // TODO review\r\n  public _metricFuncs: MetricFunc[] = Base.defaultMetricFuncs;\r\n  get canHaveMetricFuncs() {\r\n    return false;\r\n  }\r\n  get supportedMetricFuncs() {\r\n    return []; // none supported by default\r\n  }\r\n\r\n  /** -- */\r\n  addSupportedMetricFunc(t: MetricFunc) {\r\n    if (this._metricFuncs.includes(t)) return;\r\n    this._metricFuncs.push(t);\r\n    this.browser.measureSummary.refresh();\r\n  }\r\n  /** -- */\r\n  removeSupportedMetricFunc(t: MetricFunc) {\r\n    if (!this._metricFuncs.includes(t)) return; // not included already\r\n    this._metricFuncs = this._metricFuncs.filter((_) => _ != t);\r\n    if (\r\n      this.attribID === this.measureSummary?.attribID &&\r\n      this.browser.measureFunc.is(t)\r\n    ) {\r\n      this.browser.measureFunc.set(\"Count\");\r\n      this.browser.measureFunc.refresh();\r\n    } else {\r\n      this.browser.measureSummary.refresh(); // drop-down options refresh\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  // used to add class name to UI\r\n  public readonly blockClassName: string;\r\n  public readonly nuggetClassName: string;\r\n\r\n  // Does not support record encoding by default, can be extended\r\n  supportsRecordEncoding(_coding: RecordVisCoding): boolean {\r\n    return false;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Record value access\r\n  // ********************************************************************\r\n\r\n  getRecordValue(record: Record) {\r\n    return record.getValue(this);\r\n  }\r\n  setRecordValueCacheToMissing(record) {\r\n    // TO-DO: Remove record from its existing aggregate for this summary\r\n    record.setValue(this, null);\r\n    this.noValueAggr.addRecord(record);\r\n  }\r\n\r\n  getFormattedValue(_v, _isSVG): string {\r\n    return \"\";\r\n  }\r\n  renderRecordValue(_v, _d3_selection): string{\r\n    return \"\";\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  constructor(\r\n    browser: Browser,\r\n    name: string,\r\n    template: AttribTemplate = null,\r\n    _type: AttribType,\r\n    blockClassName: string = \"\",\r\n    nuggetClassName: string = \"\"\r\n  ) {\r\n    this.browser = browser;\r\n    this._attribName = name;\r\n    this.type = _type;\r\n\r\n    this.attribID = this.browser.attribCounter++;\r\n    this.blockClassName = blockClassName;\r\n    this.nuggetClassName = nuggetClassName;\r\n\r\n    this.browser.attribs.push(this);\r\n\r\n    if (template instanceof AttribTemplate) {\r\n      this.template = template;\r\n    } else {\r\n      this.template = new AttribTemplate(name, this.browser);\r\n    }\r\n\r\n    this.noValueAggr = new Aggregate_NoValue(this);\r\n    this.browser.allAggregates.push(this.noValueAggr);\r\n\r\n    this.isComparable = new Config<boolean>({\r\n      parent: this,\r\n      cfgClass: \"isComparable\",\r\n      cfgTitle: \"Select-Compare\",\r\n      UI: { disabled: true },\r\n      default: true,\r\n      itemOptions: [\r\n        { name: \"Enabled\", value: true },\r\n        { name: \"Disabled\", value: false },\r\n      ],\r\n      onSet: (v) => {\r\n        if (!v) {\r\n          // if not comparable, cannot be used to sum/avg data\r\n          this._metricFuncs = [];\r\n        }\r\n        if (!v && this.isComparedAttrib()) {\r\n          this.browser.clearSelect_Compare(this.browser.activeComparisons);\r\n        }\r\n        this.block?.DOM.root?.classed(\"disableCompareLock\", !v);\r\n      },\r\n    });\r\n\r\n    this.measureScaleType = new Config<LinearOrLog>({\r\n      cfgClass: \"measureScaleType\",\r\n      cfgTitle: \"Axis Scale\",\r\n      parent: this,\r\n      UISeperator: {\r\n        title: \"Axis\",\r\n      },\r\n      default: \"linear\",\r\n      iconClass: \"fa fa-chart-line\",\r\n      helparticle: \"5e88d63f04286364bc97d40b\",\r\n      itemOptions: [\r\n        {\r\n          name: i18n.Linear + \" \" + i18n.LinearSequence,\r\n          value: \"linear\",\r\n        },\r\n        { name: i18n.Log + \" \" + i18n.Log10Sequence, value: \"log\" },\r\n      ],\r\n      forcedValue: () => {\r\n        if (this.stackedCompare) return \"linear\";\r\n        if (this.percentBreakdown) return \"linear\";\r\n        if (this.browser.measureSumWithNegativeValues()) return \"linear\";\r\n      },\r\n      onSet: (v) => {\r\n        this.refreshScale_Measure(v);\r\n        this.block?.refreshViz_All();\r\n      },\r\n    });\r\n\r\n    this.axisScaleType = new Config<\"fit\" | \"sync\" | \"full\">({\r\n      cfgClass: \"axisScaleType\",\r\n      cfgTitle: \"Axis Extent\",\r\n      default: \"fit\",\r\n      parent: this,\r\n      iconClass: \"fa fa-chart-line\",\r\n      helparticle: \"5e893b562c7d3a7e9aea656e\",\r\n      itemOptions: [\r\n        { name: \"Fit\", value: \"fit\" },\r\n        { name: \"Sync\", value: \"sync\" },\r\n        { name: \"Full\", value: \"full\" },\r\n      ],\r\n      forcedValue: () => {\r\n        if (this.percentBreakdown && !this.browser.isCompared()) {\r\n          return \"fit\";\r\n        }\r\n        if (\r\n          this.browser.measureFunc_Avg &&\r\n          this.axisScaleType._value === \"full\"\r\n        ) {\r\n          return \"fit\";\r\n        }\r\n      },\r\n      onSet: () => {\r\n        if (!this.aggr_initialized) return;\r\n        this.updateChartScale_Measure(true);\r\n        this.block?.refreshViz_All();\r\n      },\r\n    });\r\n  }\r\n\r\n  finishTemplateSpecial() {\r\n    if (this.template.special) {\r\n      // add to parent's derivatives automatically\r\n      if (this.template.parent) {\r\n        this.template.parent.derivatives[this.template.special] = this;\r\n      }\r\n      // customizations per attribute class.\r\n      this.applyTemplateSpecial();\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.browser.destroyAttrib(this);\r\n  }\r\n\r\n  /** Utility method to inject HTML into DOM */\r\n  addDOMBlockName(DOM) {\r\n    DOM.html(this.attribNameHTML);\r\n\r\n    DOM.select(\".blockName_Path\")\r\n      .tooltip(i18n[\"Show/Hide Path\"])\r\n      .on(\"click\", (event) => {\r\n        event.currentTarget.classList.toggle(\"visible\");\r\n        event.stopPropagation();\r\n      });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  // Shorthand access\r\n  get records() {\r\n    return this.browser.records;\r\n  }\r\n  get breakdownMode() {\r\n    return this.browser.breakdownMode.get();\r\n  }\r\n  get relativeBreakdown() {\r\n    return this.browser.relativeBreakdown;\r\n  }\r\n  get absoluteBreakdown() {\r\n    return this.browser.absoluteBreakdown;\r\n  }\r\n  get dependentBreakdown() {\r\n    return this.browser.dependentBreakdown;\r\n  }\r\n  get totalBreakdown() {\r\n    return this.browser.totalBreakdown;\r\n  }\r\n  get percentBreakdown() {\r\n    return this.browser.percentBreakdown;\r\n  }\r\n  get stackedCompare() {\r\n    return this.browser.stackedCompare.is(true);\r\n  }\r\n  get stackedChart() {\r\n    return this.browser.stackedChart;\r\n  }\r\n  vizActive(key: CompareType) {\r\n    return this.browser.vizActive(key);\r\n  }\r\n  get measureFunc() {\r\n    return this.browser.measureFunc.get();\r\n  }\r\n  get activeComparisons() {\r\n    return this.browser.activeComparisons;\r\n  }\r\n  get activeComparisonsCount() {\r\n    return this.browser.activeComparisonsCount;\r\n  }\r\n  get measureSummary() {\r\n    return this.browser.measureSummary.get();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  public readonly measureScaleType: Config<LinearOrLog>;\r\n\r\n  public chartScale_Measure_prev: any;\r\n  public chartScale_Measure: any;\r\n\r\n  abstract get measureRangeMax(): number;\r\n\r\n  /** -- */\r\n  get measureScale_Log() {\r\n    return this.measureScaleType.is(\"log\");\r\n  }\r\n  /** -- */\r\n  get measureScale_Linear() {\r\n    return this.measureScaleType.is(\"linear\");\r\n  }\r\n  /** -- */\r\n  get measureExtent_Self() {\r\n    var maxMeasureValue = this.getPeakAggr(d3.max);\r\n\r\n    var minMeasureValue = 0;\r\n    if (this.absoluteBreakdown && this.browser.measureSumWithNegativeValues()) {\r\n      minMeasureValue = Math.min(this.getPeakAggr(d3.min), 0); // just making sure it cannot be > 0\r\n    }\r\n\r\n    // if using log scale, minimum value cannot be zero or negative\r\n    if (this.measureScale_Log && minMeasureValue <= 0) {\r\n      minMeasureValue = Math.max(1, minMeasureValue);\r\n    }\r\n\r\n    // If min/max domain is set to zero, d3 puts zero-value in the middle of the range. prevent\r\n    if (maxMeasureValue === 0 && minMeasureValue === 0) {\r\n      maxMeasureValue = 0.001;\r\n    }\r\n\r\n    return [minMeasureValue, maxMeasureValue];\r\n  }\r\n\r\n  public readonly axisScaleType: Config<\"fit\" | \"sync\" | \"full\">;\r\n\r\n  /** -- */\r\n  get measureDomain_Final() {\r\n    if (!this.block?.panel) {\r\n      return this.measureExtent_Self;\r\n    }\r\n\r\n    if (this.axisScaleType.is(\"fit\")) {\r\n      return this.measureExtent_Self;\r\n    }\r\n\r\n    if (this.axisScaleType.is(\"full\")) {\r\n      if (this.absoluteBreakdown) {\r\n        return [0, this.browser.allRecordsAggr.measure(\"Active\")];\r\n      } else {\r\n        return [0, 100];\r\n      }\r\n    }\r\n\r\n    if (this.axisScaleType.is(\"sync\")) {\r\n      return this.block?.panel.syncedMeasureExtent;\r\n    }\r\n    // fallback, just in case\r\n    return this.measureExtent_Self;\r\n  }\r\n\r\n  public measureLogBase = 10;\r\n\r\n  refreshScale_Measure(v = null) {\r\n    v ??= this.measureScaleType.get();\r\n\r\n    this.chartScale_Measure_prev = this.chartScale_Measure\r\n      ? this.chartScale_Measure.copy().clamp(false)\r\n      : null;\r\n\r\n    this.measureLogBase = 10;\r\n    this.chartScale_Measure =\r\n      v === \"log\" ? d3.scaleLog().base(this.measureLogBase) : d3.scaleLinear();\r\n    this.chartScale_Measure.clamp(true);\r\n\r\n    if (this.chartScale_Measure_prev) {\r\n      var domain = this.chartScale_Measure_prev.domain();\r\n      var range = this.chartScale_Measure_prev.range();\r\n      if (this.measureScale_Log) {\r\n        if (domain[0] === 0) domain[0] = 1;\r\n      } else {\r\n        domain[0] = Math.min(0, domain[0]);\r\n      }\r\n      this.chartScale_Measure.domain(domain).range(range);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  updateChartScale_Measure(skipRefreshViz = false): void {\r\n    if (!this.aggr_initialized || this.isEmpty()) {\r\n      return; // nothing to do\r\n    }\r\n\r\n    this.chartScale_Measure_prev = this.chartScale_Measure\r\n      ? this.chartScale_Measure.copy().clamp(false)\r\n      : null;\r\n\r\n    var newDomain = this.measureDomain_Final;\r\n\r\n    if (this.measureScale_Log && newDomain[0] === 0) {\r\n      newDomain[0] = 1;\r\n    }\r\n\r\n    var hideActive = false;\r\n    if (this.relativeBreakdown && this.browser.activeComparisonsCount > 0) {\r\n      hideActive = newDomain[1] !== 100;\r\n    }\r\n    this.block?.DOM.root?.classed(\"hideActive\", hideActive);\r\n\r\n    this.chartScale_Measure.domain(newDomain).range([0, this.measureRangeMax]);\r\n\r\n    if (!skipRefreshViz && this.chartScale_Measure_prev) {\r\n      var oldDomain = this.chartScale_Measure_prev.domain();\r\n      if (\r\n        newDomain[0] !== oldDomain[0] ||\r\n        newDomain[1] !== oldDomain[1] ||\r\n        this.measureRangeMax !== this.chartScale_Measure_prev.range()[1]\r\n      ) {\r\n        this.block?.refreshViz_All();\r\n      }\r\n    }\r\n  }\r\n\r\n  // returns the maximum active aggregate value per row in chart data\r\n  // peakFunc is d3.min or d3.max\r\n  getPeakAggr(peakFunc, sT: MeasureType = null) {\r\n    if (this.isEmpty()) return 0;\r\n\r\n    if (typeof sT === \"string\") {\r\n      return peakFunc(this._aggrs, (aggr: Aggregate) =>\r\n        aggr.usedAggr ? this.browser.getChartValue(aggr, sT) : null\r\n      );\r\n    }\r\n\r\n    // No comparisons. Max aggregate will be that of the active\r\n    if (this.activeComparisonsCount === 0) {\r\n      return this.getPeakAggr(peakFunc, \"Active\");\r\n    }\r\n\r\n    // Active will be max if visible & using count or positive-sum's\r\n    if (\r\n      (this.absoluteBreakdown || this.totalBreakdown) &&\r\n      this.browser.showWholeAggr.is(true) &&\r\n      this.browser.measureWithPositiveValues()\r\n    ) {\r\n      return this.getPeakAggr(peakFunc, \"Active\");\r\n    }\r\n\r\n    var activeComparisons = this.activeComparisons;\r\n    if (this.stackedChart) {\r\n      // cannot add up separate maximums per selection, it needs to be accumulated per aggregate\r\n      return peakFunc(this._aggrs, (aggr) =>\r\n        aggr.usedAggr\r\n          ? activeComparisons.reduce(\r\n              (accum, sT) => accum + this.browser.getChartValue(aggr, sT),\r\n              0\r\n            )\r\n          : null\r\n      );\r\n    } else {\r\n      // pick the peak of all comparisons\r\n      return peakFunc(\r\n        activeComparisons.map((sT) => this.getPeakAggr(peakFunc, sT))\r\n      );\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Measurable configuration\r\n  // ********************************************************************\r\n\r\n  measurable: MeasurableConfig = null;\r\n\r\n  // only sets it if the attribute has/is \"measurable\"\r\n  set unitName(v: string) {\r\n    if (this.measurable) {\r\n      this.measurable.unitName = v;\r\n      this.browser.recordDisplay.View?.refreshAttribUnitName(this);\r\n    }\r\n  }\r\n  get unitName(): string {\r\n    return this.measurable?.unitName || \"\";\r\n  }\r\n  get valueDomain(): [number, number] {\r\n    return this.measurable?.valueDomain || null;\r\n  }\r\n  get metricFuncs(): MetricFunc[] {\r\n    return this.measurable?.metricFuncs || Base.defaultMetricFuncs;\r\n  }\r\n\r\n  // ....\r\n  get isMultiValued() {\r\n    return false;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Export & apply config\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  async applyConfig(blockCfg: SummarySpec) {\r\n    if (blockCfg.noNugget) {\r\n      this.browser.removeAttribFromGroupIndex(this);\r\n    }\r\n\r\n    if (blockCfg.isComparable === false) {\r\n      await this.isComparable.set(false);\r\n    }\r\n\r\n    if (blockCfg.metricFuncs) {\r\n      this._metricFuncs = blockCfg.metricFuncs;\r\n    }\r\n\r\n    await this.axisScaleType.set(blockCfg.axisScaleType);\r\n\r\n    this.block?.setCollapsed(blockCfg.collapsed === true);\r\n    this.description = blockCfg.description;\r\n\r\n    this.initializeAggregates();\r\n  }\r\n\r\n  isExportable(): boolean {\r\n    return true;\r\n  }\r\n\r\n  /** -- */\r\n  exportConfig() {\r\n    var cfg1: BlockSpec = {\r\n      name: this._attribName,\r\n      panel: this.block?.panel?.name || \"none\",\r\n      description: this.description || undefined,\r\n      collapsed: this.block?.collapsed,\r\n      type: this.type,\r\n      // TODO: nonugget\r\n    };\r\n\r\n    var cfg2: SummaryConfig = {\r\n      value: this.template.str !== cfg1.name ? this.template.str : undefined,\r\n      axisScaleType: this.axisScaleType.exportValue(),\r\n      measureScaleType: this.measureScaleType.exportValue(),\r\n      isComparable: this.isComparable.exportValue(),\r\n      ...this.measurable,\r\n    };\r\n\r\n    return Object.assign({}, cfg1, cfg2);\r\n  }\r\n}\r\n","import noUiSlider from 'nouislider/dist/nouislider.mjs';\r\n\r\nimport { i18n } from \"./i18n\";\r\nimport { Modal } from \"./UI/Modal.js\";\r\nimport { Attrib } from \"./Attrib.js\";\r\n\r\nexport class ConfigS<T> {\r\n  cfgClass?: string;\r\n}\r\n\r\ntype ItemOption<T> = {\r\n  name?: string;\r\n  value?: T;\r\n  DOM?: any;\r\n  max?: number; // sometimes, numbers specy a maximum value for each UI-item\r\n  activeWhen?: () => boolean;\r\n  _type?: string;\r\n  minValue?: number;\r\n  maxValue?: number;\r\n};\r\n\r\n/** -- */\r\nexport class Config<T> {\r\n  // current value\r\n  _value: T;\r\n\r\n  private _prevValue: T;\r\n\r\n  // default value\r\n  readonly default: T;\r\n  // cfgClass / varible name\r\n  readonly cfgClass?: string;\r\n  // printed title in UI\r\n  cfgTitle?: string;\r\n\r\n  // forced value (depends on other app settings)\r\n  readonly forcedValue?: (Config) => T | null;\r\n  // adjustments on current value when reading the value\r\n  readonly onRead?: (T) => T;\r\n\r\n  readonly onSet?: (a: T, b: Config<T>) => void;\r\n\r\n  readonly preSet?: (T, Config) => Promise<T>;\r\n\r\n  readonly isActive?: (Config) => boolean;\r\n\r\n  readonly onRefreshDOM?: (Config) => void;\r\n\r\n  readonly itemOptions: ItemOption<T>[];\r\n\r\n  // disables export setting\r\n  readonly noExport: boolean = false;\r\n\r\n  // TODO: {configs[], finalized, .refreshConfigs}\r\n  readonly parent: any;\r\n\r\n  private lookup = new Map<T, string>();\r\n\r\n  // DOM /rendering\r\n\r\n  public DOM: {\r\n    root?: any;\r\n    configOptions?: any;\r\n    noUiSlider?: any;\r\n    mainSelect?: any;\r\n    timeKeys?: any;\r\n    keySelect?: any;\r\n  };\r\n\r\n  // TODO: extend with necessary UI options\r\n  readonly UI: {\r\n    disabled?: boolean;\r\n    range?: [number, number];\r\n    step?: number;\r\n  };\r\n  readonly helparticle?: string;\r\n  readonly iconClass?: string;\r\n  readonly iconXML?: string;\r\n  readonly tooltip?: string;\r\n\r\n  readonly UISeperator?: {\r\n    className?: string;\r\n    title?: string;\r\n  };\r\n\r\n  readonly onDOM?: (any) => void;\r\n\r\n  /** -- */\r\n  constructor(_cfg: Partial<Config<T>>) {\r\n    Object.assign(this, _cfg);\r\n\r\n    this.UI ??= { disabled: false };\r\n\r\n    this.isActive ??= ((d) => {\r\n      if (d._type === \"_range_\") {\r\n        return (this.get() as unknown as number) > 0;\r\n      }\r\n      return this.is(d.value);\r\n    });\r\n\r\n    this.itemOptions\r\n      ?.filter((option) => option.value !== null)\r\n      .forEach((option) => this.lookup.set(option.value, option.name));\r\n\r\n    if (this?.parent?.configs)\r\n      this.parent.configs[this.cfgClass] = this;\r\n\r\n    this._prevValue = _cfg.default;\r\n    this._value = _cfg.default;\r\n\r\n    // TODO: This function may be async, but we are in a constructor...\r\n    this.onSet?.(this.get(), this);\r\n  }\r\n\r\n  /** Current value to string */\r\n  public toString() {\r\n    var v = this.get();\r\n    return i18n[this.lookup.get(v) || (v as undefined as string)];\r\n  }\r\n\r\n  /** Value getter */\r\n  public get(): T {\r\n    // If we have a forcedValue function that returns a non-null value, that's our current value;\r\n    var forced = this.forcedValue?.(this);\r\n    if (forced != null) return forced;\r\n\r\n    // We may run an onRead function to customize the value, or directly return the value itself.\r\n    return this.onRead?.(this._value) ?? this._value;\r\n  }\r\n\r\n  public is(v: T): boolean {\r\n    return this.get() === v;\r\n  }\r\n\r\n  /** Value setter - onSet function may be async*/\r\n  public async set(v: T) {\r\n    if (v == null) return; // cannot set to null or undefined. (false is ok)\r\n\r\n    var forced = this.forcedValue?.(this);\r\n    if (forced !== null && forced === v) return; // trying to set to current forced value. No need.\r\n\r\n    if (this.preSet) {\r\n      try {\r\n        v = await this.preSet(v, this);\r\n      } catch (error) {\r\n        if (this.parent?.finalized) {\r\n          Modal.alert(error); // show alert only after dashboard loading\r\n        }\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (v == null) return; // preSet can return null, preventing change and raising no error\r\n\r\n    if (this._value === v) return; // prevent setting it to current value - no change\r\n\r\n    this._prevValue = this._value;\r\n    this._value = v;\r\n\r\n    await this.onSet?.(this.get(), this);\r\n\r\n    if (this.parent?.refreshConfigs) {\r\n      this.parent.refreshConfigs();\r\n    } else {\r\n      this.refresh();\r\n    }\r\n  }\r\n\r\n  // sets the value to previous value\r\n  public async undoChange(){\r\n    await this.set(this._prevValue);\r\n  }\r\n\r\n  /** -- */\r\n  public async refresh() {\r\n    this.onRefreshDOM?.(this);\r\n\r\n    if (this.DOM) {\r\n      // we have custom forced value function\r\n      if (this.forcedValue) {\r\n        var v = this.forcedValue(this);\r\n        this.DOM.root.classed(\"forced\", v != null);\r\n        if (v != null) await this.onSet?.(v, this);\r\n      }\r\n\r\n      if (this.isActive) {\r\n        this.DOM.configOptions.classed(\"active\", this.isActive);\r\n      }\r\n\r\n      this.DOM.noUiSlider?.setHandle(0, this._value, false);\r\n\r\n      this.itemOptions\r\n        ?.filter((_) => _.DOM && _.activeWhen)\r\n        .forEach((_) => {\r\n          _.DOM.classList[!_.activeWhen() ? \"add\" : \"remove\"](\"disabled\");\r\n        });\r\n    }\r\n  }\r\n\r\n  /** Calls oNSet and refresh... */\r\n  public async reset() {\r\n    await this.onSet?.(this.get(), this);\r\n\r\n    if (this.parent?.refreshConfigs) {\r\n      this.parent.refreshConfigs(); // refresh all configs of the parent\r\n    } else {\r\n      await this.refresh();\r\n    }\r\n  }\r\n\r\n  private addUISeperator(DOM) {\r\n    if (!this.UISeperator) return;\r\n    DOM.append(\"tr\")\r\n      .attr(\"class\", \"configItemGroup \" + this.UISeperator.className ?? \"\")\r\n      .append(\"td\")\r\n      .attr(\"class\", \"groupName\")\r\n      .html(i18n[this.UISeperator.title]);\r\n  }\r\n\r\n  /** -- */\r\n  public insertControl(DOM) {\r\n    if (this.UI?.disabled) return;\r\n\r\n    this.addUISeperator(DOM);\r\n\r\n    this.DOM = {};\r\n    this.DOM.root = DOM.append(\"tr\")\r\n      .attr(\"class\", \"configItem configItem_\" + this.cfgClass);\r\n\r\n    this.DOM.root.append(\"td\")\r\n      .attr(\"class\", \"configItem_Header\")\r\n      .append(\"span\")\r\n      .html(i18n[this.cfgTitle]);\r\n\r\n    let icon = this.DOM.root.append(\"td\")\r\n      .attr(\"class\", \"configItem_Icon\")\r\n      .append(\"span\");\r\n\r\n    // We can use a css class, or iconXML.\r\n    if (this.iconClass) {\r\n      icon.attr(\"class\", \"icon \" + this.iconClass);\r\n    } else {\r\n      icon.attr(\"class\", \"icon\").append(\"span\").html(this.iconXML);\r\n    }\r\n\r\n    var _ = this.DOM.root\r\n      .append(\"td\")\r\n      .attr(\"class\", \"configItem_Options_td\")\r\n      .append(\"div\")\r\n      .attr(\"class\", \"configItem_Options\");\r\n\r\n    this.DOM.configOptions = _.selectAll(\".configOption\")\r\n      .data(this.itemOptions || [])\r\n      .enter()\r\n      .append(\"span\")\r\n      .attr(\r\n        \"class\",\r\n        (d: ItemOption<T>) => \"configOption pos_\" + (d._type || d.value || d.name)\r\n      )\r\n      .each((d: ItemOption<T>, i, nodes) => {\r\n        d.DOM = nodes[i];\r\n      });\r\n\r\n    this.DOM.configOptions\r\n      .filter((_: ItemOption<T>) => _.value !== undefined)\r\n      .html((d: ItemOption<T>) => i18n[d.name])\r\n      .on(\"click\", async (_event, d: ItemOption<T>) => await this.set(d.value) );\r\n\r\n    this.DOM.configOptions\r\n      .filter((_) => _._type === \"_range_\")\r\n      .append(\"span\")\r\n      .attr(\"class\", \"configOptionRange\")\r\n      .each((_, i, nodes) => {\r\n        this.DOM.noUiSlider = noUiSlider.create(nodes[i], {\r\n          connect: \"lower\",\r\n          step: 1,\r\n          behaviour: \"tap-drag\",\r\n          range: {\r\n            min: _.minValue,\r\n            max: _.maxValue,\r\n          },\r\n          start: this.default,\r\n        });\r\n        nodes[i].noUiSlider.on(\"set\", async (v) => await this.set(v));\r\n      });\r\n\r\n    this.DOM.root\r\n      .append(\"td\")\r\n      .attr(\"class\", \"configItem_Info\")\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa fa-question-circle\")\r\n      .attr(\"data-helparticle\", this.helparticle)\r\n      .tooltip((this.tooltip ? this.tooltip + \"<br><br>\" : \"\") + \"Learn more\", {\r\n        placement: \"bottom\",\r\n      });\r\n\r\n    Modal.createHelpScoutLinks(this.DOM.root);\r\n\r\n    this.onDOM?.(this.DOM);\r\n\r\n    this.refresh();\r\n  }\r\n\r\n  public exportValue() {\r\n    if (this.noExport) return undefined;\r\n    if (this._value === this.default) return undefined;\r\n    var v: any = this._value;\r\n    if (v instanceof Attrib) v = v.attribName;\r\n    if (v._time_src) v = v._time_src;\r\n    return v;\r\n  }\r\n\r\n  /** -- */\r\n  public exportConfigTo(_to) {\r\n    _to[this.cfgClass] = this.exportValue();\r\n  }\r\n}\r\n","import { utcParse } from \"d3-time-format\";\r\nimport { format } from \"d3-format\";\r\nimport { easeCubicOut } from \"d3-ease\";\r\nimport { scaleLog, scaleLinear } from \"d3-scale\";\r\nimport { arc, line, curveMonotoneX } from \"d3-shape\";\r\n\r\nimport { BlockType } from \"./Types\";\r\n\r\nconst d3 = {\r\n  utcParse,\r\n  format,\r\n  easeCubicOut,\r\n  scaleLog,\r\n  scaleLinear,\r\n  arc,\r\n  line,\r\n  curveMonotoneX,\r\n};\r\n\r\n/** A namespace for various independent functions */\r\nvar Util = {\r\n  // Does not modify _base or _extend configurations\r\n  mergeConfig(_base, _extend = {}) {\r\n    return Util._mergeLevel(\r\n      JSON.parse(JSON.stringify(_base)),\r\n      JSON.parse(JSON.stringify(_extend)),\r\n      _base,\r\n      _extend\r\n    );\r\n  },\r\n  // _target: is updated\r\n  // returns: _target\r\n  _mergeLevel(_target, _extend, _base_raw, _extend_raw) {\r\n    for (var _key in _extend_raw) {\r\n      var _value = _extend_raw[_key];\r\n\r\n      //if(_value==null) continue; // skip undefined values\r\n\r\n      if (_target[_key] == null) {\r\n        // key is new => Just assign the variable\r\n        _target[_key] = _value;\r\n        continue;\r\n      }\r\n\r\n      if (_value === null) {\r\n        delete _target[_key];\r\n        continue;\r\n      }\r\n\r\n      switch (typeof _value) {\r\n        case \"object\":\r\n          if (typeof _target[_key] === \"object\") {\r\n            // merge summaries section - custom logic\r\n            if (_key === \"summaries\") {\r\n              // both source and target has \"summaries\" section set\r\n              if (\r\n                !Array.isArray(_extend.summaries) ||\r\n                !Array.isArray(_target.summaries)\r\n              ) {\r\n                console.log(\"Merge error: summaries property is not array\");\r\n                continue;\r\n              }\r\n\r\n              var _finalSummaries = [];\r\n\r\n              _extend_raw.summaries.forEach((srcSummaryConfig) => {\r\n                if (!srcSummaryConfig.skipConfig)\r\n                  srcSummaryConfig.skipConfig = false;\r\n\r\n                var targetSummaryCfg = _base_raw.summaries.find(\r\n                  (s) => s.name === srcSummaryConfig.name\r\n                );\r\n                if (targetSummaryCfg) {\r\n                  srcSummaryConfig = Util._mergeLevel(\r\n                    JSON.parse(JSON.stringify(targetSummaryCfg)),\r\n                    JSON.parse(JSON.stringify(srcSummaryConfig)),\r\n                    targetSummaryCfg,\r\n                    srcSummaryConfig\r\n                  );\r\n                  if (!srcSummaryConfig.skipConfig)\r\n                    delete srcSummaryConfig.skipConfig;\r\n                }\r\n\r\n                // summary gets added to end of summaries list\r\n                _finalSummaries.push(srcSummaryConfig);\r\n              });\r\n              _base_raw.summaries.forEach((s) => {\r\n                if (!_finalSummaries.find((_s) => _s.name === s.name)) {\r\n                  _finalSummaries.push(s);\r\n                }\r\n              });\r\n              _target.summaries = _finalSummaries;\r\n            } else {\r\n              // recursion to merge new objects\r\n              Util._mergeLevel(\r\n                _target[_key],\r\n                _extend[_key],\r\n                _base_raw[_key],\r\n                _extend_raw[_key]\r\n              );\r\n            }\r\n            break;\r\n          }\r\n        // just assign the value to the key\r\n        default:\r\n          _target[_key] = _value;\r\n          break;\r\n      }\r\n    }\r\n\r\n    // there may be keys in raw target OR source that's not in _target\r\n    // Specically, function values (and dates) are skipped bc of JSON.stringify\r\n    for (var _key in _base_raw) {\r\n      if (_extend_raw[_key] === undefined) {\r\n        _target[_key] = _base_raw[_key];\r\n      }\r\n    }\r\n    for (var _key in _extend_raw) {\r\n      _target[_key] = _target[_key] || _extend_raw[_key];\r\n    }\r\n\r\n    return _target;\r\n  },\r\n\r\n  // ********************************************\r\n  // String methods\r\n  // ********************************************\r\n\r\n  // ***************\r\n  strCollate: new Intl.Collator(undefined, {\r\n    ignorePunctuation: true,\r\n    sensitivity: \"base\",\r\n    numeric: true,\r\n  }),\r\n  // ***************\r\n  sortFunc_List_String(a, b) {\r\n    return Util.strCollate.compare(\"\" + a, \"\" + b);\r\n  },\r\n  // ***************\r\n  sortFunc_List_Date(a, b) {\r\n    if (a == null || a === \"\") return 1;\r\n    if (b == null || b === \"\") return -1;\r\n    return b.getTime() - a.getTime(); // recent first\r\n  },\r\n  sortFunc_List_Number(a, b) {\r\n    return b - a;\r\n  },\r\n  /** -- */\r\n  toProperCase: function (str) {\r\n    return str.toLowerCase().replace(/\\b[a-z]/g, (f) => f.toUpperCase());\r\n  },\r\n\r\n  /** -- */\r\n  addUnitName: function (v, unitName, isSVG = false) {\r\n    if (!unitName) return (v + \"\").replace(\"G\", \"B\"); // replace abbrevation G with B;\r\n    var s = isSVG ? unitName : \"<span class='unitName'>\" + unitName + \"</span>\";\r\n    return ((Util.isCurrency(unitName) ? s + v : v + s) + \"\").replace(\"G\", \"B\"); // replace abbrevation G with B;\r\n  },\r\n\r\n  /** -- */\r\n  isCurrency(v) {\r\n    switch (v) {\r\n      case \"$\":\r\n      case \"€\":\r\n      case \"₺\":\r\n      case \"¥\":\r\n      case \"£\":\r\n      case \"₼\":\r\n      case \"؋\":\r\n      case \"ƒ\":\r\n      case \"¢\":\r\n      case \"﷼\":\r\n      case \"₪\":\r\n      case \"₣\":\r\n      case \"₩\":\r\n      case \"₦\":\r\n      case \"₲\":\r\n      case \"฿\":\r\n      case \"₴\":\r\n      case \"₡\": // Costa rica colon\r\n      case \"₱\": // Cuba peso\r\n      case \"₫\": // Viet nam dong\r\n      case \"₽\": // Russian ruble\r\n      case \"₹\": // India rupee\r\n      case \"៛\": // Cambodia riel\r\n      case \"лв\":\r\n      case \"zł\": // Poland Zloty\r\n      case \"Br\": // Belarus Ruble\r\n      case \"Lek\": // Albania Lek\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  },\r\n\r\n  /** -- */\r\n  getTimeParseFunc(fmt) {\r\n    // Note: new EPOCH config is %s (d3 standard method). Keeping for backwards compatibility!\r\n    if (fmt === \"%EPOCH\") {\r\n      return (v) => new Date(Math.floor(v * 1000));\r\n    }\r\n\r\n    if (fmt !== \"%sn\" && fmt !== \"%SN\") {\r\n      return d3.utcParse(fmt);\r\n    }\r\n\r\n    // Parse (Google) Sheet Date\r\n    // Days are counted from December 31st 1899 and are incremented by 1\r\n    // Decimals are fractions of a day.\r\n    return function (v) {\r\n      if (v && v !== \"\") {\r\n        var utc_days = Math.floor(v - 25569);\r\n        var utc_base = utc_days * 86400;\r\n\r\n        var fractional_day = v - Math.floor(v);\r\n        if (fractional_day === 0) {\r\n          return new Date(utc_base * 1000);\r\n        }\r\n        var total_seconds = Math.floor(86400 * fractional_day);\r\n\r\n        return new Date(utc_base * 1000 + total_seconds * 1000);\r\n      }\r\n    };\r\n  },\r\n\r\n  baseMeasureFormat: d3.format(\".2s\"),\r\n\r\n  /** You should only display at most 3 digits + k/m/etc */\r\n  formatForItemCount(n, unitName = \"\") {\r\n    n = Math.round(n);\r\n    var str;\r\n    if (n < 1000 && n > -1000) {\r\n      str = n.toString();\r\n    } else {\r\n      str = Util.baseMeasureFormat(n);\r\n      if (str.replace(/\\D/g, \"\").length === 3) {\r\n        str = d3.format(\".3s\")(n);\r\n      }\r\n    }\r\n    return Util.addUnitName(str, unitName, false);\r\n  },\r\n\r\n  /** -- */\r\n  isStepTicks: function (ticks) {\r\n    // increasing or decreasing (+/- 1)\r\n    return (\r\n      ticks.length >= 2 &&\r\n      ticks.every((v, i) =>\r\n        i === 0 ? true : Math.abs(ticks[i] - ticks[i - 1]) === 1\r\n      )\r\n    );\r\n  },\r\n\r\n  /** -- */\r\n  insertMinorTicks: function (ticks, _scale, _out, numMinor = 4) {\r\n    // if ticks[0] is larger than ticks[last], reverse\r\n    if (ticks[0] > ticks[ticks.length - 1]) ticks = ticks.reverse();\r\n    for (var i = 1; i < ticks.length; i++) {\r\n      var _minR = ticks[i - 1];\r\n      var _maxR = ticks[i];\r\n      var _difR = (_maxR - _minR) / numMinor;\r\n      var _min = _scale(_minR);\r\n      var _max = _scale(_maxR);\r\n      for (var j = 1; j < numMinor; j++) {\r\n        if (numMinor === 4) {\r\n          // base 2\r\n          var x = (_min + _max) / 2;\r\n          var _midR = (_minR + _maxR) / 2;\r\n          _out.push({\r\n            tickValue: _scale.invert(x),\r\n            major: false,\r\n            tickUnique: _midR,\r\n          });\r\n          _min = x;\r\n          _minR = _midR;\r\n        } else {\r\n          // new way\r\n          x = ticks[i - 1] + j * _difR;\r\n          _out.push({ tickValue: x, major: false, tickUnique: x });\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  /** -- */\r\n  ignoreScrollEvents: false,\r\n  scrollToPos_do(scrollDom, targetPos) {\r\n    scrollDom = scrollDom.node();\r\n    Util.ignoreScrollEvents = true;\r\n    // scroll to top\r\n    var startTime = null;\r\n    var scrollInit = scrollDom.scrollTop;\r\n    var easeFunc = d3.easeCubicOut;\r\n    var scrollTime = 500;\r\n    var animateToTop = function (timestamp) {\r\n      var progress;\r\n      if (startTime == null) startTime = timestamp;\r\n      // complete animation in 500 ms\r\n      progress = (timestamp - startTime) / scrollTime;\r\n      var m = easeFunc(progress);\r\n      scrollDom.scrollTop = (1 - m) * scrollInit + m * targetPos;\r\n      if (\r\n        scrollDom.scrollTop >= targetPos ||\r\n        scrollDom.offsetHeight + scrollDom.scrollTop >= scrollDom.scrollHeight\r\n      ) {\r\n        Util.ignoreScrollEvents = false;\r\n      } else {\r\n        window.requestAnimationFrame(animateToTop);\r\n      }\r\n    };\r\n    window.requestAnimationFrame(animateToTop);\r\n  },\r\n\r\n  removeEmptyKeys: function(cfg){\r\n    Object.keys(cfg).forEach(\r\n      (key) => cfg[key] === undefined && delete cfg[key]\r\n    );\r\n  },\r\n\r\n  // http://stackoverflow.com/questions/13627308/add-st-nd-rd-and-th-ordinal-suffix-to-a-number\r\n  ordinal_suffix_of: function (i) {\r\n    var j = i % 10,\r\n      k = i % 100;\r\n    if (j == 1 && k != 11) return i + \"st\";\r\n    if (j == 2 && k != 12) return i + \"nd\";\r\n    if (j == 3 && k != 13) return i + \"rd\";\r\n    return i + \"th\";\r\n  },\r\n\r\n  /** -- Geo-helper */\r\n  addMarginToBounds: function (bounds) {\r\n    if (!bounds.isValid()) return bounds;\r\n    var _NW = bounds.getNorthWest();\r\n    var _SE = bounds.getSouthEast();\r\n    var dist = _NW.distanceTo(_SE);\r\n    return bounds.extend(_NW.toBounds(dist / 5)).extend(_SE.toBounds(dist / 5));\r\n  },\r\n\r\n  /** The order of data type sorting on the attribute panel */\r\n  getAttribTypeOrder: (t: BlockType) => {\r\n    switch (t) {\r\n      case \"categorical\":\r\n        return 1;\r\n      case \"numeric\":\r\n        return 2;\r\n      case \"timestamp\":\r\n        return 3;\r\n      case \"timeseries\":\r\n        return 4;\r\n      case \"recordGeo\":\r\n        return 5;\r\n      case \"content\":\r\n        return 6;\r\n      case \"recordGeo\":\r\n        return 7;\r\n      default:\r\n        return 20;\r\n    }\r\n  },\r\n\r\n  /* -- */\r\n  intersects(d3bound, leafletbound) {\r\n    if (d3bound[0][0] > leafletbound._northEast.lng) return false;\r\n    if (d3bound[0][1] > leafletbound._northEast.lat) return false;\r\n    if (d3bound[1][0] < leafletbound._southWest.lng) return false;\r\n    if (d3bound[1][1] < leafletbound._southWest.lat) return false;\r\n    return true;\r\n  },\r\n\r\n  /** -- */\r\n  intersectsDOMRect(R1, R2) {\r\n    if (!R1 || !R2) return false;\r\n    if (R1.left > R2.right) return false;\r\n    if (R1.right < R2.left) return false;\r\n    if (R1.top > R2.bottom) return false;\r\n    if (R1.bottom < R2.top) return false;\r\n    return true;\r\n  },\r\n\r\n  /** -- */\r\n  getD3Scale: function (useLog) {\r\n    return useLog ? d3.scaleLog().base(2) : d3.scaleLinear();\r\n  },\r\n\r\n  /** -- */\r\n  getLineGenerator(timeScale, valueScale) {\r\n    return d3\r\n      .line()\r\n      .curve(d3.curveMonotoneX)\r\n      .x((d) => timeScale(d._time))\r\n      .y((d) => valueScale(d._value))\r\n      .defined((d) => d._value != null);\r\n  },\r\n\r\n  /** -- */\r\n  // http://stackoverflow.com/questions/5737975/circle-drawing-with-svgs-arc-path\r\n  // http://stackoverflow.com/questions/15591614/svg-radial-wipe-animation-using-css3-js\r\n  // http://jsfiddle.net/Matt_Coughlin/j3Bhz/5/\r\n  getPieSVGPath(_start, _angle, _r, strokeOnly) {\r\n    var _end = Math.min(_start + _angle, 0.999999);\r\n    var startRadian = (Math.PI * (360 * _start - 90)) / 180;\r\n    var endRadian = (Math.PI * (360 * _end - 90)) / 180;\r\n    var largeArcFlag = _angle > 0.5 ? 1 : 0;\r\n\r\n    return (\r\n      \"M \" +\r\n      Math.cos(startRadian) * _r +\r\n      \",\" +\r\n      Math.sin(startRadian) * _r +\r\n      \" A \" +\r\n      _r +\r\n      \",\" +\r\n      _r +\r\n      \" \" +\r\n      largeArcFlag +\r\n      \" \" +\r\n      largeArcFlag +\r\n      \" 1 \" +\r\n      Math.cos(endRadian) * _r +\r\n      \",\" +\r\n      Math.sin(endRadian) * _r +\r\n      \" \" +\r\n      (!strokeOnly ? \"L0,0\" : \"\")\r\n    );\r\n  },\r\n\r\n  /** -- */\r\n  getCirclePath: function () {\r\n    return d3\r\n      .arc()\r\n      .innerRadius(0)\r\n      .outerRadius(0.001)\r\n      .startAngle(0)\r\n      .endAngle(2 * Math.PI)();\r\n  },\r\n};\r\n\r\nexport { Util };\r\n","import { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { Aggregate } from \"./Aggregate\";\r\nimport { IntervalT } from \"./Types\";\r\n\r\n/** -- */\r\nexport abstract class Aggregate_Interval<T extends IntervalT> extends Aggregate {\r\n  readonly attrib: Attrib_Interval<T>;\r\n\r\n  public _minV: T = null;\r\n  get minV(){\r\n    return this._minV;\r\n  }\r\n\r\n  public _maxV: T = null;\r\n  get maxV(){\r\n    return this._maxV;\r\n  }\r\n\r\n  get tooltipTitle(): string {\r\n    return this.attrib.attribNameHTML;\r\n  }\r\n\r\n  validateMinMax() {\r\n    if (this.minV <= this.maxV) return;\r\n    let _temp = this.minV;\r\n    this._minV = this.maxV;\r\n    this._maxV = _temp;\r\n  }\r\n\r\n  isMinLarger(){\r\n    return this.minV > this.attrib.rangeOrg[0];\r\n  }\r\n  isMaxSmaller(){\r\n    return this.maxV < this.attrib.rangeOrg[1];\r\n  }\r\n\r\n  updateRecords(){\r\n    this.records = this.attrib.sortedRecords.filter((record) =>\r\n      this.isRecordWithin(record)\r\n    );\r\n  }\r\n\r\n  // true if the maximum value is included within the scale\r\n  isMaxIncluded: boolean = false;\r\n\r\n  // _spacer is needed to detect intersecting labels and prevent overlaps\r\n  // used by Block_Interval\r\n  public _spacer?: any;\r\n\r\n  constructor(attrib: Attrib_Interval<T>, minV: T, maxV: T) {\r\n    super(attrib);\r\n    this.setRange(minV, maxV);\r\n  }\r\n\r\n  setRange(_minV: T, _maxV: T) {\r\n    this._minV = _minV;\r\n    this._maxV = _maxV;\r\n  }\r\n\r\n  isRecordWithin(record) {\r\n    let v = this.attrib.getRecordValue(record);\r\n    if(v < this.minV ) return false;\r\n    if(v > this.maxV ) return false;\r\n    if( v=== this.maxV) return this.isMaxIncluded;\r\n    return true;\r\n  }\r\n\r\n  /** -- */\r\n  exportAggregateInfo() {\r\n    return {\r\n      min: this.minV,\r\n      max: this.maxV,\r\n    };\r\n  }\r\n}\r\n\r\nexport class Aggregate_Interval_Numeric extends Aggregate_Interval<number> {\r\n  hasFloat: boolean = true;\r\n\r\n  get label(): string {\r\n    if (this.minV == null || this.maxV == null) return \"-\";\r\n\r\n    if(this.maxV === this.minV + 1 && !this.hasFloat){\r\n      return this.attrib.getFormattedValue(this.minV, false);\r\n    }\r\n\r\n    var minStr = this.attrib.getFormattedValue(this.minV, false);\r\n    var maxStr = this.attrib.getFormattedValue(this.maxV, false);\r\n\r\n    if (this.isMinLarger() && this.isMaxSmaller()) {\r\n      if(this.isMaxIncluded){\r\n        return `${minStr} &mdash; ${maxStr}`;\r\n      } else {\r\n        return `${minStr} up to ${maxStr}`;\r\n      }\r\n    } else if (this.isMinLarger()) {\r\n      return `Min ${minStr}`;\r\n    } else {\r\n      if(this.isMaxIncluded){\r\n        return `Max ${maxStr}`;\r\n      } else {\r\n        return `Up to ${maxStr}`;\r\n      }\r\n    }\r\n  }\r\n\r\n  validateMinMax() {\r\n    super.validateMinMax();\r\n\r\n    // must be integers\r\n    if (!this.hasFloat) {\r\n      this._minV = Math.floor(this.minV);\r\n      this._maxV = Math.ceil(this.maxV);\r\n    }\r\n\r\n    this._minV = Math.max(this.minV, this.attrib.rangeOrg[0]);\r\n    this._maxV = Math.min(this.maxV, this.attrib.rangeOrg[1]);\r\n  }\r\n}\r\n","import { Aggregate_Interval } from \"./Aggregate_Interval\";\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Filter_Interval_Spec, IntervalT } from \"./Types\";\r\nimport { Filter } from \"./Filter\";\r\nimport { i18n } from \"./i18n\";\r\n\r\n/** Filtering based on intervals */\r\nexport class Filter_Interval<T extends IntervalT> extends Filter {\r\n  public readonly attrib: Attrib_Interval<T>;\r\n\r\n  public active: Aggregate_Interval<T>;\r\n\r\n  /** -- */\r\n  constructor(_browser: Browser, attrib: Attrib_Interval<T>) {\r\n    super(_browser);\r\n    this.attrib = attrib;\r\n  }\r\n\r\n  /** -- */\r\n  get title(): string {\r\n    return this.attrib.attribName;\r\n  }\r\n  /** -- */\r\n  exportFilter(): Filter_Interval_Spec<T> {\r\n    var _: Filter_Interval_Spec<T> = {};\r\n    if (this.noValueAggr.filtered) {\r\n      _.missing = this.noValueAggr.filtered;\r\n    } else if(this.active) {\r\n      _.min = this.active.minV;\r\n      _.max = this.active.maxV;\r\n    }\r\n    return _;\r\n  }\r\n  /** -- */\r\n  importFilter(_: Filter_Interval_Spec<T>) {\r\n    if (_.missing) {\r\n      this.noValueAggr.filtered = _.missing;\r\n    } else {\r\n      this.active = this.attrib.createAggregate(_.min, _.max);\r\n    }\r\n    this.setFiltered(false);\r\n    this.applyFilter();\r\n  }\r\n  /** -- */\r\n  onClear() {\r\n    super.onClear();\r\n\r\n    this.active = null;\r\n\r\n    this.browser.recordDisplay?.filterStatusUpdated(this.attrib);\r\n  }\r\n  /** -- */\r\n  onFilter(): void {\r\n    this.browser.recordDisplay?.filterStatusUpdated(this.attrib);\r\n\r\n    if (this.noValueAggr.filtered) {\r\n      var c =\r\n        this.noValueAggr.filtered === \"in\"\r\n          ? (record) => this.attrib.getRecordValue(record) === null\r\n          : (record) => this.attrib.getRecordValue(record) !== null;\r\n      this.attrib.records.forEach((record) => {\r\n        record.setFilterCache(this.filterID, c(record));\r\n      });\r\n      return;\r\n    }\r\n\r\n    var isFilteredCb;\r\n    if (this.active.isMinLarger() && this.active.isMaxSmaller()) {\r\n      if(this.active.isMaxIncluded){\r\n        isFilteredCb = (v) => v >= this.active.minV && v <= this.active.maxV;\r\n      } else {\r\n        isFilteredCb = (v) => v >= this.active.minV && v < this.active.maxV;\r\n      }\r\n      //\r\n    } else if (this.active.isMinLarger()) {\r\n      isFilteredCb = (v) => v >= this.active.minV;\r\n      //\r\n    } else {\r\n      if(this.active.isMaxIncluded){\r\n        isFilteredCb = (v) => v <= this.active.maxV;\r\n      } else {\r\n        isFilteredCb = (v) => v < this.active.maxV;\r\n      }\r\n    }\r\n\r\n    // TO-DO: Optimize: Check if the interval scale is extending/shrinking or completely updated...\r\n    this.attrib.records.forEach((record) => {\r\n      var v = this.attrib.getRecordValue(record);\r\n      record.setFilterCache(\r\n        this.filterID,\r\n        v !== null ? isFilteredCb(v) : false\r\n      );\r\n    });\r\n\r\n    this.attrib.block.DOM.zoomControl?.attr(\r\n      \"sign\",\r\n      this.attrib.block.zoomableStatus()\r\n    );\r\n\r\n    this.attrib.block.refreshIntervalSlider();\r\n\r\n    super.onFilter();\r\n  }\r\n\r\n  filterView_Detail() {\r\n    if (this.noValueAggr.filtered === \"in\") return `(${i18n.NoData})`;\r\n    if (this.noValueAggr.filtered === \"out\") return `(${i18n.ValidData})`;\r\n    return this.active.label;\r\n  }\r\n}\r\n\r\nexport class Filter_Numeric extends Filter_Interval<number> {}\r\n\r\nexport class Filter_Timestamp extends Filter_Interval<Date> {\r\n  /** -- */\r\n  importFilter(_: Filter_Interval_Spec<Date>) {\r\n    if (_.missing) {\r\n      this.noValueAggr.filtered = _.missing;\r\n    } else {\r\n      this.active = this.active = this.attrib.createAggregate(_.min, _.max);\r\n      // if (this.attrib.type === \"timestamp\") {\r\n      //   this.active.min = new Date(this.active.min);\r\n      //   this.active.max = new Date(this.active.max);\r\n      // }\r\n    }\r\n    this.setFiltered(false);\r\n    this.applyFilter();\r\n  }\r\n}\r\n","import { Aggregate } from \"./Aggregate\";\r\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { TimeData, TimeKey, TimeSeriesData } from \"./TimeSeriesData\";\r\n\r\nimport { Base } from \"./Base\";\r\nimport { CompareType } from \"./Types\";\r\n\r\nexport class Record {\r\n  public readonly _id: string;\r\n\r\n  public readonly data: any;\r\n\r\n  // By default, each item is aggregated as 1\r\n  // You can modify this with a non-negative value\r\n  // Note that the aggregation currently works by summation only.\r\n  public measure_Self = 1;\r\n\r\n  public DOM: {\r\n    record: any;\r\n  };\r\n\r\n  /** -- */\r\n  constructor(d, idIndex) {\r\n    this.data = d;\r\n    this._id = d[idIndex];\r\n\r\n    this.DOM = { record: undefined };\r\n  }\r\n\r\n  get id() {\r\n    return this._id;\r\n  }\r\n\r\n  get label() {\r\n    return this._id;\r\n  }\r\n\r\n  // Aggregates which this record falls under\r\n  private _aggrCache: Aggregate[] = [];\r\n\r\n  // The data that's used for mapping this item, used as a cache.\r\n  // This is accessed by filterID, and used for getRecordValue\r\n  private _valueCache: any[] = []; // caching the values this item was mapped toggle\r\n\r\n  setValue(attrib: Attrib, v: any) {\r\n    this._valueCache[attrib.attribID] = v;\r\n  }\r\n  getValue(attrib: Attrib): any {\r\n    return this._valueCache[attrib.attribID];\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering state\r\n  // ********************************************************************\r\n\r\n  // Cached filter state, indexed by attribute ID\r\n  private _filterCache: boolean[] = [];\r\n\r\n  // Wanted item / not filtered out\r\n  private _filteredOut: boolean = false;\r\n  get filteredOut(): boolean {\r\n    return this._filteredOut;\r\n  }\r\n  get isIncluded(): boolean {\r\n    return !this._filteredOut;\r\n  }\r\n\r\n  // If true, filter/wanted state is dirty and needs to be updated.\r\n  private _filterCacheIsDirty = true;\r\n\r\n  /** -- */\r\n  setFilterCache(index: number, v: boolean): void {\r\n    if (this._filterCache[index] === v) return;\r\n    this._filterCache[index] = v;\r\n    this._filterCacheIsDirty = true;\r\n  }\r\n\r\n  /** Updates isIncluded state, and notifies all related aggregates of the change\r\n   *  Returns true iff the filtered stated is changed.\r\n   **/\r\n  refreshFilterCache(): boolean {\r\n    if (!this._filterCacheIsDirty) return false;\r\n\r\n    var prev = this.isIncluded;\r\n\r\n    this._filteredOut = this._filterCache.some((f) => !f); // set to true iff at least one is false\r\n    this._filterCacheIsDirty = false;\r\n\r\n    if (this.isIncluded === prev) return false;\r\n\r\n    if (this.measure_Self != null) {\r\n      // may be zero or negative...\r\n      var cntToAdd = this.isIncluded ? 1 : -1;\r\n      var measureToAdd = cntToAdd * this.measure_Self; // Add : Remove value\r\n      this._aggrCache.forEach((aggr) => {\r\n        aggr.addToActive(measureToAdd, cntToAdd);\r\n      });\r\n    }\r\n\r\n    this.DOM.record?.classList.toggle(\"isExcluded\");\r\n\r\n    return true;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Selected state\r\n  // ********************************************************************\r\n\r\n  private selected = {\r\n    Compare_A: false,\r\n    Compare_B: false,\r\n    Compare_C: false,\r\n    Compare_D: false,\r\n    Compare_E: false,\r\n  };\r\n\r\n  // if a specific compare type is given, looks that up. otherwise, checks if ANY is selected\r\n  isSelected(cT: CompareType = null): boolean {\r\n    if (cT) return this.selected[cT];\r\n    return Base.Compare_List.some((cT) => this.selected[cT]);\r\n  }\r\n  /** -- */\r\n  get activeComparisons() {\r\n    return Base.Compare_List.filter((cT) => this.selected[cT]);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Rank information (used externally)\r\n  // ********************************************************************\r\n\r\n  // Rank order of the record. Starts from zero\r\n  // Used by the list view only TODO: Review\r\n  public recordRank = 0;\r\n  // assigned on data load, each record has a unique order position\r\n  public recordOrder = 0;\r\n  // negative if filtered out, positive if filtered in\r\n  public recordRank_Unique = 0;\r\n\r\n  // ********************************************************************\r\n  // Used by other methods to track additional view-state\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  assignDOM(dom) {\r\n    this.DOM.record = dom;\r\n    if (!dom) return;\r\n\r\n    this.DOM.record.classList[this.isIncluded ? \"remove\" : \"add\"](\"isExcluded\");\r\n    Base.Compare_List.forEach((cT) => {\r\n      this.DOM.record.classList[this.selected[cT] ? \"add\" : \"remove\"](\r\n        \"rec-selected-\" + cT\r\n      );\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  removeAggrFromCache(aggr: Aggregate) {\r\n    this._aggrCache.splice(this._aggrCache.indexOf(aggr), 1);\r\n  }\r\n\r\n  /** -- */\r\n  moveDOMtoTop() {\r\n    if (this.DOM.record && navigator.userAgent.indexOf(\"Edge\") <= 0) {\r\n      this.DOM.record.parentNode.appendChild(this.DOM.record);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  highlightRecord() {\r\n    this.DOM.record?.classList.add(\"rec-selected-onRecord\");\r\n    // update visuals of aggregates that this record appears in\r\n    this._aggrCache.forEach((aggr) => {\r\n      aggr.DOM.aggrGlyph?.classList.add(\"withRecordHighlight\");\r\n      if (aggr instanceof Aggregate_Interval) {\r\n        aggr.attrib.block.showRecordValue(this);\r\n      }\r\n    });\r\n  }\r\n  /** -- */\r\n  unhighlightRecord() {\r\n    this.DOM.record?.classList.remove(\"rec-selected-onRecord\");\r\n    this._aggrCache.forEach((aggr) => {\r\n      aggr.DOM.aggrGlyph?.classList.remove(\"withRecordHighlight\");\r\n      if (aggr instanceof Aggregate_Interval) {\r\n        aggr.attrib.block.hideRecordValue?.();\r\n      }\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  flipSelected(f, cT) {\r\n    this.DOM.record?.classList[this.selected[cT] === f ? \"remove\" : \"add\"](\r\n      \"rec-selected-\" + cT\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  addToAggrMeasure(_type) {\r\n    if (this.filteredOut) return;\r\n\r\n    this._aggrCache.forEach((aggr) => {\r\n      if (this.measure_Self === 0) return;\r\n      aggr[_type].measure += this.measure_Self;\r\n      aggr[_type].recCnt++;\r\n    });\r\n  }\r\n  /** -- */\r\n  removeFromAggrMeasure(_type) {\r\n    if (this.filteredOut) return;\r\n\r\n    this._aggrCache.forEach((aggr) => {\r\n      if (this.measure_Self === 0) return;\r\n      aggr[_type].measure -= this.measure_Self;\r\n      aggr[_type].recCnt--;\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  setCompared(cT) {\r\n    if (this.selected[cT]) return;\r\n    this.selected[cT] = true;\r\n    if (this.DOM.record) {\r\n      this.DOM.record.classList.add(\"rec-selected-\" + cT);\r\n      // SVG geo area - move it to the bottom of parent so that border can be displayed nicely.\r\n      // TO-DO: improve the conditional check!\r\n      if (this.DOM.record.nodeName === \"path\")\r\n        this.DOM.record.parentNode.appendChild(this.DOM.record);\r\n    }\r\n    this.addToAggrMeasure(cT);\r\n  }\r\n\r\n  /** -- */\r\n  unsetCompared(cT) {\r\n    if (!this.selected[cT]) return;\r\n    this.selected[cT] = false;\r\n    this.DOM.record?.classList.remove(\"rec-selected-\" + cT);\r\n    this.removeFromAggrMeasure(cT);\r\n  }\r\n\r\n  /** -- */\r\n  getTimeKeys(): TimeKey[] {\r\n    // collect ALL time keys / all attributes\r\n    return (\r\n      this._valueCache\r\n        // only the timseries values\r\n        .filter((_) => _ instanceof TimeSeriesData)\r\n        // Keep TimeData only\r\n        .map((ts: TimeSeriesData) => Object.values(ts._keyIndex))\r\n        .flat()\r\n        // filter to unique values\r\n        .filter(\r\n          (key, index, self: TimeData[]) =>\r\n            self.findIndex(\r\n              (t: TimeData) => t._time.getTime() === key._time.getTime()\r\n            ) === index\r\n        )\r\n        // sort by _time (latest first)\r\n        .sort((a, b) => b._time.getTime() - a._time.getTime())\r\n    );\r\n  }\r\n\r\n  public _view: {\r\n    inCluster?: any;\r\n    _labelHidden?: any;\r\n    _labelOverlap?: any;\r\n    _labelPos?: any;\r\n    hideTextLabel?: any;\r\n    textBounds?: any;\r\n    isInScatterPlot?: any;\r\n    wasInScatterPlot?: any;\r\n    isInRange?: any;\r\n    viewBounds?: any;\r\n    x?: any,\r\n    y?: any,\r\n  } = {};\r\n}\r\n","import { extent } from \"d3-array\";\r\n\r\nimport { BlockType, CompareType, IntervalT, SummarySpec } from \"./Types\";\r\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\r\nimport { Block_Interval } from \"./Block_Interval\";\r\nimport { Filter_Interval } from \"./Filter_Interval\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Record } from \"./Record\";\r\n\r\nconst d3 = { extent };\r\n\r\nexport abstract class Attrib_Interval<T extends IntervalT> extends Attrib {\r\n  public _aggrs: Aggregate_Interval<T>[] = [];\r\n\r\n  protected _block: Block_Interval<T>;\r\n  public get block(): Block_Interval<T> {\r\n    return this._block;\r\n  }\r\n\r\n  public sortedRecords: Record[] = [];\r\n\r\n  get attribName(): string {\r\n    return super.attribName;\r\n  }\r\n\r\n  set attribName(name: string) {\r\n    super.attribName = name;\r\n    // name wasn't updated\r\n    if (this.attribName === name) {\r\n      this.browser.recordDisplay.refreshAttribOptions(\"sort\");\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Value scale and Ticks\r\n  // ********************************************************************\r\n\r\n  public intervalTicks: T[] = [];\r\n\r\n  binMatch(bin: [T, T, any], aggr: Aggregate_Interval<T>) {\r\n    return +bin[0] - +aggr.minV === 0 && +bin[1] - +aggr.maxV === 0;\r\n  }\r\n\r\n  // d3 scale object (linear / log / time\r\n  // depends on whether it is numeric or timestamp attibute\r\n  public valueScale: any = null;\r\n  public valueScale_prev: any = null;\r\n\r\n  // linear scale, log scale, time scale\r\n  abstract getValueScaleObj(): any;\r\n  // adjusts between linear and log (for numeric) - no-op for timestamp;\r\n  abstract refreshScaleType(): any;\r\n\r\n  // Printing\r\n  abstract updateTickPrintFunc();\r\n  // looks like a function, but created like a member in subclasses dynamically\r\n  intervalTickPrint: (T) => string = null;\r\n\r\n  // TODO: move to Block (View)\r\n  abstract getValuePosX(v: T): number;\r\n\r\n  // Resets the valueScale and intervalTicks based on \r\n  // active range (filtering/zoom), UI width, scale type\r\n  refreshValueScale() {\r\n    var nicing = this.block.getScaleNicing();\r\n\r\n    this.valueScale = this.getValueScaleObj()\r\n      .domain(this.rangeActive)\r\n      .range([0, this.block.width_histogram])\r\n      .nice(nicing);\r\n\r\n    this.intervalTicks = this.valueScale.ticks(nicing);\r\n\r\n    this.updateTickPrintFunc();\r\n  }\r\n\r\n  updateScaleAndBins(forceRenderUpdate = false) {\r\n    if (this.isEmpty()) return;\r\n    if (!this.aggr_initialized) return;\r\n\r\n    this.valueScale_prev = this.valueScale.copy();\r\n\r\n    // if the labels are updated (multiple rows), design needs update too.\r\n    var height_labels_prev = this.block.height_Ticklabels;\r\n\r\n    this.refreshValueScale();\r\n\r\n    var ticks = this.intervalTicks;\r\n\r\n    if (ticks.length === 0) return;\r\n\r\n    this.block.aggrWidth =\r\n      this.valueScale(ticks[1]) - this.valueScale(ticks[0]);\r\n\r\n    // [ From , To (excluding), assign aggregate ]\r\n    type Bin = [T, T, Aggregate_Interval<T>];\r\n\r\n    // converts ticks to bins\r\n    var bins: Bin[] = this.intervalTicks.reduce(\r\n      (result: Bin[], value: T, index: number, array) => {\r\n        if (index < array.length - 1) {\r\n          result.push([value, array[index + 1], null]);\r\n        }\r\n        return result;\r\n      },\r\n      []\r\n    );\r\n\r\n    // Identify aggregates that don't match to a bin, clear their records, remove them from all aggreegate index\r\n    this._aggrs = this._aggrs.filter((curAggr) => {\r\n      // aggregate that matches one of the bins exists already. Do not modify...\r\n      if (bins.some((bin) => this.binMatch(bin, curAggr))) {\r\n        return true;\r\n      }\r\n      curAggr.clearRecords();\r\n      this.browser.allAggregates.splice(\r\n        this.browser.allAggregates.indexOf(curAggr),\r\n        1\r\n      );\r\n      return false;\r\n    });\r\n\r\n    // keep only bins that do not have an existing aggregate\r\n    bins = bins.filter(\r\n      (bin: Bin) => !this._aggrs.some((curAggr) => this.binMatch(bin, curAggr))\r\n    );\r\n\r\n    // if there are new bins, create aggregates, and put records inside\r\n    if (bins.length > 0) {\r\n      // create new aggregate interval for each remaining bin\r\n      bins.forEach((bin: Bin, i) => {\r\n        let aggr = this.getAggregate(bin[0], bin[1]);\r\n        if (i === bins.length - 1) {\r\n          aggr.isMaxIncluded = true;\r\n        }\r\n        bin[2] = aggr; // indexing aggregate object for the bin\r\n      });\r\n\r\n      // sort aggregates by order of bin values, min to max\r\n      this._aggrs = this._aggrs.sort((a, b) => +b.minV - +a.minV);\r\n\r\n      // place records across bins\r\n      this.records.forEach((record) => {\r\n        var v = this.getRecordValue(record);\r\n        if (v == null) return;\r\n        // Add record into appropriate bin.\r\n        // This iterates only over new bins\r\n        bins.forEach((bin) => {\r\n          if (v < bin[0]) return;\r\n          var aggr = bin[2];\r\n          if (v < bin[1] || (v == bin[1] && aggr.isMaxIncluded)) {\r\n            aggr.addRecord(record);\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    // RENDER UPDATES\r\n    if (!this.block.DOM.inited) return;\r\n\r\n    this.block.refreshIntervalSlider();\r\n\r\n    if (bins.length > 0 || forceRenderUpdate) {\r\n      this.block.insertVizDOM();\r\n\r\n      if (height_labels_prev !== this.block.height_Ticklabels) {\r\n        this.block.setHeight(this.block.getHeight());\r\n      }\r\n\r\n      this.updateChartScale_Measure();\r\n\r\n      this.block.refreshViz_All(false); // no-axis\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Step ticks\r\n  // ********************************************************************\r\n\r\n  private _stepTicks: boolean = false;\r\n  get stepTicks() {\r\n    return this._stepTicks;\r\n  }\r\n  setStepTicks(v) {\r\n    this._stepTicks = v;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Aggregates / bins\r\n  // ********************************************************************\r\n\r\n  abstract fillValueCache(): void;\r\n  abstract pofffff(): void;\r\n\r\n  initializeAggregates(): void {\r\n    if (this.aggr_initialized) return;\r\n\r\n    if (this.noValueAggr.records.length > 0) {\r\n      this.noValueAggr.records = [];\r\n      this.noValueAggr.resetAggregateMeasures();\r\n    }\r\n\r\n    this.fillValueCache();\r\n\r\n    // remove records that map to null / undefined\r\n    this.sortedRecords = this.records.filter(\r\n      (record) => this.getRecordValue(record) != null\r\n    );\r\n    // Sort the items by their attribute value\r\n    this.sortedRecords.sort((a: Record, b: Record) => {\r\n      // +Date converts the date to a number, and the template system continues by conversion\r\n      let a1 = +this.getRecordValue(a);\r\n      let a2 = +this.getRecordValue(b);\r\n      return a1 - a2;\r\n    });\r\n\r\n    this.updatedRangeOrg();\r\n\r\n    this.refreshValueScale();\r\n\r\n    this.pofffff();\r\n\r\n    this.aggr_initialized = true;\r\n  }\r\n\r\n  abstract createAggregate(minV: T, maxV: T): Aggregate_Interval<T>;\r\n\r\n  getAggregate(minV: T, maxV: T): Aggregate_Interval<T> {\r\n    var newAggr = this.createAggregate(minV, maxV);\r\n    this._aggrs.push(newAggr);\r\n    this.browser.allAggregates.push(newAggr);\r\n    return newAggr;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering and Range\r\n  // ********************************************************************\r\n\r\n  public summaryFilter: Filter_Interval<T>;\r\n  createSummaryFilter() {\r\n    this.summaryFilter = new Filter_Interval(this.browser, this);\r\n  }\r\n\r\n  // original data scale\r\n  rangeOrg: [T, T];\r\n  updatedRangeOrg() {\r\n    this.rangeOrg = this.getRecordValueExtent();\r\n  }\r\n\r\n  // returns filtered range if filtered. Otherwise, original range\r\n  get rangeActive(): [T, T] {\r\n    return (this.summaryFilter.isFiltered && this.block.zoomed.is(true))\r\n      ? [this.summaryFilter.active.minV, this.summaryFilter.active.maxV]\r\n      : this.rangeOrg;\r\n  }\r\n\r\n  // in numbers, if time-series key, uses timeseries extent automatically\r\n  getRecordValueExtent(): [T, T] {\r\n    return d3.extent(this.sortedRecords, (record: Record) =>\r\n      this.getRecordValue(record)\r\n    );\r\n  }\r\n\r\n  // if time-series time key, returns timeserie's scale domain.\r\n  getVizDomain(): [T, T] {\r\n    this.initializeAggregates();\r\n    return this.valueScale.domain();\r\n  }\r\n\r\n  rangeFilterTimer: number = 0;\r\n\r\n  // creates new aggregate, and uses a timer to run the filtering\r\n  setRangeFilter_Custom(minV, maxV) {\r\n    var aggr = this.createAggregate(minV, maxV);\r\n    aggr.validateMinMax();\r\n    this.setRangeFilter(aggr, true);\r\n  }\r\n\r\n  setRangeFilter(aggr: Aggregate_Interval<T>, useTimer = false) {\r\n    aggr.validateMinMax();\r\n\r\n    this.summaryFilter.active = aggr;\r\n\r\n    this.summaryFilter.noValueAggr.filtered = false;\r\n\r\n    this.block.refreshIntervalSlider();\r\n\r\n    if (this.rangeFilterTimer) window.clearTimeout(this.rangeFilterTimer);\r\n    this.rangeFilterTimer = window.setTimeout(\r\n      () => {\r\n        this.summaryFilter.setFiltered();\r\n        this.rangeFilterTimer = 0;\r\n      },\r\n      useTimer ? 250 : 0\r\n    );\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Sort labels (when attribute is used for sorting)\r\n  // ********************************************************************\r\n\r\n  _sortLabel: (Record) => string = null;\r\n\r\n  get sortLabel(): (Record) => string {\r\n    if (this._sortLabel) {\r\n      return (record) => this._sortLabel.call(record.data, record);\r\n    }\r\n    return (record) => {\r\n      var s = this.getRecordValue(record);\r\n      return s == null ? \"\" : this.getFormattedValue(s, false);\r\n    };\r\n  }\r\n\r\n  set sortLabel(v) {\r\n    this._sortLabel = v;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Record / printing / access\r\n  // ********************************************************************\r\n\r\n  getRecordValue(record: Record): T {\r\n    return record.getValue(this);\r\n  }\r\n\r\n  constructor(\r\n    browser: Browser,\r\n    name: string,\r\n    template: any,\r\n    _type: BlockType,\r\n    blockClassName,\r\n    nuggetClassName\r\n  ) {\r\n    super(\r\n      browser,\r\n      name,\r\n      template,\r\n      _type,\r\n      \"kshfSummary_Interval \" + blockClassName, // adds \"kshfSummary_Interval\" to given class name\r\n      nuggetClassName\r\n    );\r\n\r\n    this.createSummaryFilter();\r\n  }\r\n\r\n  updateChartScale_Measure(skipRefreshViz = false) {\r\n    if (!this.block.isVisible()) return;\r\n    super.updateChartScale_Measure(skipRefreshViz);\r\n\r\n    this.block.refreshViz_Bins();\r\n    this.block.refreshViz_All(false); // no-axis\r\n  }\r\n\r\n  get measureRangeMax(): number {\r\n    return this.block.height_hist;\r\n  }\r\n\r\n  // if range is invalid, returns the same value in both pairs\r\n  sanitizeRange(minV: T, maxV: T): [T, T] {\r\n    var activeRanges = this.activeComparisons\r\n      .filter((_: CompareType) => {\r\n        return (\r\n          this.browser.Compare_Highlight !== _ &&\r\n          (this.browser.selectedAggrs[_] as Aggregate_Interval<T>).minV != null\r\n        );\r\n      })\r\n      .map((_) => this.browser.selectedAggrs[_])\r\n      .map((_: Aggregate_Interval<T>) => ({ minV: _.minV, maxV: _.maxV }));\r\n\r\n    var r = activeRanges.reduce(\r\n      (accum, curRange) => {\r\n        // zero size range. no-op\r\n        if (accum.minV === accum.maxV) return accum;\r\n        // current range holds the input range. bad!\r\n        if (curRange.minV <= accum.minV && accum.maxV <= curRange.maxV) {\r\n          return { minV: minV, maxV: maxV }; // same value - signals invalid range\r\n        }\r\n        // input range holds the active range. bad!\r\n        if (accum.minV <= curRange.minV && curRange.maxV <= accum.maxV) {\r\n          return { minV: minV, maxV: maxV }; // same value - signals invalid range\r\n        }\r\n        // current range does not intersect with active range. Continue as-is\r\n        if (curRange.minV > accum.maxV || curRange.maxV < accum.minV) {\r\n          return accum;\r\n        }\r\n        // current range limits the active minimum value\r\n        if (curRange.maxV > accum.minV && curRange.minV < accum.minV) {\r\n          return { minV: curRange.maxV, maxV: accum.maxV };\r\n        }\r\n        // current range limits the active maximum value\r\n        if (curRange.minV < accum.maxV && curRange.minV > accum.maxV) {\r\n          return { minV: accum.minV, maxV: curRange.minV };\r\n        }\r\n        return accum;\r\n      },\r\n      { minV: minV, maxV: maxV }\r\n    );\r\n\r\n    return [r.minV, r.maxV];\r\n  }\r\n\r\n  renderRecordValue(v, d3_selection): string {\r\n    if (v instanceof Record) v = this.getRecordValue(v);\r\n\r\n    if (v == null) {\r\n      v = \"-\";\r\n    } else if (this.type !== \"timestamp\") {\r\n      v = v.toLocaleString();\r\n    }\r\n    let str = this.getFormattedValue(v, false);\r\n    if (d3_selection) {\r\n      d3_selection.html(str);\r\n    } else {\r\n      return str;\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  printAbbr(v: number, isSVG = false) {\r\n    if (v == null) return \"-\";\r\n    this.initializeAggregates();\r\n    return this.getFormattedValue(this.intervalTickPrint(v), isSVG);\r\n  }\r\n\r\n  isEmpty() {\r\n    return !this.aggr_initialized;\r\n  }\r\n\r\n  async applyConfig(blockCfg: SummarySpec) {\r\n    super.applyConfig(blockCfg);\r\n\r\n    await this.block.showHistogram.set(blockCfg.showHistogram);\r\n    await this.block.optimumBinWidth.set(blockCfg.optimumBinWidth);\r\n    await this.block.maxHeightRatio.set(blockCfg.maxHeightRatio);\r\n    await this.measureScaleType.set(blockCfg.measureScaleType);\r\n    await this.block.zoomed.set(blockCfg.zoomed);\r\n\r\n    if (blockCfg.filter) {\r\n      this.summaryFilter.importFilter(blockCfg.filter as any);\r\n    } else if (this.isFiltered()) {\r\n      this.summaryFilter.clearFilter();\r\n    }\r\n  }\r\n}\r\n","import { select, pointer } from \"./d3_select\";\r\n\r\nimport { Panel } from \"./UI/Panel\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { i18n } from \"./i18n\";\r\nimport { CompareType, d3Selection, MeasureType } from \"./Types\";\r\nimport { Util } from \"./Util\";\r\nimport { Base } from \"./Base\";\r\nimport { Modal } from \"./UI/Modal\";\r\nimport { Record } from \"./Record\";\r\nimport { Aggregate } from \"./Aggregate\";\r\n\r\nconst d3 = { select, pointer };\r\n\r\nexport abstract class Block {\r\n  // attribute of the block\r\n  public readonly attrib: Attrib;\r\n  // browser of the block (retrieved from attribute)\r\n  protected get browser() {\r\n    return this.attrib.browser;\r\n  }\r\n\r\n  // shorthand\r\n  get _aggrs(): Aggregate[] {\r\n    return this.attrib._aggrs;\r\n  }\r\n\r\n  public DOM: {\r\n    inited: boolean;\r\n    nugget?: d3Selection;\r\n    summaryIcons?: d3Selection;\r\n    root?: d3Selection;\r\n    headerGroup?: d3Selection;\r\n    summaryConfig?: d3Selection;\r\n    wrapper?: d3Selection;\r\n    summaryNameWrapper?: d3Selection;\r\n    blockName?: d3Selection;\r\n    summaryConfigControl?: d3Selection;\r\n\r\n    [index: string]: d3Selection; // general access...\r\n  } = { inited: false };\r\n\r\n  // The panel this block appears in (if placed in dashboard)\r\n  public panel: Panel = null;\r\n  public orderInPanel: number;\r\n\r\n  // Can be accessed by called .collapsed\r\n  private _collapsed: boolean = false;\r\n  get collapsed(): boolean {\r\n    return this._collapsed;\r\n  }\r\n\r\n  private _height_header: number = 0; // TODO\r\n  // Used by panel layouting to keep track of which blocks need to be layout\r\n  public dueForLayout: boolean; // TODO\r\n\r\n  constructor(attrib: Attrib) {\r\n    this.attrib = attrib;\r\n  }\r\n\r\n  get inDashboard() {\r\n    return this.panel !== null;\r\n  }\r\n  isVisible() {\r\n    return (\r\n      !this.attrib.isEmpty() &&\r\n      this.inDashboard &&\r\n      !this.collapsed &&\r\n      this.DOM.inited\r\n    );\r\n  }\r\n\r\n  abstract get height_Content(): number;\r\n  abstract get height_RangeMin(): number;\r\n  abstract get height_RangeMax(): number;\r\n  abstract setHeight(targetHeight: number): void;\r\n  abstract refreshWidth(): void;\r\n  abstract hasStaticHeight(): boolean;\r\n\r\n  abstract initDOM(beforeDOM): boolean;\r\n\r\n  onClearFilter(forceUpdate: boolean = false) {}\r\n\r\n  getWidth(): number {\r\n    return this.panel ? this.panel.width_Real - 2 : 0; // 1 pixel border on left & right\r\n  }\r\n  getHeight(): number {\r\n    return this.height_Header + this.height_Content;\r\n  }\r\n  get height_withMargin() {\r\n    return this.getHeight() + 8;\r\n  }\r\n\r\n  get height_Header() {\r\n    if (!this.DOM.inited) return 0;\r\n    if (!this._height_header) {\r\n      if (this.panel.isCollapsed()) return 0;\r\n      this._height_header = 29; // too much work to get the height/width right with panels collapsing\r\n      // 1 * this.DOM.headerGroup.node().offsetHeight;\r\n    }\r\n    return this._height_header;\r\n  }\r\n\r\n  refreshHeight() {\r\n    if (this.attrib.isEmpty() || !this.inDashboard || !this.DOM.inited) return;\r\n    this.DOM.root.style(\"flex-basis\", this.getHeight() + \"px\");\r\n  }\r\n\r\n  insertRoot(beforeDOM: Element | null) {\r\n    this.DOM.root = this.panel.DOM.root.insert(\"div\", () => {\r\n      return beforeDOM;\r\n    });\r\n\r\n    this.DOM.root\r\n      .attr(\"class\", \"kshfSummary \" + this.attrib.blockClassName)\r\n      .attr(\"summary_id\", this.attrib.attribID) // can be used to customize a specific summary using CSS\r\n      .classed(\"disableCompareLock\", !this.attrib.isComparable.is(true))\r\n      .classed(\"filtered\", this.attrib.isFiltered())\r\n      .datum(this);\r\n\r\n    // can be extended by sub-classes\r\n    this.insertHeader();\r\n\r\n    // initialize config controls\r\n    Object.values(this.attrib.configs).forEach((cfg) =>\r\n      cfg.insertControl(this.DOM.summaryConfig)\r\n    );\r\n  }\r\n\r\n  updateDescription() {\r\n    this.DOM.nugget\r\n      ?.select(\".summaryDescription\")\r\n      .classed(\"active\", this.attrib.description ? true : null)\r\n      .node()\r\n      .tippy.setContent(this.attrib.description);\r\n    this.DOM.summaryIcons\r\n      ?.select(\".summaryDescription\")\r\n      .classed(\"active\", this.attrib.description ? true : null);\r\n  }\r\n\r\n  addToPanel(panel: Panel, index = null, _force = false) {\r\n    if (!panel) return;\r\n\r\n    if (index === null) {\r\n      index = panel.attribs.length; // add to end\r\n    }\r\n\r\n    var panelChanged = false;\r\n    if (this.panel === null) {\r\n      panelChanged = true;\r\n    } else if (this.panel && this.panel !== panel) {\r\n      this.panel.removeBlock(this);\r\n      panelChanged = true;\r\n    } else {\r\n      // re-inserting to current panel\r\n      if (this.orderInPanel === index) {\r\n        return; // inserting the summary to the same index as current one\r\n      }\r\n      // remove the dropzone above the moved summary\r\n      var dropZoneDOM = this.panel.DOM.root.selectAll(\".dropZone\").nodes()[\r\n        this.orderInPanel\r\n      ];\r\n      dropZoneDOM.parentNode.removeChild(dropZoneDOM);\r\n      if (this.orderInPanel < index) index--;\r\n    }\r\n\r\n    panel.addBlock(this, index);\r\n    this.DOM.nugget?.classed(\"inDashboard\", (_) => this.inDashboard);\r\n\r\n    if (panelChanged) {\r\n      this.refreshWidth();\r\n    }\r\n\r\n    this.browser.refreshIsEmpty();\r\n  }\r\n\r\n  removeFromPanel() {\r\n    if (!this.panel) return;\r\n    this.panel.removeBlock(this);\r\n\r\n    if (this.DOM.root) {\r\n      let dom = this.DOM.root.node();\r\n      dom.parentNode.removeChild(dom);\r\n    }\r\n\r\n    this.panel = null;\r\n\r\n    this.DOM.nugget?.classed(\"inDashboard\", (_) => this.inDashboard);\r\n\r\n    this.browser.refreshIsEmpty();\r\n  }\r\n\r\n  insertHeader() {\r\n    var me = this;\r\n\r\n    var _tempMoved = false;\r\n    this.DOM.headerGroup = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"headerGroup\")\r\n      .on(\"mousedown\", function (event) {\r\n        if (!me.browser.authorMode) {\r\n          event.preventDefault();\r\n          return;\r\n        }\r\n        var _this = this;\r\n        var moved = false;\r\n        _tempMoved = false;\r\n        d3.select(\"body\")\r\n          .style(\"cursor\", \"move\")\r\n          .on(\"keydown.layout\", function () {\r\n            if (event.keyCode === 27) {\r\n              // Escape key\r\n              _this.style.opacity = null;\r\n              me.browser.clearDropZones();\r\n            }\r\n          })\r\n          .on(\"mousemove.layout\", function (event2) {\r\n            _tempMoved = true;\r\n            if (!moved) {\r\n              if (_this.nextSibling) _this.nextSibling.style.display = \"none\";\r\n              if (_this.previousSibling)\r\n                _this.previousSibling.style.display = \"none\";\r\n              _this.parentNode.style.opacity = 0.5;\r\n              me.browser.prepareDropZones(me.attrib, \"browser\");\r\n              moved = true;\r\n            }\r\n            var mousePos = d3.pointer(event2, me.browser.DOM.root.node());\r\n            me.browser.DOM.attribDragBox.style(\r\n              \"transform\",\r\n              \"translate(\" +\r\n                (mousePos[0] - 20) +\r\n                \"px,\" +\r\n                (mousePos[1] + 5) +\r\n                \"px)\"\r\n            );\r\n            event2.stopPropagation();\r\n            event2.preventDefault();\r\n          })\r\n          .on(\"mouseup.layout\", function (event2) {\r\n            d3.select(\"body\").style(\"cursor\", null);\r\n            // Mouse up on the body\r\n            me.browser.clearDropZones();\r\n            if (me.panel !== undefined || true) {\r\n              _this.parentNode.style.opacity = null;\r\n              if (_this.nextSibling) _this.nextSibling.style.display = \"\";\r\n              if (_this.previousSibling)\r\n                _this.previousSibling.style.display = \"\";\r\n            }\r\n            event2.preventDefault();\r\n          });\r\n        event.preventDefault();\r\n      })\r\n      .on(\"mouseup\", () => {\r\n        if (_tempMoved) return;\r\n        d3.select(\"body\").style(\"cursor\", null);\r\n        this.browser.clearDropZones();\r\n        this.browser.unregisterBodyCallbacks();\r\n      });\r\n\r\n    this.DOM.headerGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"header_display_control iconGroup\")\r\n      .on(\"mousedown\", (event) => event.stopPropagation())\r\n      .selectAll(\"span\")\r\n      .data([\r\n        [\r\n          \"Remove\",\r\n          \"fa fa-times-circle\",\r\n          () => {\r\n            this.removeFromPanel();\r\n            this.browser.updateLayout();\r\n          },\r\n        ],\r\n        [\r\n          \"Collapse\",\r\n          \"fa fa-compress-alt\",\r\n          () => this.setCollapsedAndLayout(true),\r\n        ],\r\n        [\"Open\", \"fa fa-expand-alt\", () => this.setCollapsedAndLayout(false)],\r\n      ])\r\n      .enter()\r\n      .append(\"span\")\r\n      .attr(\"class\", (_) => \"buttonSummary\" + _[0] + \" \" + _[1])\r\n      .tooltip((_) => i18n[_[0] + \"Summary\"], { placement: \"bottom\" })\r\n      .on(\"click\", (_event, _) => _[2]());\r\n\r\n    this.DOM.summaryNameWrapper = this.DOM.headerGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"summaryNameWrapper\");\r\n\r\n    this.DOM.blockName = this.DOM.summaryNameWrapper\r\n      .append(\"span\")\r\n      .attr(\"class\", \"blockName summaryName\")\r\n      .on(\"click\", () => {\r\n        if (this.collapsed) {\r\n          this.setCollapsedAndLayout(false); //un-collapse\r\n        }\r\n      });\r\n\r\n    this.attrib.addDOMBlockName(this.DOM.blockName);\r\n\r\n    this.DOM.summaryIcons = this.DOM.headerGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"summaryIcons iconGroup\")\r\n      .on(\"mousedown\", (event) => event.stopPropagation());\r\n\r\n    this.DOM.summaryConfigControl = this.DOM.summaryIcons\r\n      .append(\"span\")\r\n      .attr(\"class\", \"summaryConfigControl fa fa-cog\")\r\n      .tooltip(i18n.Configure, { placement: \"bottom\" })\r\n      .on(\"click\", () => {\r\n        var open = !this.DOM.root.classed(\"showConfig\");\r\n        this.browser.closeConfigPanels();\r\n        if (open) {\r\n          this.browser.blockWithOpenConfig = this;\r\n        }\r\n        this.DOM.root.classed(\"showConfig\", open);\r\n      });\r\n\r\n    this.DOM.summaryIcons\r\n      .append(\"span\")\r\n      .attr(\"class\", \"summaryDescription fa fa-info\")\r\n      .tooltip(\"\", {\r\n        placement: \"bottom\",\r\n        onShow: (instance) => {\r\n          instance.reference.tippy.setContent(this.attrib.description);\r\n        },\r\n      });\r\n\r\n    this.DOM.headerGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"configPanel summaryConfig\")\r\n      .on(\"mousedown\", (event) => event.stopPropagation())\r\n      .call((summaryConfig) => {\r\n        summaryConfig\r\n          .append(\"div\")\r\n          .attr(\"class\", \"configClose fa fa-window-close\")\r\n          .tooltip(i18n.Close)\r\n          .on(\"click\", () => {\r\n            this.browser.closeConfigPanels();\r\n            this.DOM.root.classed(\"showConfig\", false);\r\n          });\r\n        summaryConfig\r\n          .append(\"div\")\r\n          .attr(\"class\", \"compactSizeControl fa fa-angle-double-up\")\r\n          .on(\"click\", (event) =>\r\n            event.target.parentNode.classList.toggle(\"compact\")\r\n          );\r\n        this.DOM.summaryConfig = summaryConfig\r\n          .append(\"table\")\r\n          .attr(\"class\", \"configTable\");\r\n      });\r\n\r\n    this.DOM.wrapper = this.DOM.root.append(\"div\").attr(\"class\", \"wrapper\");\r\n\r\n    this.refreshSummaryName_DOM();\r\n\r\n    this.insertDOM_EmptyAggr();\r\n\r\n    this.DOM.summaryNameWrapper\r\n      .insert(\"div\", \":first-child\")\r\n      .attr(\"class\", \"summaryHeaderButton clearFilterButton fa\")\r\n      .tooltip(i18n.RemoveFilter, { placement: \"bottom\" })\r\n      .on(\"mousedown\", (event) => event.stopPropagation())\r\n      .on(\"click\", (event) => {\r\n        this.attrib.summaryFilter?.clearFilter();\r\n        event.stopPropagation();\r\n      });\r\n\r\n    this.DOM.summaryNameWrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"summaryHeaderButton summaryLockButton fa fa-clone\")\r\n      .tooltip(\"\", {\r\n        onTrigger: (instance) => {\r\n          instance.reference.tippy.setContent(\r\n            i18n[\r\n              this.browser.comparedAttrib === this.attrib\r\n                ? \"Unlock\"\r\n                : \"CompareTopCategories\"\r\n            ]\r\n          );\r\n        },\r\n      })\r\n      .on(\"mousedown\", (event) => event.stopPropagation())\r\n      .on(\"click\", (event) => {\r\n        if (this.attrib.isComparedAttrib()) {\r\n          this.browser.clearSelect_Compare(\r\n            this.browser.activeComparisons,\r\n            true,\r\n            true\r\n          );\r\n        } else {\r\n          this.attrib.autoCompare();\r\n        }\r\n        event.stopPropagation();\r\n      });\r\n  }\r\n\r\n  refreshSummaryName_DOM() {\r\n    if (this.DOM.blockName) {\r\n      this.attrib.addDOMBlockName(this.DOM.blockName);\r\n    }\r\n    this.DOM.nugget?.select(\".summaryName\").html(this.attrib.printName);\r\n  }\r\n\r\n  get hasNugget(): boolean {\r\n    return !!this.DOM.nugget;\r\n  }\r\n\r\n  refreshNugget(_dom) {\r\n    var me = this;\r\n    let attribMoved;\r\n    this.DOM.nugget = _dom;\r\n    this.DOM.nugget\r\n      .on(\"dblclick\", (event, d) => {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        if (this.inDashboard) {\r\n          this.removeFromPanel();\r\n        } else {\r\n          this.browser.autoAddAttib(d.item);\r\n        }\r\n        this.browser.updateLayout();\r\n      })\r\n      .on(\"mousedown\", function (event) {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n\r\n        var _this = this;\r\n        attribMoved = false;\r\n        d3.select(\"body\")\r\n          .on(\"keydown.layout\", (event2) => {\r\n            if (event2.keyCode === 27) {\r\n              // Escape key\r\n              _this.removeAttribute(\"moved\");\r\n              me.browser.clearDropZones();\r\n            }\r\n          })\r\n          .on(\"mousemove.layout\", (event2) => {\r\n            if (!attribMoved) {\r\n              _this.setAttribute(\"moved\", \"\");\r\n              me.browser.prepareDropZones(me.attrib, \"authoringPanel\");\r\n              attribMoved = true;\r\n            }\r\n            var mousePos = d3.pointer(event2, me.browser.DOM.root.node());\r\n            me.browser.DOM.attribDragBox.style(\r\n              \"transform\",\r\n              `translate(${mousePos[0] - 20}px,${mousePos[1] + 5}px)`\r\n            );\r\n            event2.stopPropagation();\r\n            event2.preventDefault();\r\n          })\r\n          .on(\"mouseup.layout\", (event2) => {\r\n            if (!attribMoved) return;\r\n            _this.removeAttribute(\"moved\");\r\n            me.browser.DOM.root.attr(\"drag_cursor\", null);\r\n            me.browser.clearDropZones();\r\n            event2.preventDefault();\r\n          });\r\n        event.preventDefault();\r\n      })\r\n      .on(\"mouseup\", () => {\r\n        if (!attribMoved) this.browser.unregisterBodyCallbacks();\r\n      });\r\n  }\r\n\r\n  setCollapsedAndLayout(collapsed) {\r\n    this.setCollapsed(collapsed);\r\n    this.browser.updateLayout_Height();\r\n\r\n    if (!this.DOM.root || this.collapsed || !this.DOM.inited) return;\r\n    this.refreshViz_All();\r\n    this.refreshMeasureLabelText(\"Active\");\r\n  }\r\n\r\n  setCollapsed(v: boolean): void {\r\n    this._collapsed = v;\r\n    this.panel?.refreshCollapsed();\r\n    var _ = this.height_Header; // computes header height if needed.\r\n    this.DOM.root\r\n      ?.classed(\"collapsed\", this.collapsed)\r\n      .classed(\"showConfig\", false);\r\n    this.onCollapse();\r\n  }\r\n\r\n  // Can be extended by sub-classes as needed\r\n  onCollapse(): void {\r\n    return;\r\n  }\r\n\r\n  abstract refreshViz_Active(): void;\r\n  abstract refreshViz_Compare(\r\n    cT: CompareType,\r\n    curGroup,\r\n    totalGroups,\r\n    prevCts\r\n  ): void;\r\n\r\n  // used by subclasses as well\r\n  get measureLineZero() {\r\n    return this.attrib.chartScale_Measure(0);\r\n  }\r\n\r\n  refreshViz_Cache(sT: MeasureType, _preCompare = null) {\r\n    if (!this.DOM.inited) return;\r\n    if (this.attrib.type === \"setpair\") return;\r\n\r\n    var baseline = this.measureLineZero;\r\n    var preCompare = this.browser.stackedChart\r\n      ? _preCompare || this.browser.activeComparisons\r\n      : [];\r\n\r\n    var _chartValue = (aggr, sT) =>\r\n      this.attrib.chartScale_Measure(this.browser.getChartValue(aggr, sT)) -\r\n      baseline;\r\n\r\n    this._aggrs.forEach((aggr) => {\r\n      aggr.setScale(sT, _chartValue(aggr, sT));\r\n      aggr.setOffset(\r\n        sT,\r\n        preCompare.reduce((accum, sT) => accum + _chartValue(aggr, sT), 0)\r\n      );\r\n    });\r\n\r\n    // flip 'active' selection\r\n    if (sT === \"Active\" && preCompare.length > 0 && this.browser.stackedChart) {\r\n      this._aggrs.forEach((aggr) => {\r\n        aggr.setScale(sT, aggr.scale(\"Active\") - aggr.offset(sT));\r\n      });\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshViz_All(withAxisRefresh = true) {\r\n    if (!this.isVisible()) return;\r\n    if (!this.attrib.chartScale_Measure) return;\r\n    this.refreshViz_Active();\r\n    this.refreshViz_Compare_All();\r\n    this.refreshViz_NoValueAggr();\r\n    if (withAxisRefresh) this.refreshViz_Axis();\r\n  }\r\n  // -- TODO: incomplete / check references, not used much\r\n  refreshViz(sT) {\r\n    if (this.attrib.type === \"content\") return;\r\n    return sT === \"Active\"\r\n      ? this.refreshViz_Active()\r\n      : this.refreshViz_Compare(sT, 0, 0, null);\r\n  }\r\n  /** -- */\r\n  refreshViz_Compare_All() {\r\n    if (this.attrib.type === \"content\") return;\r\n    var compared = this.browser.activeComparisons;\r\n    var totalC = this.browser.activeComparisonsCount;\r\n\r\n    compared.forEach((cT, i) =>\r\n      this.refreshViz_Compare(cT, i, totalC, compared.slice(0, i))\r\n    );\r\n  }\r\n\r\n  // This can be set to true to prevent refreshViz_Axis from executing\r\n  noRefreshVizAxis: boolean = false;\r\n\r\n  abstract chartAxis_Measure_TickSkip(): number;\r\n\r\n  /** -- */\r\n  refreshViz_Axis() {\r\n    if (!this.isVisible()) return;\r\n    if (this.noRefreshVizAxis) return;\r\n\r\n    var axis_Scale = this.attrib.chartScale_Measure.copy().clamp(false);\r\n\r\n    // GET TICK VALUES ***********************************************************\r\n    // (no more than 10 tick values)\r\n    var tickValues = axis_Scale.ticks(\r\n      Math.min(10, this.chartAxis_Measure_TickSkip())\r\n    );\r\n\r\n    // Remove 0-tick if all domain values are non-negative\r\n    // if(axis_Scale.domain()[0]>=0) tickValues = tickValues.filter(d => d!==0 );\r\n\r\n    if (this.browser.hasIntOnlyMeasure())\r\n      tickValues = tickValues.filter((d) => Number.isInteger(d));\r\n\r\n    var ticks = tickValues.map((p) => ({ tickValue: p, major: true }));\r\n\r\n    if (this.attrib.measureScale_Log) {\r\n      if (this.attrib.measureLogBase === 2) {\r\n        Util.insertMinorTicks(\r\n          tickValues,\r\n          this.attrib.chartScale_Measure,\r\n          ticks\r\n        );\r\n      } else {\r\n        var maxDomainValue = axis_Scale.domain()[1];\r\n        if (maxDomainValue > this.attrib.measureLogBase) {\r\n          ticks = [];\r\n          tickValues = [];\r\n          var x = 1;\r\n          maxDomainValue *= this.attrib.measureLogBase; // adding one more major tick beyond the domain, so minors can be added.\r\n          while (x < maxDomainValue) {\r\n            ticks.push({ tickValue: x, major: true });\r\n            tickValues.push(x);\r\n            x *= this.attrib.measureLogBase;\r\n          }\r\n        }\r\n        Util.insertMinorTicks(\r\n          tickValues,\r\n          this.attrib.chartScale_Measure,\r\n          ticks,\r\n          this.attrib.measureLogBase - 1\r\n        );\r\n        maxDomainValue = axis_Scale.domain()[1];\r\n        ticks = ticks.filter((_) => _.tickValue < maxDomainValue);\r\n      }\r\n    }\r\n\r\n    var _transform =\r\n      this.attrib.type === \"categorical\"\r\n        ? (d, _scale) => `translateX(${_scale(d.tickValue) - 0.5}px)`\r\n        : (d, _scale) => `translateY(${-_scale(d.tickValue)}px)`;\r\n\r\n    var finalAnim = (t) =>\r\n      t\r\n        .style(\"transform\", (d) => _transform(d, axis_Scale))\r\n        .style(\"opacity\", 1);\r\n\r\n    var selection = this.DOM.chartAxis_Measure_TickGroup\r\n      .selectAll(\"span.tick\")\r\n      .data(ticks, (t) => t.tickValue);\r\n\r\n    selection\r\n      .enter()\r\n      .append(\"span\")\r\n      .attr(\"class\", \"tick\")\r\n      .call((ticks) => {\r\n        ticks.append(\"span\").attr(\"class\", \"line\");\r\n        ticks.append(\"span\").attr(\"class\", \"text measureAxis_1\");\r\n        ticks.append(\"span\").attr(\"class\", \"text measureAxis_2\");\r\n\r\n        if (\r\n          this.browser.chartsLoaded &&\r\n          this.attrib.chartScale_Measure_prev &&\r\n          !this.browser.preventAxisScaleTransition\r\n        ) {\r\n          // to transition position from previous scale, set position based on previous scale first\r\n          ticks\r\n            .style(\"opacity\", 0)\r\n            .classed(\"noAnim\", true)\r\n            .style(\"transform\", (tick) =>\r\n              _transform(tick, this.attrib.chartScale_Measure_prev)\r\n            )\r\n            .classed(\"noAnim\", false)\r\n            .call((ticks) =>\r\n              finalAnim(ticks.transition().duration(0).delay(10))\r\n            );\r\n        } else {\r\n          finalAnim(ticks);\r\n        }\r\n      })\r\n      .merge(selection)\r\n      .classed(\"major\", (tick) => tick.major)\r\n      .classed(\"minor\", (tick) => !tick.major)\r\n      .call((x) =>\r\n        x\r\n          .selectAll(\".text\")\r\n          .html((tick) => this.browser.getValueLabel(tick.tickValue, false))\r\n      );\r\n\r\n    finalAnim(selection);\r\n\r\n    selection.exit().call((exit) => {\r\n      if (\r\n        this.browser.chartsLoaded &&\r\n        this.attrib.chartScale_Measure_prev &&\r\n        !this.browser.preventAxisScaleTransition\r\n      ) {\r\n        exit = exit.style(\"transform\", (tick) => _transform(tick, axis_Scale));\r\n      }\r\n      return exit\r\n        .style(\"opacity\", 0)\r\n        .transition()\r\n        .duration(0)\r\n        .delay(500)\r\n        .remove();\r\n    });\r\n  }\r\n\r\n  refreshViz_NoValueAggr() {\r\n    if(this.attrib.noValueAggr.records.length===0) return;\r\n    this.DOM.noValueAggr?.classed(\r\n      \"visible\",\r\n      this.attrib.noValueAggr.recCnt(\"Active\") > 0\r\n    );\r\n  }\r\n\r\n  refreshMeasureLabelPos_All() {\r\n    this.refreshMeasureLabelPos(\"Active\");\r\n    this.browser.activeComparisons.forEach((cT, i) =>\r\n      this.refreshMeasureLabelPos(cT, i)\r\n    );\r\n  }\r\n  refreshMeasureLabelPos(sT = \"Active\", curGroup = 0) {\r\n    // No-op, can be extended\r\n  }\r\n\r\n  refreshMeasureLabelText(selectType: MeasureType) {\r\n    if (!this.isVisible()) return;\r\n    var _ = this.DOM[\"measureLabel_\" + selectType];\r\n    if (!_) return;\r\n\r\n    var offset =\r\n      this.browser.stackedChart && selectType === \"Active\"\r\n        ? this.browser.activeComparisons\r\n        : [];\r\n\r\n    var func = (aggr: Aggregate) => {\r\n      var _val = this.browser.getMeasureValue(aggr, selectType, null, offset);\r\n      var isSVG = aggr.DOM?.aggrGlyph?.nodeName === \"g\";\r\n      return this.browser.getValueLabel(\r\n        _val,\r\n        isSVG,\r\n        Base.percentDecimal ? 1 : 0\r\n      );\r\n    };\r\n\r\n    _.html(func);\r\n\r\n    if (\r\n      this.attrib.noValueAggr.records.length > 0 &&\r\n      selectType === \"Active\"\r\n    ) {\r\n      offset = [];\r\n      this.DOM.noValueAggr?.select(\".measureLabel_Active\").html(func);\r\n    }\r\n  }\r\n\r\n  insertDOM_EmptyAggr() {\r\n    this.DOM.noValueAggr = this.DOM.wrapper\r\n      .append(\"span\")\r\n      .attr(\"class\", \"noValueAggr aggrGlyph\")\r\n      .classed(\"filtered\", this.attrib.noValueAggr.filtered)\r\n      .datum(this.attrib.noValueAggr)\r\n      .tooltip((_) => this.attrib.noValueAggr.getTooltipHTML(), {\r\n        theme: \"dark kshf-tooltip kshf-record\",\r\n      })\r\n      .each((_, i, nodes) => {\r\n        this.attrib.noValueAggr.setAggrGlyph(nodes[i]);\r\n      })\r\n      .on(\"mouseover\", () => {\r\n        if (this.browser.adjustMode) return;\r\n        if (this.browser.mouseOverCompare.is(false)) return;\r\n        this.browser.setSelect_Compare(this.attrib.noValueAggr);\r\n      })\r\n      .on(\"mouseout\", () => {\r\n        this.browser.clearSelect_Compare();\r\n      })\r\n      .on(\"click\", (event) => {\r\n        if (event.shiftKey) {\r\n          this.browser.lockSelect_Compare();\r\n          return;\r\n        }\r\n\r\n        var noValAggr = this.attrib.noValueAggr;\r\n\r\n        var menuConfig = { name: \"Filter\", items: [] };\r\n\r\n        if (noValAggr.filtered) {\r\n          menuConfig.items.push({\r\n            id: \"filterOption_Remove\",\r\n            name: `<span class='filterContextOpt'>${i18n.Clear}</span>`,\r\n            do: () => {\r\n              noValAggr.filtered = false;\r\n              this.attrib.summaryFilter.how = \"All\";\r\n              this.attrib.summaryFilter.clearFilter();\r\n            },\r\n          });\r\n        }\r\n\r\n        if (noValAggr.filtered !== \"in\") {\r\n          menuConfig.items.push({\r\n            id: \"filterOption_Only\",\r\n            iconXML: \"✗\",\r\n            name: i18n.KeepNoData,\r\n            helparticle: \"5e88e95e04286364bc97d43f\",\r\n            do: () => {\r\n              this.attrib.summaryFilter.clearFilter();\r\n              noValAggr.filtered = \"in\";\r\n              this.attrib.summaryFilter.how = \"All\";\r\n              this.attrib.summaryFilter.setFiltered();\r\n            },\r\n          });\r\n        }\r\n        if (noValAggr.filtered !== \"out\") {\r\n          menuConfig.items.push({\r\n            id: \"filterOption_Not\",\r\n            iconXML: \"✓\",\r\n            name: i18n.KeepValidData,\r\n            helparticle: \"5e88e95e04286364bc97d43f\",\r\n            do: () => {\r\n              noValAggr.filtered = \"out\";\r\n              this.attrib.summaryFilter.setFiltered();\r\n            },\r\n          });\r\n        }\r\n        Modal.popupMenu(event, menuConfig, noValAggr);\r\n      });\r\n\r\n    this.DOM.noValueAggr.append(\"div\").attr(\"class\", \"noValueIcon\").text(\"∅\");\r\n    this.DOM.noValueAggr\r\n      .append(\"div\")\r\n      .attr(\"class\", \"measureLabel measureLabel_Active\");\r\n\r\n    this.refreshViz_NoValueAggr();\r\n  }\r\n\r\n  abstract updateAfterFilter(refreshViz: boolean): void;\r\n  refreshUIFiltered(v) {\r\n    this.DOM.root\r\n      ?.classed(\"filtered\", v)\r\n      .classed(\r\n        \"filtered_missing\",\r\n        v ? this.attrib.noValueAggr.filtered !== false : false\r\n      );\r\n  }\r\n\r\n  // -- Shared - Summary Base --\r\n  insertChartAxis_Measure(dom) {\r\n    this.DOM.chartAxis_Measure = dom\r\n      .append(\"div\")\r\n      .attr(\"class\", \"chartAxis_Measure\");\r\n\r\n    this.DOM.chartAxis_Measure.append(\"div\").attr(\"class\", \"measureDescrLabel\");\r\n    this.refreshMeasureDescrLabel();\r\n\r\n    this.DOM.chartAxis_Measure_TickGroup = this.DOM.chartAxis_Measure\r\n      .append(\"div\")\r\n      .attr(\"class\", \"tickGroup\");\r\n  }\r\n  refreshMeasureDescrLabel() {\r\n    this.DOM.root\r\n      ?.selectAll(\".measureDescrLabel\")\r\n      .html(i18n.MeasureDescrLabel(this.browser, this.attrib));\r\n  }\r\n\r\n  // Utility method for subclasses\r\n  insertAggrLockButton(dom, placement) {\r\n    var onClick = (aggr: Aggregate) => {\r\n      if (aggr.compared && aggr.locked) {\r\n        this.browser.clearSelect_Compare(aggr.compared, true, true);\r\n      } else {\r\n        if (\r\n          this.browser.setSelect_Compare(\r\n            aggr,\r\n            null,\r\n            false // no finalize analytics\r\n          )\r\n        ) {\r\n          this.browser.lockSelect_Compare();\r\n        }\r\n      }\r\n    };\r\n\r\n    dom\r\n      .append(\"span\")\r\n      .attr(\"class\", \"lockButton fa fa-clone\")\r\n      .tooltip((_: Aggregate) => i18n[_.locked ? \"Unlock\" : \"LockToCompare\"], {\r\n        placement: placement,\r\n      })\r\n      .on(\"click\", (event, aggr) => {\r\n        if (this.browser.comparedAttrib && !this.attrib.isComparedAttrib()) {\r\n          Modal.confirm(\r\n            i18n.DialogChangeCompare(\r\n              this.attrib.attribNameHTML,\r\n              this.browser.comparedAttrib.attribNameHTML\r\n            ),\r\n            i18n.Confirm\r\n          ).then(\r\n            () => {\r\n              this.browser.clearSelect_Compare(\r\n                this.browser.activeComparisons,\r\n                false,\r\n                true\r\n              ); // don't finalize yet\r\n              onClick(aggr);\r\n            },\r\n            () => {}\r\n          );\r\n        } else if (!this.browser.Compare_Highlight && !aggr.locked) {\r\n          Modal.alert(i18n.ComparedSelectionsLimit);\r\n        } else {\r\n          onClick(aggr);\r\n        }\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  showRecordValue(record: Record): void {}\r\n  hideRecordValue(): void {}\r\n}\r\n","import { select, pointer } from \"./d3_select\";\r\nimport { min, max, extent } from \"d3-array\";\r\n\r\nimport { Block } from \"./Block\";\r\nimport { Base } from \"./Base\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\r\nimport { Config } from \"./Config\";\r\nimport { Record } from \"./Record\";\r\n\r\nimport { CompareType, IntervalT, MeasureType } from \"./Types\";\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  min,\r\n  max,\r\n  extent,\r\n};\r\n\r\nexport type ZoomableStatus = \"plus\" | \"minus\" | \"\";\r\n\r\nexport abstract class Block_Interval<T extends IntervalT> extends Block {\r\n  // specific attribute type\r\n  public readonly attrib: Attrib_Interval<T>;\r\n\r\n  readonly zoomed: Config<boolean>;\r\n  readonly optimumBinWidth: Config<number>;\r\n  readonly maxHeightRatio: Config<number>;\r\n  readonly showHistogram: Config<boolean>;\r\n\r\n  abstract dragRange(initPos, curPos, initMin, initMax): void;\r\n  abstract showValuePicker(DOM, d: \"min\" | \"max\"): void;\r\n\r\n  // shorthand\r\n  get valueScale() {\r\n    return this.attrib.valueScale;\r\n  }\r\n\r\n  constructor(attrib: Attrib_Interval<T>) {\r\n    super(attrib);\r\n\r\n    this.zoomed = new Config<boolean>({\r\n      parent: this,\r\n      cfgClass: \"zoomed\",\r\n      cfgTitle: \"ValueAxisZoom\",\r\n      default: false,\r\n      UI: { disabled: true },\r\n      iconClass: \"fa fa-search\",\r\n      helparticle: \"5e87ea002c7d3a7e9aea606c\",\r\n      itemOptions: [\r\n        { name: \"Zoomed\", value: true },\r\n        { name: \"Full\", value: false },\r\n      ],\r\n      forcedValue: () => {\r\n        if (!this.attrib.isFiltered()) return false;\r\n      },\r\n      onSet: async (v) => {\r\n        if (!this.attrib.aggr_initialized) return;\r\n\r\n        this.attrib.refreshValueScale();\r\n\r\n        if (this.DOM.inited) {\r\n          this.DOM.summaryInterval.classed(\"zoomed\", v);\r\n          this.DOM.zoomControl.attr(\"sign\", v ? \"minus\" : \"plus\");\r\n        }\r\n\r\n        this.noRefreshVizAxis = true;\r\n        var tempScale_prev = this.attrib.chartScale_Measure.copy().clamp(false);\r\n\r\n        if (this.attrib.type !== \"timestamp\") this.attrib.refreshScaleType(); // linear vs log\r\n        this.attrib.updateScaleAndBins();\r\n        this.refreshHeight();\r\n\r\n        this.noRefreshVizAxis = false;\r\n        this.attrib.chartScale_Measure_prev = tempScale_prev;\r\n        this.refreshViz_Axis();\r\n\r\n        await this.browser.recordDisplay?.refreshAttribScaleType(this);\r\n\r\n        this.attrib.updateScaleAndBins();\r\n      },\r\n    });\r\n\r\n    // ******************************************************\r\n    // Interval Bin width\r\n    this.optimumBinWidth = new Config<number>({\r\n      parent: this,\r\n      cfgClass: \"optimumBinWidth\",\r\n      cfgTitle: \"BinWidth\",\r\n      UISeperator: {\r\n        title: \"Binning\",\r\n      },\r\n      default: Base.width_HistBinDefault,\r\n      iconClass: \"fa fa-arrows-h\",\r\n      helparticle: \"5e87e8952c7d3a7e9aea6065\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\r\n        { name: \"1x\", value: 45, max: 90 },\r\n        { name: \"2x\", value: 90, max: 135 },\r\n        { name: \"3x\", value: 135, max: 180 },\r\n        { name: \"4x\", value: 180, max: 100000 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\r\n      ],\r\n      isActive: (d) =>\r\n        d.value <= this.optimumBinWidth.get() && d.max > this.optimumBinWidth.get(),\r\n      preSet: async (v, obj) => {\r\n        if (v === -99) {\r\n          v = obj._value - 5;\r\n        } else if (v === -199) {\r\n          v = obj._value + 5;\r\n        }\r\n        return Math.max(45, Math.min(180, v));\r\n      },\r\n      onSet: () => this.attrib.updateScaleAndBins(),\r\n    });\r\n\r\n    // ******************************************************\r\n    // Interval Bin height (linear / log)\r\n    this.maxHeightRatio = new Config<number>({\r\n      parent: this,\r\n      cfgClass: \"maxHeightRatio\",\r\n      cfgTitle: \"BinHeight\",\r\n      default: Base.height_MaxRatioDefault,\r\n      UISeperator: {\r\n        title: \"Size\",\r\n      },\r\n      iconClass: \"fa fa-arrows-v\",\r\n      helparticle: \"5e87e7502c7d3a7e9aea6060\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\r\n        { name: \"1x\", value: 0.15, max: 0.3 },\r\n        { name: \"2x\", value: 0.3, max: 0.6 },\r\n        { name: \"4x\", value: 0.6, max: 1.2 },\r\n        { name: \"8x\", value: 1.2, max: 1.5 },\r\n        { name: \"10x\", value: 1.5, max: 2.0 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\r\n      ],\r\n      isActive: (d) => {\r\n        var v = this.maxHeightRatio.get();\r\n        if (this.attrib.type === \"timestamp\") v *= 3;\r\n        return d.value <= v && d.max > v;\r\n      },\r\n      // if timestamp, the returned value is divided by 3.\r\n      onRead: (v: number) => (this.attrib.type === \"timestamp\" ? v / 3 : v),\r\n      preSet: async (v, obj) => {\r\n        if (v === -99) {\r\n          v = obj._value - 0.05;\r\n        } else if (v === -199) {\r\n          v = obj._value + 0.05;\r\n        }\r\n        return Math.max(0.08, Math.min(1.5, v));\r\n      },\r\n      onSet: () => {\r\n        if(!this.attrib.aggr_initialized) return;\r\n        this.browser.updateLayout_Height();\r\n      }\r\n    });\r\n\r\n    this.showHistogram = new Config<boolean>({\r\n      parent: this,\r\n      cfgClass: \"showHistogram\",\r\n      cfgTitle: \"Histogram\",\r\n      iconClass: \"fa fa-chart-bar\",\r\n      UISeperator: {\r\n        title: \"Charts\",\r\n      },\r\n      default: true,\r\n      itemOptions: [\r\n        { name: \"Show\", value: true },\r\n        { name: \"Hide\", value: false },\r\n      ],\r\n      onSet: (v) => {\r\n        if (!attrib.aggr_initialized) return; // not initialized yet\r\n        if (!v) this.height_hist = 0;\r\n        this.refreshChartsVisibleOption();\r\n        this.browser.updateLayout_Height();\r\n      },\r\n    });\r\n\r\n    this.attrib.configs.zoomed = this.zoomed;\r\n    this.attrib.configs.optimumBinWidth = this.optimumBinWidth;\r\n    this.attrib.configs.maxHeightRatio = this.maxHeightRatio;\r\n    this.attrib.configs.showHistogram = this.showHistogram;\r\n  }\r\n\r\n  get _aggrs(): Aggregate_Interval<T>[] {\r\n    return this.attrib._aggrs;\r\n  }\r\n\r\n  abstract zoomableStatus(): ZoomableStatus;\r\n\r\n  abstract getScaleNicing(): number;\r\n\r\n  // pixel width settings...\r\n  public height_hist = 1; // Initial height (will be updated later...)\r\n  public height_Ticklabels = 13; // can be double line\r\n  private width_measureAxisLabel = 35; // ..\r\n\r\n  protected highlightRangeLimits_Active = false;\r\n\r\n  // width for one aggregate - fixed width\r\n  public aggrWidth: number = 0;\r\n\r\n  refreshIntervalSlider(t: MeasureType[] = undefined) {\r\n    if (!this.DOM.intervalSlider) return;\r\n\r\n    (t || Base.Active_Compare_List).forEach((cT: CompareType | \"Active\") => {\r\n      var minPos: IntervalT, maxPos: IntervalT, visible;\r\n      switch (cT) {\r\n        case \"Active\":\r\n          // based on filtered range\r\n          visible = this.attrib.isFiltered();\r\n          minPos =\r\n            this.attrib.summaryFilter.active?.minV ?? this.attrib.rangeOrg[0];\r\n          maxPos =\r\n            this.attrib.summaryFilter.active?.maxV ?? this.attrib.rangeOrg[1];\r\n          break;\r\n        default:\r\n          visible =\r\n            this.browser.vizActive(cT) && this.attrib.isComparedAttrib();\r\n          var aggr = this.browser.selectedAggrs[cT] as Aggregate_Interval<T>;\r\n          if (visible) {\r\n            minPos = aggr.minV;\r\n            maxPos = aggr.maxV;\r\n          }\r\n          break;\r\n      }\r\n\r\n      minPos = Math.max(this.valueScale.range()[0], this.valueScale(minPos));\r\n      maxPos = Math.min(this.valueScale.range()[1], this.valueScale(maxPos));\r\n\r\n      this.DOM.intervalSlider\r\n        .select(\".base_\" + cT)\r\n        .classed(\"visible\", visible)\r\n        .style(\"left\", minPos + \"px\")\r\n        .style(\"width\", maxPos - minPos + \"px\");\r\n      if (cT === \"Active\") {\r\n        this.DOM.rangeHandle.style(\r\n          \"transform\",\r\n          (d) => `translateX(${d === \"min\" ? minPos : maxPos}px)`\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Height & width\r\n  // ********************************************************************\r\n\r\n  get height_hist_max() {\r\n    return Math.max(\r\n      Base.height_HistMin,\r\n      this.width_histogram * this.maxHeightRatio.get()\r\n    ); // Maximim possible histogram height\r\n  }\r\n\r\n  get height_RangeMax() {\r\n    if (this.attrib.isEmpty()) return this.height_Header;\r\n    return (\r\n      this.height_Header +\r\n      this.height_Extra_max +\r\n      (this.showHistogram.get() ? this.height_hist_max : 0)\r\n    );\r\n  }\r\n\r\n  get height_RangeMin() {\r\n    if (this.attrib.isEmpty()) return this.height_Header;\r\n    return 0 + this.height_Header + this.height_Extra_max;\r\n  }\r\n\r\n  get height_slider() {\r\n    return 12;\r\n  }\r\n  get height_padding() {\r\n    return 7;\r\n  }\r\n\r\n  get height_Extra_base() {\r\n    return this.height_padding + this.height_slider + this.height_Ticklabels;\r\n  }\r\n\r\n  get height_Extra() {\r\n    return (\r\n      this.height_Extra_base +\r\n      (this.showHistogram.get() ? Base.height_HistBottomGap : 0) +\r\n      4\r\n    ); // 4 is some gap\r\n  }\r\n\r\n  get height_Extra_max() {\r\n    return this.height_Extra_base + Base.height_HistBottomGap;\r\n  }\r\n\r\n  get height_Content() {\r\n    return !this.isVisible()\r\n      ? 0\r\n      : (this.showHistogram.get() ? this.height_hist : 0) + this.height_Extra;\r\n  }\r\n\r\n  chartAxis_Measure_TickSkip(): number {\r\n    return this.height_hist / 30;\r\n  }\r\n\r\n  setHeight(targetHeight) {\r\n    if (!this._aggrs) return;\r\n    var c = Math.min(\r\n      this.height_hist_max,\r\n      targetHeight - this.height_Header - this.height_Extra\r\n    );\r\n    if (this.height_hist === c) return;\r\n    this.height_hist = c;\r\n    this.attrib.updateChartScale_Measure(true);\r\n  }\r\n\r\n  refreshHeight() {\r\n    super.refreshHeight();\r\n    if (this.attrib.isEmpty() || !this.inDashboard || !this.DOM.inited) return;\r\n\r\n    var _h = this.showHistogram.get() ? this.height_hist + 23 : 10;\r\n\r\n    this.DOM.valueTickGroup.style(\"height\", this.height_Ticklabels + \"px\");\r\n    this.DOM.rangeHandle\r\n      .style(\"height\", _h + \"px\")\r\n      .style(\"top\", -_h + 10 + \"px\");\r\n    this.DOM.highlightRangeLimits.style(\"height\", this.height_hist + \"px\");\r\n    this.DOM.histogram.style(\"height\", this.height_hist + \"px\");\r\n\r\n    this.DOM.root\r\n      .select(\".chartAxis_Measure > .measureDescrLabel\")\r\n      .style(\"width\", this.height_hist + \"px\")\r\n      .style(\"left\", -this.height_hist / 2 + \"px\");\r\n\r\n    this.refreshViz_Bins();\r\n    this.updateValueTicks();\r\n\r\n    this.refreshViz_All();\r\n  }\r\n\r\n  get width_marginLeft() {\r\n    return this.width_measureAxisLabel + Base.width_measureDescrLabel;\r\n  }\r\n\r\n  get width_marginRight() {\r\n    return this.width_measureAxisLabel * (this.isWideChart() ? 1 : 0.5) + 8;\r\n  }\r\n\r\n  get width_histogram() {\r\n    if (!this.inDashboard) return 30;\r\n    return Math.max(\r\n      2,\r\n      this.getWidth() - this.width_marginLeft - this.width_marginRight\r\n    );\r\n  }\r\n\r\n  get width_Bin() {\r\n    return this.aggrWidth - Base.width_HistBarGap * 2;\r\n  }\r\n\r\n  isWideChart() {\r\n    return this.getWidth() > 500;\r\n  }\r\n\r\n  refreshWidth() {\r\n    this.attrib.updateScaleAndBins(true); // forces render update\r\n\r\n    if (this.DOM.inited === false) return;\r\n\r\n    this.DOM.wrapper.classed(\"showMeasureAxis_2\", this.isWideChart());\r\n    this.DOM.summaryInterval\r\n      .style(\"padding-left\", this.width_marginLeft + \"px\")\r\n      .style(\"padding-right\", this.width_marginRight + \"px\");\r\n\r\n    this.DOM.blockName.style(\r\n      \"max-width\",\r\n      this.collapsed ? null : this.getWidth() - 40 + \"px\"\r\n    );\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Visualization\r\n  // ********************************************************************\r\n\r\n  insertVizDOM() {\r\n    this.refreshViz_Bins();\r\n    this.refreshViz_Axis();\r\n    this.refreshMeasureLabelText(\"Active\");\r\n    this.updateValueTicks();\r\n  }\r\n\r\n  refreshViz_Bins() {\r\n    if (!this.DOM.inited) return;\r\n    var me = this;\r\n\r\n    var baseline = this.measureLineZero;\r\n\r\n    var _width = (aggr: Aggregate_Interval<T>) =>\r\n      this.valueScale(aggr.maxV) -\r\n      this.valueScale(aggr.minV) -\r\n      Base.width_HistBarGap * 2;\r\n    var _transform = (aggr) =>\r\n      `translateX(${this.valueScale(aggr.minV) + Base.width_HistBarGap}px)`;\r\n\r\n    var updateVizBinWidth = (selection) => {\r\n      Base.Total_Active_Compare_List.forEach((t) => {\r\n        selection\r\n          .selectAll(\".measure_\" + t)\r\n          .style(\r\n            \"transform\",\r\n            (aggr) =>\r\n              `translateY(${this.height_hist - baseline}px) scale(${_width(\r\n                aggr\r\n              )},0)`\r\n          );\r\n      });\r\n    };\r\n\r\n    this.DOM.aggrGlyphs = this.DOM.histogram_bins\r\n      .selectAll(\".aggrGlyph\")\r\n      .data(this._aggrs, (aggr) => [aggr.maxV, aggr.minV])\r\n      .join(\r\n        (enter) =>\r\n          enter\r\n            .append(\"span\")\r\n            .attr(\"class\", \"aggrGlyph rangeGlyph\")\r\n            .tooltip((aggr: Aggregate_Interval<T>) => aggr.getTooltipHTML(), {\r\n              theme: \"dark kshf-tooltip kshf-record\",\r\n              placement: \"bottom\",\r\n              animation: \"fade\",\r\n              trigger: \"manual\",\r\n            })\r\n            .on(\"mouseenter\", function (_event, aggr) {\r\n              if (aggr.Active.recCnt === 0) return;\r\n              if (me.highlightRangeLimits_Active) return;\r\n\r\n              this.highlightTimeout = window.setTimeout(() => {\r\n                me.onAggrHighlight(aggr);\r\n                this.tippy.show();\r\n              }, me.browser.movingMouseDelay);\r\n            })\r\n            .on(\"mouseleave\", function (_event, aggr) {\r\n              this.tippy.hide();\r\n              if (aggr.Active.recCnt === 0) return;\r\n              if (me.highlightRangeLimits_Active) return;\r\n              if (this.highlightTimeout)\r\n                window.clearTimeout(this.highlightTimeout);\r\n              me.onAggrLeave(aggr);\r\n            })\r\n            .on(\"click\", (event, aggr) => this.onAggrClick(event, aggr))\r\n            .call((aggrGlyph) => {\r\n              aggrGlyph\r\n                .transition()\r\n                .duration(0)\r\n                .delay(10)\r\n                .style(\"opacity\", null)\r\n                .style(\"pointer-events\", null);\r\n\r\n              var measureGroup = aggrGlyph\r\n                .append(\"div\")\r\n                .attr(\"class\", \"measureGroup\");\r\n\r\n              Base.Total_Active_Compare_List.forEach((t) => {\r\n                this.DOM[\"measure_\" + t] = measureGroup\r\n                  .append(\"span\")\r\n                  .attr(\"class\", `measure_${t} bg_${t}`)\r\n                  .on(\"mouseenter\", (_event, aggr) => {\r\n                    aggr.DOM.aggrGlyph\r\n                      .querySelector(\".measureLabel_\" + t)\r\n                      .classList.add(\"forceShow\");\r\n                    if (Base.Compare_List.find((_) => _ === t)) {\r\n                      this.browser.refreshAllMeasureLabels(t);\r\n                    }\r\n                  })\r\n                  .on(\"mouseleave\", (_event, aggr) => {\r\n                    var labelDOM = aggr.DOM.aggrGlyph.querySelector(\r\n                      \".measureLabel_\" + t\r\n                    );\r\n                    if (labelDOM) labelDOM.classList.remove(\"forceShow\");\r\n                    if (Base.Compare_List.find((_) => _ === t)) {\r\n                      this.browser.refreshAllMeasureLabels(\"Active\");\r\n                    }\r\n                  });\r\n              });\r\n\r\n              updateVizBinWidth(aggrGlyph);\r\n\r\n              this.insertAggrLockButton(aggrGlyph, \"top\");\r\n\r\n              aggrGlyph\r\n                .append(\"span\")\r\n                .attr(\"class\", \"measureLabelGroup\")\r\n                .call((measureLabelGroup) => {\r\n                  Base.Active_Compare_List.forEach((t) => {\r\n                    measureLabelGroup\r\n                      .append(\"span\")\r\n                      .attr(\"class\", \"measureLabel measureLabel_\" + t);\r\n                  });\r\n                });\r\n            }),\r\n        (update) =>\r\n          update\r\n            .style(\r\n              \"width\",\r\n              (aggr: Aggregate_Interval<T>) => _width(aggr) + \"px\"\r\n            )\r\n            .style(\"transform\", _transform)\r\n            .call((update) => updateVizBinWidth(update)),\r\n        (exit) => {\r\n          if (this.noRefreshVizAxis && this.browser.finalized) {\r\n            exit\r\n              .style(\r\n                \"width\",\r\n                (aggr: Aggregate_Interval<T>) => _width(aggr) + \"px\"\r\n              )\r\n              .style(\"transform\", _transform)\r\n              .style(\"opacity\", 0)\r\n              .style(\"pointer-events\", \"none\")\r\n              .transition()\r\n              .duration(0)\r\n              .delay(700)\r\n              .remove();\r\n\r\n            updateVizBinWidth(exit);\r\n          } else {\r\n            exit.remove();\r\n          }\r\n          return exit;\r\n        }\r\n      )\r\n      .call((merged) => {\r\n        merged\r\n          .style(\"width\", (aggr: Aggregate_Interval<T>) => _width(aggr) + \"px\")\r\n          .style(\"transform\", _transform);\r\n\r\n        merged.each(function (aggr: Aggregate_Interval<T>) {\r\n          aggr.isVisible = true;\r\n          aggr.setAggrGlyph(this);\r\n        });\r\n\r\n        Base.Total_Active_Compare_List.forEach((t) => {\r\n          this.DOM[\"measure_\" + t] = merged.selectAll(\".measure_\" + t);\r\n        });\r\n        this.DOM.lockButton = merged.selectAll(\".lockButton\");\r\n        this.DOM.measureLabelGroup = merged.selectAll(\".measureLabelGroup\");\r\n        Base.Active_Compare_List.forEach((t) => {\r\n          this.DOM[\"measureLabel_\" + t] = merged.selectAll(\r\n            \".measureLabel_\" + t\r\n          );\r\n        });\r\n      });\r\n  }\r\n\r\n  refreshViz_Active(): void {\r\n    if (!this.isVisible() || !this.DOM.aggrGlyphs || !this.valueScale) return;\r\n\r\n    var baseline = this.measureLineZero;\r\n\r\n    this.DOM.aggrGlyphs.classed(\r\n      \"NoActiveRecords\",\r\n      (aggr) => aggr.measure(\"Active\") === 0\r\n    );\r\n\r\n    this.refreshViz_Cache(\"Active\");\r\n\r\n    // Position the lock button\r\n    this.DOM.lockButton\r\n      .style(\r\n        \"transform\",\r\n        (aggr: Aggregate_Interval<T>) =>\r\n          `translateY(${\r\n            this.height_hist - baseline - aggr.sumOffsetScale(\"Active\") - 10\r\n          }px)`\r\n      )\r\n      .classed(\r\n        \"inside\",\r\n        (aggr: Aggregate_Interval<T>) =>\r\n          this.browser.relativeBreakdown ||\r\n          Math.abs(\r\n            this.height_hist - aggr.offset(\"Active\") - aggr.scale(\"Active\")\r\n          ) < 6\r\n      );\r\n\r\n    var maybePartial =\r\n      this.attrib.isFiltered() &&\r\n      !this.attrib.stepTicks &&\r\n      this.attrib.summaryFilter.active &&\r\n      this.attrib.type !== \"timestamp\";\r\n\r\n    // Used for partial rendering\r\n    let filter_min: T, filter_max: T, minPos: number, maxPos: number;\r\n    if (maybePartial) {\r\n      filter_min = this.attrib.summaryFilter.active.minV;\r\n      filter_max = this.attrib.summaryFilter.active.maxV;\r\n      minPos = this.valueScale(filter_min);\r\n      maxPos = this.valueScale(filter_max);\r\n    }\r\n\r\n    this.DOM.measure_Active.style(\"transform\", (aggr) => {\r\n      var translateX = 0;\r\n      var _w: number = this.width_Bin;\r\n\r\n      if (maybePartial) {\r\n        var aggr_min = aggr.minV;\r\n        var aggr_max = aggr.maxV;\r\n        // it is within the filtered range\r\n        if (aggr_max > filter_min && aggr_min < filter_max) {\r\n          if (aggr_min < filter_min) {\r\n            var lostWidth = minPos - this.valueScale(aggr_min);\r\n            translateX = lostWidth;\r\n            _w -= lostWidth;\r\n          }\r\n          if (aggr_max > filter_max) {\r\n            _w -=\r\n              this.valueScale(aggr_max) - maxPos - Base.width_HistBarGap * 2;\r\n          }\r\n        } else {\r\n          aggr.setScale(\"Active\", 0);\r\n        }\r\n      }\r\n\r\n      return `translate(${translateX}px, ${\r\n        this.height_hist - baseline - aggr.offset(\"Active\")\r\n      }px) scale(${_w},${aggr.scale(\"Active\")})`;\r\n    });\r\n\r\n    // doing position update after rendering the bar,\r\n    // bc the active scale can be set to zero if the bar is outside filtering.\r\n    this.refreshMeasureLabelText(\"Active\");\r\n    this.refreshMeasureLabelPos(\"Active\");\r\n  }\r\n\r\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\r\n    if (!this.isVisible() || !this.DOM.aggrGlyphs || !this.valueScale) return;\r\n\r\n    this.refreshViz_Cache(cT, prevCts);\r\n\r\n    this.refreshMeasureLabelText(cT);\r\n    this.refreshMeasureLabelPos(cT, curGroup);\r\n  }\r\n\r\n  refreshMeasureLabelPos(sT: MeasureType = \"Active\", curGroup = 0) {\r\n    if (!this.isVisible() || !this.DOM.aggrGlyphs || !this.valueScale) return;\r\n    if (sT === \"Other\") return;\r\n\r\n    if (this.browser.stackedChart) {\r\n      this.DOM[\"measureLabel_\" + sT]\r\n        .classed(\r\n          \"hidden\",\r\n          (aggr: Aggregate_Interval<T>) =>\r\n            aggr.scale(sT) < 16 || this.browser.getMeasureValue(aggr, sT) == 0\r\n        )\r\n        .style(\"width\", \"100%\")\r\n        .style(\"transform\", (aggr: Aggregate_Interval<T>, i, nodes) => {\r\n          nodes[i].setAttribute(\"labelAlign\", \"middle\");\r\n          return `translate(0px, ${-aggr[sT].offset - aggr[sT].scale / 2}px)`;\r\n        });\r\n    } else {\r\n      if (\r\n        this.attrib.type === \"timestamp\" &&\r\n        (sT !== \"Active\" || this.browser.activeComparisonsCount > 0)\r\n      ) {\r\n        // Line chart\r\n\r\n        // _spacer is needed to detect intersecting labels and prevent overlaps\r\n        // cannot use LabelSpacer because this needs to maintain which selections are visible, etc.\r\n        this._aggrs.forEach((_: Aggregate_Interval<T>) => {\r\n          _._spacer = _._spacer || {};\r\n        });\r\n\r\n        var visibleStuff = [\"Active\"]\r\n          .concat(this.browser.activeComparisons)\r\n          .filter((_) => _ !== sT);\r\n\r\n        this.DOM[\"measureLabel_\" + sT].style(\r\n          \"transform\",\r\n          (aggr: Aggregate_Interval<T>, i, nodes) => {\r\n            var v = aggr.offset(sT) + aggr.scale(sT);\r\n            if (sT === \"Active\") {\r\n              v += 20; // 20 pixel up\r\n            }\r\n            // 5px: just extra offset to avoid intersecting with line\r\n            v = 5 - Math.min(v, this.height_hist);\r\n\r\n            aggr._spacer[sT] = { min: v - 5, max: v + 20 };\r\n            var intersects = visibleStuff.some((s) => {\r\n              var l = aggr._spacer[s];\r\n              return l ? l.min <= v && l.max >= v : false;\r\n            });\r\n\r\n            // the visibility (hidden class) of label depends on all other labels on the same aggregate\r\n            nodes[i].classList[intersects ? \"add\" : \"remove\"](\"hidden\");\r\n\r\n            return `translate(0px, ${v}px)`;\r\n          }\r\n        );\r\n      } else {\r\n        var totalGroups = this.browser.activeComparisonsCount;\r\n        var width = 100;\r\n        var tX = 0;\r\n        var hidden = false;\r\n        if (\r\n          (sT !== \"Active\" && sT !== \"Total\") &&\r\n          totalGroups > 1 &&\r\n          this.browser.vizActive(sT)\r\n        ) {\r\n          var realWidth = this.width_Bin / totalGroups;\r\n          tX = realWidth * curGroup;\r\n          width = 100 / totalGroups;\r\n          hidden = realWidth < this.panel.width_CatMeasureLabel;\r\n        }\r\n        this.DOM[\"measureLabel_\" + sT]\r\n          .classed(\"hidden\", this.attrib.type !== \"timestamp\" && hidden)\r\n          .style(\"transform\", `translate(${tX}px, 2px)`)\r\n          .style(\"width\", `${width}%`);\r\n      }\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Show record value\r\n  // ********************************************************************\r\n\r\n  updateAfterFilter(): void {\r\n    if (!this.isVisible()) return;\r\n    this.attrib.updateChartScale_Measure();\r\n    this.refreshMeasureLabelText(\"Active\");\r\n    this.refreshViz_NoValueAggr();\r\n  }\r\n\r\n  showRecordValue(record: Record): void {\r\n    if (!this.inDashboard || !this.DOM.inited || !this.valueScale) return;\r\n    var v: T = this.attrib.getRecordValue(record);\r\n    if (v == null) return;\r\n    if (v < this.valueScale.domain()[0]) return;\r\n    if (v > this.valueScale.domain()[1]) return;\r\n\r\n    this.DOM.recordValue\r\n      .style(\"transform\", \"translateX(\" + this.attrib.getValuePosX(v) + \"px)\")\r\n      .style(\"display\", \"block\");\r\n    this.DOM.recordValueText.html(this.attrib.getFormattedValue(v, false));\r\n  }\r\n\r\n  hideRecordValue() {\r\n    if (!this.DOM.inited || !this.DOM.recordValue) return;\r\n    this.DOM.recordValue.style(\"display\", null);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // DOM initializations\r\n  // ********************************************************************\r\n\r\n  _initPos: T = null;\r\n\r\n  initDOM(beforeDOM): boolean {\r\n    this.attrib.initializeAggregates();\r\n    if (this.attrib.isEmpty()) return false;\r\n    if (this.DOM.inited) return true;\r\n\r\n    this.insertRoot(beforeDOM);\r\n\r\n    this.DOM.summaryInterval = this.DOM.wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"summaryInterval\")\r\n      .on(\"mousedown\", (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      });\r\n\r\n    var _flexClear = (event) => {\r\n      this._initPos = undefined;\r\n      this.highlightRangeLimits_Active = false;\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    };\r\n\r\n    this.DOM.histogram = this.DOM.summaryInterval\r\n      .append(\"div\")\r\n      .attr(\"class\", \"histogram\");\r\n    this.DOM.histogram_bins = this.DOM.histogram\r\n      .append(\"div\")\r\n      .attr(\"class\", \"aggrGroup\")\r\n      .on(\"mousemove\", (event) => {\r\n        if (!event.shiftKey) {\r\n          if (this.highlightRangeLimits_Active) {\r\n            this.browser.clearSelect_Compare();\r\n            _flexClear(event);\r\n          }\r\n          return;\r\n        }\r\n\r\n        // dynamically select... range by mouse-move\r\n        var pointerPosition = this.valueScale.invert(d3.pointer(event)[0]);\r\n        if (this._initPos == null) {\r\n          this._initPos = pointerPosition as T;\r\n        }\r\n\r\n        var [minV, maxV] = d3.extent([this._initPos, pointerPosition]);\r\n\r\n        [minV, maxV] = this.attrib.sanitizeRange(minV, maxV);\r\n        if (minV === maxV) return; // no selection!\r\n        this.highlightRangeLimits_Active = true;\r\n\r\n        if (this.browser.vizActive(this.browser.Compare_Highlight)) {\r\n          this.browser.clearSelect_Compare(\r\n            this.browser.Compare_Highlight,\r\n            false\r\n          );\r\n        }\r\n\r\n        var aggr = this.attrib.createAggregate(minV, maxV);\r\n        aggr.updateRecords();\r\n\r\n        this.browser.allRecordsAggr.clearCompare(\r\n          this.browser.Compare_Highlight\r\n        );\r\n        this.browser.setSelect_Compare(aggr);\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      })\r\n      .on(\"click\", (event) => {\r\n        if (event.shiftKey && this.highlightRangeLimits_Active) {\r\n          this.browser.lockSelect_Compare();\r\n          _flexClear(event);\r\n        }\r\n      });\r\n\r\n    this.DOM.highlightRangeLimits = this.DOM.histogram_bins\r\n      .selectAll(\".highlightRangeLimits\")\r\n      .data([0, 1])\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", \"highlightRangeLimits\");\r\n\r\n    this.insertChartAxis_Measure(this.DOM.histogram);\r\n\r\n    this.initDOM_Slider();\r\n\r\n    this.insertVizDOM();\r\n\r\n    this.setCollapsed(this.collapsed);\r\n\r\n    this.DOM.inited = true;\r\n\r\n    this.refreshChartsVisibleOption();\r\n\r\n    return true;\r\n  }\r\n\r\n  initDOM_Slider() {\r\n    var me = this;\r\n\r\n    this.DOM.intervalSlider = this.DOM.summaryInterval\r\n      .append(\"div\")\r\n      .attr(\"class\", \"intervalSlider\");\r\n\r\n    this.DOM.zoomControl = this.DOM.intervalSlider\r\n      .append(\"span\")\r\n      .attr(\"class\", \"zoomControl far\")\r\n      .tooltip(\"\", {\r\n        onTrigger: (instance) => {\r\n          var zoomIn = instance.reference.getAttribute(\"sign\") === \"plus\";\r\n          instance.reference.tippy.setContent(\r\n            zoomIn ? \"Zoom into filtered range\" : \"Zoom out\"\r\n          );\r\n        },\r\n      })\r\n      .attr(\"sign\", this.zoomed.is(true) ? \"minus\" : \"plus\")\r\n      .on(\"click\", async (event) => {\r\n        await this.zoomed.set(event.currentTarget.getAttribute(\"sign\") === \"plus\");\r\n      });\r\n\r\n    var controlLine = this.DOM.intervalSlider\r\n      .append(\"div\")\r\n      .attr(\"class\", \"controlLine\")\r\n      .on(\"mousedown\", function (event) {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        me.browser.DOM.root\r\n          .classed(\"adjustingWidth\", true)\r\n          .classed(\"noPointerEvents\", true);\r\n        var e = this.parentNode;\r\n        var initPos: T = me.valueScale.invert(d3.pointer(event, e)[0]);\r\n        d3.select(\"body\")\r\n          .on(\"mousemove\", function (event2) {\r\n            var targetPos: T = me.valueScale.invert(d3.pointer(event2, e)[0]);\r\n            me.browser.preventAxisScaleTransition = true;\r\n            me.attrib.setRangeFilter_Custom(\r\n              d3.min([initPos, targetPos]),\r\n              d3.max([initPos, targetPos])\r\n            );\r\n          })\r\n          .on(\"mouseup\", function () {\r\n            me.browser.preventAxisScaleTransition = false;\r\n            me.browser.DOM.root\r\n              .classed(\"adjustingWidth\", false)\r\n              .classed(\"noPointerEvents\", false);\r\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\r\n          });\r\n        event.preventDefault();\r\n      });\r\n\r\n    this.DOM.activeTotalRange = controlLine\r\n      .append(\"span\")\r\n      .attr(\"class\", \"base base_Total\");\r\n\r\n    controlLine\r\n      .append(\"span\")\r\n      .attr(\"class\", \"base base_Active\")\r\n      .tooltip(i18n.DragToFilter, { placement: \"bottom\" })\r\n      .on(\"mousedown\", function (event) {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        // time is not supported for now.\r\n        // if (me instanceof Summary_Timestamp) return;\r\n        if (me.attrib.type === \"timestamp\") return;\r\n\r\n        me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n\r\n        var e = this.parentNode;\r\n        var initMin = me.attrib.summaryFilter.active.minV;\r\n        var initMax = me.attrib.summaryFilter.active.maxV;\r\n        var initPos = d3.pointer(event, e)[0];\r\n\r\n        d3.select(\"body\")\r\n          .on(\"mousemove\", () => {\r\n            me.browser.preventAxisScaleTransition = true;\r\n            me.dragRange(initPos, d3.pointer(event, e)[0], initMin, initMax);\r\n          })\r\n          .on(\"mouseup\", () => {\r\n            me.browser.preventAxisScaleTransition = false;\r\n            me.browser.DOM.root.classed(\"noPointerEvents\", false);\r\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\r\n          });\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n\r\n    Base.Compare_List.forEach((cT) => {\r\n      controlLine\r\n        .append(\"span\")\r\n        .attr(\"class\", \"base base_Compare bg_\" + cT)\r\n        .tooltip(i18n.DragToFilter, { placement: \"bottom\" });\r\n    });\r\n\r\n    this.DOM.rangeHandle = controlLine\r\n      .selectAll(\".rangeHandle\")\r\n      .data([\"min\", \"max\"])\r\n      .enter()\r\n      .append(\"span\")\r\n      .attr(\"class\", (d) => \"rangeHandle \" + d)\r\n      .tooltip(i18n.DragToFilter)\r\n      .on(\"mouseenter\", function () {\r\n        if (this.dragging) return;\r\n        this.tippy.show();\r\n        this.classList.add(\"dragging\");\r\n      })\r\n      .on(\"mouseleave\", function () {\r\n        if (this.dragging) return;\r\n        this.tippy.hide();\r\n        this.classList.remove(\"dragging\");\r\n      })\r\n      .on(\"dblclick\", function (_event, d: \"min\" | \"max\") {\r\n        me.showValuePicker(this, d);\r\n      })\r\n      .on(\"mousedown\", function (event, d: \"min\" | \"max\") {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n\r\n        me.browser.DOM.root\r\n          .classed(\"adjustingWidth\", true)\r\n          .classed(\"noPointerEvents\", true);\r\n        this.classList.add(\"dragging\");\r\n\r\n        var mee = this;\r\n        mee.dragging = true;\r\n        var e = this.parentNode;\r\n        var org = {\r\n          min: me.attrib.summaryFilter.active.minV,\r\n          max: me.attrib.summaryFilter.active.maxV,\r\n        };\r\n        d3.select(\"body\")\r\n          .on(\"mousemove.range\", function (event2) {\r\n            var _v: T = me.valueScale.invert(d3.pointer(event2, e)[0]);\r\n            // TODO!\r\n            // me.attrib.setRangeFilter({ [d]: _v }, true);\r\n            // detect a flip :: TODO: Works only once, if there's a second flip, it doesn't detect correctly\r\n            if (d === \"min\" && _v >= org.max) d = \"max\";\r\n            if (d === \"max\" && _v <= org.min) d = \"min\";\r\n            me.browser.preventAxisScaleTransition = true;\r\n          })\r\n          .on(\"mouseup.range\", function () {\r\n            delete me.browser.preventAxisScaleTransition;\r\n            mee.dragging = false;\r\n            mee.classList.remove(\"dragging\");\r\n            me.browser.DOM.root\r\n              .classed(\"adjustingWidth\", null)\r\n              .classed(\"noPointerEvents\", false);\r\n            d3.select(\"body\")\r\n              .style(\"cursor\", \"auto\")\r\n              .on(\"mousemove.range\", null)\r\n              .on(\"mouseup.range\", null);\r\n          });\r\n        event.stopPropagation();\r\n      });\r\n\r\n    this.DOM.recordValue = controlLine\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordValue\");\r\n    this.DOM.recordValue.append(\"span\").attr(\"class\", \"valueScaleMark\");\r\n    this.DOM.recordValueText = this.DOM.recordValue\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordValueText\")\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordValueText-v\");\r\n\r\n    this.DOM.valueTickGroup = this.DOM.intervalSlider\r\n      .append(\"div\")\r\n      .attr(\"class\", \"valueTickGroup\");\r\n  }\r\n\r\n  onAggrHighlight(aggr: Aggregate_Interval<T>) {\r\n    if (this.browser.adjustMode) return;\r\n    if (this.browser.mouseOverCompare.is(false)) return;\r\n    if (!this.browser.can_setSelect_Compare(aggr)) return;\r\n    var [minV, maxV] = this.attrib.sanitizeRange(aggr.minV, aggr.maxV);\r\n\r\n    if (minV === maxV) return; // no selection!\r\n\r\n    if (!this.attrib.binMatch([minV, maxV, null], aggr)) {\r\n      aggr.updateRecords();\r\n    }\r\n    aggr.DOM.aggrGlyph?.setAttribute(\"selection\", \"selected\");\r\n    this.browser.setSelect_Compare(aggr);\r\n  }\r\n\r\n  onAggrLeave(aggr) {\r\n    if (this.browser.adjustMode) return;\r\n    aggr.unselectAggregate();\r\n    this.browser.clearSelect_Compare();\r\n  }\r\n\r\n  onAggrClick(event, aggr) {\r\n    if (this.highlightRangeLimits_Active) return;\r\n    if (event && event.shiftKey) {\r\n      this.browser.lockSelect_Compare();\r\n      return;\r\n    }\r\n    this.attrib.setRangeFilter(aggr);\r\n  }\r\n\r\n  refreshValueTickLabels() {\r\n    this.DOM.valueTickGroup\r\n      ?.selectAll(\".valueTick > .text\")\r\n      .html((tick) => this.attrib.printAbbr(tick.tickValue, false));\r\n  }\r\n\r\n  refreshChartsVisibleOption() {\r\n    if (!this.DOM.inited) return;\r\n    this.DOM.root.classed(\"chartVisibleHistogram\", this.showHistogram.is(true));\r\n  }\r\n\r\n  onClearFilter() {\r\n    this.attrib.noValueAggr.filtered = false;\r\n    this.attrib.summaryFilter.active = null;\r\n    this.zoomed.set(false);\r\n    this.refreshIntervalSlider();\r\n  }\r\n\r\n  // extended by Block_Numeric to add minor ticks when using log scale\r\n  insertMinorTicks(ticks) {}\r\n\r\n  updateValueTicks() {\r\n    var me = this;\r\n\r\n    // create ticks used in the value scale / interval range slider\r\n    var ticksOrg: T[] = this.attrib.intervalTicks.slice();\r\n\r\n    if (this.attrib.stepTicks) ticksOrg.pop(); // won't insert last tick here\r\n\r\n    type Tick = { tickValue: T; major: boolean };\r\n\r\n    let ticks: Tick[] = ticksOrg.map((p) => ({ tickValue: p, major: true }));\r\n\r\n    this.insertMinorTicks(ticks);\r\n\r\n    var finalPos = (d: Tick) => this.valueScale(d.tickValue) + \"px\";\r\n    var prevPos = (d: Tick) => this.attrib.valueScale_prev(d.tickValue) + \"px\";\r\n\r\n    if (!this.browser.chartsLoaded) prevPos = finalPos;\r\n\r\n    this.DOM.valueTickGroup\r\n      .selectAll(\".valueTick\")\r\n      .data(ticks, (t: Tick) => t.tickValue)\r\n      .join(\r\n        (enter) =>\r\n          enter\r\n            .append(\"span\")\r\n            .attr(\"class\", \"valueTick\")\r\n            .style(\"opacity\", 1)\r\n            .style(\"left\", finalPos)\r\n            .style(\"top\", \"20px\")\r\n            .call((valueTicks) => {\r\n              valueTicks.append(\"span\").attr(\"class\", \"line\");\r\n              valueTicks\r\n                .append(\"span\")\r\n                .attr(\"class\", \"text\")\r\n                .on(\"mouseover\", function () {\r\n                  if (this.bin) me.onAggrHighlight(this.bin);\r\n                })\r\n                .on(\"mouseleave\", function () {\r\n                  if (this.bin) me.onAggrLeave(this.bin);\r\n                })\r\n                .on(\"click\", function (event) {\r\n                  if (this.bin) me.onAggrClick(event, this.bin);\r\n                });\r\n            }),\r\n        // .call((valueTicks) => {\r\n        //   window.setTimeout(() => {\r\n        //     valueTicks\r\n        //       .style(\"pointer-events\", null)\r\n        //       .style(\"opacity\", 1)\r\n        //       .style(\"left\", finalPos);\r\n        //   }, 0);\r\n        // })\r\n        (update) => update,\r\n        (exit) => {\r\n          if (!this.browser.chartsLoaded) {\r\n            exit.remove();\r\n          } else {\r\n            exit\r\n              .style(\"left\", finalPos)\r\n              .style(\"opacity\", 0)\r\n              .transition()\r\n              .duration(0)\r\n              .delay(600)\r\n              .remove();\r\n          }\r\n        }\r\n      )\r\n      .classed(\"major\", (tick) => tick.major)\r\n      .style(\"left\", finalPos)\r\n      .call((valueTicks) => {\r\n        valueTicks.transition().duration(500).delay(5).style(\"top\", \"0px\");\r\n        //.style(\"left\", finalPos);\r\n        valueTicks.selectAll(\".text\").each(function (d) {\r\n          this.bin = null;\r\n          var v = +d.tickValue;\r\n          me._aggrs.some((bin) => {\r\n            if (+bin.minV - v) return false;\r\n            this.bin = bin;\r\n            return true;\r\n          });\r\n        });\r\n      });\r\n\r\n    this.refreshValueTickLabels();\r\n\r\n    this.DOM.valueTickGroup.style(\r\n      \"left\",\r\n      (this.attrib.stepTicks ? this.aggrWidth / 2 : 0) + \"px\"\r\n    );\r\n  }\r\n}\r\n","import { quantile } from \"d3-array\";\r\nimport { select } from \"./d3_select\";\r\n\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\nimport { Base } from \"./Base\";\r\nimport { Block_Interval, ZoomableStatus } from \"./Block_Interval\";\r\nimport { Config } from \"./Config\";\r\nimport { CompareType, MeasureType } from \"./Types\";\r\nimport { Util } from \"./Util\";\r\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\r\nimport { i18n } from \"./i18n\";\r\n\r\nconst d3 = { select, quantile };\r\n\r\nexport class Block_Numeric extends Block_Interval<number> {\r\n  // specific attribute type\r\n  public readonly attrib: Attrib_Numeric;\r\n\r\n  readonly showPercentiles: Config<boolean>;\r\n\r\n  constructor(attrib: Attrib_Numeric) {\r\n    super(attrib);\r\n\r\n    this.showPercentiles = new Config<boolean>({\r\n      cfgClass: \"showPercentiles\",\r\n      cfgTitle: \"Percentiles\",\r\n      iconClass: \"percentileBlocks\",\r\n      default: false,\r\n      parent: this,\r\n      itemOptions: [\r\n        { name: \"Show\", value: true },\r\n        { name: \"Hide\", value: false },\r\n      ],\r\n      onDOM: (DOM) => {\r\n        DOM.root\r\n          .select(\".percentileBlocks\")\r\n          .classed(\"percentileChart_Active\", true)\r\n          .selectAll(\".block\")\r\n          .data([1, 4, 4, 3, 2, 1])\r\n          .enter()\r\n          .append(\"i\")\r\n          .attr(\"class\", (_) => \"percentileBlock qG\" + _);\r\n      },\r\n      onSet: () => {\r\n        if (!this.DOM.inited) return;\r\n        var curHeight = this.getHeight();\r\n        this.refreshChartsVisibleOption();\r\n        this.updatePercentiles();\r\n        this.setHeight(curHeight);\r\n        this.browser.updateLayout_Height();\r\n      },\r\n    });\r\n\r\n    this.attrib.configs.showPercentiles = this.showPercentiles;\r\n  }\r\n\r\n  /** -- */\r\n  get height_Percentile() {\r\n    return this.showPercentiles.is(true) ? Base.height_Percentile : 0;\r\n  }\r\n  /** -- */\r\n  get height_Extra_base() {\r\n    return super.height_Extra_base + this.height_Percentile;\r\n  }\r\n\r\n  /** - */\r\n  refreshWidth() {\r\n    this.attrib.refreshScaleType();\r\n    super.refreshWidth();\r\n  }\r\n\r\n  getScaleNicing(): number {\r\n    if (!this.inDashboard) {\r\n      return this.width_histogram / 10;\r\n    }\r\n    var v = this.optimumBinWidth.get();\r\n    if (this.attrib.unitName) {\r\n      v += (v * (2 + this.attrib.unitName.length * 8)) / 45;\r\n    }\r\n    return this.width_histogram / v;\r\n  }\r\n\r\n  dragRange(initPos, curPos, initMin, initMax) {\r\n    var targetDif;\r\n    var r = {\r\n      min: undefined,\r\n      max: undefined,\r\n    };\r\n\r\n    if (this.attrib.isValueScale_Log) {\r\n      targetDif = curPos - initPos;\r\n      r.min = this.valueScale.invert(this.valueScale(initMin) + targetDif);\r\n      r.max = this.valueScale.invert(this.valueScale(initMax) + targetDif);\r\n      //\r\n    } else if (this.attrib.isValueScale_Linear) {\r\n      targetDif =\r\n        this.valueScale.invert(curPos) - this.valueScale.invert(initPos);\r\n      if (!this.attrib.hasFloat) targetDif = Math.round(targetDif);\r\n\r\n      r.min = initMin + targetDif;\r\n      r.max = initMax + targetDif;\r\n\r\n      var diff = initMax - initMin;\r\n      \r\n      var currentLimit = this.attrib.valueScale.domain();\r\n\r\n      // Limit the active filter to expand beyond the current min/max of the view.\r\n      if (r.min < currentLimit[0]) {\r\n        r.min = currentLimit[0];\r\n        r.max = currentLimit[0] + diff;\r\n      }\r\n      if (r.max > currentLimit[1]) {\r\n        r.max = currentLimit[1];\r\n        r.min = currentLimit[1] - diff;\r\n      }\r\n    }\r\n\r\n    this.attrib.setRangeFilter_Custom( r.min, r.max);\r\n  }\r\n\r\n  /** -- */\r\n  showValuePicker(DOM, d: \"min\" | \"max\") {\r\n    var pikanum = DOM.pikanum;\r\n    if (!pikanum) {\r\n      DOM.pikanum = pikanum = d3\r\n        .select(DOM)\r\n        .append(\"input\")\r\n        .attr(\"class\", \"rangeInput\")\r\n        .attr(\"type\", \"number\")\r\n        .attr(\"min\", this.attrib.rangeOrg[0])\r\n        .attr(\"max\", this.attrib.rangeOrg[1])\r\n        .on(\"blur\", function () {\r\n          pikanum.style(\"display\", \"none\");\r\n        })\r\n        .on(\"focusout\", function () {\r\n          pikanum.style(\"display\", \"none\");\r\n        })\r\n        .on(\"keydown\", function (event) {\r\n          if (event.keyCode === 27) {\r\n            // Escape key\r\n            pikanum.node().blur();\r\n          }\r\n        })\r\n        .on(\"change\", () => {\r\n          var v = 1 * pikanum.node().value;\r\n          var minV = this.attrib.summaryFilter.active.minV;\r\n          var maxV = this.attrib.summaryFilter.active.minV;\r\n          if(d===\"min\") minV = v;\r\n          if(d===\"max\") maxV = v;\r\n          this.attrib.setRangeFilter_Custom( minV, maxV);\r\n          pikanum.node().blur();\r\n        });\r\n    }\r\n    pikanum.attr(\"step\", 1).style(\"display\", \"block\");\r\n    pikanum.node().focus();\r\n    pikanum.node().value = this.attrib.summaryFilter.active[d];\r\n  }\r\n\r\n  zoomableStatus(): ZoomableStatus {\r\n    if (this.attrib.stepTicks) {\r\n      return this.zoomed.is(true) ? \"minus\" : \"\";\r\n    }\r\n    return \"plus\";\r\n  }\r\n  hasStaticHeight(): boolean {\r\n    return this.showHistogram.is(false);\r\n  }\r\n\r\n  /** -- */\r\n  initDOM(beforeDOM): boolean {\r\n    if (!super.initDOM(beforeDOM)) return false;\r\n    this.initDOM_Percentile();\r\n    return true;\r\n  }\r\n\r\n  refreshChartsVisibleOption() {\r\n    if (!this.DOM.inited) return;\r\n    super.refreshChartsVisibleOption();\r\n\r\n    this.DOM.root.classed(\"chartVisiblePercentile\", this.showPercentiles.is(true));\r\n  }\r\n  insertMinorTicks(ticks) {\r\n    if(this.attrib.isValueScale_Log){\r\n      Util.insertMinorTicks(this.attrib.intervalTicks, this.valueScale, ticks);\r\n    }\r\n  }\r\n\r\n  /** - */\r\n  updateAfterFilter(): void {\r\n    if (!this.isVisible()) return;\r\n    super.updateAfterFilter();\r\n    this.updatePercentiles();\r\n  }\r\n\r\n  refreshViz_Active(): void {\r\n    super.refreshViz_Active();\r\n\r\n    this.updatePercentiles(\"Active\");\r\n  }\r\n\r\n  /** - */\r\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\r\n    if (!this.isVisible() || !this.DOM.aggrGlyphs) return;\r\n    super.refreshViz_Compare(cT, curGroup, totalGroups, prevCts);\r\n\r\n    var baseline = this.measureLineZero;\r\n    \r\n    var maybePartial = this.attrib.isFiltered() && this.attrib.summaryFilter.active && !this.attrib.stepTicks;\r\n\r\n    // used in partial rendering\r\n    let filter_min: number, filter_max: number, minPos: number, maxPos: number;\r\n\r\n    if(maybePartial){\r\n      filter_min = this.attrib.summaryFilter.active.minV;\r\n      filter_max = this.attrib.summaryFilter.active.maxV;\r\n      minPos = this.valueScale(filter_min);\r\n      maxPos = this.valueScale(filter_max);\r\n    }\r\n\r\n    var _do = (withScale) => {\r\n      this.DOM[\"measure_\" + cT].style(\r\n        \"transform\",\r\n        (aggr: Aggregate_Interval<number>) => {\r\n          var _w = this.width_Bin;\r\n          var _translateX = 0;\r\n\r\n          if (maybePartial) {\r\n            var aggr_min = aggr.minV;\r\n            var aggr_max = aggr.maxV;\r\n            // it is within the filtered range\r\n            if (aggr_max > filter_min && aggr_min < filter_max) {\r\n              if (aggr_min < filter_min) {\r\n                var lostWidth = minPos - this.valueScale(aggr_min);\r\n                _translateX = lostWidth;\r\n                _w -= lostWidth;\r\n              }\r\n              if (aggr_max > filter_max) {\r\n                _w -=\r\n                  this.valueScale(aggr_max) -\r\n                  maxPos -\r\n                  Base.width_HistBarGap * 2;\r\n              }\r\n            } else {\r\n              aggr.setScale(cT, 0);\r\n            }\r\n          }\r\n\r\n          if (!this.browser.stackedCompare) {\r\n            _w = _w / totalGroups;\r\n            _translateX = _w * curGroup;\r\n          }\r\n\r\n          return `translate(${_translateX}px, ${\r\n            this.height_hist - baseline - aggr.offset(cT)\r\n          }px) scale(${_w}, ${withScale ? aggr.scale(cT) : 0})`;\r\n        }\r\n      );\r\n    };\r\n\r\n    if (curGroup === totalGroups - 1 && this.browser.addedCompare) {\r\n      _do(false);\r\n    }\r\n    _do(true);\r\n\r\n    this.updatePercentiles(cT);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Percentile chart\r\n  // ********************************************************************\r\n\r\n  // Percentile chart stuff\r\n  quantile_val: { [index: number]: number } = {};\r\n\r\n  /** -- */\r\n  private initDOM_Percentile() {\r\n    if (!this.DOM.summaryInterval || this.DOM.percentileGroup) return;\r\n\r\n    var me = this;\r\n    this.DOM.percentileGroup = this.DOM.summaryInterval\r\n      .append(\"div\")\r\n      .attr(\"class\", \"percentileGroup\");\r\n    this.DOM.percentileGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"percentileTitle\")\r\n      .html(i18n.Percentiles);\r\n\r\n    (Base.Compare_List as MeasureType[])\r\n      .concat(\"Active\")\r\n      .forEach((sT: MeasureType) => {\r\n        var parent = me.DOM.percentileGroup\r\n          .append(\"div\")\r\n          .attr(\"class\", \"percentileChart_\" + sT);\r\n\r\n        parent\r\n          .selectAll(\".aggrGlyph\")\r\n          .data([\r\n            [10, 20, 1],\r\n            [20, 30, 2],\r\n            [30, 40, 3],\r\n            [40, 50, 4],\r\n            [50, 60, 4],\r\n            [60, 70, 3],\r\n            [70, 80, 2],\r\n            [80, 90, 1],\r\n          ])\r\n          .enter()\r\n          .append(\"span\")\r\n          .attr(\"class\", (qb) => \"quantile aggrGlyph q_range qG\" + qb[2])\r\n          .each(function () {\r\n            this.__data__.summary = me;\r\n          })\r\n          .tooltip(\r\n            (qb) =>\r\n              `<div><span style='font-weight:400'>${qb[0]}% - ${\r\n                qb[1]\r\n              }%</span> Percentile:</div><div style='font-weight: 500'>${me.attrib.printAbbr(\r\n                me.quantile_val[sT + qb[0]]\r\n              )} - ${me.attrib.printAbbr(me.quantile_val[sT + qb[1]])}</div>`,\r\n            { placement: \"top\" }\r\n          )\r\n          .on(\"mouseover\", (_event, qb) => {\r\n            if (this.browser.comparedAttrib && !this.attrib.isComparedAttrib())\r\n              return;\r\n            if (this.browser.mouseOverCompare.is(false)) return;\r\n            this.highlightRangeLimits_Active = true;\r\n\r\n            var aggr = this.attrib.createAggregate(\r\n              this.quantile_val[sT + qb[0]],\r\n              this.quantile_val[sT + qb[1]]\r\n            );\r\n            aggr.updateRecords();\r\n\r\n            this.browser.allRecordsAggr.clearCompare(\r\n              this.browser.Compare_Highlight\r\n            );\r\n            this.browser.setSelect_Compare(aggr);\r\n          })\r\n          .on(\"mouseout\", () => {\r\n            if (this.browser.comparedAttrib && !this.attrib.isComparedAttrib())\r\n              return;\r\n            this.browser.clearSelect_Compare();\r\n            this.highlightRangeLimits_Active = false;\r\n          })\r\n          .on(\"click\", (event, qb) => {\r\n            if (event.shiftKey) {\r\n              this.browser.clearSelect_Compare(null, true, true);\r\n              this.highlightRangeLimits_Active = false;\r\n              return;\r\n            }\r\n\r\n            this.attrib.summaryFilter.active = this.attrib.createAggregate(\r\n              this.quantile_val[sT + qb[0]],\r\n              this.quantile_val[sT + qb[1]]\r\n            );\r\n            this.attrib.summaryFilter.setFiltered();\r\n          });\r\n\r\n        parent\r\n          .selectAll(\".q_pos\")\r\n          .data([50])\r\n          .enter()\r\n          .append(\"span\")\r\n          .attr(\"class\", (q) => \"quantile q_pos q_\" + q)\r\n          .tooltip(\r\n            (q) =>\r\n              `<u>Median</u><br><b>${me.attrib.getFormattedValue(\r\n                me.quantile_val[sT + q]\r\n              )}</b>`,\r\n            { placement: \"top\" }\r\n          );\r\n      });\r\n\r\n    this.refreshChartsVisibleOption();\r\n  }\r\n\r\n  /** - */\r\n  private refreshViz_Percentiles(distr) {\r\n    if (!this.DOM.percentileGroup) return;\r\n    if (!this.valueScale) return;\r\n    if (this.showPercentiles.is(false)) return;\r\n\r\n    var percentileChart = this.DOM.percentileGroup.select(\r\n      \".percentileChart_\" + distr\r\n    );\r\n\r\n    percentileChart\r\n      .style(\"margin-left\", \"0px\")\r\n      .style(\"opacity\", (q) =>\r\n        this.quantile_val[distr + \"10\"] == null ? 0 : 1\r\n      )\r\n      .style(\r\n        \"transform\",\r\n        this.attrib.stepTicks\r\n          ? \"translateX(\" + this.aggrWidth / 2 + \"px)\"\r\n          : null\r\n      );\r\n    percentileChart\r\n      .selectAll(\".q_pos\")\r\n      .style(\r\n        \"transform\",\r\n        (q) =>\r\n          \"translateX(\" + this.valueScale(this.quantile_val[distr + q]) + \"px)\"\r\n      );\r\n    percentileChart\r\n      .selectAll(\".quantile.aggrGlyph\")\r\n      .style(\"transform\", (qb) => {\r\n        var pos_1 = this.valueScale(this.quantile_val[distr + qb[0]]);\r\n        var pos_2 = this.valueScale(this.quantile_val[distr + qb[1]]);\r\n        return `translateX(${pos_1}px) scaleX(${pos_2 - pos_1})`;\r\n      });\r\n  }\r\n\r\n  private updatePercentiles(sT: MeasureType = null) {\r\n    if (sT === \"Other\") return;\r\n\r\n    if (this.showPercentiles.is(false)) return;\r\n\r\n    if (!sT) {\r\n      this.browser.activeComparisons.forEach((t) => this.updatePercentiles(t));\r\n      this.updatePercentiles(\"Active\");\r\n      return;\r\n    }\r\n\r\n    if (sT === \"Total\") return; // no total-vis for percentiles\r\n\r\n    if( sT !== \"Active\"){\r\n      if (!this.attrib.vizActive(sT)) return;\r\n    }\r\n\r\n    // the items are already sorted by their numeric value, it's just a linear pass.\r\n    var values = this.attrib.sortedRecords\r\n      .filter(\r\n        sT === \"Active\"\r\n          ? (record) => record.isIncluded\r\n          : (record) => record.isIncluded && record.isSelected(sT)\r\n      )\r\n      .map((record) => this.attrib.getRecordValue(record));\r\n\r\n    [10, 20, 30, 40, 50, 60, 70, 80, 90].forEach((q) => {\r\n      this.quantile_val[sT + q] = d3.quantile(values, q / 100);\r\n    });\r\n\r\n    this.refreshViz_Percentiles(sT);\r\n  }\r\n}\r\n","import { format } from \"d3-format\";\r\nimport { deviation } from \"d3-array\";\r\n\r\nimport { Aggregate_Interval_Numeric } from \"./Aggregate_Interval\";\r\n\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\r\nimport { TimeKey } from \"./TimeSeriesData\";\r\n\r\nimport { Block_Numeric } from \"./Block_Numeric\";\r\nimport { LinearOrLog, RecordVisCoding, SummarySpec } from \"./Types\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Config } from \"./Config\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Util } from \"./Util\";\r\nimport { Base } from \"./Base\";\r\n\r\nconst d3 = { format, deviation };\r\n\r\nexport class Attrib_Numeric extends Attrib_Interval<number> {\r\n  protected _block: Block_Numeric;\r\n  public get block(): Block_Numeric {\r\n    return this._block;\r\n  }\r\n\r\n  hasTimeSeriesParent(): boolean {\r\n    return this.parent?.type === \"timeseries\";\r\n  }\r\n\r\n  get timeseriesParent(): Attrib_Timeseries | null {\r\n    return this.parent?.type === \"timeseries\"\r\n      ? (this.parent as unknown as Attrib_Timeseries)\r\n      : null;\r\n  }\r\n\r\n  // specialized method to consider/change behavior if with timeseries parent\r\n  get groupPath() {\r\n    return this.timeseriesParent?.attribName.split(\"->\") || this.pathName;\r\n  }\r\n  \r\n  readonly valueScaleType: Config<LinearOrLog | \"auto\">;\r\n\r\n  // has floating numbers as data points\r\n\r\n  private tickPrecision = 3;\r\n\r\n  autoScaleType: LinearOrLog | null = null;\r\n\r\n  constructor(browser: Browser, name: string, template: any) {\r\n    super(\r\n      browser,\r\n      name,\r\n      template,\r\n      \"numeric\",\r\n      \"kshfSummary_Numeric\",\r\n      \"fa fa-hashtag\"\r\n    );\r\n\r\n    this._block = new Block_Numeric(this);\r\n\r\n    this.measurable = {\r\n      metricFuncs: Base.defaultMetricFuncs,\r\n    };\r\n\r\n    this.valueScaleType = new Config<LinearOrLog | \"auto\">({\r\n      cfgClass: \"valueScaleType\",\r\n      cfgTitle: \"BinScale\",\r\n      iconClass: \"fa fa-arrows-h\",\r\n      parent: this,\r\n      default: \"auto\",\r\n      helparticle: \"5e87eabc04286364bc97d0cf\",\r\n      itemOptions: [\r\n        { name: \"Auto\", value: \"auto\" },\r\n        { name: i18n.Linear + \" \" + i18n.LinearSequence, value: \"linear\" },\r\n        { name: i18n.Log + \" \" + i18n.Log2Sequence, value: \"log\" },\r\n      ],\r\n      forcedValue: () => {\r\n        if (this.timeseriesParent) return this.timeseriesParent.valueScaleType.get();\r\n        if (this.stepTicks) return \"linear\";\r\n        if (!this.supportsLogScale()) return \"linear\";\r\n        if (this.valueScaleType._value === \"auto\") return this.autoScaleType;\r\n      },\r\n      onSet: async () => {\r\n        if(!this.aggr_initialized) return;\r\n        this.block.noRefreshVizAxis = true;\r\n        await this.applyScaleType();\r\n        this.block.noRefreshVizAxis = false;\r\n\r\n        await this.browser.recordDisplay?.refreshAttribScaleType(this);\r\n      },\r\n    });\r\n\r\n    this.finishTemplateSpecial();\r\n\r\n    // TODO: maintain good order for UI, delete showHistogram index and add it at appropriate position\r\n  }\r\n\r\n  createAggregate(minV: number, maxV: number){\r\n    return new Aggregate_Interval_Numeric(this, minV, maxV);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Range and Scale...\r\n  // ********************************************************************\r\n\r\n  get isValueScale_Log() {\r\n    return this.valueScaleType.is(\"log\");\r\n  }\r\n  get isValueScale_Linear() {\r\n    return this.valueScaleType.is(\"linear\");\r\n  }\r\n\r\n  supportsLogScale(): boolean {\r\n    return !this.hasNegativeValues();\r\n  }\r\n\r\n  sanitizeRange(minV: number, maxV: number): [number, number] {\r\n    if (!this.hasFloat) {\r\n      maxV = Math.round(maxV);\r\n      minV = Math.round(minV);\r\n    }\r\n    return super.sanitizeRange(minV, maxV);\r\n  }\r\n\r\n  getRecordValueExtent(): [number, number] {\r\n    if (this.valueDomain) {\r\n      return [...this.valueDomain];\r\n    }\r\n    if (this.timeseriesParent?.valueDomain) {\r\n      return [...this.timeseriesParent.valueDomain];\r\n    }\r\n    return super.getRecordValueExtent();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Data & initialization\r\n  // ********************************************************************\r\n\r\n  private _hasFloat: boolean;\r\n  get hasFloat(): boolean {\r\n    return this._hasFloat;\r\n  }\r\n\r\n  /** -- */\r\n  fillValueCache() {\r\n    this._hasFloat = false;\r\n\r\n    this.records.forEach((record) => {\r\n      var v = this.template.func.call(record.data, record);\r\n      if (v === undefined) v = null;\r\n      if (isNaN(v)) v = null;\r\n      if (v === 0 && this.skipZero) v = null;\r\n      if (v !== null) {\r\n        if (typeof v !== \"number\") {\r\n          v = null;\r\n        } else {\r\n          this._hasFloat = this._hasFloat || v % 1 !== 0;\r\n        }\r\n      }\r\n      record.setValue(this, v);\r\n      if (v == null) {\r\n        this.noValueAggr.addRecord(record);\r\n      }\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  pofffff() {\r\n    this.refreshScaleType();\r\n  }\r\n\r\n  // Also a method of Timeseries\r\n  hasNegativeValues() {\r\n    if (!this.aggr_initialized) return true; // unknown, assume it can have negative\r\n    return this.rangeOrg[0] < 0;\r\n  }\r\n\r\n  /** -- */\r\n  supportsRecordEncoding(_type: RecordVisCoding) {\r\n    if (this.isEmpty()) return false;\r\n    if ([\"text\", \"textBrief\"].includes(_type)) return true;\r\n    this.initializeAggregates();\r\n    if (!this.isComparable.get()) return false;\r\n    if ([\"sort\", \"scatterX\", \"scatterY\", \"color\"].includes(_type)) return true;\r\n    if (_type === \"size\") {\r\n      return !this.hasNegativeValues();\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /** -- */\r\n  get canHaveMetricFuncs() {\r\n    if (this.isIDAttrib()) return false;\r\n    if (!this.aggr_initialized) return false;\r\n    return true;\r\n  }\r\n  /** -- */\r\n  get supportedMetricFuncs() {\r\n    return this.canHaveMetricFuncs ? this._metricFuncs : [];\r\n  }\r\n\r\n  /** -- */\r\n  private getTickPrecision() {\r\n    return this.timeseriesParent?.tickPrecision ?? this.tickPrecision;\r\n  }\r\n\r\n  updateTickPrintFunc(){\r\n    var t = d3.format(\".\" + this.getTickPrecision() + \"~s\");\r\n    if (this.getTickPrecision() === 0) {\r\n      t = d3.format(\"~s\");\r\n    }\r\n\r\n    this.intervalTickPrint = (v: number) => {\r\n      if (!this.hasFloat) v = Math.round(v);\r\n      var r = t(v);\r\n      var _r = v.toLocaleString();\r\n      // if value is 1021 and summary doesn't have float, formatted value returns \"1,021k\" - Stupid!\r\n      if (_r.length <= r.length) return _r;\r\n      if (r.substr(-1) === \"m\") {\r\n        r = parseFloat(r) / 1000;\r\n        r = Math.round((r + 0.000001) * 1000) / 1000;\r\n      }\r\n      return r;\r\n    };\r\n\r\n    if (this.stepTicks) {\r\n      this.intervalTickPrint = d3.format(\"d\");\r\n    }\r\n  }\r\n\r\n  refreshValueScale(){\r\n    super.refreshValueScale();\r\n\r\n    if (!this.hasFloat) {\r\n      this.intervalTicks = this.intervalTicks.filter((tick) => tick % 1 === 0);\r\n    }\r\n  }\r\n\r\n  // if parent is timeseries, timeKey shows which time we are about...\r\n  timeKey: TimeKey = null;\r\n\r\n  /** -- */\r\n  isPercentageUnit() {\r\n    if (this.unitName !== \"%\") return false;\r\n    if (this.hasNegativeValues()) return false;\r\n    if (this.rangeOrg[1] > 100) return false;\r\n    return true;\r\n  }\r\n\r\n  /** -- */\r\n  refreshScaleType() {\r\n    if (this.isEmpty()) return;\r\n\r\n    this.setStepTicks(false);\r\n\r\n    if (this.timeseriesParent) {\r\n      this.timeseriesParent.initializeAggregates();\r\n      return;\r\n    }\r\n\r\n    var domain = this.valueScale.domain();\r\n\r\n    // decide scale type based on the filtered records\r\n    var deviation = d3.deviation(this.sortedRecords, (record) => {\r\n      var v = this.getRecordValue(record);\r\n      if(v==null) return undefined;\r\n      if(v >= domain[0] && v <= domain[1]) return v;\r\n    });\r\n\r\n    var range = this.valueScale.domain();\r\n    var activeRange = range[1] - range[0];\r\n\r\n    var optTicks = this.block.getScaleNicing();\r\n\r\n    if (!this.hasFloat && optTicks >= activeRange) {\r\n      // Apply step domain before you check for log - it has higher precedence\r\n      this.setStepTicks(true);\r\n    } else if (\r\n      deviation / activeRange < 0.12 &&\r\n      this.rangeOrg[0] > 0\r\n    ) {\r\n      // Log scale\r\n      this.autoScaleType = \"log\";\r\n      return;\r\n    } else if (!this.hasFloat && optTicks >= activeRange) {\r\n      // The scale can be linear or step after this stage\r\n      this.setStepTicks(true);\r\n    }\r\n    this.autoScaleType = \"linear\";\r\n  }\r\n\r\n  getFormattedValue(v: any, isSVG: any = false): string {\r\n    if (v == null) {\r\n      v = \"-\";\r\n    } else if (typeof v === \"number\") {\r\n      if (!this.intervalTickPrint) this.refreshValueScale();\r\n      v = this.intervalTickPrint(v);\r\n    }\r\n    return Util.addUnitName(v, this.unitName, isSVG);\r\n  }\r\n\r\n  /** -- */\r\n  private keepOnlyPositiveRecords() {\r\n    this.sortedRecords = this.records.filter((record) => {\r\n      var isPositive = this.getRecordValue(record) > 0;\r\n      if (!isPositive) {\r\n        this.setRecordValueCacheToMissing(record);\r\n      }\r\n      return isPositive;\r\n    });\r\n\r\n    this.updatedRangeOrg();\r\n  }\r\n\r\n  /** -- */\r\n  async applyScaleType() {\r\n    if (!this.sortedRecords) return;\r\n\r\n    this.initializeAggregates();\r\n\r\n    // remove records with value:0 (because log(0) is invalid)\r\n    if (this.isValueScale_Log && this.rangeOrg[0] <= 0) {\r\n      this.keepOnlyPositiveRecords();\r\n    }\r\n\r\n    this.updateScaleAndBins();\r\n    await this.browser.recordDisplay?.refreshAttribScaleType(this);\r\n  }\r\n\r\n  getValueScaleObj() {\r\n    return Util.getD3Scale(this.isValueScale_Log);\r\n  }\r\n  getValuePosX(v: number) {\r\n    return this.valueScale(v) + (this.stepTicks ? this.block.aggrWidth / 2 : 0);\r\n  }\r\n\r\n  getVizDomain(): [number, number] {\r\n    if (this.timeseriesParent) {\r\n      this.timeseriesParent.initializeAggregates();\r\n      return this.timeseriesParent.timeSeriesScale_Value.domain();\r\n    }\r\n    return super.getVizDomain();\r\n  }\r\n\r\n  applyTemplateSpecial(): void {\r\n    if (this.template.special === \"TimePoint\" && this.template.parent) {\r\n      this.timeseriesParent.setTimepointAttrib(this.template.lastKey, this);\r\n    } else if (this.template.special === \"Hour\") {\r\n      this.unitName = \":00\";\r\n    }\r\n  }\r\n\r\n  skipZero: boolean = false;\r\n\r\n  /** -- */\r\n  setSkipZero() {\r\n    if (!this.aggr_initialized) return;\r\n    if (this.rangeOrg[0] > 0) return;\r\n    if (this.skipZero) return;\r\n\r\n    this.skipZero = true;\r\n\r\n    this.keepOnlyPositiveRecords();\r\n\r\n    this.refreshScaleType();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Unit name access  & updates\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  get unitName(): string {\r\n    return this.timeseriesParent?.unitName ?? this.measurable?.unitName ?? \"\";\r\n  }\r\n\r\n  /** -- */\r\n  set unitName(v: string) {\r\n    if (!v) v = \"\";\r\n    if (this.unitName === v) return;\r\n    if (this.timeseriesParent) {\r\n      this.timeseriesParent.unitName = v;\r\n      return;\r\n    }\r\n\r\n    super.unitName = v;\r\n\r\n    this.block.refreshValueTickLabels();\r\n\r\n    this.browser.recordDisplay.View?.refreshAttribUnitName(this);\r\n\r\n    if (this.measureSummary === this) {\r\n      this.browser.blocks.forEach((block) =>\r\n        block.refreshMeasureLabelText(\"Active\")\r\n      );\r\n      this.browser.DOM.activeRecordMeasure.html(\r\n        this.browser.getGlobalActiveMeasure()\r\n      );\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Import / Export\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  async applyConfig(blockCfg: SummarySpec) {\r\n    super.applyConfig(blockCfg);\r\n\r\n    this.measurable.valueDomain = blockCfg.valueDomain;\r\n\r\n    await this.block.showPercentiles.set(blockCfg.showPercentiles);\r\n    await this.valueScaleType.set(blockCfg.valueScaleType);\r\n\r\n    if (blockCfg.unitName) {\r\n      this.unitName = blockCfg.unitName;\r\n    }\r\n\r\n    if (blockCfg.skipZero) {\r\n      this.setSkipZero();\r\n    }\r\n  }\r\n\r\n  // not exportable if this is just a timekey - it inherits properties from its parent\r\n  isExportable(): boolean {\r\n    return this.timeseriesParent === null;\r\n  }\r\n\r\n  /** -- */\r\n  exportConfig() {\r\n    var config = super.exportConfig();\r\n\r\n    var c = {\r\n      unitName: this.unitName,\r\n      skipZero: this.skipZero,\r\n      filter: this.summaryFilter.exportFilter()\r\n    };\r\n\r\n    return Object.assign(config, c);\r\n  }\r\n}\r\n","import * as d3 from \"../d3_select\";\r\nimport * as Popper from \"@popperjs/core\";\r\n\r\nimport { RecordDisplay } from \"../RecordDisplay\";\r\nimport { RecordVisCoding } from \"../Types\";\r\nimport { Attrib } from \"../Attrib\";\r\nimport { i18n } from \"../i18n\";\r\nimport { Attrib_Numeric } from \"../Attrib_Numeric\";\r\n\r\ntype DropdownOption = {\r\n  item: Attrib | string | null, // if null, it means no value\r\n  measureType?: \"Sum\" | \"Count\", // special grouping option\r\n  name: string,\r\n  sub: {[index: string]: DropdownOption},\r\n  parents?: string[], // if not defined, means no parent\r\n}\r\n\r\ntype DropdownSpec = {[index:string]: DropdownOption};\r\n\r\n// group attribList by pathName\r\nfunction groupSummaries(attribList: Attrib[]): DropdownSpec {\r\n  var grouped: DropdownSpec = {};\r\n\r\n  for (const attrib of attribList) {\r\n    if (attrib == null) {\r\n      grouped[\"\"] = { item: null, name: i18n[\"(None)\"], sub: {} };\r\n      continue;\r\n    }\r\n\r\n    var target = grouped;\r\n\r\n    attrib.pathName.forEach((_key: string) => {\r\n      target[_key] =  target[_key] || {\r\n        item: _key,\r\n        name: _key,\r\n        sub: {}, // creates one with empty sub\r\n      };\r\n      target = target[_key].sub;\r\n    });\r\n\r\n    target[attrib.printName] = target[attrib.printName] || {\r\n      name: attrib.printName,\r\n      item: attrib,\r\n      sub: {},\r\n    };\r\n\r\n    // overwriting it here, since the existing one might be set before as a simple group (item as key)\r\n    target[attrib.printName].item = attrib;\r\n  }\r\n  return grouped;\r\n}\r\n\r\nexport class AttribDropdown {\r\n  private readonly _type: RecordVisCoding;\r\n  private readonly recordDisplay: RecordDisplay;\r\n  private _element: any; // d3 select\r\n  private _button: any; // d3 select\r\n  private _popup: any; // d3 select\r\n  private _popper: any; // d3 select\r\n\r\n  /** -- */\r\n  constructor(_type: RecordVisCoding, recDisp: RecordDisplay) {\r\n    this.recordDisplay = recDisp;\r\n    this._type = _type;\r\n\r\n    this._element = this.recordDisplay.DOM[_type + \"ControlGroup\"]\r\n      .append(\"span\")\r\n      .attr(\"class\", \"summaryGroup\");\r\n\r\n    this._button = this._element\r\n      .append(\"div\")\r\n      .attr(\"class\", \"selectButton\")\r\n      .on(\"click\", () => this.toggle());\r\n\r\n    this._button.append(\"div\").attr(\"class\", \"text\");\r\n    this._button.append(\"div\").attr(\"class\", \"caret fa fa-angle-down\");\r\n\r\n    this._popup = this._element.append(\"div\").attr(\"class\", \"selectOptions\");\r\n\r\n    this._element\r\n      .append(\"span\")\r\n      .attr(\"class\", \"summaryDescription fa fa-info\")\r\n      .tooltip(\"\");\r\n\r\n    this._popper = null;\r\n  }\r\n\r\n  /** -- */\r\n  get browser() {\r\n    return this.recordDisplay.browser;\r\n  }\r\n\r\n  /** Returns main timeseries if selected one is a timeKey */\r\n  get activeAttrib() {\r\n    var attrib = this.recordDisplay.codeBy[this._type];\r\n    if (attrib instanceof Attrib_Numeric && attrib.hasTimeSeriesParent()) {\r\n      return attrib.timeseriesParent;\r\n    }\r\n    return attrib;\r\n  }\r\n\r\n  /** -- */\r\n  refresh() {\r\n    var attrib = this.activeAttrib;\r\n    var text: string;\r\n\r\n    if (attrib == null) {\r\n      text = i18n.NoAttribute;\r\n    } else if (attrib === \"_measure_\") {\r\n      text = (this.browser.measureFunc.is(\"Count\"))\r\n        ? this.browser.recordName \r\n        : this.browser.measureSummary.get().printName;\r\n    } else {\r\n      text = attrib.printName;\r\n    }\r\n\r\n    this._button.select(\".text\").html(text);\r\n    this._button.classed(\"none\", attrib == null);\r\n\r\n    // Update description tooltip\r\n    var descSummary =\r\n      attrib === \"_measure_\" ? this.browser.measureSummary : attrib;\r\n    if (descSummary instanceof Attrib) {\r\n      var description = descSummary ? descSummary.description : null;\r\n      this._element\r\n        .select(\".summaryDescription\")\r\n        .style(\"display\", description ? null : \"none\")\r\n        .tooltip(description, { placement: \"bottom\" });\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  toggle() {\r\n    if (this._popper) {\r\n      this.hide();\r\n    } else {\r\n      this.show();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  show() {\r\n    if (this._popper) return;\r\n\r\n    var measuring = (this._type===\"size\" || this._type===\"color\") && this.recordDisplay.hasAggregates();\r\n\r\n    var dropdownOptions: DropdownSpec;\r\n\r\n    if (measuring) {\r\n      dropdownOptions = {};\r\n      dropdownOptions[\"\"] = {\r\n        item: null,\r\n        name: i18n.NoAttribute,\r\n        sub: {},\r\n      };\r\n      dropdownOptions[\"Count\"] = {\r\n        item: null,\r\n        measureType: \"Count\",\r\n        name: `${i18n.measure_Count}: ${this.browser.recordName}`,\r\n        sub: {},\r\n      };\r\n      dropdownOptions[\"Sum\"] = {\r\n        item: null,\r\n        name: \"Sum\",\r\n        measureType: \"Sum\",\r\n        sub: groupSummaries(this.browser.getMeasurableSummaries(\"Sum\")),\r\n      };\r\n      // \r\n    } else {\r\n      dropdownOptions = groupSummaries(\r\n        this.recordDisplay.getAttribOptions_UI(this._type)\r\n      );\r\n    }\r\n\r\n    this._popup.selectAll(\"div\").remove();\r\n\r\n    // recursiv method to add list of options\r\n    var addList = (DOM, def: DropdownSpec, level = 0) => {\r\n      var list: DropdownOption[] = Object.values(def);\r\n\r\n      // sort list so that items without group appear on top\r\n      list = list.sort((a: DropdownOption, b: DropdownOption) => {\r\n        if (a.item === null) return 1;\r\n        if (b.item === null) return -1;\r\n        return (\r\n          Object.entries(b.sub).length - Object.entries(a.sub).length ||\r\n          a.name.localeCompare(b.name)\r\n        );\r\n      });\r\n\r\n      var listItems = DOM.selectAll(\"div\")\r\n        .data(list)\r\n        .enter()\r\n        .append(\"div\")\r\n        .attr(\"class\", \"option\")\r\n        .classed(\r\n          \"active\",\r\n          (_: DropdownOption) => {\r\n            if(measuring){\r\n              if(_.measureType===\"Count\"){\r\n                return this.activeAttrib===\"_measure_\";\r\n              }\r\n              if(_.measureType===\"Sum\"){\r\n                return this.activeAttrib===\"_measure_\";\r\n              }\r\n            }\r\n            if( _.item == this.activeAttrib ) return true;\r\n            return (_.item === \"Count\" && this.activeAttrib === \"_measure_\" && this.browser.measureFunc.is(\"Count\"))\r\n          }\r\n        )\r\n        .classed(\"collapsed\", true)\r\n        .attr(\"data-id\", (_: DropdownOption) => {\r\n          if (_.item === null) return \"none\";\r\n          if (typeof _.item === \"string\") return \"_measure_\";// Count or Sum\r\n          return _.item.attribID;\r\n        })\r\n        .classed(\"isSelectable\", (_: DropdownOption) => _.item instanceof Attrib)\r\n        .classed(\"hasSubItems\", (_: DropdownOption) => Object.entries(_.sub).length > 0);\r\n\r\n      listItems\r\n        .append(\"div\")\r\n        .attr(\"class\", \"optionItem\")\r\n        .call((optionItem) => {\r\n          optionItem\r\n            .append(\"div\")\r\n            .attr(\"class\", \"groupControl\")\r\n            .tooltip(i18n[\"Open/Close\"])\r\n            .on(\"click\", (event) => {\r\n              event.stopPropagation();\r\n              event.preventDefault();\r\n              event.currentTarget.parentNode.parentNode.classList.toggle(\"collapsed\");\r\n            })\r\n            .append(\"div\")\r\n            .attr(\"class\", \"fa fa-caret-down\");\r\n          optionItem\r\n            .append(\"div\")\r\n            .attr(\"class\", \"optionName\")\r\n            .html((_) => _.name);\r\n        })\r\n        .on(\"click\", async (event, _: DropdownOption) => {\r\n          if(measuring){\r\n            if (_.measureType) {\r\n              await this.browser.measureFunc.set(_.measureType);\r\n              this.recordDisplay.setAttrib(this._type, \"_measure_\", true);\r\n            } else{\r\n              this.recordDisplay.setAttrib(this._type, null, true);\r\n            }\r\n            this.hide();\r\n            return;\r\n          }\r\n\r\n          if (typeof _.item === \"string\") {\r\n            // grouping only. open/close group\r\n            event.currentTarget.parentNode.classList.toggle(\"collapsed\");\r\n            return;\r\n          }\r\n\r\n          // Attrib selection\r\n          this.recordDisplay.setAttrib(this._type, _.item, true);\r\n          this.hide();\r\n        });\r\n\r\n      listItems\r\n        .append(\"div\")\r\n        .attr(\"class\", \"subItems\")\r\n        .each((d, i, nodes) => {\r\n          addList(d3.select(nodes[i]), d.sub, level + 1);\r\n        });\r\n    };\r\n\r\n    addList(this._popup, dropdownOptions, 0);\r\n\r\n    this._popup.style(\"min-width\", this._button.node().offsetWidth + \"px\");\r\n\r\n    this._popper = Popper.createPopper(\r\n      this._button.node(),\r\n      this._popup.node(),\r\n      {\r\n        placement:\r\n          this._type == \"timeSeries\" || this._type == \"scatterY\"\r\n            ? \"right-start\"\r\n            : \"bottom-start\",\r\n        strategy: \"absolute\",\r\n        modifiers: [\r\n          {\r\n            name: \"flip\",\r\n            enabled: true,\r\n            boundary: this.browser.DOM.root.node(),\r\n            //fallbackPlacements: ['top', 'right', 'bottom', 'left'],\r\n          },\r\n        ],\r\n      }\r\n    );\r\n\r\n    setTimeout(() => this._element.classed(\"dropdownOpen\", true), 10);\r\n  }\r\n\r\n  /** -- */\r\n  hide() {\r\n    this._element.classed(\"dropdownOpen\", false);\r\n    setTimeout(() => {\r\n      if (!this._popper) return;\r\n      this._popper.destroy();\r\n      this._popper = null;\r\n    }, 350);\r\n  }\r\n}\r\n","import { select, pointer } from \"../d3_select\";\r\n\r\nimport { i18n } from \"../i18n\";\r\nimport { Browser } from \"../Browser\";\r\nimport { Base } from \"../Base\";\r\nimport { Config } from \"../Config\";\r\n\r\nconst d3 = { select, pointer };\r\n\r\nexport class ConfigPanel {\r\n  private readonly browser: Browser;\r\n  private readonly DOM: { root: any; configTable: any };\r\n  private readonly controlButton: any;\r\n\r\n  /** -- */\r\n  constructor(\r\n    rootDOM,\r\n    headerName,\r\n    className,\r\n    configs: Config<any>[],\r\n    browser: Browser,\r\n    controlButton\r\n  ) {\r\n    this.browser = browser;\r\n\r\n    this.DOM = {\r\n      root: rootDOM\r\n        .append(\"div\")\r\n        .attr(\"class\", \"configPanel \" + className)\r\n        .classed(\"active\", false),\r\n      configTable: null,\r\n    };\r\n\r\n    this.controlButton = controlButton;\r\n\r\n    this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"configClose fa fa-window-close\")\r\n      .tooltip(i18n.Close)\r\n      .on(\"click\", () => this.hide());\r\n\r\n    this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"popupPanel_Header\")\r\n      .html(i18n[headerName])\r\n\r\n      // Dragging support while keeping it within window\r\n      .on(\"mousedown\", (event) => {\r\n        browser.DOM.root\r\n          .classed(\"noPointerEvents\", true)\r\n          .attr(\"drag_cursor\", \"grabbing\");\r\n\r\n        var bodyDOM = d3.select(\"body\").node();\r\n\r\n        var initPos = d3.pointer(event, bodyDOM);\r\n        var DOM = this.DOM.root.node();\r\n        var initX = parseInt(DOM.offsetLeft);\r\n        var initY = parseInt(DOM.offsetTop);\r\n\r\n        d3.select(\"body\")\r\n          .on(\"mousemove\", (event2) => {\r\n            var newPos = d3.pointer(event2, bodyDOM);\r\n            this.checkPositionSanity(\r\n              initX - initPos[0] + newPos[0],\r\n              initY - initPos[1] + newPos[1]\r\n            );\r\n          })\r\n          .on(\"mouseup\", () => {\r\n            browser.DOM.root\r\n              .classed(\"noPointerEvents\", false)\r\n              .attr(\"drag_cursor\", null);\r\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\r\n          });\r\n\r\n        event.preventDefault();\r\n      });\r\n\r\n    this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"compactSizeControl fa fa-angle-double-up\")\r\n      .on(\"click\", () => this.DOM.root.node().classList.toggle(\"compact\"));\r\n\r\n    this.DOM.configTable = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"popupPanel_Content\")\r\n      .append(\"table\")\r\n      .attr(\"class\", \"configTable\");\r\n\r\n    configs.forEach((cfg) => this.insertConfigUI(cfg));\r\n  }\r\n\r\n  insertConfigUI(cfg){\r\n    cfg.insertControl(this.DOM.configTable);\r\n  }\r\n\r\n  /** -- */\r\n  showAtPos(left, top) {\r\n    if (this.DOM.root.classed(\"active\")) {\r\n      this.hide();\r\n      return;\r\n    }\r\n    this.browser.closeConfigPanels();\r\n    this.DOM.root.classed(\"active\", true);\r\n    this.controlButton.classed(\"fa-spin\", true);\r\n    this.checkPositionSanity(left, top);\r\n  }\r\n\r\n  /** -- */\r\n  hide() {\r\n    this.DOM.root.classed(\"active\", false);\r\n    this.controlButton.classed(\"fa-spin\", false);\r\n  }\r\n\r\n  /** -- */\r\n  private checkPositionSanity(curLeft = null, curTop = null) {\r\n    if (!Base.browser) return;\r\n    var space = 8; // just to add some space around...\r\n    var dom = this.DOM.root.node();\r\n    var panelWidth = dom.offsetWidth + space;\r\n    var panelHeight = dom.offsetHeight + space;\r\n    if (curLeft == null) curLeft = parseFloat(dom.style.left);\r\n    if (curTop == null) curTop = parseFloat(dom.style.top);\r\n    var maxWidth = dom.offsetParent.getBoundingClientRect().width;\r\n    var maxHeight = dom.offsetParent.getBoundingClientRect().height;\r\n    dom.style.left =\r\n      Math.max(space, Math.min(maxWidth - panelWidth, curLeft)) + \"px\";\r\n    dom.style.top =\r\n      Math.max(space, Math.min(maxHeight - panelHeight, curTop)) + \"px\";\r\n  }\r\n}\r\n","import { Attrib_RecordGeo } from \"./Attrib_RecordGeo\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Filter } from \"./Filter\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Util } from \"./Util\";\r\n\r\nexport class Filter_Spatial extends Filter {\r\n  public readonly attrib: Attrib_RecordGeo;\r\n\r\n  bounds: any; // TODO\r\n\r\n  constructor(_browser: Browser, attrib: Attrib_RecordGeo) {\r\n    super(_browser);\r\n    this.bounds = null;\r\n  }\r\n  get title() {\r\n    return i18n[\"Spatial\"];\r\n  }\r\n  exportFilter() {\r\n    return {\r\n      bounds: this.bounds,\r\n    };\r\n  }\r\n  importFilter(_) {\r\n    this.bounds = _;\r\n    this.setFiltered(false); // no update...\r\n    this.applyFilter();\r\n  }\r\n  onClear() {\r\n    this.browser.recordDisplay.DOM.recordBase_Map\r\n      .select(\".spatialQueryBox_Filter\")\r\n      .classed(\"active\", null);\r\n  }\r\n  filterView_Detail() {\r\n    return \"<i class='fa fa-square-o'></i> (Area)\";\r\n  }\r\n  onFilter(): void {\r\n    this.browser.recordDisplay.DOM.recordBase_Map\r\n      .select(\".spatialQueryBox_Filter\")\r\n      .classed(\"active\", true);\r\n\r\n    this.browser.records.forEach((record) => {\r\n      var rBounds = this.attrib.getRecordValue(record)._bounds;\r\n      record.setFilterCache(\r\n        this.filterID,\r\n        rBounds ? Util.intersects(rBounds, this.bounds) : false\r\n      );\r\n    }, this);\r\n  }\r\n}\r\n\r\n","import { geoBounds } from \"d3-geo\";\r\n\r\nimport { Aggregate } from \"./Aggregate.js\";\r\nimport { Attrib } from \"./Attrib.js\";\r\nimport { AttribTemplate } from \"./AttribTemplate.js\";\r\nimport { Base } from \"./Base.js\";\r\nimport { Browser } from \"./Browser.js\";\r\nimport {\r\n  BlockSpec,\r\n  RecordVisCoding,\r\n  SummaryConfig,\r\n  SummarySpec,\r\n} from \"./Types.js\";\r\nimport { Filter_Spatial as Filter_Geo } from \"./Filter_Geo.js\";\r\nimport { i18n } from \"./i18n.js\";\r\nimport { MapData } from \"./MapData.js\";\r\nimport { Record } from \"./Record.js\";\r\n\r\nconst d3 = { geoBounds };\r\n\r\ndeclare let Supercluster: any;\r\ndeclare let L: any;\r\n\r\n/** -- */\r\nexport class Aggregate_PointCluster extends Aggregate {\r\n  // cluster structure is returned by Supercluster library\r\n  cluster: any;\r\n\r\n  _glyphOrder: any; // TODO\r\n\r\n  /** -- */\r\n  constructor(attrib: Attrib_RecordGeo, _cluster) {\r\n    super(attrib);\r\n    this.cluster = _cluster;\r\n  }\r\n  get tooltipTitle() {\r\n    return i18n[\"Cluster\"];\r\n  }\r\n  get label(): string {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport type RecordGeoData = {\r\n  geoFeat: any;\r\n  _bounds: any;\r\n};\r\n\r\n/** Can be a point object, or polygon objects */\r\nexport class Attrib_RecordGeo extends Attrib {\r\n  public _aggrs: Aggregate_PointCluster[] = [];\r\n\r\n  recordGeoMap: MapData;\r\n\r\n  geoType:\r\n    | \"Point\"\r\n    | \"MultiPoint\"\r\n    | \"LineString\"\r\n    | \"MultiLineString\"\r\n    | \"Polygon\"\r\n    | \"MultiPolygon\"\r\n    | \"GeometryCollection\"\r\n    | \"Feature\"\r\n    | \"FeatureCollection\";\r\n\r\n  constructor(browser: Browser, name: string, template: AttribTemplate) {\r\n    super(browser, name, template, \"recordGeo\", \"\", \"fa fa-map-marker\");\r\n\r\n    this.createSummaryFilter();\r\n  }\r\n\r\n  getRecordValue(record: Record): RecordGeoData {\r\n    return record.getValue(this);\r\n  }\r\n\r\n  /** Only supports \"geo\" encoding */\r\n  supportsRecordEncoding(coding: RecordVisCoding) {\r\n    return coding === \"geo\";\r\n  }\r\n\r\n  get measureRangeMax(): number {\r\n    return this.geoType === \"Point\" ? this._pointClusterRadius : 1;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering\r\n  // ********************************************************************\r\n\r\n  public summaryFilter: Filter_Geo | null = null;\r\n\r\n  createSummaryFilter() {\r\n    this.summaryFilter = new Filter_Geo(this.browser, this);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Aggregates / geo-cache\r\n  // ********************************************************************\r\n\r\n  async loadGeo() {\r\n    if (this.recordGeoMap) {\r\n      await this.recordGeoMap.loadGeo();\r\n    }\r\n\r\n    this.browser.records.forEach((record) => {\r\n      var feature = this.template.func.call(record.data, record);\r\n      if (typeof feature === \"string\" && this.recordGeoMap) {\r\n        feature = this.recordGeoMap.getFeature(feature.toUpperCase());\r\n      }\r\n      if (feature) {\r\n        var g: RecordGeoData = {\r\n          geoFeat: feature,\r\n          _bounds: d3.geoBounds(feature),\r\n        };\r\n        this.geoType = feature.type;\r\n        record.setValue(this, g);\r\n      } else {\r\n        record.setValue(this, null);\r\n        this.noValueAggr.addRecord(record);\r\n      }\r\n    });\r\n  }\r\n\r\n  initializeAggregates(): void {\r\n    if (this.aggr_initialized) return;\r\n\r\n    this.aggr_initialized = true;\r\n  }\r\n\r\n  async applyConfig(blockCfg: SummarySpec) {\r\n    super.applyConfig(blockCfg);\r\n\r\n    if (blockCfg.recordGeo) {\r\n      this.recordGeoMap = Base.maps.get(blockCfg.recordGeo);\r\n      if (!this.recordGeoMap) {\r\n        this.recordGeoMap = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  getRecordBounds(onlyIncluded) {\r\n    var bs = [];\r\n    this.browser.records.forEach((record) => {\r\n      if (onlyIncluded && record.filteredOut) return;\r\n      var v = this.getRecordValue(record);\r\n      if (!v) return;\r\n      if (!v._bounds) return;\r\n      var b = v._bounds;\r\n      if (isNaN(b[0][0])) return;\r\n      var p1 = L.latLng(b[0][1], b[0][0]);\r\n      var p2 = L.latLng(b[1][1], b[1][0]);\r\n      bs.push(p1);\r\n      bs.push(p2);\r\n    });\r\n    return new L.latLngBounds(bs);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Point cluster management\r\n  // ********************************************************************\r\n\r\n  readonly maxNodeRecordSize = 1000;\r\n\r\n  public PointCluster: any; // Supercluster library\r\n\r\n  async prepPointCluster(leafletMap) {\r\n    if (this.pointClusterRadius === 0) {\r\n      return;\r\n    }\r\n\r\n    if (!Supercluster) {\r\n      Supercluster = await import(\"supercluster\");\r\n    }\r\n\r\n    this.PointCluster = new Supercluster({\r\n      radius: this.pointClusterRadius, // in pixels\r\n      maxZoom: leafletMap.getMaxZoom() - 1,\r\n      minZoom: leafletMap.getMinZoom(),\r\n      //map: (props) => ({data: props.data}),\r\n    });\r\n\r\n    var points = [];\r\n    this.records.forEach((record) => {\r\n      points.push({\r\n        type: \"Feature\",\r\n        properties: record,\r\n        geometry: this.getRecordValue(record).geoFeat,\r\n      });\r\n    });\r\n\r\n    this.PointCluster.load(points);\r\n  }\r\n\r\n  updateClusters(_bounds, zoom) {\r\n    this.deletePointClusters();\r\n\r\n    var _clusters = this.PointCluster.getClusters(\r\n      [\r\n        _bounds.getWest(),\r\n        _bounds.getSouth(),\r\n        _bounds.getEast(),\r\n        _bounds.getNorth(),\r\n      ],\r\n      Math.floor(zoom)\r\n    );\r\n\r\n    _clusters.forEach((cluster) => {\r\n      if (!cluster.id) {\r\n        // single record\r\n        let record: Record = cluster.properties;\r\n        record._view.inCluster = false;\r\n        //\r\n      } else {\r\n        var clusterMembers = this.PointCluster.getLeaves(\r\n          cluster.id,\r\n          this.maxNodeRecordSize\r\n        );\r\n\r\n        var clusterAggr = new Aggregate_PointCluster(this, cluster);\r\n\r\n        clusterMembers.forEach((member) => {\r\n          let record: Record = member.properties;\r\n          record._view.inCluster = true;\r\n          if (record.isIncluded) {\r\n            clusterAggr.addRecord(record);\r\n          }\r\n        });\r\n\r\n        if (clusterAggr.records.length === 0) return;\r\n\r\n        if (clusterAggr.records.length === 1) {\r\n          // remove individual record from cluster\r\n          let record: Record = clusterAggr.records[0];\r\n          record._view.inCluster = false;\r\n          clusterAggr.clearRecords();\r\n          return;\r\n        }\r\n\r\n        this._aggrs.push(clusterAggr);\r\n        this.browser.allAggregates.push(clusterAggr);\r\n      }\r\n    });\r\n\r\n    // sort aggregates by active measure size\r\n    this._aggrs.sort((c1, c2) => c2.measure(\"Active\") - c1.measure(\"Active\"));\r\n  }\r\n\r\n  /** -- */\r\n  private deletePointClusters() {\r\n    // delete all clusters\r\n    this._aggrs.forEach((clusterAggr: Aggregate_PointCluster) => {\r\n      clusterAggr.clearRecords(); // removes cluster aggregate from record's aggregate index\r\n      clusterAggr.DOM.aggrGlyph.remove(); // removes the DOM item\r\n      this.browser.allAggregates.splice(\r\n        this.browser.allAggregates.indexOf(clusterAggr),\r\n        1\r\n      );\r\n    });\r\n    this.records.forEach((record: Record) => {\r\n      record._view.inCluster = false;\r\n    });\r\n    this._aggrs = [];\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Cluster radius management\r\n  // ********************************************************************\r\n\r\n  private _pointClusterRadius: number = 50;\r\n  public get pointClusterRadius() {\r\n    return this._pointClusterRadius;\r\n  }\r\n\r\n  async setPointClusterRadius(_v, leafletRecordMap) {\r\n    // must be positive integer\r\n    this._pointClusterRadius = Math.round(Math.max(0, _v));\r\n    if (this.pointClusterRadius === 0) {\r\n      this.deletePointClusters();\r\n      return;\r\n    }\r\n    return await this.prepPointCluster(leafletRecordMap);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Export / import config\r\n  // ********************************************************************\r\n\r\n  exportConfig(): BlockSpec & SummaryConfig {\r\n    return {\r\n      pointClusterRadius: this._pointClusterRadius,\r\n    } as any;\r\n  }\r\n}\r\n","import { scaleTime, scaleLinear } from \"d3-scale\";\r\nimport { min, max, extent, deviation } from \"d3-array\";\r\nimport { format } from \"d3-format\";\r\nimport { easePolyInOut } from \"d3-ease\";\r\n\r\nimport { Config } from \"./Config\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Util } from \"./Util\";\r\nimport { Record } from \"./Record\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\nimport { LinearOrLog, RecordVisCoding } from \"./Types\";\r\nimport { AttribTemplate } from \"./AttribTemplate\";\r\nimport { Base } from \"./Base\";\r\nimport { TimeData, TimeKey, TimeSeriesData } from \"./TimeSeriesData\";\r\n\r\nconst d3 = {\r\n  scaleTime,\r\n  scaleLinear,\r\n  min,\r\n  max,\r\n  extent,\r\n  format,\r\n  deviation,\r\n  easePolyInOut,\r\n};\r\n\r\nvar _tempClipPathCounter;\r\n\r\n/** -- */\r\nexport class Attrib_Timeseries extends Attrib {\r\n  get measureRangeMax(): number {\r\n    throw new Error(\"Not applicable.\");\r\n  }\r\n\r\n  // hared with Attribute_Numeric\r\n  // accessed by RecordView_Timeseries\r\n  public hasFloat: boolean;\r\n\r\n  public tickPrecision = 3;\r\n\r\n  public timeKeys: TimeKey[] = [];\r\n\r\n  public timeKeyAttribs: Attrib_Numeric[] = [];\r\n\r\n  valueScaleType: Config<LinearOrLog>;\r\n\r\n  public timeSeriesScale_Time: any;\r\n  public timeSeriesScale_Value: any;\r\n\r\n  // given a number, returns the formatted string\r\n  numberFormat: (number) => string;\r\n\r\n  constructor(browser, name: string, template: AttribTemplate) {\r\n    super(browser, name, template, \"timeseries\", \"\", \"fa fa-chart-line\");\r\n\r\n    this.measurable = {\r\n      metricFuncs: Base.defaultMetricFuncs\r\n    };\r\n\r\n    this.valueScaleType = new Config<LinearOrLog>({\r\n      cfgClass: \"valueScaleType\",\r\n      cfgTitle: \"BinScale\",\r\n      iconClass: \"fa fa-arrows-h\",\r\n      parent: this,\r\n      default: \"linear\",\r\n      helparticle: \"5e87eabc04286364bc97d0cf\",\r\n      itemOptions: [\r\n        { name: `${i18n.Linear} ${i18n.LinearSequence}`, value: \"linear\" },\r\n        { name: `${i18n.Log} ${i18n.Log2Sequence}`, value: \"log\" },\r\n      ],\r\n      forcedValue: () => {\r\n        if (!this.supportsLogScale()) return \"linear\";\r\n      },\r\n      preSet: async (v) => {\r\n        if (v !== \"log\" && v !== \"linear\") return;\r\n        // don't set to log if it's not applicable\r\n        return v;\r\n      },\r\n      onSet: async (v) => {\r\n        if (!this.timeSeriesScale_Value) return;\r\n\r\n        for (var c in this.timeKeyAttribs) {\r\n          var s = this.timeKeyAttribs[c];\r\n          if (s.timeKey) await s.applyScaleType();\r\n        }\r\n\r\n        this.timeSeriesScale_Value = Util.getD3Scale(v === \"log\").domain(\r\n          this.getExtent_Value()\r\n        );\r\n\r\n        await this.browser.recordDisplay.refreshAttribScaleType(this);\r\n      },\r\n    });\r\n\r\n    this.numberFormat = (x) => {\r\n      if (this.hasFloat && x < 1000) {\r\n        return d3.format(\",.3~f\")(x);\r\n      }\r\n      var m = d3.format(\".3~s\")(x); // if input is 9, it returns 9.0 . ARGH!\r\n      return m.replace(\".0\", \"\");\r\n    };\r\n\r\n    this.finishTemplateSpecial();\r\n  }\r\n\r\n  getRecordValue(record: Record): TimeSeriesData {\r\n    return record.getValue(this);\r\n  }\r\n\r\n  /** -- */\r\n  supportsRecordEncoding(coding: RecordVisCoding): boolean {\r\n    if (this.isEmpty()) return false;\r\n    this.initializeAggregates();\r\n    if (this.isComparable.is(false)) return false;\r\n    if (coding === \"timeSeries\") return true;\r\n    if (coding === \"sort\") return true;\r\n    if (coding === \"scatterX\") return true;\r\n    if (coding === \"scatterY\") return true;\r\n    if (coding === \"color\") return true;\r\n    if (coding === \"size\") {\r\n      return !this.hasNegativeValues();\r\n    }\r\n    return false;\r\n  }\r\n  /** -- */\r\n  isEmpty() {\r\n    return !this.timeKeys || this.timeKeys.length === 0;\r\n  }\r\n  /** -- */\r\n  get canHaveMetricFuncs() {\r\n    return true;\r\n  }\r\n  /** -- */\r\n  get supportedMetricFuncs() {\r\n    return this._metricFuncs;\r\n  }\r\n  /** -- */\r\n  supportsLogScale(): boolean {\r\n    if (!this.timeSeriesScale_Value) {\r\n      return true; // assume it supports by default\r\n    }\r\n    return (\r\n      this.timeSeriesScale_Value &&\r\n      this.timeSeriesScale_Value.domain().every((_) => _ > 0)\r\n    );\r\n    // Do not filter by unitName!==\"%\" - in some cases it may make sense\r\n  }\r\n  /** -- */\r\n  hasNonNegativeValueDomain() {\r\n    return this.timeSeriesScale_Value.domain().every((_) => _ >= 0);\r\n  }\r\n\r\n  get attribName(): string {\r\n    return super.attribName;\r\n  }\r\n  set attribName(name: string) {\r\n    super.attribName = name;\r\n\r\n    // name wasn't updated\r\n    if (this.attribName !== name) return;\r\n\r\n    for (var timeKey in this.timeKeyAttribs) {\r\n      var attrib = this.timeKeyAttribs[timeKey];\r\n      attrib.attribName = `${this.attribName} <i class=\"fa fa-calendar-day\"></i> ${attrib.timeKey._time_src}`;\r\n    }\r\n\r\n    // Refresh other places which is linked to this timeseries variable\r\n    if (this.browser.recordChartType.is(\"timeseries\")) {\r\n      this.browser.recordDisplay.refreshAttribOptions(\"timeSeries\");\r\n    }\r\n\r\n    this.browser.recordDisplay.refreshAttribOptions(\"sort\");\r\n  }\r\n\r\n  /** -- */\r\n  updateChartScale_Measure(): void {\r\n    // no-op\r\n  }\r\n\r\n  applyTemplateSpecial(): void {\r\n    if (this.template.special === \"TimeseriesChange-%\") {\r\n      this.unitName = \"%\";\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  initializeAggregates(): void {\r\n    if (this.aggr_initialized) return;\r\n\r\n    var timeIndex: { [index: number]: string } = {};\r\n    var extent_Time: [Date, Date][] = [];\r\n    var extent_Value: [number, number][] = [];\r\n    var allRecordValues: number[] = [];\r\n\r\n    this.browser.records.forEach((record: Record) => {\r\n      var _ = this.template.func.call(record.data, record);\r\n      if (_ == null) {\r\n        record.setValue(this, null);\r\n        return;\r\n      }\r\n\r\n      var ts = _ as TimeSeriesData;\r\n\r\n      record.setValue(this, ts);\r\n\r\n      ts.sortTimeseries();\r\n\r\n      ts.computeCaches();\r\n\r\n      // per whole attribute\r\n      ts._timeseries_.forEach((k: TimeData) => {\r\n        timeIndex[k._time.getTime()] = k._time_src;\r\n        allRecordValues.push(k._value);\r\n      });\r\n      extent_Time.push(ts.extent_Time);\r\n      extent_Value.push(ts.extent_Value);\r\n    });\r\n\r\n    if (extent_Time.length === 0) {\r\n      this.aggr_initialized = true;\r\n      return;\r\n    }\r\n\r\n    // min of the min's, max of the max's\r\n    var valueDomain: [number, number] = this.valueDomain || [\r\n      d3.min(extent_Value, (_) => _[0]),\r\n      d3.max(extent_Value, (_) => _[1]),\r\n    ];\r\n    var timeDomain: [Date, Date] = [\r\n      d3.min(extent_Time, (_) => _[0]),\r\n      d3.max(extent_Time, (_) => _[1]),\r\n    ];\r\n\r\n    // Figure out if the values are floating points or full integers\r\n    this.hasFloat = allRecordValues.some((v) => v % 1 !== 0);\r\n\r\n    if (!this.hasFloat) {\r\n      this.tickPrecision = valueDomain[1].toLocaleString().length > 5 ? 3 : 0;\r\n    }\r\n\r\n    // Set scale\r\n    var deviation = d3.deviation(allRecordValues);\r\n    var activeRange = valueDomain[1] - valueDomain[0];\r\n    this.valueScaleType.set(\r\n      (deviation / activeRange < 0.12 && valueDomain[0] > 0) ? \"log\" : \"linear\"\r\n    );\r\n\r\n    // Currently static settings once a timeseries is selected\r\n    this.timeSeriesScale_Time = d3.scaleTime().domain(timeDomain);\r\n    this.timeSeriesScale_Value = Util.getD3Scale(this.isValueScale_Log);\r\n    this.timeSeriesScale_Value.domain(valueDomain);\r\n\r\n    for (var _ in timeIndex) {\r\n      this.timeKeys.push({\r\n        _time: new Date(Number(_)), // convert string to number\r\n        _time_src: timeIndex[_],\r\n      });\r\n    }\r\n    this.timeKeys.sort((a, b) => a._time.getTime() - b._time.getTime());\r\n    this.timeKeys.forEach((timeKey, i) => {\r\n      timeKey._index = i;\r\n    });\r\n\r\n    // Some records may be missing some values on some time-keys.\r\n    // Here, we need to insert new time keys and set them to undefined\r\n    // Charting will take care whether to interpolate the missing values or not.\r\n    this.browser.records.forEach((record) => {\r\n      var _ts: TimeSeriesData | null = this.getRecordValue(record);\r\n      if (!_ts) return;\r\n\r\n      var newTimeKeyAdded = false;\r\n\r\n      this.timeKeys.forEach((_key: TimeKey) => {\r\n        if (!_ts._keyIndex[_key._time_src]) {\r\n          _ts.addTimeData({\r\n            _time: _key._time,\r\n            _time_src: _key._time_src,\r\n            _value: undefined,\r\n          });\r\n          newTimeKeyAdded = true;\r\n        }\r\n      });\r\n\r\n      if (newTimeKeyAdded) {\r\n        _ts.sortTimeseries();\r\n      }\r\n    });\r\n\r\n    this.aggr_initialized = true;\r\n  }\r\n\r\n  /** -- */\r\n  getExtent_Value(onlyUnfiltered = false, timeDomain: [Date, Date] = null) {\r\n    if (!onlyUnfiltered && this.valueDomain) {\r\n      return this.valueDomain;\r\n    }\r\n\r\n    var inTimeDomain = (_d: TimeData) => true;\r\n    if (timeDomain) {\r\n      inTimeDomain = (d: TimeData) =>\r\n        d._time >= timeDomain[0] && d._time <= timeDomain[1];\r\n    }\r\n\r\n    var extent_Value: [number, number][] = [];\r\n\r\n    var valFunc = (k: TimeData): number => (inTimeDomain(k) ? k._value : null);\r\n    if (this.isValueScale_Log) {\r\n      valFunc = (k: TimeData): number => (inTimeDomain(k) && k._value > 0 ? k._value : null);\r\n    }\r\n\r\n    this.browser.records.forEach((record) => {\r\n      if (onlyUnfiltered && record.filteredOut) return;\r\n      var _ts = this.getRecordValue(record);\r\n      if (!_ts) return;\r\n\r\n      _ts.extent_Value = d3.extent(_ts._timeseries_, valFunc);\r\n      if (typeof _ts.extent_Value[0] === \"number\") {\r\n        extent_Value.push(_ts.extent_Value);\r\n      }\r\n    });\r\n\r\n    return [\r\n      d3.min(extent_Value, (_) => _[0]),\r\n      d3.max(extent_Value, (_) => _[1]),\r\n    ];\r\n  }\r\n\r\n  /** -- */\r\n  hasNegativeValues() {\r\n    return d3.min(this.timeSeriesScale_Value.domain()) < 0;\r\n  }\r\n  /** -- */\r\n  hasFlippedDomain() {\r\n    var tsDomain = this.timeSeriesScale_Value.domain();\r\n    return tsDomain[0] > tsDomain[1];\r\n  }\r\n\r\n  /** -- */\r\n  computeRecordRanks() {\r\n    this.timeKeys.forEach((timeKey: TimeKey) => {\r\n      // sort records in place\r\n      var compFunc = this.hasFlippedDomain()\r\n        ? (vA: TimeData, vB: TimeData) => vA._value - vB._value\r\n        : (vA: TimeData, vB: TimeData) => vB._value - vA._value;\r\n\r\n      var getValueAtTime = (record: Record, key: string): TimeData => {\r\n        var v = this.getRecordValue(record);\r\n        if (!v || v.isEmpty()) return null;\r\n        let v2 = v._keyIndex[key];\r\n        if (v2 == null) return null;\r\n        return v2;\r\n      };\r\n\r\n      // sorts a copied record list, and assigns _rank.\r\n      Array.from(this.browser.records)\r\n        .sort((a: Record, b: Record) => {\r\n          if (a.filteredOut) return 1;\r\n          if (b.filteredOut) return -1;\r\n\r\n          var vA = getValueAtTime(a, timeKey._time_src);\r\n          if (vA == null) return 1;\r\n\r\n          var vB = getValueAtTime(b, timeKey._time_src);\r\n          if (vB == null) return -1;\r\n\r\n          return compFunc(vA, vB);\r\n        })\r\n        .forEach((record: Record, i) => {\r\n          var v: TimeData = getValueAtTime(record, timeKey._time_src);\r\n          if (v != null) v._rank = i + 1;\r\n        });\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  get isValueScale_Log() {\r\n    return this.valueScaleType.is(\"log\");\r\n  }\r\n  get isValueScale_Linear() {\r\n    return this.valueScaleType.is(\"linear\");\r\n  }\r\n\r\n  // No-ops\r\n  createSummaryFilter() {}\r\n  refreshViz_Compare() {}\r\n\r\n  // ********************************************************************\r\n  // Accessing specific timepoint attributes\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  setTimepointAttrib(timePoint, summary: Attrib_Numeric) {\r\n    if (typeof timePoint === \"string\" || !timePoint._time) {\r\n      timePoint = this.timeKeys.filter((key) => key._time_src === timePoint)[0];\r\n      if (!timePoint) return; // nope\r\n    }\r\n    summary.timeKey = timePoint;\r\n    this.timeKeyAttribs[timePoint._time_src] = summary;\r\n  }\r\n\r\n  /** -- */\r\n  getTimepointSummary_Next(curSummary, shift = 1) {\r\n    this.initializeAggregates(); // make sure the summary is ready\r\n    if (this.isEmpty()) return null;\r\n    var timeKey = curSummary.timeKey._time_src;\r\n    if (!timeKey) return null;\r\n\r\n    // Return null if end of keys\r\n    var curIndex = -1;\r\n    this.timeKeys.some((key, i) => {\r\n      if (key._time_src === timeKey) {\r\n        curIndex = i;\r\n        return true;\r\n      }\r\n    });\r\n\r\n    // check if new value is in range\r\n    if (shift > 0 && curIndex === this.timeKeys.length - 1) {\r\n      return null;\r\n    }\r\n    if (shift < 0 && curIndex === 0) {\r\n      return null;\r\n    }\r\n    var target = Math.min(\r\n      this.timeKeys.length - 1,\r\n      Math.max(0, curIndex + shift)\r\n    );\r\n    return this.getTimepointSummary(this.timeKeys[target]);\r\n  }\r\n\r\n  /** - */\r\n  getTimepointSummary(timePoint): Attrib_Numeric {\r\n    this.initializeAggregates(); // make sure the summary is ready\r\n    var attrib = this.timeKeyAttribs[timePoint._time_src];\r\n    if (!attrib) {\r\n      attrib = this.browser.createAttrib(\r\n        `${this.attribName} <i class=\"fa fa-calendar-day\"></i> ${timePoint._time_src}`,\r\n        `${this.template}->${timePoint._time_src}`,\r\n        \"numeric\"\r\n      ) as Attrib_Numeric;\r\n      this.setTimepointAttrib(timePoint, attrib);\r\n      attrib.initializeAggregates();\r\n    }\r\n    return attrib;\r\n  }\r\n\r\n  /** -- */\r\n  printAbbr(v: TimeData, isSVG = false) {\r\n    // uses print from a timeKey summary\r\n    return this.getTimepointSummary(this.timeKeys[0]).printAbbr(v._value, isSVG);\r\n  }\r\n  /** -- */\r\n  getFormattedValue(v, isSVG = false) {\r\n    var formatted = this.numberFormat(v);\r\n    return v == null ? \"-\" : Util.addUnitName(formatted, this.unitName, isSVG);\r\n  }\r\n  /** -- */\r\n  async applyConfig(blockCfg) {\r\n    super.applyConfig(blockCfg);\r\n\r\n    this.measurable.valueDomain = blockCfg.valueDomain;\r\n\r\n    if (blockCfg.valueScaleType) {\r\n      await this.valueScaleType.set(blockCfg.valueScaleType);\r\n    }\r\n    if (blockCfg.unitName) {\r\n      this.unitName = blockCfg.unitName;\r\n    }\r\n  }\r\n  /** -- */\r\n  exportConfig() {\r\n    return Object.assign(\r\n      super.exportConfig(), \r\n      {\r\n        unitName: this.unitName,\r\n        valueScaleType: this.valueScaleType.get(),\r\n      });\r\n  }\r\n  /** -- */\r\n  renderRecordValue(v, d3_selection, timeKeys = null): string {\r\n    if (v instanceof Record) v = this.getRecordValue(v);\r\n\r\n    if (!d3_selection || !v) return;\r\n\r\n    if(!(v instanceof TimeSeriesData)) return\r\n\r\n    this.initializeAggregates();\r\n\r\n    var timeseriesWidth = this.browser.recordDisplay.config.timeseriesWidth;\r\n\r\n    var timeScale = d3\r\n      .scaleTime()\r\n      .domain(d3.extent(timeKeys, (f) => f._time))\r\n      .rangeRound([5, timeseriesWidth - 5]);\r\n\r\n    let timeData: TimeData[] = v._timeseries_;\r\n\r\n    var [value_min, value_max] = d3.extent(timeData, (d) => d._value);\r\n    var steadyValue = false;\r\n    if (value_min === value_max) {\r\n      steadyValue = value_max;\r\n      value_min -= 0.00001;\r\n      value_max += 0.00001;\r\n    } else if (this.hasFlippedDomain()) {\r\n      // if the timeseries value-axis is flipped\r\n      [value_min, value_max] = [value_max, value_min];\r\n    }\r\n\r\n    var valueScale = d3\r\n      .scaleLinear()\r\n      .domain([value_min, value_max])\r\n      .rangeRound([40, 0]);\r\n\r\n    _tempClipPathCounter++;\r\n\r\n    var colorOut = this.browser.colorTheme.getContinuous();\r\n    var mapp = this.timeSeriesScale_Value.copy().range([0, 1]);\r\n\r\n    var _timeSeriesSvg = d3_selection\r\n      .append(\"svg\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n      .attr(\"class\", \"recordDetailTimeseries\")\r\n      .style(\"width\", timeseriesWidth + \"px\");\r\n\r\n    var defs = _timeSeriesSvg.append(\"defs\");\r\n    defs\r\n      .append(\"clipPath\")\r\n      .attr(\"id\", \"RecordTimeseriesClip_\" + _tempClipPathCounter)\r\n      .append(\"rect\")\r\n      .attr(\"class\", \"recordTimeseriesClipPath\")\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", -10)\r\n      .attr(\"height\", 70)\r\n      .attr(\"width\", 1)\r\n      .transition()\r\n      .duration(1500)\r\n      .delay(0)\r\n      .ease(d3.easePolyInOut)\r\n      .attr(\"width\", timeseriesWidth + 10);\r\n\r\n    var _ = defs\r\n      .append(\"linearGradient\")\r\n      .attr(\"id\", \"GradientPath_\" + _tempClipPathCounter)\r\n      .attr(\"x1\", \"0\")\r\n      .attr(\"x2\", \"0\")\r\n      .attr(\"y1\", \"0\")\r\n      .attr(\"y2\", \"1\");\r\n    _.append(\"stop\")\r\n      .attr(\"stop-color\", colorOut(mapp(value_max)))\r\n      .attr(\"offset\", \"0%\");\r\n    _.append(\"stop\")\r\n      .attr(\"stop-color\", colorOut(mapp(value_min)))\r\n      .attr(\"offset\", \"100%\");\r\n\r\n    _timeSeriesSvg\r\n      .selectAll(\".extentValueGroup\")\r\n      .data(steadyValue !== false ? [steadyValue] : [value_min, value_max])\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr(\"class\", \"extentValueGroup\")\r\n      .attr(\"transform\", (d) => `translate(0,${valueScale(d)})`)\r\n      .call((_) => {\r\n        _.append(\"text\")\r\n          .attr(\"class\", \"extentText\")\r\n          .html((timeData) => this.printAbbr(timeData, true))\r\n          .attr(\"x\", timeseriesWidth + 6);\r\n        _.append(\"line\")\r\n          .attr(\"class\", \"extentLine\")\r\n          .attr(\"x1\", 0)\r\n          .attr(\"x2\", timeseriesWidth)\r\n          .attr(\"y1\", 0)\r\n          .attr(\"y2\", 0);\r\n      });\r\n\r\n    var maxChar = timeKeys.reduce(\r\n      (accum, key) => Math.max(accum, key._time_src.length),\r\n      0\r\n    );\r\n    var tickGapWidth = maxChar * 7;\r\n\r\n    var lastTickPos = 30000;\r\n    _timeSeriesSvg\r\n      .append(\"g\")\r\n      .attr(\"class\", \"extentYearGroup\")\r\n      .selectAll(\".extentYear\")\r\n      .data(timeKeys)\r\n      .enter()\r\n      .append(\"text\")\r\n      .attr(\"class\", \"extentYear\")\r\n      .attr(\"y\", 53)\r\n      .attr(\"x\", (tick) => timeScale(tick._time))\r\n      .html((tick) => tick._time_src)\r\n      .style(\"opacity\", (tick) => {\r\n        var newTickPos = timeScale(tick._time);\r\n        if (lastTickPos - newTickPos < tickGapWidth) return 0;\r\n        lastTickPos = newTickPos;\r\n        return 0.8;\r\n      });\r\n\r\n    _timeSeriesSvg\r\n      .append(\"g\")\r\n      .attr(\r\n        \"clip-path\",\r\n        'url(\"#RecordTimeseriesClip_' + _tempClipPathCounter + '\")'\r\n      )\r\n      .call((_g) => {\r\n        _g.append(\"path\")\r\n          .attr(\"class\", \"recordTimeseriesLine\")\r\n          .datum(timeData)\r\n          .attr(\"d\", Util.getLineGenerator(timeScale, valueScale))\r\n          .attr(\r\n            \"stroke\",\r\n            steadyValue !== false\r\n              ? colorOut(mapp(value_max))\r\n              : \"url(#GradientPath_\" + _tempClipPathCounter + \")\"\r\n          );\r\n\r\n        _g.selectAll(\".recordTimeseriesDot\")\r\n          .data(timeData.filter((_: TimeData) => !!_._value)) // only use the entries which have a _value set\r\n          .enter()\r\n          .append(\"circle\")\r\n          .attr(\"class\", \"recordTimeseriesDot\")\r\n          .attr(\"r\", 3)\r\n          .attr(\"cx\", (d) => timeScale(d._time))\r\n          .attr(\"cy\", (d) => valueScale(d._value))\r\n          .attr(\"fill\", (d) => colorOut(mapp(d._value)))\r\n          .tooltip(\r\n            (d) =>\r\n              \"<div class='recordColorInfo'>\" +\r\n              \"<span class='mapTooltipLabel'>\" +\r\n              \"<i class='fa fa-calendar'></i> \" +\r\n              d._time_src +\r\n              \"</span><br> \" +\r\n              \"<b><span class='mapTooltipValue'>\" +\r\n              this.getFormattedValue(d._value) +\r\n              \"</span></b>\" +\r\n              \"</div>\",\r\n            {\r\n              theme: \"dark timeseriesRecordDot\",\r\n              placement: \"top\",\r\n            }\r\n          )\r\n          .on(\"click\", (_event, d) => this.browser.recordDetailsPopup.updateFocusedTimeKey(d));\r\n      });\r\n  }\r\n}\r\n","import { select, pointer } from \"./d3_select\";\r\nimport { scaleQuantize } from \"d3-scale\";\r\nimport { max } from \"d3-array\";\r\nimport { format } from \"d3-format\";\r\nimport { hsl } from \"d3-color\";\r\nimport { geoBounds, geoPath, geoTransform } from \"d3-geo\";\r\n\r\nimport DOMPurify from \"dompurify/dist/purify.es\";\r\n\r\nimport { Aggregate_Category } from \"./Aggregate_Category\";\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Attrib_Set } from \"./Attrib_Set\";\r\nimport { Modal } from \"./UI/Modal\";\r\nimport { Block } from \"./Block\";\r\nimport { Base } from \"./Base\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Util } from \"./Util\";\r\n\r\nimport {\r\n  CompareType,\r\n  DropdownType,\r\n  MeasureType,\r\n  SummaryCatView,\r\n} from \"./Types\";\r\n\r\ndeclare let L: any;\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  max,\r\n  format,\r\n  hsl,\r\n  geoBounds,\r\n  geoPath,\r\n  geoTransform,\r\n  scaleQuantize,\r\n};\r\n\r\nexport class Block_Categorical extends Block {\r\n  // specific attribute type\r\n  public readonly attrib: Attrib_Categorical;\r\n  constructor(attrib: Attrib_Categorical) {\r\n    super(attrib);\r\n  }\r\n\r\n  get _aggrs(): Aggregate_Category[] {\r\n    return this.attrib._aggrs;\r\n  }\r\n\r\n  get setAttrib(): Attrib_Set | null {\r\n    return this.attrib.setAttrib;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Collapse / add / remove pansl\r\n  // ********************************************************************\r\n\r\n  setCollapsed(v: boolean): void {\r\n    super.setCollapsed(v);\r\n    if (this.leafletAttrMap && !this.collapsed) {\r\n      setTimeout(() => {\r\n        this.leafletAttrMap.invalidateSize();\r\n        this.catMap_zoomToActive();\r\n      }, 500);\r\n    }\r\n    if (this.collapsed && this.setAttrib) {\r\n      this.showSetMatrix(false);\r\n    }\r\n  }\r\n\r\n  onCollapse() {\r\n    if (!this.collapsed && this.DOM.root && this.isView_List) {\r\n      if (this.attrib.dirtySort) {\r\n        this.updateCatSorting_now();\r\n        this.refreshViz_All();\r\n      }\r\n      this.refreshLabelWidth();\r\n      this.catList_cullCategories();\r\n    }\r\n  }\r\n\r\n  addToPanel(panel, index, force = false) {\r\n    var _do = () => {\r\n      super.addToPanel(panel, index);\r\n\r\n      if (this.setAttrib) {\r\n        if (this.panel.name === \"left\" || this.panel.name === \"right\") {\r\n          this.setAttrib.block.refreshPopupSide();\r\n        } else {\r\n          this.hideSetMatrix();\r\n        }\r\n      }\r\n\r\n      this.browser.updateLayout();\r\n    };\r\n\r\n    if (\r\n      this._aggrs.length > 500 &&\r\n      this.attrib.minAggrSize.get() === 1 &&\r\n      !force\r\n    ) {\r\n      Modal.confirm(\r\n        \"<div style='text-align:center'>There are many (\" +\r\n          this._aggrs.length.toLocaleString() +\r\n          \") \" +\r\n          \"categories in \" +\r\n          this.attrib.attribName +\r\n          \".<br>\" +\r\n          \"Adding all can make your dashboard slower.<br><br>\" +\r\n          \"Would you like to hide categories with 5 or less records?</div>\",\r\n        \"Hide small categories\",\r\n        \"Show all categories\"\r\n      )\r\n        .then(async () => await this.attrib.minAggrSize.set(5))\r\n        .finally(() => _do());\r\n    } else {\r\n      _do();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // View type control\r\n  // ********************************************************************\r\n\r\n  public viewType: SummaryCatView = \"list\";\r\n\r\n  get isView_Dropdown() {\r\n    return this.viewType === \"dropdown\";\r\n  }\r\n  get isView_List() {\r\n    return this.viewType === \"list\";\r\n  }\r\n  get isView_Map() {\r\n    return this.viewType === \"map\";\r\n  }\r\n\r\n  async catViewAs(_type) {\r\n    if (_type === \"map\") {\r\n      try {\r\n        if (!this.attrib.catGeo) throw new Error(\"No mapping specified\");\r\n\r\n        if (!(window as any).L) {\r\n          await import(\"leaflet\");\r\n        }\r\n\r\n        await this.attrib.loadMap();\r\n\r\n        this.mapIsReady = false;\r\n      } catch (error) {\r\n        console.log(error);\r\n        Modal.alert(error.message);\r\n        this.catViewAs(\"list\");\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.viewType = _type;\r\n\r\n    this.noRefreshVizAxis = this.isView_Dropdown;\r\n\r\n    if (!this.DOM.inited) return;\r\n    this.DOM.root.attr(\"viewType\", this.viewType);\r\n    this.DOM.root.selectAll(\".summaryViewAs\").classed(\"active\", false);\r\n    this.DOM.root\r\n      .selectAll(\".summaryViewAs_\" + this.viewType)\r\n      .classed(\"active\", true);\r\n\r\n    if (this.viewType === \"list\") {\r\n      this.list_prepView();\r\n    } else if (this.viewType === \"map\") {\r\n      this.catMap_prepView();\r\n    } else if (this.viewType === \"dropdown\") {\r\n      this.dropdown_prepView();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Height\r\n  // ********************************************************************\r\n\r\n  private _height_Categories = 0;\r\n\r\n  public heightRow_category_dirty = false;\r\n\r\n  get height_Categories(): number {\r\n    return this._height_Categories;\r\n  }\r\n  get height_Content(): number {\r\n    if (!this.isVisible()) return 0;\r\n    if (this.isView_Dropdown) return this.height_Dropdown;\r\n    return (\r\n      this._height_Categories + this.height_Config + this.height_Bottom + 1\r\n    );\r\n  }\r\n  get height_RangeMin(): number {\r\n    if (this.attrib.isEmpty()) return this.height_Header;\r\n    if (this.isView_Dropdown) return this.height_Dropdown;\r\n    if (this.isView_Map) return this.getWidth() * 0.2;\r\n    return this.height_ListWithoutCats + 1.5 * this.heightCat;\r\n  }\r\n  get height_RangeMax(): number {\r\n    if (this.attrib.isEmpty()) return this.height_Header;\r\n    if (this.isView_Dropdown) return this.height_Dropdown;\r\n    if (this.isView_Map) return this.getWidth() * 1.5;\r\n    return this.height_ListWithoutCats + this._aggrs.length * this.heightCat;\r\n  }\r\n  get heightCat(): number {\r\n    return this.attrib.barHeight.get();\r\n  }\r\n  get height_Dropdown(): number {\r\n    return 42;\r\n  }\r\n  get height_ListWithoutCats(): number {\r\n    return this.height_Header + this.height_Config + this.height_Bottom;\r\n  }\r\n  get height_VisibleAttrib(): number {\r\n    return this.catCount_Active * this.heightCat;\r\n  }\r\n  get height_Config(): number {\r\n    return 18 * (this.hasTextSearch() ? 1 : 0);\r\n  }\r\n  get height_bar_topGap(): number {\r\n    return this.heightCat > 20 ? 4 : 2;\r\n  }\r\n  get barHeight_Full(): number {\r\n    return this.heightCat - 2 * this.height_bar_topGap;\r\n  }\r\n  get height_Bottom(): number {\r\n    if (\r\n      !this.areAllCatsInDisplay() ||\r\n      !this.panel.hiddenCatBars() ||\r\n      this._aggrs.length > 4\r\n    ) {\r\n      this.DOM.summaryCategorical?.classed(\"nobottoms\", false);\r\n      return Base.height_CatBottom;\r\n    }\r\n    this.DOM.summaryCategorical?.classed(\"nobottoms\", true);\r\n    return 0;\r\n  }\r\n  /** -- */\r\n  get catLabelFontSize() {\r\n    var fontSize = this.heightCat - 2;\r\n    if (this.heightCat > 15) fontSize = 13;\r\n    if (this.heightCat > 25) fontSize = 15;\r\n    if (this.heightCat > 30) fontSize = 17;\r\n    if (this.heightCat > 35) fontSize = 19;\r\n    return fontSize;\r\n  }\r\n\r\n  hasStaticHeight(): boolean {\r\n    return this.isView_Dropdown;\r\n  }\r\n\r\n  setHeight(targetHeight: number): void {\r\n    if (this.attrib.isEmpty()) return;\r\n    // take into consideration the other components in the summary\r\n    targetHeight -=\r\n      this.height_Header + this.height_Config + this.height_Bottom;\r\n\r\n    if (this.isView_Map) {\r\n      this._height_Categories = targetHeight;\r\n      setTimeout(() => {\r\n        if (this.leafletAttrMap) this.leafletAttrMap.invalidateSize();\r\n      }, 700);\r\n      return;\r\n    }\r\n\r\n    this._height_Categories = Math.min(\r\n      targetHeight,\r\n      this.heightCat * this.catCount_Active - 1\r\n    );\r\n  }\r\n  refreshHeight_Category() {\r\n    if (!this.DOM.inited) return;\r\n    if (!this.isView_List) return;\r\n\r\n    this.heightRow_category_dirty = false;\r\n\r\n    this.browser.updateLayout();\r\n\r\n    this.DOM.aggrGlyphs.style(\"transform\", (_cat) => _cat.transformPos);\r\n\r\n    this.refreshHeight_Category_do();\r\n  }\r\n  /** -- */\r\n  refreshHeight_Category_do() {\r\n    this.DOM.aggrGlyphs.style(\"height\", this.heightCat + \"px\");\r\n\r\n    this.DOM.root\r\n      .selectAll(\".catLabel\")\r\n      .style(\"font-size\", this.catLabelFontSize + \"px\");\r\n\r\n    this.DOM.chartBackground.style(\"height\", this.height_VisibleAttrib + \"px\");\r\n\r\n    this.DOM.catChart.classed(\r\n      \"multiLine\",\r\n      this.heightCat >= 56 && // 4x\r\n        this.DOM.root.node().style.webkitLineClamp !== undefined\r\n    );\r\n\r\n    this.refreshViz_All();\r\n  }\r\n\r\n  refreshHeight() {\r\n    super.refreshHeight();\r\n    if (this.attrib.isEmpty() || !this.inDashboard || !this.DOM.inited) return;\r\n    if (this.isView_Dropdown) return;\r\n\r\n    // It can be collapsed! - don't use \"isVisible\" fucntion here\r\n    if (this.collapsed) {\r\n      if (this.isView_Map) this.DOM.catMap_Base.style(\"height\", \"0px\");\r\n      return;\r\n    }\r\n\r\n    // update catCount_InDisplay\r\n    var c = Math.floor(this._height_Categories / this.heightCat);\r\n    if (c < 0) c = 1;\r\n    if (c > this.catCount_Active) c = this.catCount_Active;\r\n    if (this.catCount_Active <= 2) {\r\n      c = this.catCount_Active;\r\n    } else {\r\n      c = Math.max(c, 2);\r\n    }\r\n    this.catCount_InDisplay = c + 1;\r\n    this.catCount_InDisplay = Math.min(\r\n      this.catCount_InDisplay,\r\n      this.catCount_Active\r\n    );\r\n\r\n    this.refreshScrollDisplayMore(\r\n      this.firstCatIndexInView + this.catCount_InDisplay\r\n    );\r\n\r\n    this.updateCats_IsVisible();\r\n    this.catList_cullCategories();\r\n\r\n    this.DOM.headerGroup.attr(\"allCatsInDisplay\", this.areAllCatsInDisplay());\r\n\r\n    if (this.isView_Map) {\r\n      this.DOM.catMap_Base.style(\"height\", null);\r\n      if (this.leafletAttrMap) this.leafletAttrMap.invalidateSize();\r\n    }\r\n  }\r\n\r\n  catList_cullCategories() {\r\n    if (!this.isView_List) return;\r\n    if (!this.DOM.aggrGlyphs) return;\r\n    this.DOM.aggrGlyphs\r\n      .style(\"display\", (_cat) => (_cat.isVisible ? null : \"none\"))\r\n      .style(\"opacity\", (_cat) => (_cat.isVisible ? 1 : 0))\r\n      .style(\"transform\", (_cat) =>\r\n        _cat.isVisible ? `translate(0px,${_cat.posY}px)` : null\r\n      );\r\n\r\n    if (this.setAttrib && !this.setAttrib.block.pausePanning) {\r\n      this.setAttrib.block.refreshSVGViewBox();\r\n    }\r\n  }\r\n\r\n  refreshConfigRowCount() {\r\n    this.DOM.summaryControls?.style(\r\n      \"display\",\r\n      this.hasTextSearch() ? \"block\" : null\r\n    );\r\n    this.DOM.wrapper?.classed(\"showMeasureAxis_2\", this.hasTextSearch());\r\n    this.DOM.catTextSearch?.classed(\"active\", this.hasTextSearch());\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Width\r\n  // ********************************************************************\r\n\r\n  get width_CatLabel() {\r\n    return this.isVisible() ? this.panel.width_CatLabel : 0;\r\n  }\r\n  get width_CatMeasureLabel() {\r\n    return this.isVisible() ? this.panel.width_CatMeasureLabel : 0;\r\n  }\r\n  get width_CatText() {\r\n    return this.isVisible() ? this.panel.width_CatText : 0;\r\n  }\r\n  get width_CatChart() {\r\n    return this.isVisible() ? this.panel.width_CatBars : 1;\r\n  }\r\n  refreshWidth(): void {\r\n    if (!this.DOM.summaryCategorical) return;\r\n    this.attrib.updateChartScale_Measure(); // refreshes viz axis if needed\r\n    if (this.isView_List) {\r\n      this.DOM.chartAxis_Measure.style(\"width\", this.width_CatChart + 5 + \"px\");\r\n    }\r\n    if (this.isView_Map && this.mapIsReady) {\r\n      this.leafletAttrMap.invalidateSize();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Text search\r\n  // ********************************************************************\r\n\r\n  skipTextSearchClear: boolean = false;\r\n\r\n  hasTextSearch(): boolean {\r\n    return this._aggrs.length >= 15;\r\n  }\r\n\r\n  initDOM_CatTextSearch() {\r\n    var me = this;\r\n    this.DOM.catTextSearch = this.DOM.summaryControls\r\n      .append(\"div\")\r\n      .attr(\"class\", \"textSearchBox catTextSearch hasLabelWidth\");\r\n\r\n    this.DOM.catTextSearch.append(\"span\").attr(\"class\", \"fa fa-search\");\r\n    this.DOM.catTextSearch\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa fa-times-circle\")\r\n      .tooltip(i18n.ClearTextSearch)\r\n      .on(\"click\", () => this.attrib.summaryFilter.clearFilter());\r\n    this.DOM.catTextSearchInput = this.DOM.catTextSearch\r\n      .append(\"input\")\r\n      .attr(\"class\", \"textSearchInput\")\r\n      .attr(\"type\", \"text\")\r\n      .attr(\"placeholder\", \"...\")\r\n      .tooltip(i18n.Search)\r\n      .on(\"keydown\", (event) => event.stopPropagation())\r\n      .on(\"keypress\", (event) => event.stopPropagation())\r\n      .on(\"keyup\", (event) => event.stopPropagation())\r\n      .on(\"input\", function () {\r\n        this.tippy.hide();\r\n        if (this.timer) clearTimeout(this.timer);\r\n        var x = this;\r\n        this.timer = setTimeout(function () {\r\n          me.attrib.unselectAllCategories();\r\n          var query = [];\r\n\r\n          // split the query by \" character\r\n          var processed = x.value.toLowerCase().split('\"');\r\n          processed.forEach((block, i) => {\r\n            if (i % 2 === 0) {\r\n              block.split(/\\s+/).forEach((q) => query.push(q));\r\n            } else {\r\n              query.push(block);\r\n            }\r\n          });\r\n\r\n          // Remove the empty strings\r\n          query = query.filter((v) => v !== \"\");\r\n\r\n          if (query.length > 0) {\r\n            me.DOM.catTextSearch.classed(\"showClear\", true);\r\n            me._aggrs.forEach((_cat) => {\r\n              var catLabel = _cat.label.toString().toLowerCase();\r\n              var f = query.every((query_str) => {\r\n                if (catLabel.indexOf(query_str) !== -1) {\r\n                  return true;\r\n                }\r\n                return false;\r\n              });\r\n              if (f) {\r\n                _cat.set_OR(me.attrib.summaryFilter.selected_OR);\r\n              } else {\r\n                _cat.set_NONE();\r\n              }\r\n            });\r\n\r\n            // All categories are process, and the filtering state is set. Now, process the summary as a whole\r\n            if (me.attrib.summaryFilter.selectedCount_Total() === 0) {\r\n              me.skipTextSearchClear = true;\r\n              me.attrib.summaryFilter.clearFilter();\r\n              me.skipTextSearchClear = false;\r\n            } else {\r\n              me.attrib.summaryFilter.how = \"All\";\r\n              me.attrib.noValueAggr.filtered = false;\r\n              me.attrib.summaryFilter.setFiltered();\r\n            }\r\n          } else {\r\n            me.attrib.summaryFilter.clearFilter();\r\n          }\r\n        }, 750);\r\n      });\r\n  }\r\n\r\n  clearCatTextSearch() {\r\n    if (!this.hasTextSearch()) return;\r\n    if (this.skipTextSearchClear) return;\r\n    if (!this.DOM.catTextSearch) return;\r\n    this.DOM.catTextSearch.classed(\"showClear\", false);\r\n    this.DOM.catTextSearchInput.node().value = \"\";\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Managing in-display / visible categories\r\n  // ********************************************************************\r\n\r\n  isCatActive(_cat: Aggregate_Category) {\r\n    if (!_cat.usedAggr) return false;\r\n    if (_cat.isFiltered()) return true;\r\n    if (_cat.recCnt('Active') !== 0) return true;\r\n    if (!this.attrib.isFiltered()) return _cat.recCnt('Active') !== 0;\r\n    if (this.viewType === \"map\") return _cat.recCnt('Active') !== 0;\r\n    // Hide if multiple options are selected and selection is and\r\n    //        if(this.summaryFilter.selecttype===\"SelectAnd\") return false;\r\n    // TO-DO: Figuring out non-selected, zero-active-item attribs under \"SelectOr\" is tricky!\r\n    return true;\r\n  }\r\n\r\n  public catCount_InDisplay = 0;\r\n  public catCount_Active: number;\r\n  private firstCatIndexInView = 0;\r\n\r\n  areAllCatsInDisplay() {\r\n    return this.catCount_Active === this.catCount_InDisplay;\r\n  }\r\n  updateCats_IsActive() {\r\n    this.catCount_Active = 0;\r\n    this._aggrs.forEach((_cat) => {\r\n      _cat.isActiveBefore = _cat.isActive;\r\n      _cat.isActive = this.isCatActive(_cat);\r\n      if (_cat.isActive) this.catCount_Active++;\r\n    });\r\n    if (this.attrib.catOrder_Fixed) {\r\n      // if fixed, categories do not roll up on each other, the total count is still original count\r\n      this.catCount_Active = this._aggrs.length;\r\n    }\r\n  }\r\n  updateCats_IsVisible() {\r\n    var maxVisibleNumCats = Math.ceil(\r\n      (this.scrollTop_cache + this._height_Categories) / this.heightCat\r\n    );\r\n    this._aggrs.forEach((_cat) => {\r\n      _cat.isVisibleBefore = _cat.isVisible;\r\n      _cat.isVisible =\r\n        this.viewType === \"map\"\r\n          ? true\r\n          : _cat.isActive &&\r\n            _cat.orderIndex >= this.firstCatIndexInView &&\r\n            _cat.orderIndex < maxVisibleNumCats;\r\n    });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Active / Compare visualizations\r\n  // ********************************************************************\r\n\r\n  vizSideBySide() {\r\n    if (this.browser.stackedChart) return false;\r\n    if (this.browser.activeComparisonsCount < 2) return false;\r\n    if (!this.attrib.isComparedAttrib()) return true;\r\n    return this.attrib.isMultiValued && this.splitOnSelfCompare;\r\n  }\r\n\r\n  refreshViz_Active() {\r\n    if (!this.isVisible()) return;\r\n\r\n    if (this.isView_Dropdown) return;\r\n    if (!this.attrib.chartScale_Measure) return;\r\n\r\n    if (this.isView_Map && this.mapIsReady) {\r\n      this.catMap_refreshVis(\"Active\");\r\n      return;\r\n    }\r\n\r\n    if (this.isView_List) {\r\n      var baseline = this.measureLineZero;\r\n\r\n      this.refreshViz_Cache(\"Active\", null);\r\n\r\n      this.DOM.aggrGlyphs.classed(\r\n        \"NoActiveRecords\",\r\n        (aggr) => aggr.Active.measure === 0\r\n      );\r\n\r\n      this.DOM.measure_Active.style(\r\n        \"transform\",\r\n        (aggr) =>\r\n          `translate(${baseline + aggr.offset(\"Active\")}px, ${\r\n            this.height_bar_topGap\r\n          }px) ` + `scale(${aggr.scale(\"Active\")}, ${this.barHeight_Full})`\r\n      );\r\n\r\n      this.refreshMeasureLabelText(\"Active\");\r\n      this.refreshMeasureLabelPos(\"Active\", -1);\r\n    }\r\n  }\r\n\r\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\r\n    if (!this.isVisible()) return;\r\n\r\n    if (this.isView_Dropdown) {\r\n      this.dropdown_refreshCategories(); // might change the assigned colors\r\n      return;\r\n    }\r\n\r\n    this.refreshMeasureLabelText(cT);\r\n\r\n    if (cT === \"Compare_A\") {\r\n      this.refreshViz_NoValueAggr();\r\n    }\r\n\r\n    if (this.isView_List) {\r\n      var baseline = this.measureLineZero;\r\n      var _translateY = this.height_bar_topGap;\r\n      var barHeight = this.barHeight_Full;\r\n\r\n      // adjust position if sidebyside\r\n      if (this.vizSideBySide()) {\r\n        barHeight = barHeight / totalGroups;\r\n        _translateY += barHeight * curGroup;\r\n      }\r\n\r\n      this.refreshViz_Cache(cT, prevCts);\r\n      this.refreshMeasureLabelPos(cT, curGroup);\r\n\r\n      var onlySelectedNoSplit =\r\n        true &&\r\n        !this.browser.stackedChart &&\r\n        this.attrib.isComparedAttrib() &&\r\n        this.attrib.isMultiValued &&\r\n        !this.splitOnSelfCompare;\r\n\r\n      var _do = (scaleX) => {\r\n        this.DOM[\"measure_\" + cT].style(\r\n          \"transform\",\r\n          (aggr: Aggregate_Category) => {\r\n            if (onlySelectedNoSplit) scaleX = aggr.compared === cT;\r\n\r\n            return `translate(${\r\n              baseline + aggr.offset(cT)\r\n            }px, ${_translateY}px) scale(${\r\n              scaleX ? aggr.scale(cT) : 0\r\n            }, ${barHeight})`;\r\n          }\r\n        );\r\n      };\r\n\r\n      if (curGroup === totalGroups - 1 && this.browser.addedCompare) {\r\n        _do(false); // sets scaleX to zero, - I believe this was for animation purposes\r\n      }\r\n      _do(true);\r\n    }\r\n\r\n    if (this.isView_Map && this.mapIsReady && this.attrib.vizActive(cT)) {\r\n      if (this.attrib.isComparedAttrib() && !this.attrib.isMultiValued) return;\r\n      this.catMap_refreshVis(cT);\r\n    }\r\n  }\r\n\r\n  // Overwrites base class\r\n  chartAxis_Measure_TickSkip(): number {\r\n    var width = this.width_CatChart;\r\n    var widthPerTick = 35;\r\n\r\n    if (this.attrib.getPeakAggr(d3.max, \"Active\") > 100000) {\r\n      widthPerTick += 12; // k,m etc\r\n    }\r\n\r\n    if (this.browser.percentBreakdown) {\r\n      widthPerTick += 11; // %\r\n    } else if (this.browser.measureFunc.get() !== \"Count\") {\r\n      var unitName = this.browser.measureSummary.get()?.unitName;\r\n      if (unitName) widthPerTick += 2 + unitName.length * 9;\r\n    }\r\n\r\n    return width / widthPerTick;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Set matrix - multi valuied control\r\n  // ********************************************************************\r\n\r\n  private show_set_matrix = false;\r\n  public splitOnSelfCompare = true;\r\n\r\n  showSetMatrix(v: boolean) {\r\n    if (!this.isView_List && v === true) {\r\n      return;\r\n    }\r\n    this.show_set_matrix = v;\r\n    this.refreshShowSetMatrix();\r\n  }\r\n  hideSetMatrix() {\r\n    this.showSetMatrix(false);\r\n  }\r\n\r\n  refreshShowSetMatrix() {\r\n    this.DOM.root?.classed(\"show_set_matrix\", this.show_set_matrix);\r\n\r\n    if (this.show_set_matrix) {\r\n      this.attrib.showSetSummary();\r\n    } else if (this.setAttrib) {\r\n      this.attrib.setSortingOption(\"Active\"); // back to dynamic order\r\n      this.updateCatSorting(0); // no delay, animated\r\n    }\r\n  }\r\n\r\n  initDOM(beforeDOM): boolean {\r\n    this.attrib.initializeAggregates();\r\n    if (this.attrib.isEmpty()) return false;\r\n    if (this.DOM.inited) return true;\r\n\r\n    this.insertRoot(beforeDOM);\r\n\r\n    this.DOM.root\r\n      .attr(\"viewType\", this.viewType)\r\n      .classed(\"hasMultiAnd\", this.attrib.summaryFilter.selected_AND.length > 1)\r\n      .classed(\"isMultiValued\", this.attrib.isMultiValued)\r\n      .classed(\"supportsSetMatrix\", this.attrib.supportsSetMatrix)\r\n      .attr(\"hasMap\", this.attrib.catGeo !== null);\r\n\r\n    this.DOM.summaryCategorical = this.DOM.wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"summaryCategorical\");\r\n\r\n    if (!this.isView_Dropdown) {\r\n      this.init_DOM_Cat();\r\n    }\r\n\r\n    this.setCollapsed(this.collapsed);\r\n\r\n    this.DOM.inited = true;\r\n    this.catViewAs(this.viewType);\r\n\r\n    this.refreshShowSetMatrix();\r\n\r\n    return true;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Main block setup (header / root)\r\n  // ********************************************************************\r\n\r\n  insertHeader() {\r\n    super.insertHeader();\r\n    [\r\n      [\r\n        \"summaryViewAs setMatrixButton\",\r\n        \"ViewSetMatrix\",\r\n        \"fa fa-tags\",\r\n        () => this.showSetMatrix(!this.show_set_matrix),\r\n      ],\r\n      [\r\n        \"summaryViewAs summaryViewAs_list\",\r\n        \"ViewAsList\",\r\n        \"fa fa-list-ul\",\r\n        () => this.catViewAs(\"list\"),\r\n      ],\r\n      [\r\n        \"summaryViewAs summaryViewAs_map\",\r\n        \"ViewAsMap\",\r\n        \"fa fa-globe\",\r\n        () => this.catViewAs(\"map\"),\r\n      ],\r\n    ].forEach((button: any[], i, arr) => {\r\n      this.DOM.summaryIcons\r\n        .append(\"span\")\r\n        .attr(\"class\", button[0])\r\n        .tooltip(i18n[button[1]], { placement: \"bottom\" })\r\n        .on(\"click\", button[3])\r\n        .append(\"div\")\r\n        .attr(\"class\", button[2]);\r\n    });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering\r\n  // ********************************************************************\r\n\r\n  onClearFilter(forceUpdate) {\r\n    this.attrib.noValueAggr.filtered = false;\r\n    this.attrib.unselectAllCategories();\r\n    this.clearCatTextSearch();\r\n    if (forceUpdate !== false && this.isView_Dropdown) {\r\n      this.dropdown_refreshCategories();\r\n    }\r\n    this.DOM.root?.classed(\"hasMultiAnd\", false);\r\n  }\r\n\r\n  updateAfterFilter(refreshViz = true): void {\r\n    if (!this.isVisible()) {\r\n      this.attrib.dirtySort = true;\r\n      return;\r\n    }\r\n\r\n    if (this.isView_Dropdown) {\r\n      if (!this.attrib.dirtySort) this.updateCatSorting_now();\r\n      this.dropdown_refreshCategories();\r\n      return;\r\n    }\r\n\r\n    this.refreshViz_NoValueAggr();\r\n    this.refreshMeasureLabelText(\"Active\");\r\n\r\n    if (this.isView_Map) {\r\n      this.attrib.updateChartScale_Measure(true); // skep refresh viz\r\n      this.updateCats_IsActive();\r\n      this.refreshViz_Active(); // maps can only visualize \"active\" selection.\r\n      return;\r\n    }\r\n\r\n    if (this.show_set_matrix) this.attrib.dirtySort = true;\r\n\r\n    if (!this.attrib.dirtySort) this.updateCatSorting();\r\n\r\n    if (refreshViz) {\r\n      this.attrib.updateChartScale_Measure(true); // skep refresh viz\r\n      this.refreshViz_All();\r\n    }\r\n  }\r\n\r\n  refreshLabelWidth() {\r\n    if (!this.isVisible()) return;\r\n    if (!this.DOM.summaryCategorical) return;\r\n    if (!this.isView_List) return;\r\n\r\n    this.DOM.chartCatLabelResize.style(\"left\", `${this.width_CatLabel}px`);\r\n\r\n    this.DOM.summaryCategorical\r\n      .selectAll(\".hasLabelWidth\")\r\n      .style(\"width\", `${this.width_CatLabel}px`);\r\n\r\n    this.DOM.measureLabelGroup.style(\r\n      \"width\",\r\n      `${this.width_CatMeasureLabel}px`\r\n    );\r\n\r\n    this.DOM.chartAxis_Measure.style(\r\n      \"transform\",\r\n      `translateX(${this.width_CatText}px)`\r\n    );\r\n  }\r\n\r\n  refreshScrollDisplayMore(bottomItem) {\r\n    if (!this.isView_List) {\r\n      return;\r\n    }\r\n    this.DOM.catSortButton.style(\r\n      \"display\",\r\n      this._aggrs.length === 1 ? \"none\" : null\r\n    );\r\n    if (this.catCount_Active <= 4) {\r\n      this.DOM.scroll_display_more.style(\"display\", \"none\");\r\n      return;\r\n    }\r\n    var below = this.catCount_Active - bottomItem;\r\n    var moreTxt = `<span class='rowCount ${below ? \" hasMore\" : \"\"}'>${\r\n      this.catCount_Active\r\n    } ${i18n.Rows}</span>`;\r\n    if (below > 0)\r\n      moreTxt += ` <span class='belowCount'>${below} ${i18n.More} <span class='fa fa-angle-double-down'></span></span>`;\r\n    this.DOM.scroll_display_more.html(moreTxt);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Mapping\r\n  // ********************************************************************\r\n\r\n  private leafletAttrMap: any = null;\r\n  private mapIsReady: any;\r\n  public invertedColorTheme: any;\r\n  private mapColorScale: any;\r\n  private mapBounds_Active: any;\r\n  private geoPath: any;\r\n  private mapConfig: any; // todo\r\n\r\n  removeCatGeo() {\r\n    if (this.viewType === \"map\") {\r\n      this.catViewAs(\"list\");\r\n    }\r\n    this.DOM.root?.attr(\"hasMap\", false);\r\n    this.leafletAttrMap?.remove();\r\n    this.leafletAttrMap = null;\r\n  }\r\n\r\n  catMap_projectCategories() {\r\n    if (!this.panel) return;\r\n    // the following is temporary\r\n    var missingRegions = [];\r\n    this.DOM.measure_Active.attr(\"d\", (aggr, i, nodes) => {\r\n      if (!aggr._geo_) {\r\n        missingRegions.push(aggr.label);\r\n        nodes[i].parentNode.style.display = \"none\";\r\n        return;\r\n      }\r\n      return this.geoPath(aggr._geo_);\r\n    });\r\n\r\n    this.DOM.root\r\n      .select(\".mapView-UnmatchedData\")\r\n      .classed(\"active\", missingRegions.length > 0);\r\n\r\n    this.DOM.measureLabel\r\n      .attr(\"transform\", (_cat) => {\r\n        var centroid = this.geoPath.centroid(_cat._geo_);\r\n        return `translate(${centroid[0]},${centroid[1]})`;\r\n      })\r\n      .style(\"display\", (_cat) => {\r\n        var bounds = this.geoPath.bounds(_cat._geo_);\r\n        var width = Math.abs(bounds[0][0] - bounds[1][0]);\r\n        return width < this.width_CatMeasureLabel ? \"none\" : \"block\";\r\n      });\r\n  }\r\n\r\n  catMap_refreshBounds_Active() {\r\n    this.mapBounds_Active = this.catMap_getBounds(true);\r\n  }\r\n\r\n  catMap_zoomToActive(fly = false) {\r\n    if (this.attrib.mapInitView) {\r\n      this.leafletAttrMap.setView(\r\n        L.latLng(this.attrib.mapInitView[0], this.attrib.mapInitView[1]),\r\n        this.attrib.mapInitView[2]\r\n      );\r\n      this.attrib.mapInitView = null;\r\n      return;\r\n    }\r\n\r\n    if (fly) {\r\n      this.leafletAttrMap.flyToBounds(\r\n        this.mapBounds_Active,\r\n        this.mapConfig.flyConfig\r\n      );\r\n    } else {\r\n      this.leafletAttrMap.fitBounds(this.mapBounds_Active);\r\n      // there's a bug that makes the map not set the bounds correctly first time\r\n      //window.setTimeout(() => this.leafletAttrMap.fitBounds(this.mapBounds_Active), 100);\r\n    }\r\n  }\r\n\r\n  catMap_setMaxBounds() {\r\n    this.leafletAttrMap.setMaxBounds(this.catMap_getBounds());\r\n  }\r\n\r\n  catMap_getBounds(onlyActive = false) {\r\n    var bs = [];\r\n    // Insert the bounds for each record path into the bs\r\n    this._aggrs.forEach((_cat) => {\r\n      if (!_cat._geo_) return;\r\n      if (onlyActive && !_cat.isActive) return;\r\n      // get bounding box, cached in _geo_ property\r\n      var b = _cat._geo_._bounds;\r\n      if (b === undefined) {\r\n        b = d3.geoBounds(_cat._geo_);\r\n        if (isNaN(b[0][0])) {\r\n          b = null;\r\n        }\r\n        _cat._geo_._bounds = b;\r\n      }\r\n      if (b === null) return;\r\n      var p1 = L.latLng(b[0][1], b[0][0]);\r\n      var p2 = L.latLng(b[1][1], b[1][0]);\r\n      bs.push(p1);\r\n      bs.push(p2);\r\n    });\r\n    if (bs.length === 0) {\r\n      return this.catMap_getBounds(false); // not only active.\r\n    }\r\n    return Util.addMarginToBounds(new L.latLngBounds(bs));\r\n  }\r\n\r\n  catMap_invertColorTheme(v = null) {\r\n    if (v === null) v = !this.invertedColorTheme; // invert\r\n    this.invertedColorTheme = v;\r\n    if (this.mapColorScale) {\r\n      this.mapColorScale.range(this.invertedColorTheme ? [9, 0] : [0, 9]);\r\n      this.catMap_refreshColorScale();\r\n      this.refreshViz_All();\r\n      this.DOM.root\r\n        .select(\".editColorTheme.fa-adjust\")\r\n        .classed(\"rotatedY\", this.invertedColorTheme);\r\n    }\r\n  }\r\n\r\n  catMap_refreshColorScale() {\r\n    if (!this.DOM.mapColorBlocks) return;\r\n    var colorTheme = this.browser.colorTheme.getDiscrete(9);\r\n    if (this.invertedColorTheme) {\r\n      colorTheme = colorTheme.reverse();\r\n    }\r\n\r\n    this.DOM.mapColorBlocks\r\n      .style(\"background-color\", (d) => colorTheme[d])\r\n      .style(\"transform\", (d) => {\r\n        var left = (100 * d) / 9;\r\n        var right = (100 * (d + 1)) / 9;\r\n        return (\r\n          \"translateX(\" +\r\n          left +\r\n          \"%) scaleX(\" +\r\n          Math.abs(right - left) / 100 +\r\n          \")\"\r\n        );\r\n      });\r\n  }\r\n\r\n  catMap_prepView() {\r\n    if (this.setAttrib) this.showSetMatrix(false);\r\n\r\n    if (this.leafletAttrMap) {\r\n      // The map view was already initialized\r\n\r\n      this.leafletAttrMap.invalidateSize();\r\n\r\n      this.DOM.aggrGroup = this.DOM.summaryCategorical.select(\r\n        \".catMap_SVG > .aggrGroup\"\r\n      );\r\n      this.refreshDOMcats();\r\n\r\n      this.mapIsReady = true;\r\n\r\n      //  No longer resetting the zoom after switching back to an already existing map.\r\n      //  this.catMap_refreshBounds_Active();\r\n      //  this.catMap_zoomToActive();\r\n\r\n      this.catMap_projectCategories();\r\n      this.refreshViz_Active();\r\n      this.refreshViz_All();\r\n      return;\r\n    }\r\n\r\n    this.mapConfig = Util.mergeConfig(Base.map, this.attrib.mapConfig || {});\r\n\r\n    var me = this;\r\n    this.leafletAttrMap = L.map(\r\n      this.DOM.catMap_Base.node(),\r\n      this.mapConfig.leafConfig\r\n    )\r\n      .addLayer(\r\n        new L.TileLayer(this.mapConfig.tileTemplate, this.mapConfig.tileConfig)\r\n      )\r\n      .on(\"viewreset\", () => this.catMap_projectCategories())\r\n      .on(\"movestart\", function () {\r\n        me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n        this._zoomInit_ = this.getZoom();\r\n        me.DOM.catMap_SVG.style(\"opacity\", 0.3);\r\n      })\r\n      .on(\"moveend\", function () {\r\n        me.browser.DOM.root.classed(\"noPointerEvents\", false);\r\n        me.DOM.catMap_SVG.style(\"opacity\", null);\r\n        if (this._zoomInit_ !== this.getZoom()) me.catMap_projectCategories();\r\n      });\r\n\r\n    this.leafletAttrMap.attributionControl.setPosition(\"topright\");\r\n\r\n    this.geoPath = d3.geoPath().projection(\r\n      d3.geoTransform({\r\n        // Use Leaflet latLngToLayerPoint to implement a D3 geometric transformation.\r\n        point: function (x, y) {\r\n          var point = me.leafletAttrMap.latLngToLayerPoint(L.latLng(y, x));\r\n          this.stream.point(point.x, point.y);\r\n        },\r\n      })\r\n    );\r\n\r\n    this.DOM.catMap_SVG = d3\r\n      .select(this.leafletAttrMap.getPanes().overlayPane)\r\n      .append(\"svg\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n      .attr(\"class\", \"catMap_SVG\");\r\n\r\n    // The fill pattern definition in SVG, used to denote geo-objects with no data.\r\n    // http://stackoverflow.com/questions/17776641/fill-rect-with-pattern\r\n    this.DOM.catMap_SVG\r\n      .append(\"defs\")\r\n      .append(\"pattern\")\r\n      .attr(\"id\", \"diagonalHatch\")\r\n      .attr(\"patternUnits\", \"userSpaceOnUse\")\r\n      .attr(\"width\", 4)\r\n      .attr(\"height\", 4)\r\n      .append(\"path\")\r\n      .attr(\"d\", \"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2\")\r\n      .attr(\"stroke\", \"gray\")\r\n      .attr(\"stroke-width\", 1);\r\n\r\n    // Add custom controls\r\n\r\n    var X;\r\n    X = this.DOM.summaryCategorical\r\n      .append(\"div\")\r\n      .attr(\"class\", \"visViewControl ViewControlGroup\");\r\n\r\n    X.append(\"div\")\r\n      .attr(\"class\", \"visViewControlButton fa fa-plus\")\r\n      .tooltip(i18n.ZoomIn)\r\n      .on(\"click\", () => this.leafletAttrMap.zoomIn());\r\n    X.append(\"div\")\r\n      .attr(\"class\", \"visViewControlButton fa fa-minus\")\r\n      .tooltip(i18n.ZoomOut)\r\n      .on(\"click\", () => this.leafletAttrMap.zoomOut());\r\n    X.append(\"div\")\r\n      .attr(\"class\", \"visViewControlButton viewFit fa fa-expand-arrows-alt\")\r\n      .tooltip(i18n.ZoomToFit)\r\n      .on(\"click\", (event) => {\r\n        this.catMap_refreshBounds_Active();\r\n        this.catMap_zoomToActive(true);\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n\r\n    X.append(\"div\")\r\n      .attr(\r\n        \"class\",\r\n        \"visViewControlButton mapView-UnmatchedData fa fa-exclamation\"\r\n      )\r\n      .tooltip(i18n.MissingLocations)\r\n      .on(\"click\", () => {\r\n        var missingRegions = [];\r\n        this._aggrs.forEach((_cat) => {\r\n          if (_cat._geo_ === undefined)\r\n            missingRegions.push(\r\n              _cat.label +\r\n                ` <span style='color: gray; font-weight:300; font-size: 0.9em;'>[${_cat.recCnt(\r\n                  \"Total\"\r\n                )} ${this.browser.recordName}\"]</span>`\r\n            );\r\n        });\r\n        Modal.alert(\r\n          \"The following regions do not appear on the map.<br><br>\" +\r\n            missingRegions.join(\", \") +\r\n            \"<br><br>\" +\r\n            \"<span style='font-size: 0.9em; color: gray; font-weight: 300'>\" +\r\n            \"Please see the list of standard region names \" +\r\n            \"<a style='color: gray; text-decoration: underline;' href='https://docs.google.com/spreadsheets/d/1DKNXwsJy6_Mdy3ofwbBIZeBGrxSItYOJXNZgLyu0IM4' target='_blank'>here</a>.<br>\" +\r\n            \"If the place names above are misspelled, please update your data source.<span>\"\r\n        ).then(() => {\r\n          this.DOM.root\r\n            .select(\".mapView-UnmatchedData\")\r\n            .classed(\"active\", false);\r\n        });\r\n      });\r\n\r\n    X = this.DOM.summaryCategorical\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapGlyphColorSetting\");\r\n\r\n    var XX = X.append(\"div\")\r\n      .attr(\"class\", \"colorOptions\")\r\n      .classed(\"active\", true);\r\n\r\n    this.DOM.aggrGroup = this.DOM.catMap_SVG\r\n      .append(\"g\")\r\n      .attr(\"class\", \"leaflet-zoom-hide aggrGroup\");\r\n\r\n    // This will insert map svg component\r\n    this.insertCategoryGlyphs();\r\n\r\n    this.DOM.mapColorScaleGroup = XX.append(\"div\").attr(\r\n      \"class\",\r\n      \"mapColorScaleGroup\"\r\n    );\r\n\r\n    this.DOM.mapColorHighlightedValue = this.DOM.mapColorScaleGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"mapColorHighlightedValue fa fa-caret-down\");\r\n\r\n    this.DOM.mapColorBlocks = this.DOM.mapColorScaleGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorScaleBins\")\r\n      .selectAll(\".mapColorThemeBin\")\r\n      .data([0, 1, 2, 3, 4, 5, 6, 7, 8])\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorThemeBin\")\r\n      .tooltip(\"\", { placement: \"bottom\" })\r\n      .on(\"mouseenter\", (event, d) => {\r\n        var _minValue = Math.round(this.mapColorScale.invert(d));\r\n        var _maxValue = Math.round(this.mapColorScale.invert(d + 1));\r\n        event.currentTarget.tippy.setContent(\r\n          Math.round(_minValue) + \" &mdash; \" + Math.round(_maxValue)\r\n        );\r\n      });\r\n\r\n    this.DOM.mapColorScaleGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorScaleLabels\")\r\n      .call((mapColorScaleLabels) => {\r\n        mapColorScaleLabels\r\n          .selectAll(\".asdsd\")\r\n          .data([0, 3, 6, 9])\r\n          .enter()\r\n          .append(\"div\")\r\n          .attr(\"class\", \"mapColorScaleLabel\")\r\n          .style(\"left\", (i) => (100 * i) / 9 + \"%\")\r\n          .call((ticks) => {\r\n            ticks.append(\"div\").attr(\"class\", \"tickLine\");\r\n            ticks.append(\"div\").attr(\"class\", \"tickLabel\");\r\n          });\r\n      });\r\n\r\n    this.DOM.mapColorScaleGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"measureDescrLabel\");\r\n    this.refreshMeasureDescrLabel();\r\n\r\n    XX.append(\"div\")\r\n      .attr(\"class\", \"colorThemeOptions\")\r\n      .append(\"div\")\r\n      .attr(\"class\", \"editColorTheme fa fa-adjust\")\r\n      .tooltip(i18n[\"InvertColorTheme\"])\r\n      .on(\"click\", () => this.catMap_invertColorTheme());\r\n\r\n    this.mapIsReady = true;\r\n\r\n    this.leafletAttrMap.invalidateSize();\r\n\r\n    this.catMap_refreshBounds_Active();\r\n    this.catMap_zoomToActive();\r\n    this.catMap_setMaxBounds();\r\n    this.catMap_projectCategories();\r\n    this.refreshMeasureLabelText(\"Active\");\r\n    this.refreshMapColorScaleBounds();\r\n    this.refreshViz_Active();\r\n    this.catMap_refreshColorScale();\r\n    this.refreshHeight();\r\n  }\r\n\r\n  refreshMapColorScaleBounds(_type = \"Active\") {\r\n    this.mapColorScale = this.attrib.chartScale_Measure\r\n      .copy()\r\n      .range(this.invertedColorTheme ? [9, 0] : [0, 9]);\r\n\r\n    this.DOM.mapColorScaleGroup\r\n      .selectAll(\".mapColorScaleLabels > .mapColorScaleLabel > .tickLabel\")\r\n      .html((d, i) =>\r\n        this.browser.getValueLabel(\r\n          this.mapColorScale.invert((this.invertedColorTheme ? 3 - i : i) * 3)\r\n        )\r\n      );\r\n  }\r\n\r\n  catMap_refreshVis(sT) {\r\n    this.DOM.root.select(\".editColorTheme\").attr(\"data-color\", sT);\r\n\r\n    this.refreshMapColorScaleBounds(sT);\r\n\r\n    var mapColorQuantize = d3\r\n      .scaleQuantize()\r\n      .domain([0, 9])\r\n      .range(this.browser.colorTheme.getDiscrete(9));\r\n\r\n    this.DOM.measure_Active.each((aggr, i, nodes) => {\r\n      var _visV = this.browser.getChartValue(aggr, sT);\r\n      if (aggr[sT].recCnt === 0) _visV = null;\r\n      var DOM = nodes[i];\r\n      var _fill = \"url(#diagonalHatch)\";\r\n      var _stroke = \"#111111\";\r\n      if (_visV != null) {\r\n        _fill = mapColorQuantize(this.mapColorScale(_visV));\r\n        _stroke = d3.hsl(_fill).l > 0.5 ? \"#111111\" : \"#EEEEEE\";\r\n      }\r\n      DOM.style.fill = _fill;\r\n      DOM.style.stroke = _stroke;\r\n      DOM.classList[_visV == null ? \"add\" : \"remove\"](\"noData\");\r\n    });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // List\r\n  // ********************************************************************\r\n\r\n  list_prepView() {\r\n    this.DOM.aggrGroup = this.DOM.aggrGroup_list;\r\n    this.insertCategoryGlyphs();\r\n    if (this.heightRow_category_dirty) this.refreshHeight_Category();\r\n    this.updateCats_IsActive();\r\n    this.updateCatSorting_now();\r\n    this.refreshLabelWidth();\r\n    this.refreshViz_All();\r\n    this.refreshHeight();\r\n    this.refreshLabelWidth();\r\n    this.DOM.measureLabel.style(\"display\", null); // default is visible\r\n  }\r\n\r\n  init_DOM_Cat() {\r\n    this.DOM.summaryControls = this.DOM.summaryCategorical\r\n      .append(\"div\")\r\n      .attr(\"class\", \"summaryControls\");\r\n    this.initDOM_CatTextSearch();\r\n\r\n    this.refreshConfigRowCount();\r\n\r\n    this.DOM.catChart = this.DOM.summaryCategorical\r\n      .append(\"div\")\r\n      .attr(\"class\", \"catChart\");\r\n\r\n    this.DOM.aggrGroup = this.DOM.catChart\r\n      .append(\"div\")\r\n      .attr(\"class\", \"aggrGroup\")\r\n      .on(\"mousedown\", (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      })\r\n      .on(\"scroll\", () => {\r\n        if (Util.ignoreScrollEvents === true) return;\r\n        this.scrollTop_cache = this.DOM.aggrGroup.node().scrollTop;\r\n\r\n        this.DOM.chartCatLabelResize.style(\"top\", \"0px\");\r\n        this.firstCatIndexInView = Math.floor(\r\n          this.scrollTop_cache / this.heightCat\r\n        );\r\n        this.refreshScrollDisplayMore(\r\n          this.firstCatIndexInView + this.catCount_InDisplay\r\n        );\r\n        this.updateCats_IsVisible();\r\n        this.catList_cullCategories();\r\n        this.refreshMeasureLabelText(\"Active\");\r\n      });\r\n    this.DOM.aggrGroup_list = this.DOM.aggrGroup;\r\n\r\n    this.DOM.catMap_Base = this.DOM.catChart\r\n      .append(\"div\")\r\n      .attr(\"class\", \"catMap_Base\");\r\n\r\n    // This makes sure that the (scrollable) div height is correctly set to visible number of categories\r\n    this.DOM.chartBackground = this.DOM.aggrGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"chartBackground\");\r\n\r\n    this.DOM.chartCatLabelResize = this.DOM.catChart\r\n      .append(\"span\")\r\n      .attr(\"class\", \"chartCatLabelResize dragWidthHandle\")\r\n      .tooltip(i18n[\"Adjust Label Width\"])\r\n      .on(\"mousedown\", (event) => {\r\n        var initWidth =\r\n          this.width_CatLabel - d3.pointer(event, d3.select(\"body\").node())[0];\r\n\r\n        this.browser.activateWidthDrag(\r\n          this.panel.DOM.root.node(),\r\n          event,\r\n          (event2) => {\r\n            this.panel.width_CatText =\r\n              initWidth +\r\n              d3.pointer(event2, d3.select(\"body\").node())[0] +\r\n              this.width_CatMeasureLabel;\r\n          }\r\n        );\r\n      });\r\n\r\n    this.insertChartAxis_Measure(this.DOM.catChart);\r\n\r\n    this.DOM.belowCatChart = this.DOM.summaryCategorical\r\n      .append(\"div\")\r\n      .attr(\"class\", \"belowCatChart catSummary_ListOnly hasLabelWidth\")\r\n      .style(\"height\", Base.height_CatBottom - 1 + \"px\"); // for some reason, chrome needs 1 more pixel for categories\r\n\r\n    this.initDOM_CatSortButton();\r\n\r\n    this.DOM.scroll_display_more = this.DOM.belowCatChart\r\n      .append(\"div\")\r\n      .attr(\"class\", \"scroll_display_more\")\r\n      .on(\"click\", () =>\r\n        Util.scrollToPos_do(\r\n          this.DOM.aggrGroup,\r\n          this.DOM.aggrGroup.node().scrollTop + this.heightCat\r\n        )\r\n      );\r\n\r\n    this.DOM.belowCatChart.append(\"div\").attr(\"class\", \"gap\");\r\n\r\n    // move noValueAggr under belowChart\r\n    // TODO: Fix. If it's map view or dropdown view, it shouldn't be moved under this dom element\r\n    this.DOM.belowCatChart.node().appendChild(this.DOM.noValueAggr.node());\r\n  }\r\n\r\n  initDOM_CatSortButton() {\r\n    this.DOM.catSortButton = this.DOM.belowCatChart\r\n      .append(\"span\")\r\n      .attr(\"class\", \"catSortButton fa fa-sort catSummary_ListOnly\") // alt icon: fa-bars\r\n      .tooltip(i18n[\"Sorting\"])\r\n      .on(\"click\", (event) =>\r\n        Modal.popupMenu(event, this.attrib.getSortMenuOpts(), this, {\r\n          placement: \"top-start\",\r\n        })\r\n      );\r\n  }\r\n\r\n  insertCategoryGlyphs() {\r\n    var me = this;\r\n    if (this.isView_Dropdown) {\r\n      this.dropdown_refreshCategories();\r\n      return;\r\n    }\r\n\r\n    if (!this.DOM.aggrGroup) return;\r\n\r\n    var aggrGlyphSelection = this.DOM.aggrGroup\r\n      .selectAll(\".aggrGlyph\")\r\n      .data(this._aggrs, (aggr) => aggr.id);\r\n\r\n    var DOM_cats_new = aggrGlyphSelection\r\n      .enter()\r\n      .append(this.viewType == \"list\" ? \"span\" : \"g\")\r\n      .attr(\r\n        \"class\",\r\n        \"aggrGlyph \" + (this.viewType == \"list\" ? \"cat\" : \"map\") + \"Glyph\"\r\n      ) // mapGlyph, catGlyph\r\n      .tooltip((aggr: Aggregate_Category) => aggr.getTooltipHTML(), {\r\n        theme: \"dark kshf-tooltip kshf-record\",\r\n        placement: \"right\",\r\n        animation: \"fade\",\r\n        followCursor: this.isView_Map,\r\n        offset: [0, this.isView_Map ? 15 : 0],\r\n        trigger: \"manual\",\r\n        // don't show the tooltip if the categorical chart is made up of unique categories.\r\n        onShow: () => !this.attrib.uniqueCategories(),\r\n      })\r\n      .on(\"mouseenter\", function (_event, aggr) {\r\n        if (me.browser.adjustMode) return;\r\n        this.highlightTimeout = window.setTimeout(() => {\r\n          this.highlightTimeout = null;\r\n          this.classList.add(\"catMouseOver\");\r\n          me.attrib.onAggrHighlight(aggr);\r\n          // Do not change.\r\n          // If trigger is automated (not manual), mouse-over automatically shows the tooltip\r\n          //  but, the highliht/compare setting may be old (invalid) because of the delay to apply it.\r\n          // So, we need to keep this manual\r\n          this.tippy.show();\r\n        }, me.browser.movingMouseDelay);\r\n      })\r\n      .on(\"mouseleave\", function (_event, aggr) {\r\n        if (this.tippy) {\r\n          this.tippy.hide();\r\n        }\r\n        if (me.browser.adjustMode) return;\r\n        this.classList.remove(\"catMouseOver\");\r\n        if (this.highlightTimeout) window.clearTimeout(this.highlightTimeout);\r\n        me.attrib.onAggrLeave(aggr);\r\n      })\r\n      .on(\"click\", (event, aggr) => {\r\n        if (this.browser.adjustMode) return;\r\n        this.attrib.onAggrClick(event, aggr);\r\n      });\r\n\r\n    this.updateCats_IsVisible();\r\n\r\n    if (this.isView_List) {\r\n      DOM_cats_new.style(\"height\", this.heightCat + \"px\").style(\r\n        \"transform\",\r\n        \"translateY(0px)\"\r\n      );\r\n\r\n      DOM_cats_new.append(\"span\").attr(\r\n        \"class\",\r\n        \"catLabelGroup_BG hasLabelWidth\"\r\n      );\r\n\r\n      var domAttrLabel = DOM_cats_new.append(\"span\").attr(\r\n        \"class\",\r\n        \"catLabelGroup hasLabelWidth\"\r\n      );\r\n\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"filterButton fa fa-filter\")\r\n        .tooltip(i18n.Filter)\r\n        .on(\"click\", (event, _cat: Aggregate_Category) => {\r\n          var menuConfig = { name: \"Filter\", items: [] };\r\n          var _only = true,\r\n            _and = !_cat.filtered_AND(),\r\n            _or = !_cat.filtered_OR(),\r\n            _not = !_cat.filtered_NOT(),\r\n            _remove = _cat.isFiltered();\r\n          var _Or_And =\r\n            this.attrib.summaryFilter.selected_OR.length > 0 ||\r\n            this.attrib.summaryFilter.selected_AND.length > 0;\r\n\r\n          if (!this.attrib.isMultiValued) {\r\n            _only = !_cat.filtered_AND();\r\n            _and = false;\r\n            _or = _or && _Or_And && !_cat.filtered_AND();\r\n            _not = _not && (!_Or_And || _cat.filtered_AND());\r\n          } else {\r\n            _only = true;\r\n            _and = _and && _Or_And;\r\n            _or = _or && _Or_And;\r\n          }\r\n\r\n          var _label = `<span class='filterContextLabel'>${_cat.label}</span>`;\r\n\r\n          if (_remove) {\r\n            menuConfig.items.push({\r\n              id: \"filterOption_Remove\",\r\n              name: \"<span class='filterContextOpt'>\" + i18n.Clear + \"</span>\",\r\n              helparticle: \"5e88e80a2c7d3a7e9aea63ed\",\r\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"NONE\"),\r\n            });\r\n          }\r\n\r\n          if (_only) {\r\n            menuConfig.items.push({\r\n              id: \"filterOption_Only\",\r\n              name: `<span class='filterContextOpt'>${i18n.Only}</span> ${_label}`,\r\n              helparticle: \"5e88e7bc2c7d3a7e9aea63e9\",\r\n              do: (_cat: Aggregate_Category) => {\r\n                this.attrib.noValueAggr.filtered = null;\r\n                this.attrib.summaryFilter\r\n                  .selected_AndOrNot()\r\n                  .forEach((_) => _.set_NONE());\r\n                this.attrib.filterCategory(_cat, \"AND\", \"All\");\r\n              },\r\n            });\r\n          }\r\n          if (_and) {\r\n            menuConfig.items.push({\r\n              id: \"filterOption_And\",\r\n              name:\r\n                `<span class='filterContextOpt'>${i18n.And}</span> ${_label}`+\r\n                ` <span class='filterContextMultiple'>[${i18n.Multiple}]</span>`,\r\n              helparticle: \"5e88e81a2c7d3a7e9aea63ee\",\r\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"AND\"),\r\n            });\r\n          }\r\n          if (_or) {\r\n            menuConfig.items.push({\r\n              id: \"filterOption_Or\",\r\n              name:\r\n              `<span class='filterContextOpt'>${i18n.Or}</span> ${_label}`+\r\n              ` <span class='filterContextMultiple'>[${i18n.Multiple}]</span>`,\r\n              helparticle: \"5e88e7e22c7d3a7e9aea63ec\",\r\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"OR\"),\r\n            });\r\n          }\r\n          if (_not) {\r\n            menuConfig.items.push({\r\n              id: \"filterOption_Not\",\r\n              name:\r\n                \"<span class='filterContextOpt'>\" +\r\n                i18n.Not +\r\n                \"</span> \" +\r\n                _label,\r\n              helparticle: \"5e88e7cf2c7d3a7e9aea63ea\",\r\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"NOT\"),\r\n            });\r\n          }\r\n          Modal.popupMenu(event, menuConfig, _cat, {\r\n            placement: \"bottom-start\",\r\n          });\r\n          event.stopPropagation();\r\n          event.preventDefault();\r\n        });\r\n\r\n      this.insertAggrLockButton(domAttrLabel, \"bottom\");\r\n\r\n      domAttrLabel.append(\"span\").attr(\"class\", \"catLabelGap\");\r\n\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"AndOrNot AndOrNot_And\")\r\n        .text(i18n.And);\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"AndOrNot AndOrNot_Or\")\r\n        .text(i18n.Or);\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"AndOrNot AndOrNot_Not\")\r\n        .text(i18n.Not);\r\n\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"catLabelOrder fa fa-bars\")\r\n        .tooltip(i18n[\"Reorder\"])\r\n        .on(\"mousedown\", (event, aggr: Aggregate_Category) => {\r\n          var catNode = event.currentTarget.parentNode.parentNode;\r\n          var catGroupNode =\r\n            event.currentTarget.parentNode.parentNode.parentNode;\r\n          me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n          var srcIndex = aggr.orderIndex;\r\n\r\n          d3.select(\"body\")\r\n            .on(\"mousemove.reordercat\", function (event2) {\r\n              catNode.classList.add(\"draggedCategory\");\r\n\r\n              var targetPos = Math.min(\r\n                Math.max(d3.pointer(event2, catGroupNode)[1], 0),\r\n                me.heightCat * (me.catCount_Active - 1)\r\n              );\r\n              var targetIndex = Math.min(\r\n                Math.max(Math.round(targetPos / me.heightCat), 0),\r\n                me.catCount_Active - 1\r\n              );\r\n              var skip = { from: srcIndex, to: targetIndex };\r\n\r\n              me.updateCatSorting(0, true, skip); // zero-delay, animated\r\n\r\n              catNode.style.transform = `translate(0px, ${targetPos}px)`; // transition the moved cat directly\r\n            })\r\n            .on(\"mouseup.reordercat\", function (event3) {\r\n              catNode.classList.remove(\"draggedCategory\");\r\n\r\n              var targetPos = Math.min(\r\n                Math.max(d3.pointer(event3, catGroupNode)[1], 0),\r\n                me.heightCat * (me.catCount_Active - 1)\r\n              );\r\n              var targetIndex = Math.min(\r\n                Math.max(Math.round(targetPos / me.heightCat), 0),\r\n                me.catCount_Active - 1\r\n              );\r\n              var skip = { from: srcIndex, to: targetIndex, mult: undefined };\r\n\r\n              if (skip.from > skip.to) {\r\n                var _ = skip.to;\r\n                skip.to = skip.from;\r\n                skip.from = _;\r\n                skip.mult = 1;\r\n              } else {\r\n                // from smaller than to\r\n                skip.mult = -1;\r\n              }\r\n\r\n              // update orderIndex!\r\n              aggr.orderIndex = targetIndex;\r\n              me.DOM.aggrGlyphs\r\n                .filter((_cat: Aggregate_Category) => _cat.label !== aggr.label) // all but the moved one\r\n                .each((_cat: Aggregate_Category) => {\r\n                  if (\r\n                    _cat.orderIndex >= skip.from &&\r\n                    _cat.orderIndex <= skip.to\r\n                  )\r\n                    _cat.orderIndex += skip.mult;\r\n                });\r\n\r\n              me.attrib.pleaseSort = true;\r\n              // Save the ordering\r\n              me.attrib.setFixedCatOrder();\r\n\r\n              me.browser.DOM.root.classed(\"noPointerEvents\", false);\r\n              d3.select(\"body\")\r\n                .on(\"mousemove.reordercat\", null)\r\n                .on(\"mouseup.reordercat\", null);\r\n            });\r\n        });\r\n\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"catLabelEdit fa fa-pencil\")\r\n        .tooltip(\"\")\r\n        .on(\"mouseenter\", (event, d: Aggregate_Category) => {\r\n          var info = \"\";\r\n          if (me.attrib.catLabel_attr[d.id]) {\r\n            // Show original value\r\n            info = ` <span>(${d.id})</span>`;\r\n            if (event.shiftKey) {\r\n              event.currentTarget.tippy.setContent(\r\n                \"+Shift : \" + i18n.Reset + info\r\n              );\r\n              return;\r\n            }\r\n          }\r\n          event.currentTarget.tippy.setContent(i18n.EditTitle + info);\r\n        })\r\n        .on(\"click\", function (event, d: Aggregate_Category) {\r\n          this.tippy.hide();\r\n          if (event.shiftKey) {\r\n            delete me.attrib.catLabel_attr[d.id];\r\n            this.nextSibling.innerHTML = DOMPurify.sanitize(d.id);\r\n            return;\r\n          }\r\n          this.style.display = \"none\";\r\n          this.previousSibling.style.display = \"none\";\r\n          this.nextSibling.setAttribute(\"contenteditable\", true);\r\n          this.nextSibling.focus();\r\n        });\r\n\r\n      domAttrLabel\r\n        .append(\"span\")\r\n        .attr(\"class\", \"catLabel\")\r\n        .html((aggr: Aggregate_Category) => aggr.label)\r\n        .on(\"focus\", function () {\r\n          this._initValue = DOMPurify.sanitize(this.innerHTML);\r\n          document.execCommand(\"selectAll\", false, null);\r\n        })\r\n        .on(\"blur\", function () {\r\n          this.removeAttribute(\"contenteditable\");\r\n          this.blur();\r\n          this.previousSibling.style.display = \"\";\r\n          this.previousSibling.previousSibling.style.display = \"\";\r\n        })\r\n        .on(\"keydown\", function (event, d: Aggregate_Category) {\r\n          if (event.keyCode === 27) {\r\n            // Escape key\r\n            // Do not apply the new label\r\n            this.blur();\r\n            this.innerHTML = DOMPurify.sanitize(this._initValue);\r\n            return;\r\n          }\r\n          if (event.key === \"Enter\") {\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n            var newLabel = DOMPurify.sanitize(this.innerHTML);\r\n            if (newLabel === \"\") {\r\n              this.innerHTML = DOMPurify.sanitize(this._initValue);\r\n              this.blur();\r\n              return;\r\n            }\r\n            d.label = newLabel;\r\n            me.attrib.catLabel_attr[d.id] = newLabel;\r\n            this.blur();\r\n          }\r\n        });\r\n\r\n      var labelGroup = DOM_cats_new.append(\"div\").attr(\r\n        \"class\",\r\n        \"measureLabelGroup\"\r\n      );\r\n      Base.Active_Compare_List.forEach((m) => {\r\n        labelGroup\r\n          .append(\"span\")\r\n          .attr(\"class\", \"measureLabel measureLabel_\" + m);\r\n      });\r\n\r\n      var measureGroup = DOM_cats_new.append(\"div\").attr(\r\n        \"class\",\r\n        \"measureGroup\"\r\n      );\r\n\r\n      Base.Total_Active_Compare_List.forEach((t) => {\r\n        measureGroup\r\n          .append(\"span\")\r\n          .attr(\"class\", `measure_${t} bg_${t}`)\r\n          .on(\"mouseenter\", (event, aggr: Aggregate_Category) => {\r\n            aggr.DOM.aggrGlyph\r\n              .querySelector(\".measureLabel_\" + t)\r\n              .classList.add(\"forceShow\");\r\n\r\n            if (Base.Compare_List.find((_) => _ === t)) {\r\n              this.browser.refreshAllMeasureLabels(t);\r\n            }\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n          })\r\n          .on(\"mouseleave\", (_event, aggr: Aggregate_Category) => {\r\n            var labelDOM = aggr.DOM.aggrGlyph.querySelector(\r\n              \".measureLabel_\" + t\r\n            );\r\n            if (labelDOM) labelDOM.classList.remove(\"forceShow\");\r\n            if (Base.Compare_List.find((_) => _ === t)) {\r\n              this.browser.refreshAllMeasureLabels(\"Active\");\r\n            }\r\n          });\r\n      });\r\n      measureGroup.append(\"div\").attr(\"class\", \"setMatrixLine\");\r\n    } else if (this.isView_Map) {\r\n      DOM_cats_new.append(\"g\")\r\n        .attr(\"class\", \"measureGroup\")\r\n        .append(\"path\")\r\n        .attr(\"class\", \"measure_Active\");\r\n      // only \"active\" measure group right now\r\n\r\n      // label on top of (after) all the rest (removed for now)\r\n    }\r\n    this.refreshDOMcats();\r\n  }\r\n\r\n  refreshMeasureLabelPos(sT: MeasureType = \"Active\", curGroup = 0) {\r\n    if (!this.isVisible()) return;\r\n    if (!this.isView_List) return;\r\n    if (sT === \"Other\") return;\r\n\r\n    var _top = this.height_bar_topGap;\r\n    var barHeight = this.barHeight_Full;\r\n\r\n    if (this.browser.stackedCompare.get() && !this.panel.hiddenCatBars()) {\r\n      var baseline = this.measureLineZero;\r\n      var maxWidth = this.width_CatChart;\r\n\r\n      var endOfBar = !this.browser.isCompared();\r\n\r\n      this.DOM[\"measureLabel_\" + sT].each(\r\n        (aggr: Aggregate_Category, i, nodes) => {\r\n          var _width = aggr.scale(sT);\r\n          var _left = baseline + aggr.offset(sT);\r\n          var _right = _left + _width;\r\n\r\n          var _hidden = this.browser.getMeasureValue(aggr, sT) == 0;\r\n\r\n          if (!_hidden && this.browser.isCompared()) {\r\n            _hidden = aggr.scale(sT) < this.width_CatMeasureLabel - 4;\r\n          }\r\n\r\n          // label alignment\r\n          var _labelAlign =\r\n            Math.abs(_left - baseline) < 2\r\n              ? \"left\"\r\n              : Math.abs(_right - maxWidth) < 2 &&\r\n                this.browser.relativeBreakdown\r\n              ? \"right\"\r\n              : \"middle\";\r\n\r\n          if (endOfBar) {\r\n            _width = this.width_CatMeasureLabel;\r\n            _left = Math.min(\r\n              baseline + aggr.sumOffsetScale(sT),\r\n              maxWidth - _width\r\n            );\r\n            _right = _left + _width;\r\n            _labelAlign = _right + 10 < maxWidth ? \"left\" : \"right\";\r\n            _hidden = aggr.recCnt(sT) === 0;\r\n          }\r\n\r\n          nodes[i].classList[_hidden ? \"add\" : \"remove\"](\"hidden\");\r\n\r\n          nodes[i].setAttribute(\"labelAlign\", _labelAlign);\r\n\r\n          nodes[i].style.width = _width + \"px\";\r\n          nodes[i].style.transform = `translate(${_left}px, ${_top}px)`;\r\n        }\r\n      );\r\n    } else {\r\n      if (this.vizSideBySide()) {\r\n        barHeight = barHeight / this.browser.activeComparisonsCount;\r\n        _top += barHeight * curGroup;\r\n      }\r\n\r\n      var onlySelectedNoSplit =\r\n        true &&\r\n        !this.browser.stackedChart &&\r\n        this.attrib.isComparedAttrib() &&\r\n        this.attrib.isMultiValued &&\r\n        !this.splitOnSelfCompare;\r\n\r\n      this.DOM[\"measureLabel_\" + sT]\r\n        .attr(\"labelAlign\", null)\r\n        .classed(\"hidden\", (aggr) => {\r\n          if (onlySelectedNoSplit) return aggr.compared !== sT;\r\n          return (\r\n            barHeight < 12 ||\r\n            (this.attrib.isComparedAttrib() &&\r\n              !this.attrib.isMultiValued &&\r\n              (sT !== aggr.compared || this.browser.relativeBreakdown))\r\n          );\r\n        })\r\n        .style(\"transform\", `translateY(${_top}px)`)\r\n        .style(\"width\", null);\r\n    }\r\n\r\n    this.DOM[\"measureLabel_\" + sT].style(\"line-height\", barHeight + \"px\");\r\n  }\r\n\r\n  refreshDOMcats() {\r\n    this.DOM.aggrGlyphs = this.DOM.aggrGroup\r\n      .selectAll(\".aggrGlyph\")\r\n      .each((aggr: Aggregate_Category, i, nodes) => {\r\n        aggr.setAggrGlyph(nodes[i]);\r\n      });\r\n\r\n    this.DOM.measureLabelGroup =\r\n      this.DOM.aggrGlyphs.selectAll(\".measureLabelGroup\");\r\n    this.DOM.measureLabel = this.DOM.aggrGlyphs.selectAll(\".measureLabel\");\r\n\r\n    Base.Active_Compare_List.forEach((t) => {\r\n      this.DOM[\"measureLabel_\" + t] = this.DOM.aggrGlyphs.selectAll(\r\n        \".measureLabel_\" + t\r\n      );\r\n    });\r\n\r\n    Base.Total_Active_Compare_List.forEach((t) => {\r\n      this.DOM[\"measure_\" + t] = this.DOM.aggrGlyphs.selectAll(\".measure_\" + t);\r\n    });\r\n\r\n    if (this.isView_List) {\r\n      this.DOM.catLabel = this.DOM.aggrGlyphs.selectAll(\".catLabel\");\r\n      this.DOM.lockButton = this.DOM.aggrGlyphs.selectAll(\".lockButton\");\r\n      this.refreshHeight_Category_do();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // List - Sorting\r\n  // ********************************************************************\r\n\r\n  public scrollTop_cache = 0;\r\n\r\n  updateCatSorting_now() {\r\n    this.updateCatSorting(0, false); // no delay, not animated\r\n  }\r\n\r\n  updateCatSorting(sortDelay = 1000, animate = true, skip: any = false) {\r\n    if (this._aggrs.length === 0) return; // no aggregates to sort\r\n    if (this.attrib.uniqueCategories() && !this.panel) return; // Nothing to sort...\r\n\r\n    if (!this.browser.finalized) animate = false;\r\n\r\n    this.updateCats_IsActive();\r\n\r\n    if (\r\n      !skip &&\r\n      (sortDelay === 0 || !this.attrib.catOrder_Fixed || this.attrib.pleaseSort)\r\n    ) {\r\n      this.attrib._sortCategories();\r\n      // ************************************************\r\n      // update orderIndex\r\n      var lastRank = 0;\r\n      this._aggrs.forEach((_cat) => {\r\n        _cat.orderIndex = _cat.isActive ? lastRank++ : -lastRank - 1;\r\n      });\r\n    }\r\n\r\n    this.updateCats_IsVisible();\r\n\r\n    // No need to update UI if checks below fail\r\n    if (!this.panel) return;\r\n    if (!this.DOM.aggrGlyphs) return;\r\n    if (!this.isView_List) return;\r\n\r\n    // The rest deals with updating UI\r\n\r\n    this.DOM.catChart.classed(\"catOrder_Fixed\", this.attrib.catOrder_Fixed);\r\n\r\n    if (!skip && this.setAttrib) {\r\n      // need to handle some setAttrib updates when the categories are re-ordered\r\n      var setAttrib = this.setAttrib;\r\n      setAttrib.block.refreshRow();\r\n      setAttrib.block.DOM.setPairGroup.attr(\"animate_position\", false);\r\n      setAttrib.block.refreshSetPair_Position();\r\n      setTimeout(\r\n        () => setAttrib.block.DOM.setPairGroup.attr(\"animate_position\", true),\r\n        1000\r\n      );\r\n    }\r\n\r\n    // Categories outside the view are set \"invisible\"\r\n    // Her, we expand the background box. This makes the scroll bar visible.\r\n    this.DOM.chartBackground.style(\"height\", this.height_VisibleAttrib + \"px\");\r\n\r\n    // scroll to top when re-sorted\r\n    if (this.scrollTop_cache !== 0) Util.scrollToPos_do(this.DOM.aggrGroup, 0);\r\n\r\n    this.refreshScrollDisplayMore(\r\n      this.firstCatIndexInView + this.catCount_InDisplay\r\n    );\r\n\r\n    if (!animate) {\r\n      this.DOM.aggrGlyphs\r\n        .each((_cat) => {\r\n          _cat.posX = 0;\r\n        })\r\n        .style(\"opacity\", 1)\r\n        .style(\"transform\", (_cat) => _cat.transformPos);\r\n      this.catList_cullCategories();\r\n      return;\r\n    }\r\n\r\n    // Exectued only when categories are reordered through GUI\r\n    if (skip) {\r\n      var selfOrder = skip.from;\r\n      // from is less than to (like, from 2 to 5 ): make 2,3,4 skip\r\n      if (skip.from > skip.to) {\r\n        var _ = skip.to;\r\n        skip.to = skip.from;\r\n        skip.from = _;\r\n        skip.mult = 1;\r\n      } else {\r\n        skip.mult = -1;\r\n      }\r\n      this.DOM.aggrGlyphs\r\n        .filter((_cat) => _cat.orderIndex !== selfOrder)\r\n        .transition()\r\n        .duration(sortDelay)\r\n        .style(\"transform\", (_cat) => {\r\n          var offset =\r\n            _cat.orderIndex >= skip.from && _cat.orderIndex <= skip.to\r\n              ? this.heightCat * skip.mult\r\n              : 0;\r\n          return `translate(${_cat.posX}px, ${_cat.posY + offset}px)`;\r\n        });\r\n\r\n      return;\r\n    }\r\n\r\n    var cats_NotActiveBeforeAndNow = this.DOM.aggrGlyphs.filter(\r\n      (_cat) => !_cat.isActiveBefore && !_cat.isActive\r\n    );\r\n    var cats_Disappearing = this.DOM.aggrGlyphs.filter(\r\n      (_cat) => _cat.isActiveBefore && !_cat.isActive\r\n    );\r\n    var cats_Appearing = this.DOM.aggrGlyphs.filter(\r\n      (_cat) => !_cat.isActiveBefore && _cat.isActive\r\n    );\r\n    var cats_Active = this.DOM.aggrGlyphs.filter((_cat) => _cat.isActive);\r\n\r\n    cats_NotActiveBeforeAndNow.style(\"display\", \"none\");\r\n\r\n    var xRemoveOffset = -100;\r\n\r\n    // Disappear animation\r\n    cats_Disappearing\r\n      .transition()\r\n      .duration(sortDelay)\r\n      .on(\"end\", function (aggr) {\r\n        this.style.opacity = 0;\r\n        aggr.posX = xRemoveOffset;\r\n        this.style.transform = aggr.transformPos;\r\n      })\r\n      .transition()\r\n      .duration(1000)\r\n      .on(\"end\", function () {\r\n        this.style.display = \"none\";\r\n      });\r\n\r\n    // Appear animation (initial position)\r\n    cats_Appearing\r\n      .transition()\r\n      .duration(sortDelay)\r\n      .on(\"end\", (aggr, i, nodes) => {\r\n        var node = nodes[i];\r\n        node.style.opacity = 0;\r\n        node.style.display = null;\r\n        aggr.posX = xRemoveOffset;\r\n        node.style.transform = aggr.transformPos;\r\n      });\r\n\r\n    // Sort animation\r\n    var perCatDelay = 30;\r\n    cats_Active\r\n      .style(\"display\", null)\r\n      .transition()\r\n      .duration((_cat) => {\r\n        if (_cat.isVisibleBefore && !_cat.isVisible) return sortDelay;\r\n        var x = _cat.isActiveBefore\r\n          ? 0\r\n          : (this.catCount_InDisplay - 5) * perCatDelay; // appear animation is further delayed\r\n        return (\r\n          100 +\r\n          sortDelay +\r\n          x +\r\n          Math.min(_cat.orderIndex, this.catCount_InDisplay + 2) * perCatDelay\r\n        );\r\n      })\r\n      .on(\"end\", (aggr, i, nodes) => {\r\n        aggr.posX = 0;\r\n        nodes[i].style.opacity = 1;\r\n        nodes[i].style.transform = aggr.transformPos;\r\n      })\r\n      .transition()\r\n      .duration(250)\r\n      .on(\"end\", (aggr, i, nodes) => {\r\n        if (!(aggr.isVisible || aggr.isVisibleBefore)) {\r\n          nodes[i].style.display = \"none\";\r\n        }\r\n      });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Dropdown\r\n  // ********************************************************************\r\n\r\n  public dropdown_type: DropdownType = \"SingleSelect\";\r\n\r\n  private choicesUI: any;\r\n\r\n  dropdown_prepView() {\r\n    this.insertCategoryGlyphs();\r\n  }\r\n\r\n  dropdown_refreshCategories() {\r\n    if (!this.DOM) return;\r\n    if (!this.DOM.summaryCategorical) return;\r\n    if (!this.inDashboard) return;\r\n    if (!this.isVisible()) return;\r\n\r\n    import(\"choices.js\").then((Choices) => {\r\n      var me = this; // callbacks set their own this context for choices library\r\n\r\n      var cfg = {\r\n        searchEnabled: this._aggrs.length > 15,\r\n        searchResultLimit: 20,\r\n        searchPlaceholderValue: i18n.Search,\r\n        shouldSort: false,\r\n        shouldSortItems: false,\r\n        duplicateItemsAllowed: false,\r\n        paste: false,\r\n\r\n        removeItemButton: this.dropdown_type === \"MultiSelect\" ? true : false,\r\n        placeholder: this.dropdown_type === \"MultiSelect\" ? true : \"\",\r\n        placeholderValue: i18n.All,\r\n\r\n        callbackOnCreateTemplates: () => ({\r\n          choice(classes, obj) {\r\n            const el = Choices.defaults.templates.choice.call(\r\n              this,\r\n              classes,\r\n              obj\r\n            );\r\n            var aggr = me.attrib.catTable_id[obj.label];\r\n            if (aggr && aggr.compared) {\r\n              el.classList.add(aggr.compared);\r\n            }\r\n            return el;\r\n          },\r\n          item(classes, obj) {\r\n            const el = Choices.defaults.templates.item.call(\r\n              this,\r\n              classes,\r\n              obj,\r\n              me.dropdown_type === \"MultiSelect\"\r\n            );\r\n            var aggr = me.attrib.catTable_id[obj.label];\r\n            if (aggr && aggr.compared) {\r\n              el.classList.add(\"bg_\" + aggr.compared);\r\n            }\r\n            return el;\r\n          },\r\n        }),\r\n      };\r\n\r\n      if (this.choicesUI) {\r\n        this.choicesUI.destroy();\r\n        this.DOM.ChoicesSelectDOM.remove();\r\n      }\r\n\r\n      this.DOM.ChoicesSelectDOM = this.DOM.summaryCategorical\r\n        .append(\"select\")\r\n        .attr(\"multiple\", this.dropdown_type === \"MultiSelect\" ? true : null);\r\n\r\n      this.DOM.ChoicesSelectDOM.node().addEventListener(\r\n        \"removeItem\",\r\n        (event) => {\r\n          if (this.dropdown_type !== \"MultiSelect\") return;\r\n          var _cat = event.detail.customProperties;\r\n          if (!_cat) {\r\n            // choices js: Update/remove after version update of library, feature just added.\r\n            _cat = this.attrib.catTable_id[event.detail.label];\r\n          }\r\n          if (_cat) this.attrib.onAggrClick(event, _cat);\r\n        }\r\n      );\r\n\r\n      this.DOM.ChoicesSelectDOM.node().addEventListener(\"choice\", (_event) => {\r\n        var selectedCat = this.attrib.summaryFilter.selected_AND[0];\r\n        var _cat = _event.detail.choice.customProperties as Aggregate_Category;\r\n        // selecting filtered category again\r\n        if (_cat && selectedCat && selectedCat.label === _cat.label) return;\r\n        if (_cat && _cat.recCnt(\"Active\") === 0 && !this.attrib.isFiltered()) {\r\n          Modal.alert(\r\n            i18n[\r\n              \"Cannot select an option with no data in current filtered dashboard.\"\r\n            ]\r\n          );\r\n          return;\r\n        }\r\n        window.setTimeout(() => {\r\n          if (this.dropdown_type === \"MultiSelect\") {\r\n            if (_cat) {\r\n              if (this.attrib.isFiltered()) {\r\n                this.attrib.filterCategory(\r\n                  _cat,\r\n                  this.attrib.isMultiValued ? \"AND\" : \"OR\",\r\n                  \"All\"\r\n                );\r\n              } else {\r\n                this.attrib.filterCategory(_cat, \"AND\", \"All\");\r\n              }\r\n            } else {\r\n              this.attrib.summaryFilter.clearFilter(_cat ? false : true);\r\n            }\r\n            return;\r\n          }\r\n          this.attrib.summaryFilter.clearFilter(_cat ? false : true);\r\n          if (_cat) {\r\n            this.attrib.filterCategory(_cat, \"AND\", \"All\");\r\n          }\r\n        }, 10);\r\n      });\r\n\r\n      this.choicesUI = new Choices(this.DOM.ChoicesSelectDOM.node(), cfg);\r\n      this.choicesUI.setChoices(\r\n        [\r\n          // \"All\" option\r\n          {\r\n            value: \"-\",\r\n            label: i18n.All,\r\n            selected: this.attrib.isFiltered() ? null : true,\r\n          },\r\n        ].concat(\r\n          this._aggrs.map((aggr) => ({\r\n            value: aggr.label,\r\n            label: aggr.label,\r\n            selected: !aggr.isFiltered() ? null : true,\r\n            disabled:\r\n              aggr.recCnt(\"Active\") === 0 && !this.attrib.isFiltered()\r\n                ? true\r\n                : null,\r\n            customProperties: aggr,\r\n          }))\r\n        ),\r\n        \"value\",\r\n        \"label\",\r\n        true\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { Aggregate } from \"./Aggregate\";\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Aggregate_SetPair } from \"./Aggregate_SetPair\";\r\n\r\nexport type CatFilterType = \"AND\" | \"OR\" | \"NOT\";\r\n\r\n/** -- */\r\nexport class Aggregate_Category extends Aggregate {\r\n  readonly attrib: Attrib_Categorical;\r\n\r\n  // DOM elements\r\n  public DOM: {\r\n    aggrGlyph?: Element;\r\n    matrixRow?: Element;\r\n  } = {};\r\n\r\n  private readonly _id: string;\r\n\r\n  private _label: string = null;\r\n\r\n  // additional active status is needed for some UI / animations\r\n  isActive?: boolean;\r\n  isActiveBefore?: boolean;\r\n\r\n  constructor(attrib: Attrib_Categorical, id: string) {\r\n    super(attrib);\r\n    this._id = id;\r\n  }\r\n\r\n  get id(): string {\r\n    return this._id;\r\n  }\r\n  set label(v: string) {\r\n    this._label = v;\r\n  }\r\n  /** If a separate label has not been assigned, the id of the category. */\r\n  get label(): string {\r\n    return this._label || this._id;\r\n  }\r\n\r\n  get tooltipTitle(): string {\r\n    return this.attrib.attribNameHTML;\r\n  }\r\n  protected get tooltipSkip1(): boolean {\r\n    return !this.filtered_AND();\r\n  }\r\n\r\n  /** Overwrite */\r\n  setAggrGlyph(v: Element) {\r\n    super.setAggrGlyph(v);\r\n    this.refreshCatDOMSelected();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering\r\n  // ********************************************************************\r\n\r\n  private catFiltering: CatFilterType = null;\r\n\r\n  isFiltered(): boolean {\r\n    return this.catFiltering !== null;\r\n  }\r\n  filtered_NOT(): boolean {\r\n    return this.catFiltering === \"NOT\";\r\n  }\r\n  filtered_AND(): boolean {\r\n    return this.catFiltering === \"AND\";\r\n  }\r\n  filtered_OR(): boolean {\r\n    return this.catFiltering === \"OR\";\r\n  }\r\n\r\n  set_NONE(): void {\r\n    if (this.inList) this.inList.splice(this.inList.indexOf(this), 1);\r\n    this.catFiltering = null;\r\n    this.refreshCatDOMSelected();\r\n  }\r\n  set_NOT(l: Aggregate_Category[]): void {\r\n    if (this.filtered_NOT()) return;\r\n    this.catFiltering = \"NOT\";\r\n    this.insertToList(l);\r\n  }\r\n  set_AND(l: Aggregate_Category[]): void {\r\n    if (this.filtered_AND()) return;\r\n    this.catFiltering = \"AND\";\r\n    this.insertToList(l);\r\n  }\r\n  set_OR(l: Aggregate_Category[]): void {\r\n    if (this.filtered_OR()) return;\r\n    this.catFiltering = \"OR\";\r\n    this.insertToList(l);\r\n  }\r\n\r\n  /** -- */\r\n  unselectAggregate(): void {\r\n    super.unselectAggregate();\r\n    if (this.locked) return;\r\n    this.DOM.matrixRow?.removeAttribute(\"selection\");\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Export\r\n  // ********************************************************************\r\n\r\n  exportAggregateInfo() {\r\n    return {\r\n      id: this.id,\r\n    };\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Visualization parameters\r\n  // ********************************************************************\r\n\r\n  // Order index of the category among other categories in the attrib\r\n  public orderIndex: number = 0;\r\n\r\n  /** -- Visual variable */\r\n  public posX: number = 0;\r\n  get posY(): number {\r\n    return this.orderIndex * this.attrib.barHeight.get();\r\n  }\r\n  get transformPos() {\r\n    return `translate(${this.posX}px, ${this.posY}px)`;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Set (multi-value) cache\r\n  // ********************************************************************\r\n\r\n  // the list of setpairs this category appears in (is one of the sets)\r\n  setPairs?: Aggregate_SetPair[];\r\n  // for computing MST tree (perceptual ordering)\r\n  MST?: {\r\n    tree: {}; // Some unqiue identifier, to check if two nodes are in the same tree.\r\n    childNodes: Aggregate_Category[];\r\n    parentNode: Aggregate_Category | null;\r\n    treeSize?: number; // computed recursively from the node networks\r\n    order?: number;\r\n  };\r\n\r\n  // ********************************************************************\r\n  // Geographic data cache\r\n  // ********************************************************************\r\n\r\n  public _geo_: any = null;\r\n\r\n  // ********************************************************************\r\n  // Private helpers\r\n  // ********************************************************************\r\n\r\n  private inList: Aggregate_Category[];\r\n\r\n  /** -- */\r\n  private insertToList(l: Aggregate_Category[]) {\r\n    if (this.inList) this.inList.splice(this.inList.indexOf(this), 1);\r\n    this.inList = l;\r\n    l.push(this);\r\n    this.refreshCatDOMSelected();\r\n  }\r\n\r\n  /** -- */\r\n  private refreshCatDOMSelected() {\r\n    if (!this.catFiltering) {\r\n      this.DOM.aggrGlyph?.removeAttribute(\"catFiltered\");\r\n    } else {\r\n      this.DOM.aggrGlyph?.setAttribute(\"catFiltered\", this.catFiltering);\r\n    }\r\n  }\r\n}\r\n","import { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Aggregate_Category } from \"./Aggregate_Category\";\r\nimport { Aggregate } from \"./Aggregate\";\r\n\r\n/** -- */\r\nexport class Aggregate_SetPair extends Aggregate {\r\n  readonly attrib: Attrib_Categorical;\r\n\r\n  // Composed of two sets (categories)\r\n  readonly set_1: Aggregate_Category;\r\n  readonly set_2: Aggregate_Category;\r\n\r\n  constructor(\r\n    attrib: Attrib_Categorical,\r\n    set_1: Aggregate_Category,\r\n    set_2: Aggregate_Category\r\n  ) {\r\n    super(attrib);\r\n    this.set_1 = set_1;\r\n    this.set_2 = set_2;\r\n  }\r\n\r\n  mst_distance: number = 0;\r\n\r\n  similarityScore() {\r\n    var size_and = this.measure(\"Active\");\r\n    if (size_and === 0) return 0;\r\n\r\n    var size_A = this.set_1.measure(\"Active\");\r\n    var size_B = this.set_2.measure(\"Active\");\r\n    return size_and / Math.min(size_A, size_B);\r\n  }\r\n\r\n  get label() {\r\n    return `${this.set_1.label}<br> &amp; ${this.set_2.label}`;\r\n  }\r\n\r\n  exportAggregateInfo() {\r\n    return {};\r\n  }\r\n}\r\n","import { select, pointer } from \"./d3_select\";\r\nimport { max } from \"d3-array\";\r\nimport { format } from \"d3-format\";\r\nimport { easeLinear } from \"d3-ease\";\r\nimport { interpolate, interpolateHsl } from \"d3-interpolate\";\r\nimport { rgb } from \"d3-color\";\r\n\r\nimport { Attrib_Set } from \"./Attrib_Set\";\r\nimport { Aggregate_SetPair } from \"./Aggregate_SetPair\";\r\nimport { Block } from \"./Block\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Base } from \"./Base\";\r\nimport { CompareType } from \"./Types\";\r\nimport { Aggregate_Category } from \"./Aggregate_Category\";\r\nimport { Util } from \"./Util\";\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  max,\r\n  format,\r\n  easeLinear,\r\n  interpolate,\r\n  interpolateHsl,\r\n  rgb,\r\n};\r\n\r\nexport class Block_Set extends Block {\r\n  // specific attribute type\r\n  public readonly attrib: Attrib_Set;\r\n\r\n  constructor(attrib: Attrib_Set) {\r\n    super(attrib);\r\n\r\n    this.panel = attrib.setListAttrib.block.panel;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Shorthand\r\n  // ********************************************************************\r\n\r\n  get setPairs(): Aggregate_SetPair[] {\r\n    return this.attrib.setPairs;\r\n  }\r\n  get setListSummary() {\r\n    return this.attrib.parent;\r\n  }\r\n  get rowHeight(): number {\r\n    return this.setListSummary.barHeight.get();\r\n  }\r\n\r\n  /** -- */\r\n  get setPairCount_Total() {\r\n    return (this.attrib.sets.length * (this.attrib.sets.length - 1)) / 2;\r\n  }\r\n\r\n  get popupSide() {\r\n    return this.setListSummary.block.panel.name === \"left\" ? \"right\" : \"left\";\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Radius / diameter\r\n  // ********************************************************************\r\n\r\n  private setPairDiameter = 0;\r\n\r\n  updateSetPairDiameter() {\r\n    this.setPairDiameter = this.rowHeight - 2;\r\n  }\r\n\r\n  /** Shorthand - half of diameter */\r\n  get setPairRadius() {\r\n    return this.setPairDiameter / 2;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Maximum active values\r\n  // ********************************************************************\r\n\r\n  private _maxSetPairAggr_Active = 0;\r\n\r\n  /** -- */\r\n  updateMaxAggr_Active() {\r\n    this._maxSetPairAggr_Active = d3.max(\r\n      this.setPairs,\r\n      (aggr: Aggregate_SetPair) => aggr.measure(\"Active\")\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  private getCliqueSizeRatio(setPair) {\r\n    return this._maxSetPairAggr_Active === 0\r\n      ? 0\r\n      : Math.sqrt(setPair.measure(\"Active\") / this._maxSetPairAggr_Active);\r\n  }\r\n\r\n  /** -- */\r\n  private usingFullSizeGlyph() {\r\n    return this.browser.relativeBreakdown || this.browser.dependentBreakdown;\r\n  }\r\n\r\n  /** -- */\r\n  setCollapsed(v: boolean): void {\r\n    this.setListSummary.block.showSetMatrix(v !== true);\r\n  }\r\n\r\n  private gridPan_x = 0;\r\n  public pausePanning = false;\r\n\r\n  // ********************************************************************\r\n  // Height and width management\r\n  // ********************************************************************\r\n\r\n  /** always has static height */\r\n  hasStaticHeight(): boolean {\r\n    return true;\r\n  }\r\n  get height_Content(): number {\r\n    return this.setListSummary.block.height_Content;\r\n  }\r\n  get height_RangeMin(): number {\r\n    return this.setListSummary.block.height_RangeMin;\r\n  }\r\n  get height_RangeMax(): number {\r\n    return this.setListSummary.block.height_RangeMax;\r\n  }\r\n  getHeight(): number {\r\n    return this.setListSummary.block.height_Categories;\r\n  }\r\n  setHeight(targetHeight: number): void {\r\n    this.setListSummary.block.setHeight(targetHeight);\r\n  }\r\n\r\n  refreshHeight() {\r\n    if (!this.isVisible()) return;\r\n\r\n    this.updateSetPairDiameter();\r\n\r\n    this.DOM.chartRoot.attr(\"show_gridlines\", this.rowHeight > 15);\r\n\r\n    this.DOM.setPairGroup.attr(\"animate_position\", false);\r\n    this.refreshRow();\r\n\r\n    this.refreshSetPair_Background();\r\n    this.refreshSetPair_Position();\r\n    this.refreshViz_All();\r\n    this.refreshSetPair_Strength();\r\n    setTimeout(\r\n      () => this.DOM.setPairGroup.attr(\"animate_position\", true),\r\n      1000\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  getWidth(): number {\r\n    return this.browser.panels.middle.width_Real + Base.width_PanelGap;\r\n  }\r\n  /** -- */\r\n  refreshWidth(): void {\r\n    this.refreshWindowSize();\r\n    if (this.popupSide === \"left\") {\r\n      this.refreshRow_LineWidths();\r\n      this.refreshSetPair_Position();\r\n    }\r\n  }\r\n\r\n  initDOM(beforeDOM = null): boolean {\r\n    // Inserts the DOM root under the setListSummary so that the matrix view is attached...\r\n    this.DOM.root = this.setListSummary.block.DOM.root\r\n      .insert(\"div\", \":first-child\")\r\n      .attr(\"class\", \"kshfSummary setPairSummary\")\r\n      .attr(\"data-popupSide\", this.popupSide);\r\n\r\n    // Use keshif's standard header\r\n    this.insertHeader();\r\n\r\n    this.DOM.chartRoot = this.DOM.wrapper\r\n      .append(\"span\")\r\n      .attr(\"class\", \"Summary_Set\")\r\n      .attr(\"show_gridlines\", true);\r\n\r\n    this.insertSummaryControls();\r\n\r\n    this.DOM.setMatrixSVG = this.DOM.chartRoot\r\n      .append(\"svg\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n      .attr(\"class\", \"setMatrix\");\r\n\r\n    /** BELOW THE MATRIX **/\r\n    this.DOM.belowMatrix = this.DOM.chartRoot\r\n      .append(\"div\")\r\n      .attr(\"class\", \"belowMatrix\");\r\n\r\n    this.DOM.pairCount = this.DOM.belowMatrix\r\n      .append(\"span\")\r\n      .attr(\"class\", \"pairCount matrixInfo\");\r\n    this.DOM.pairCount_Text = this.DOM.pairCount\r\n      .append(\"span\")\r\n      .attr(\"class\", \"pairCount_Text\")\r\n      .html(`<i class='fa fa-circle' style='color: #b1bdc5;'></i> \r\n      ${this.setPairs.length} ${i18n.Pairs} (${Math.round(\r\n      (100 * this.setPairs.length) / this.setPairCount_Total\r\n    )}%)`);\r\n\r\n    this.DOM.subsetCount = this.DOM.belowMatrix\r\n      .append(\"span\")\r\n      .attr(\"class\", \"subsetCount matrixInfo\");\r\n    this.DOM.subsetCount.append(\"span\").attr(\"class\", \"circleeee borrderr\");\r\n    this.DOM.subsetCount_Text = this.DOM.subsetCount\r\n      .append(\"span\")\r\n      .attr(\"class\", \"subsetCount_Text\");\r\n\r\n    this.DOM.strengthControl = this.DOM.belowMatrix\r\n      .append(\"span\")\r\n      .attr(\"class\", \"strengthControl matrixInfo\")\r\n      .tooltip(\r\n        \"Cell color shows strength (ratio of shared elements) between categories.\"\r\n      );\r\n\r\n    // ******************* STRENGTH CONFIG\r\n    this.DOM.strengthControl\r\n      .append(\"span\")\r\n      .attr(\"class\", \"strengthLabel\")\r\n      .text(i18n.Weak);\r\n    this.DOM.strengthControl\r\n      .append(\"span\")\r\n      .attr(\"class\", \"strengthText\")\r\n      .text(i18n.Strength);\r\n    this.DOM.strengthControl\r\n      .append(\"span\")\r\n      .attr(\"class\", \"strengthLabel\")\r\n      .text(i18n.Strong);\r\n\r\n    // invisible background - Used for panning\r\n    this.DOM.setMatrixBackground = this.DOM.setMatrixSVG\r\n      .append(\"rect\")\r\n      .attr(\"class\", \"setMatrixBackground\")\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", 0)\r\n      .style(\"fill-opacity\", \"0\")\r\n      .on(\"mousedown\", (event) => {\r\n        this.browser.DOM.pointerBlock.attr(\"active\", \"\");\r\n        this.browser.DOM.root.attr(\"pointerEvents\", false);\r\n\r\n        var mouseInitPos = d3.pointer(event, this.browser.DOM.root.node());\r\n\r\n        var gridPan_x_init = this.gridPan_x;\r\n\r\n        // scroll the setlist summary too...\r\n        var scrollDom = this.setListSummary.block.DOM.aggrGroup.node();\r\n        var initScrollPos = scrollDom.scrollTop;\r\n        var w = this.getWidth();\r\n        var h = this.getHeight();\r\n        var initT = this.setListSummary.block.scrollTop_cache;\r\n        var initR = Math.min(-initT - this.gridPan_x, 0);\r\n\r\n        this.pausePanning = true;\r\n\r\n        d3.select(\"body\")\r\n          .on(\"mousemove\", (event2) => {\r\n            var mouseMovePos = d3.pointer(event2, this.browser.DOM.root.node());\r\n            var difX = mouseMovePos[0] - mouseInitPos[0];\r\n            var difY = mouseMovePos[1] - mouseInitPos[1];\r\n\r\n            if (this.popupSide === \"right\") difX *= -1;\r\n\r\n            this.gridPan_x = gridPan_x_init + difX + difY;\r\n            //this.gridPan_x = Math.min(this.getWidth(),gridPan_x_init+difX+difY);\r\n\r\n            this.refreshSVGViewBox();\r\n\r\n            scrollDom.scrollTop = Math.max(0, initScrollPos - difY);\r\n\r\n            event2.preventDefault();\r\n            event2.stopPropagation();\r\n          })\r\n          .on(\"mouseup\", (event3) => {\r\n            this.pausePanning = false;\r\n            this.browser.DOM.root.attr(\"pointerEvents\", null);\r\n            this.browser.DOM.pointerBlock.attr(\"active\", null);\r\n            this.refreshLabel_Vert_Show();\r\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\r\n            event3.preventDefault();\r\n            event3.stopPropagation();\r\n          });\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n\r\n    this.DOM.setMatrixSVG\r\n      .append(\"g\")\r\n      .attr(\"class\", \"rows\")\r\n      .style(\"transform\", \"translateY(0.5px)\"); // adjusting to match to list-view on the side on retina displays.\r\n    this.DOM.setPairGroup = this.DOM.setMatrixSVG\r\n      .append(\"g\")\r\n      .attr(\"class\", \"aggrGroup setPairGroup\")\r\n      .attr(\"animate_position\", true);\r\n\r\n    this.insertRows();\r\n    this.insertSetPairs();\r\n\r\n    this.updateSetPairDiameter();\r\n\r\n    this.refreshRow();\r\n\r\n    this.refreshSetPair_Background();\r\n    this.refreshSetPair_Position();\r\n    this.refreshSetPair_Containment();\r\n\r\n    this.refreshViz_Axis();\r\n    this.refreshViz_Active();\r\n    this.refreshViz_Compare_All();\r\n\r\n    this.DOM.inited = true;\r\n\r\n    return true;\r\n  }\r\n\r\n  /** -- */\r\n  insertSummaryControls() {\r\n    this.DOM.summaryControls = this.DOM.chartRoot\r\n      .append(\"div\")\r\n      .attr(\"class\", \"summaryControls\")\r\n      .style(\"height\", this.setListSummary.block.height_Config + 1 + \"px\");\r\n\r\n    this.DOM.scaleLegend_SVG = this.DOM.summaryControls\r\n      .append(\"svg\")\r\n      .attr(\"class\", \"sizeLegend\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\");\r\n\r\n    this.DOM.legendHeader = this.DOM.scaleLegend_SVG\r\n      .append(\"text\")\r\n      .attr(\"class\", \"legendHeader\")\r\n      .text(\"#\");\r\n    this.DOM.legend_Group = this.DOM.scaleLegend_SVG.append(\"g\");\r\n  }\r\n\r\n  /** -- */\r\n  insertRows() {\r\n    var newRows = this.DOM.setMatrixSVG\r\n      .select(\"g.rows\")\r\n      .selectAll(\"g.row\")\r\n      .data(this.attrib.sets, (aggr) => aggr.id)\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr(\"class\", \"row\")\r\n      .each((aggr: Aggregate_Category, i, nodes) => {\r\n        aggr.DOM.matrixRow = nodes[i];\r\n      })\r\n      .on(\"mouseenter\", (_event, aggr: Aggregate_Category) =>\r\n        this.setListSummary.onAggrHighlight(aggr)\r\n      )\r\n      .on(\"mouseleave\", (_event, aggr: Aggregate_Category) =>\r\n        this.setListSummary.onAggrLeave(aggr)\r\n      );\r\n\r\n    // tmp is used to parse html text\r\n    var tmp = document.createElement(\"div\");\r\n\r\n    newRows\r\n      .append(\"line\")\r\n      .attr(\"class\", \"line line_vert\")\r\n      .attr(\"x1\", 0)\r\n      .attr(\"y1\", 0)\r\n      .attr(\"y1\", 0)\r\n      .attr(\"y2\", 0);\r\n    newRows\r\n      .append(\"text\")\r\n      .attr(\"class\", \"catLabel label_horz\")\r\n      .style(\"font-size\", this.setListSummary.block.catLabelFontSize + \"px\")\r\n      .text((aggr: Aggregate_Category) => {\r\n        tmp.innerHTML = aggr.label;\r\n        return tmp.textContent || tmp.innerText || \"\";\r\n      })\r\n      .on(\"click\", (_event, aggr: Aggregate_Category) => {\r\n        this.setListSummary.filterCategory(aggr, \"AND\");\r\n      });\r\n\r\n    newRows\r\n      .append(\"line\")\r\n      .attr(\"class\", \"line line_horz\")\r\n      .attr(\"x1\", 0)\r\n      .attr(\"y1\", 0)\r\n      .attr(\"y2\", 0);\r\n    newRows\r\n      .append(\"text\")\r\n      .attr(\"class\", \"catLabel label_vert\")\r\n      .style(\"font-size\", this.setListSummary.block.catLabelFontSize + \"px\")\r\n      .text((aggr: Aggregate_Category) => {\r\n        tmp.innerHTML = aggr.label;\r\n        return tmp.textContent || tmp.innerText || \"\";\r\n      })\r\n      .attr(\"y\", -4);\r\n\r\n    tmp.remove();\r\n\r\n    this.DOM.setRows = this.DOM.setMatrixSVG.selectAll(\"g.rows > g.row\");\r\n    this.DOM.line_vert = this.DOM.setMatrixSVG.selectAll(\r\n      \"g.rows > g.row > line.line_vert\"\r\n    );\r\n    this.DOM.line_horz = this.DOM.setMatrixSVG.selectAll(\r\n      \"g.rows > g.row > line.line_horz\"\r\n    );\r\n    this.DOM.line_horz_label = this.DOM.setMatrixSVG.selectAll(\r\n      \"g.rows > g.row > text.label_horz\"\r\n    );\r\n    this.DOM.line_vert_label = this.DOM.setMatrixSVG.selectAll(\r\n      \"g.rows > g.row > text.label_vert\"\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshViz_Active() {\r\n    this.DOM.aggrGlyphs.attr(\"activesize\", (aggr) => aggr.measure(\"Active\"));\r\n    this.DOM.measure_Active\r\n      .transition()\r\n      .ease(d3.easeLinear)\r\n      .duration(500)\r\n      .attr(\r\n        \"r\",\r\n        this.usingFullSizeGlyph()\r\n          ? (setPair) => this.setPairRadius + (setPair.subt ? -1 : 0)\r\n          : (setPair) => this.getCliqueSizeRatio(setPair) * this.setPairRadius\r\n      );\r\n  }\r\n\r\n  /** -- */\r\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts) {\r\n    var strokeWidth = (aggr) => 0;\r\n    var aggrValue = (aggr, sT) => aggr.ratioToActive(sT);\r\n    var usingFullSizeGlyph = this.usingFullSizeGlyph();\r\n    if (!this.browser.stackedCompare) {\r\n      strokeWidth = (aggr) =>\r\n        (this.setPairRadius / totalGroups) *\r\n        (usingFullSizeGlyph ? 1 : this.getCliqueSizeRatio(aggr));\r\n      prevCts = [];\r\n    }\r\n\r\n    if (this.browser.dependentBreakdown) {\r\n      aggrValue = (aggr, sT) =>\r\n        aggr[sT].measure /\r\n        (this.browser.allRecordsAggr[cT].measure || 10000000000000);\r\n    }\r\n\r\n    this.DOM[\"measure_\" + cT]\r\n      .style(\"stroke-width\", strokeWidth)\r\n      .transition()\r\n      .ease(d3.easeLinear)\r\n      .duration(\r\n        curGroup === totalGroups - 1 && this.browser.addedCompare ? 500 : 0\r\n      )\r\n      .attrTween(\"d\", (aggr, i, nodes) => {\r\n        var DOM = nodes[i];\r\n        var offset = prevCts.reduce(\r\n          (accum, sT) => accum + aggrValue(aggr, sT),\r\n          0\r\n        );\r\n        var angleInterp = d3.interpolate(\r\n          DOM._currentPreviewAngle,\r\n          aggrValue(aggr, cT)\r\n        );\r\n        var r =\r\n          this.setPairRadius *\r\n            (usingFullSizeGlyph ? 1 : this.getCliqueSizeRatio(aggr)) -\r\n          (this.browser.stackedCompare\r\n            ? 0\r\n            : (curGroup + 0.5) * strokeWidth(aggr)); // side-by-side radius adjust\r\n        return (t) => {\r\n          var newAngle = angleInterp(t);\r\n          DOM._currentPreviewAngle = newAngle;\r\n          return Util.getPieSVGPath(\r\n            offset,\r\n            newAngle,\r\n            r,\r\n            !this.browser.stackedCompare\r\n          );\r\n        };\r\n      });\r\n  }\r\n\r\n  chartAxis_Measure_TickSkip(): number {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n\r\n  /** -- */\r\n  updateAfterFilter(refreshViz: boolean): void {\r\n    if (!this.isVisible()) return;\r\n    this.updateMaxAggr_Active();\r\n    this.refreshViz_All();\r\n    this.refreshViz_NoValueAggr();\r\n\r\n    this.DOM.setRows.style(\"opacity\", (row) =>\r\n      row.Active.measure > 0 ? 1 : 0.3\r\n    );\r\n\r\n    this.refreshSetPair_Containment();\r\n  }\r\n\r\n  /** Does not work with Avg pair */\r\n  private refreshSetPair_Containment() {\r\n    var numOfSubsets = 0;\r\n    this.DOM.aggrGlyphs\r\n      .each((setPair) => {\r\n        var setPair_itemCount = setPair.Active.measure;\r\n        var set_1_itemCount = setPair.set_1.Active.measure;\r\n        var set_2_itemCount = setPair.set_2.Active.measure;\r\n        if (\r\n          setPair_itemCount === set_1_itemCount ||\r\n          setPair_itemCount === set_2_itemCount\r\n        ) {\r\n          numOfSubsets++;\r\n          setPair.subset =\r\n            set_1_itemCount === set_2_itemCount ? \"equal\" : \"proper\";\r\n        } else {\r\n          setPair.subset = \"\";\r\n        }\r\n      })\r\n      .classed(\"isSubset\", (setPair) => setPair.subset !== \"\");\r\n\r\n    this.DOM.subsetCount.style(\"display\", numOfSubsets === 0 ? \"none\" : null);\r\n    this.DOM.subsetCount_Text.text(numOfSubsets);\r\n\r\n    this.refreshSetPair_Strength();\r\n  }\r\n\r\n  /** -- */\r\n  onSetPairEnter(aggr: Aggregate_SetPair) {\r\n    aggr.set_1.DOM.matrixRow?.setAttribute(\"selection\", \"selected\");\r\n    aggr.set_2.DOM.matrixRow?.setAttribute(\"selection\", \"selected\");\r\n    this.browser.setSelect_Compare(aggr);\r\n  }\r\n\r\n  /** -- */\r\n  onSetPairLeave(aggr: Aggregate_SetPair) {\r\n    aggr.set_1.DOM.matrixRow?.removeAttribute(\"selection\");\r\n    aggr.set_2.DOM.matrixRow?.removeAttribute(\"selection\");\r\n    this.browser.clearSelect_Compare();\r\n    this.browser.refreshAllMeasureLabels(\"Active\");\r\n  }\r\n\r\n  /** -- */\r\n  private refreshSetPair_Strength() {\r\n    var strengthColor = d3.interpolateHsl(\r\n      d3.rgb(169, 181, 190),\r\n      d3.rgb(232, 235, 238)\r\n    );\r\n\r\n    let _maxSimilarity = d3.max(this.setPairs, (aggr: Aggregate_SetPair) =>\r\n      aggr.similarityScore()\r\n    );\r\n\r\n    this.DOM.setPairBackground\r\n      .style(\"fill\", (setPair: Aggregate_SetPair) =>\r\n        strengthColor(setPair.similarityScore() / _maxSimilarity)\r\n      )\r\n      .each((setPair, i, nodes) => {\r\n        var _DOM = nodes[i];\r\n        // border\r\n        if (setPair.subset === \"\") return;\r\n        if (setPair.subset === \"equal\") {\r\n          _DOM.style.strokeDasharray = \"\";\r\n          _DOM.style.strokeDashoffset = \"\";\r\n          return;\r\n        }\r\n        var halfCircle = (this.setPairRadius - 1) * Math.PI;\r\n        _DOM.style.strokeDasharray = halfCircle + \"px\";\r\n        // rotate halfway\r\n        var i1 = setPair.set_1.orderIndex;\r\n        var i2 = setPair.set_2.orderIndex;\r\n        var c1 = setPair.set_1.Active.measure;\r\n        var c2 = setPair.set_2.Active.measure;\r\n        if ((i1 < i2 && c1 < c2) || (i1 > i2 && c1 > c2))\r\n          halfCircle = halfCircle / 2;\r\n        _DOM.style.strokeDashoffset = halfCircle + \"px\";\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  insertSetPairs() {\r\n    var me = this;\r\n    var newCliques = this.DOM.setMatrixSVG\r\n      .select(\"g.setPairGroup\")\r\n      .selectAll(\"g.setPairGlyph\")\r\n      .data(this.setPairs, (_, i) => i)\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr(\"class\", \"aggrGlyph setPairGlyph\")\r\n      .each((d: Aggregate_SetPair, i, nodes) => {\r\n        d.setAggrGlyph(nodes[i]);\r\n      })\r\n      .tooltip((aggr: Aggregate_SetPair) => aggr.getTooltipHTML(), {\r\n        theme: \"dark kshf-tooltip kshf-record\",\r\n        placement: \"right\",\r\n        animation: \"fade\",\r\n        boundary: \"window\",\r\n        trigger: \"manual\",\r\n      })\r\n      .on(\"mouseenter\", (event, aggr: Aggregate_SetPair) => {\r\n        if (me.browser.adjustMode) return;\r\n        var DOM = event.currentTarget;\r\n        if (DOM.highlightTimeout) window.clearTimeout(DOM.highlightTimeout);\r\n        DOM.highlightTimeout = window.setTimeout(() => {\r\n          DOM.tippy.show();\r\n          this.onSetPairEnter(aggr);\r\n        }, me.browser.movingMouseDelay);\r\n      })\r\n      .on(\"mouseleave\", (event, aggr: Aggregate_SetPair) => {\r\n        var DOM = event.currentTarget;\r\n        if (DOM.highlightTimeout) window.clearTimeout(DOM.highlightTimeout);\r\n        DOM.tippy.hide();\r\n        this.onSetPairLeave(aggr);\r\n      })\r\n      .on(\"click\", (_event, aggr: Aggregate_SetPair) => {\r\n        this.setListSummary.filterCategory(aggr.set_1, \"AND\");\r\n        this.setListSummary.filterCategory(aggr.set_2, \"AND\");\r\n      });\r\n\r\n    newCliques\r\n      .append(\"rect\")\r\n      .attr(\"class\", \"setPairBackground\")\r\n      .attr(\"rx\", 3)\r\n      .attr(\"ry\", 3);\r\n    var measureGroup = newCliques.append(\"g\").attr(\"class\", \"measureGroup\");\r\n    measureGroup\r\n      .append(\"circle\")\r\n      .attr(\"class\", \"measure_Active\")\r\n      .attr(\"cx\", 0)\r\n      .attr(\"cy\", 0)\r\n      .attr(\"r\", 0);\r\n    Base.Compare_List.forEach((cT) => {\r\n      this.DOM[\"measure_\" + cT] = measureGroup\r\n        .append(\"path\")\r\n        .attr(\"class\", \"measure_\" + cT)\r\n        .each((_d, i, nodes) => {\r\n          nodes[i]._currentPreviewAngle = 0;\r\n        });\r\n    });\r\n\r\n    this.DOM.aggrGlyphs = this.DOM.setPairGroup.selectAll(\".setPairGlyph\");\r\n    this.DOM.setPairBackground =\r\n      this.DOM.aggrGlyphs.selectAll(\".setPairBackground\");\r\n    [\"Active\"].concat(Base.Compare_List).forEach((t) => {\r\n      this.DOM[\"measure_\" + t] = this.DOM.aggrGlyphs.selectAll(\".measure_\" + t);\r\n    });\r\n  }\r\n\r\n  /** Axis is shown as a separate legend for set summaries */\r\n  refreshViz_Axis() {\r\n    this.refreshSetPair_Strength();\r\n\r\n    if (this.usingFullSizeGlyph()) {\r\n      this.DOM.scaleLegend_SVG.style(\"dislay\", \"none\");\r\n      return;\r\n    }\r\n    this.DOM.scaleLegend_SVG.style(\"display\", \"block\");\r\n\r\n    this.DOM.scaleLegend_SVG\r\n      .attr(\"width\", this.setPairDiameter + 50)\r\n      .attr(\"height\", this.setPairDiameter + 10)\r\n      .attr(\r\n        \"viewBox\",\r\n        \"0 0 \" + (this.setPairDiameter + 35) + \" \" + (this.setPairDiameter + 10)\r\n      );\r\n\r\n    this.DOM.legend_Group.attr(\r\n      \"transform\",\r\n      `translate(${this.setPairRadius},${this.setPairRadius + 18})`\r\n    );\r\n    this.DOM.legendHeader.attr(\r\n      \"transform\",\r\n      `translate(${this.setPairDiameter + 3},6)`\r\n    );\r\n\r\n    var maxVal = this._maxSetPairAggr_Active;\r\n\r\n    var tickValues = [maxVal];\r\n    if (this.setPairRadius > 8) tickValues.push(Math.round(maxVal / 4));\r\n\r\n    this.DOM.legend_Group.selectAll(\"g.legendMark\").remove();\r\n\r\n    var tickDoms = this.DOM.legend_Group\r\n      .selectAll(\"g.legendMark\")\r\n      .data(tickValues, (i) => i);\r\n\r\n    this.DOM.legendCircleMarks = tickDoms\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr(\"class\", \"legendMark\");\r\n\r\n    this.DOM.legendCircleMarks\r\n      .append(\"circle\")\r\n      .attr(\"class\", \"legendCircle\")\r\n      .attr(\"cx\", 0)\r\n      .attr(\"cy\", 0)\r\n      .attr(\"r\", (d) => this.setPairRadius * Math.sqrt(d / maxVal));\r\n    this.DOM.legendCircleMarks\r\n      .append(\"line\")\r\n      .attr(\"class\", \"legendLine\")\r\n      .each((d, i, nodes) => {\r\n        var rx = this.setPairRadius + 3;\r\n        var ry = this.setPairRadius * Math.sqrt(d / maxVal);\r\n        var x2, y1;\r\n        switch (i % 4) {\r\n          case 0:\r\n            x2 = rx;\r\n            y1 = -ry;\r\n            break;\r\n          case 1:\r\n            x2 = rx; // -rx;\r\n            y1 = ry; // -ry;\r\n            break;\r\n          case 2:\r\n            x2 = rx;\r\n            y1 = ry;\r\n            break;\r\n          case 3:\r\n            x2 = -rx;\r\n            y1 = ry;\r\n            break;\r\n        }\r\n        nodes[i].setAttribute(\"x1\", 0);\r\n        nodes[i].setAttribute(\"x2\", x2);\r\n        nodes[i].setAttribute(\"y1\", y1);\r\n        nodes[i].setAttribute(\"y2\", y1);\r\n      });\r\n    this.DOM.legendText = this.DOM.legendCircleMarks\r\n      .append(\"text\")\r\n      .attr(\"class\", \"legendLabel\");\r\n\r\n    this.DOM.legendText.each((d, i, nodes) => {\r\n      var rx = this.setPairRadius + 3;\r\n      var ry = this.setPairRadius * Math.sqrt(d / maxVal);\r\n      var x2, y1;\r\n      switch (i % 4) {\r\n        case 0:\r\n          x2 = rx;\r\n          y1 = -ry;\r\n          break;\r\n        case 1:\r\n          x2 = rx; // -rx;\r\n          y1 = ry; // -ry;\r\n          break;\r\n        case 2:\r\n          x2 = rx;\r\n          y1 = ry;\r\n          break;\r\n        case 3:\r\n          x2 = -rx;\r\n          y1 = ry;\r\n          break;\r\n      }\r\n      nodes[i].setAttribute(\"transform\", `translate(${x2},${y1})`);\r\n      nodes[i].style.textAnchor = i % 2 === 0 || true ? \"start\" : \"end\";\r\n    });\r\n\r\n    this.DOM.legendText.text((d) => {\r\n      return d3.format(\"0.1s\")(d);\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  refreshWindowSize() {\r\n    var w = this.getWidth();\r\n    var h = this.getHeight();\r\n    this.DOM.wrapper.style(\r\n      \"height\",\r\n      this.setListSummary.block.getHeight() -\r\n        this.setListSummary.block.height_Header +\r\n        \"px\"\r\n    );\r\n    this.DOM.setMatrixBackground\r\n      .attr(\"x\", -w * 24)\r\n      .attr(\"y\", -h * 24)\r\n      .attr(\"width\", w * 50)\r\n      .attr(\"height\", h * 50);\r\n    this.DOM.root\r\n      .style(this.popupSide, -w + \"px\")\r\n      .style(\"width\", w + \"px\")\r\n      .style(this.popupSide === \"left\" ? \"right\" : \"left\", \"initial\");\r\n\r\n    if (!this.pausePanning) {\r\n      this.refreshSVGViewBox();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  public refreshPopupSide() {\r\n    this.DOM.root.attr(\"data-popupSide\", this.popupSide);\r\n    this.refreshRow();\r\n    this.refreshSetPair_Position();\r\n    this.refreshSVGViewBox();\r\n  }\r\n\r\n  /** -- */\r\n  public refreshSVGViewBox() {\r\n    var w = this.getWidth();\r\n    var h = this.getHeight();\r\n    var t = this.setListSummary.block.scrollTop_cache;\r\n    var r =\r\n      Math.max(t + this.gridPan_x, 0) * (this.popupSide === \"left\" ? -1 : 1);\r\n    this.DOM.setMatrixSVG\r\n      .attr(\"width\", w)\r\n      .attr(\"height\", h)\r\n      .attr(\"viewBox\", r + \" \" + t + \" \" + w + \" \" + h);\r\n    this.refreshLabel_Vert_Show();\r\n  }\r\n\r\n  /** -- */\r\n  private refreshSetPair_Background() {\r\n    this.DOM.setPairBackground\r\n      .attr(\"x\", -this.setPairRadius)\r\n      .attr(\"y\", -this.setPairRadius)\r\n      .attr(\"width\", this.setPairDiameter)\r\n      .attr(\"height\", this.setPairDiameter);\r\n  }\r\n\r\n  /** -- */\r\n  refreshLabel_Vert_Show() {\r\n    var totalWidth = this.getWidth();\r\n    var totalHeight = this.getHeight();\r\n    var t = this.setListSummary.block.scrollTop_cache;\r\n    this.DOM.line_vert_label // points up/right\r\n      .attr(\"show\", (d) => !d.isVisible)\r\n      .attr(\"transform\", (d) => {\r\n        var i = d.orderIndex;\r\n\r\n        var x = totalWidth - (i + 0.5) * this.rowHeight - 2;\r\n        if (this.popupSide === \"right\") x = totalWidth - x - 4;\r\n\r\n        var y =\r\n          (this.setListSummary.block.catCount_Active - i - 1) * this.rowHeight -\r\n          this.setListSummary.block.height_VisibleAttrib +\r\n          this.setListSummary.block.scrollTop_cache +\r\n          totalHeight;\r\n        return `translate(${x} ${y}) rotate(-90)`;\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  refreshRow() {\r\n    this.refreshWindowSize();\r\n    this.DOM.setRows.attr(\r\n      \"transform\",\r\n      (row) => `translate(0,${(row.orderIndex + 0.5) * this.rowHeight})`\r\n    );\r\n    this.refreshRow_LineWidths();\r\n  }\r\n\r\n  /** -- */\r\n  refreshSetPair_Position() {\r\n    var w = this.getWidth();\r\n    this.DOM.aggrGlyphs.style(\"transform\", (setPair) => {\r\n      var i1 = setPair.set_1.orderIndex;\r\n      var i2 = setPair.set_2.orderIndex;\r\n      var left = (Math.min(i1, i2) + 0.5) * this.rowHeight;\r\n      if (this.popupSide === \"left\") left = w - left;\r\n      var top = (Math.max(i1, i2) + 0.5) * this.rowHeight;\r\n      return `translate(${left}px,${top}px)`;\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  private refreshRow_LineWidths() {\r\n    var setPairDiameter = this.setListSummary.barHeight.get();\r\n    var totalWidth = this.getWidth();\r\n\r\n    // vertical lines\r\n    this.DOM.line_vert.each((d, i, nodes) => {\r\n      var _DOM = nodes[i];\r\n      var i = d.orderIndex;\r\n      var height =\r\n        (this.setListSummary.block.catCount_Active - i - 1) * setPairDiameter;\r\n      var right = (i + 0.5) * setPairDiameter;\r\n      var m = this.popupSide === \"left\" ? totalWidth - right : right;\r\n      _DOM.setAttribute(\"x1\", m);\r\n      _DOM.setAttribute(\"x2\", m);\r\n      _DOM.setAttribute(\"y2\", height);\r\n    });\r\n\r\n    // horizontal lines\r\n    this.DOM.line_horz\r\n      .attr(\"x2\", this.popupSide === \"left\" ? totalWidth : 0)\r\n      .attr(\"x1\", (d) => {\r\n        var m = (d.orderIndex + 0.5) * setPairDiameter;\r\n        return this.popupSide === \"left\" ? totalWidth - m : m;\r\n      });\r\n    this.DOM.line_horz_label.attr(\"transform\", (d) => {\r\n      var m = (d.orderIndex + 0.5) * setPairDiameter + 2;\r\n      if (this.popupSide === \"left\") m = totalWidth - m;\r\n      return `translate(${m} 0)`;\r\n    });\r\n  }\r\n}\r\n","import { Aggregate_Category } from \"./Aggregate_Category\";\r\nimport { Aggregate_SetPair } from \"./Aggregate_SetPair\";\r\n\r\nimport { i18n } from \"./i18n.js\";\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Block_Set } from \"./Block_Set\";\r\n\r\n/** -- */\r\nexport class Attrib_Set extends Attrib {\r\n  // may have a single parent attribute\r\n  protected readonly _parent: Attrib_Categorical;\r\n  get parent(): Attrib_Categorical {\r\n    return this._parent;\r\n  }\r\n  get setListAttrib() {\r\n    return this._parent;\r\n  }\r\n\r\n  // The associated block (view) - null by default\r\n  protected _block: Block_Set;\r\n  public get block(): Block_Set {\r\n    return this._block;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Aggregates (setpairs)\r\n  // ********************************************************************\r\n\r\n  public _aggrs: Aggregate_SetPair[] = [];\r\n  // just renaming for convenience\r\n  public get setPairs() {\r\n    return this._aggrs;\r\n  }\r\n\r\n  private _setPairs_ID: {\r\n    [index: string]: { [index: string]: Aggregate_SetPair };\r\n  } = {};\r\n\r\n  // sets are parent summaries aggregates\r\n  get sets() {\r\n    return this.setListAttrib._aggrs;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Constructor\r\n  // ********************************************************************\r\n\r\n  constructor(browser, parent: Attrib_Categorical) {\r\n    super(\r\n      browser,\r\n      i18n.SetPairTitle(parent.attribName),\r\n      null, // no template, no accessor\r\n      \"setpair\",\r\n      \"setPairSummary\",\r\n      \"\" // not in attribute list\r\n    );\r\n\r\n    this._parent = parent;\r\n\r\n    this._block = new Block_Set(this);\r\n  }\r\n\r\n  /** -- */\r\n  initializeAggregates(): void {\r\n    if (this.aggr_initialized) return;\r\n\r\n    this.createSetPairs();\r\n\r\n    this.block.initDOM();\r\n\r\n    this.aggr_initialized = true;\r\n  }\r\n\r\n  getAggregate(set_1, set_2): Aggregate_SetPair {\r\n    var setPair = this._setPairs_ID[set_1.id][set_2.id];\r\n    if (!setPair) {\r\n      setPair = new Aggregate_SetPair(this.setListAttrib, set_1, set_2);\r\n      set_1.setPairs.push(setPair);\r\n      set_2.setPairs.push(setPair);\r\n      this.setPairs.push(setPair);\r\n      this._setPairs_ID[set_1.id][set_2.id] = setPair;\r\n      this.browser.allAggregates.push(setPair);\r\n    }\r\n    return setPair;\r\n  }\r\n\r\n  /** For each element in the given list, checks the set membership and adds setPairs */\r\n  private createSetPairs() {\r\n    this.sets.forEach((aggr) => {\r\n      aggr.setPairs = [];\r\n    });\r\n\r\n    var insertToClique = (set_1, set_2, record) => {\r\n      // avoid self reference and adding the same record twice\r\n      // (insert only A-B, not B-A / A-A / B-B)\r\n      if (set_2.id <= set_1.id) return;\r\n\r\n      if (this._setPairs_ID[set_1.id] === undefined)\r\n        this._setPairs_ID[set_1.id] = {};\r\n\r\n      this.getAggregate(set_1, set_2).addRecord(record);\r\n    };\r\n\r\n    var getSetAggr = (v: string): Aggregate_Category => {\r\n      return this.setListAttrib.getAggrWithLabel(v);\r\n    };\r\n    this.setListAttrib.records.forEach((record) => {\r\n      // read raw values, not with labeling applied\r\n      var values: string[] = record.getValue(this.setListAttrib);\r\n      if (values === null) return; // maps to no value\r\n      if (values.length < 2) return; // maps to one value\r\n      values.forEach((v_1: string) => {\r\n        var set_1 = getSetAggr(v_1);\r\n        if (!set_1.setPairs) return;\r\n        values.forEach((v_2: string) => {\r\n          var set_2 = getSetAggr(v_2);\r\n          if (!set_2.setPairs) return;\r\n          insertToClique(set_1, set_2, record);\r\n        });\r\n      });\r\n    });\r\n\r\n    this.block.updateMaxAggr_Active();\r\n  }\r\n\r\n  /** --*/\r\n  updatePerceptualOrder() {\r\n    // Edges are set-pairs with at least one element inside (based on the filtering state)\r\n    var edges = this.setPairs.filter((aggr) => aggr.measure(\"Active\") > 0);\r\n    // Nodes are the set-categories\r\n    var nodes = this.sets;\r\n\r\n    // Initialize per-node (per-set) data structures\r\n    nodes.forEach((node: Aggregate_Category) => {\r\n      node.MST = {\r\n        tree: new Object(), // Some unqiue identifier, to check if two nodes are in the same tree.\r\n        childNodes: [],\r\n        parentNode: null,\r\n      };\r\n    });\r\n\r\n    // Compute the perceptual distance metric\r\n    edges.forEach((edge: Aggregate_SetPair) => {\r\n      var set_1 = edge.set_1;\r\n      var set_2 = edge.set_2;\r\n      edge.mst_distance = 0;\r\n\r\n      // For every intersection of set_1\r\n      set_1.setPairs.forEach((setPair_1: Aggregate_SetPair) => {\r\n        if (setPair_1 === edge) return;\r\n        var set_other =\r\n          setPair_1.set_1 === set_1 ? setPair_1.set_2 : setPair_1.set_1;\r\n\r\n        // find the set-pair of set_2 and set_other;\r\n        var setPair_2: Aggregate_SetPair = null;\r\n        if (set_2.id > set_other.id) {\r\n          if (this._setPairs_ID[set_other.id])\r\n            setPair_2 = this._setPairs_ID[set_other.id][set_2.id];\r\n        } else {\r\n          if (this._setPairs_ID[set_2.id])\r\n            setPair_2 = this._setPairs_ID[set_2.id][set_other.id];\r\n        }\r\n\r\n        if (!setPair_2) {\r\n          // the other intersection size is zero, there is no link\r\n          edge.mst_distance += setPair_1.measure(\"Active\");\r\n          return;\r\n        }\r\n        edge.mst_distance += Math.abs(\r\n          setPair_1.measure(\"Active\") - setPair_2.measure(\"Active\")\r\n        );\r\n      });\r\n\r\n      // For every intersection of set_2\r\n      set_2.setPairs.forEach((setPair_1: Aggregate_SetPair) => {\r\n        if (setPair_1 === edge) return;\r\n        var set_other =\r\n          setPair_1.set_1 === set_2 ? setPair_1.set_2 : setPair_1.set_1;\r\n        // find the set-pair of set_1 and set_other;\r\n        var setPair_2 = undefined;\r\n        if (set_1.id > set_other.id) {\r\n          if (this._setPairs_ID[set_other.id])\r\n            setPair_2 = this._setPairs_ID[set_other.id][set_1.id];\r\n        } else {\r\n          if (this._setPairs_ID[set_1.id])\r\n            setPair_2 = this._setPairs_ID[set_1.id][set_other.id];\r\n        }\r\n        if (setPair_2 === undefined) {\r\n          // the other intersection size is zero, there is no link\r\n          edge.mst_distance += setPair_1.measure(\"Active\");\r\n          return;\r\n        }\r\n        // If ther is setPair_2, it was already processed in the main loop above\r\n      });\r\n    });\r\n\r\n    // Order the edges (setPairs) by their distance (lower score is better)\r\n    edges.sort(\r\n      (e1: Aggregate_SetPair, e2: Aggregate_SetPair) =>\r\n        e1.mst_distance - e2.mst_distance\r\n    );\r\n\r\n    // Run Kruskal's algorithm...\r\n    edges.forEach((setPair) => {\r\n      var node_1 = setPair.set_1;\r\n      var node_2 = setPair.set_2;\r\n      // set_1 and set_2 are in the same tree\r\n      if (node_1.MST.tree === node_2.MST.tree) return;\r\n      // set_1 and set_2 are not in the same tree, connect set_2 under set_1\r\n      var set_above: Aggregate_Category, set_below: Aggregate_Category;\r\n      if (node_1.setPairs.length < node_2.setPairs.length) {\r\n        set_above = node_1;\r\n        set_below = node_2;\r\n      } else {\r\n        set_above = node_2;\r\n        set_below = node_1;\r\n      }\r\n      set_below.MST.tree = set_above.MST.tree;\r\n      set_below.MST.parentNode = set_above;\r\n      set_above.MST.childNodes.push(set_below);\r\n    });\r\n\r\n    // Identify the root-nodes of resulting MSTs\r\n    var treeRootNodes = nodes.filter((node) => {\r\n      return node.MST.parentNode === null;\r\n    });\r\n\r\n    // We can have multiple trees (there can be sub-groups disconnected from each other)\r\n\r\n    // Update tree size recursively by starting at the root nodes\r\n    var updateTreeSize = (node: Aggregate_Category) => {\r\n      node.MST.treeSize = 1;\r\n      node.MST.childNodes.forEach((childNode) => {\r\n        node.MST.treeSize += updateTreeSize(childNode);\r\n      });\r\n      return node.MST.treeSize;\r\n    };\r\n    treeRootNodes.forEach((rootNode: Aggregate_Category) => {\r\n      updateTreeSize(rootNode);\r\n    });\r\n\r\n    // Sort the root nodes by largest tree first\r\n    treeRootNodes.sort(\r\n      (node1, node2) => node1.MST.treeSize - node2.MST.treeSize\r\n    );\r\n\r\n    // For each MST, traverse the nodes and add the MST (perceptual) node index incrementally\r\n    var mst_index = 0;\r\n    var updateNodeIndex = (node: Aggregate_Category) => {\r\n      node.MST.childNodes.forEach((chileNode) => {\r\n        chileNode.MST.order = mst_index++;\r\n      });\r\n      node.MST.childNodes.forEach((chileNode) => {\r\n        updateNodeIndex(chileNode);\r\n      });\r\n    };\r\n    treeRootNodes.forEach((node) => {\r\n      node.MST.order = mst_index++;\r\n      updateNodeIndex(node);\r\n    });\r\n  }\r\n\r\n  isExportable(): boolean{\r\n    return false;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Not applicable\r\n  // ********************************************************************\r\n\r\n  /** It doesn't have its own filter - uses filter of parent category instead */\r\n  createSummaryFilter(): void {}\r\n  /** Special templates do not apply */\r\n  applyTemplateSpecial(): void {}\r\n\r\n  /** not used for set/ circle size calculations, just implementing the interface */\r\n  get measureRangeMax(): number {\r\n    return this.block.setPairRadius;\r\n  }\r\n  updateChartScale_Measure() : void{\r\n    if (!this.block.isVisible()) return;\r\n    this.block?.refreshViz_All();\r\n  }\r\n  chartAxis_Measure_TickSkip(): number {\r\n    throw new Error(\"Not applicable.\");\r\n  }\r\n\r\n  isEmpty() {\r\n    return false;\r\n  }\r\n  isFiltered(): boolean {\r\n    return this.setListAttrib.isFiltered();\r\n  }\r\n}\r\n","import { Aggregate_Category } from \"./Aggregate_Category\";\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Filter } from \"./Filter\";\r\n\r\nimport { Filter_Categorical_Spec } from \"./Types\";\r\nimport { Record } from \"./Record\";\r\nimport { i18n } from \"./i18n\";\r\n\r\nexport class Filter_Categorical extends Filter {\r\n  public readonly attrib: Attrib_Categorical;\r\n\r\n  public selected_AND: Aggregate_Category[] = [];\r\n  public selected_OR: Aggregate_Category[] = [];\r\n  public selected_NOT: Aggregate_Category[] = [];\r\n\r\n  constructor(_browser: Browser, attrib: Attrib_Categorical) {\r\n    super(_browser);\r\n    this.attrib = attrib;\r\n  }\r\n\r\n  get title(): string {\r\n    return this.attrib.attribName;\r\n  }\r\n\r\n  selectedCount_Total(): number {\r\n    return (\r\n      this.selected_AND.length +\r\n      this.selected_OR.length +\r\n      this.selected_NOT.length\r\n    );\r\n  }\r\n  selected_Any(): boolean {\r\n    return (\r\n      this.selected_AND.length > 0 ||\r\n      this.selected_OR.length > 0 ||\r\n      this.selected_NOT.length > 0\r\n    );\r\n  }\r\n  selected_None(): boolean {\r\n    return (\r\n      this.selected_AND.length === 0 &&\r\n      this.selected_OR.length === 0 &&\r\n      this.selected_NOT.length === 0\r\n    );\r\n  }\r\n  selected_AndOrNot(): Aggregate_Category[] {\r\n    return this.selected_AND.concat(this.selected_OR).concat(this.selected_NOT);\r\n  }\r\n\r\n  selected_All_clear(): void {\r\n    this.selected_AND = [];\r\n    this.selected_OR = [];\r\n    this.selected_NOT = [];\r\n  }\r\n\r\n  private setRecordCache(record: Record, v: boolean): void {\r\n    record.setFilterCache(this.filterID, v);\r\n  }\r\n\r\n  onFilter(): void {\r\n    var noValueOut = this.noValueAggr.filtered === \"out\";\r\n    var noValueIn = this.noValueAggr.filtered === \"in\";\r\n\r\n    this.attrib.records.forEach((record) => {\r\n      // Note: Using direct access here.\r\n      // This prevents applying the look-up table overwrite in this class\r\n      var recordVal_s = record.getValue(this.attrib);\r\n\r\n      if (noValueIn) {\r\n        return this.setRecordCache(record, recordVal_s == null);\r\n      }\r\n\r\n      if (recordVal_s == null) {\r\n        if (noValueOut) {\r\n          return this.setRecordCache(record, false);\r\n        }\r\n        // survives if AND and OR is not selected\r\n        this.setRecordCache(\r\n          record,\r\n          this.selected_AND.length === 0 && this.selected_OR.length === 0\r\n        );\r\n        return;\r\n      }\r\n\r\n      var getAggr = (v) => this.attrib.catTable_id[v];\r\n\r\n      // If any of the record values are selected with NOT, the record will be removed\r\n      if (this.selected_NOT.length > 0) {\r\n        if (!recordVal_s.every((v) => !getAggr(v).filtered_NOT())) {\r\n          return this.setRecordCache(record, false);\r\n        }\r\n      }\r\n\r\n      // All AND selections must be among the record values\r\n      if (this.selected_AND.length > 0) {\r\n        var t = 0; // Compute the number of record values selected with AND.\r\n        recordVal_s.forEach((v) => {\r\n          if (getAggr(v).filtered_AND()) t++;\r\n        });\r\n        if (t !== this.selected_AND.length) {\r\n          return this.setRecordCache(record, false);\r\n        }\r\n      }\r\n\r\n      // One of the OR selections must be among the record values\r\n      if (this.selected_OR.length > 0) {\r\n        return this.setRecordCache(\r\n          record,\r\n          recordVal_s.some((v) => getAggr(v).filtered_OR())\r\n        );\r\n      }\r\n\r\n      // only NOT selection\r\n      record.setFilterCache(this.filterID, true);\r\n    });\r\n\r\n    super.onFilter();\r\n  }\r\n\r\n  filterView_Detail() {\r\n    if (this.noValueAggr.filtered === \"in\") return i18n.NoData;\r\n\r\n    // 'this' is the Filter\r\n    // go over all records and prepare the list\r\n    var text = \"\";\r\n\r\n    if (this.noValueAggr.filtered === \"out\")\r\n      text = `(${i18n.ValidData})`;\r\n\r\n    var queryStr = (_type) =>\r\n      ` <span class='AndOrNot AndOrNot_${_type}'>\"${i18n[_type]}</span> `;\r\n\r\n    if (this.selectedCount_Total() > 4) {\r\n      text = `<b>${this.selectedCount_Total()}</b> selected`;\r\n    } else {\r\n      var selectedItemsCount = 0;\r\n\r\n      // OR selections\r\n      if (this.selected_OR.length > 0) {\r\n        var useBracket_or =\r\n          this.selected_AND.length > 0 || this.selected_NOT.length > 0;\r\n        if (useBracket_or) text += \"[\";\r\n        // X or Y or ....\r\n        this.selected_OR.forEach((_cat, i) => {\r\n          text +=\r\n            (i !== 0 || selectedItemsCount > 0 ? queryStr(\"Or\") : \"\") +\r\n            `<span class='optionName'>${_cat.label}</span>`;\r\n          selectedItemsCount++;\r\n        });\r\n        if (useBracket_or) text += \"]\";\r\n      }\r\n      // AND selections\r\n      this.selected_AND.forEach((_cat) => {\r\n        text +=\r\n          (text !== \"\" ? queryStr(\"And\") : \"\") +\r\n          `<span class='optionName'>${_cat.label}</span>`;\r\n        selectedItemsCount++;\r\n      });\r\n      // NOT selections\r\n      this.selected_NOT.forEach((_cat) => {\r\n        text += `${queryStr(\"Not\")}<span class='optionName'>${\r\n          _cat.label\r\n        }</span>`;\r\n        selectedItemsCount++;\r\n      });\r\n    }\r\n    return text;\r\n  }\r\n\r\n  exportFilter(): Filter_Categorical_Spec {\r\n    var _: Filter_Categorical_Spec = {};\r\n    if (this.noValueAggr.filtered) {\r\n      _.missing = this.noValueAggr.filtered;\r\n    } else {\r\n      [\"AND\", \"OR\", \"NOT\"].forEach((logic) => {\r\n        var selected_x = this[\"selected_\" + logic];\r\n        if (selected_x.length > 0) {\r\n          _[logic] = [];\r\n          selected_x.forEach((_cat) => {\r\n            _[logic].push(_cat.label);\r\n          });\r\n        }\r\n      });\r\n    }\r\n    return _;\r\n  }\r\n\r\n  importFilter(_: Filter_Categorical_Spec) {\r\n    if (_.missing) {\r\n      this.noValueAggr.filtered = _.missing;\r\n      this.setFiltered(false);\r\n    } else {\r\n      this.selected_All_clear();\r\n\r\n      [\"AND\", \"OR\", \"NOT\"].forEach((_type: \"AND\" | \"OR\" | \"NOT\") => {\r\n        if (!_[_type]) return;\r\n        // find category, and add filter\r\n        let ar: string[] = _[_type];\r\n        ar.forEach((catStr: string) => {\r\n          var aggr = this.attrib.catTable_id[catStr];\r\n          if(aggr){ \r\n            this.attrib.filterCategory(aggr, _type, \"All\", false/** skip update */);\r\n          }\r\n        });\r\n      });\r\n    }\r\n    if (this.isFiltered) {\r\n      this.applyFilter();\r\n    }\r\n  }\r\n}\r\n","import \"leaflet/dist/leaflet.css\";\r\nimport \"choices.js/public/assets/styles/choices.min.css\";\r\n\r\nimport { max } from \"d3-array\";\r\n\r\nimport { Block_Categorical } from \"./Block_Categorical\";\r\nimport { Aggregate_Category } from \"./Aggregate_Category\";\r\n\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Attrib_Set } from \"./Attrib_Set\";\r\nimport { Browser } from \"./Browser\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Config } from \"./Config\";\r\nimport { Modal } from \"./UI/Modal\";\r\nimport { Base } from \"./Base\";\r\nimport { Util } from \"./Util\";\r\nimport { Record } from \"./Record\";\r\nimport { Filter_Categorical } from \"./Filter_Categorical\";\r\nimport {\r\n  CatLabelSpec,\r\n  CatSortSpec,\r\n  RecordVisCoding,\r\n  SummaryConfig_Categorical,\r\n  SummarySpec,\r\n} from \"./Types\";\r\nimport { AttribTemplate } from \"./AttribTemplate\";\r\nimport { MapData } from \"./MapData\";\r\n\r\nconst d3 = { max };\r\n\r\nexport class Attrib_Categorical extends Attrib {\r\n  public _aggrs: Aggregate_Category[] = [];\r\n  catTable_id: { [key: string]: Aggregate_Category } = {};\r\n  private removedAggrs: Aggregate_Category[] = [];\r\n\r\n  protected _block: Block_Categorical;\r\n  public get block(): Block_Categorical {\r\n    return this._block;\r\n  }\r\n\r\n  public readonly barHeight: Config<number>;\r\n  public readonly minAggrSize: Config<number>;\r\n\r\n  get measureRangeMax(): number {\r\n    return this.block.width_CatChart;\r\n  }\r\n\r\n  applyTemplateSpecial(): void {\r\n    if (this.template.special === \"Year\") {\r\n      this.setSortingOption(\"id\");\r\n    } else if (this.template.special === \"Month\") {\r\n      this.setSortingOption(\"id\");\r\n      this.setCatLabel(i18n.Lookup_Months);\r\n    } else if (this.template.special === \"WeekDay\") {\r\n      this.setSortingOption(\"id\");\r\n      this.setCatLabel(i18n.Lookup_DaysOfWeek);\r\n    }\r\n  }\r\n\r\n  supportsRecordEncoding(coding: RecordVisCoding) {\r\n    if (this.isEmpty()) return false;\r\n    if (coding === \"text\") return true;\r\n    if (coding === \"textBrief\") return true;\r\n    return false;\r\n  }\r\n\r\n  constructor(browser: Browser, name: string, template: AttribTemplate) {\r\n    super(\r\n      browser,\r\n      name,\r\n      template,\r\n      \"categorical\",\r\n      \"kshfSummary_Categorical\",\r\n      \"fa fa-font\"\r\n    );\r\n\r\n    this.createSummaryFilter();\r\n\r\n    this._block = new Block_Categorical(this);\r\n\r\n    this.barHeight = new Config<number>({\r\n      parent: this,\r\n      cfgClass: \"barHeight\",\r\n      cfgTitle: \"RowHeight\",\r\n      iconClass: \"fa fa-arrows-v\",\r\n      UISeperator: {\r\n        title: \"Size\",\r\n        className: \"catSummary_ListOnly\",\r\n      },\r\n      default: Base.defaultBarHeight,\r\n      helparticle: \"5e87d6d004286364bc97d079\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" }, // special value\r\n        { name: \"1x\", value: 18, max: 32 },\r\n        { name: \"2x\", value: 32, max: 44 },\r\n        { name: \"3x\", value: 44, max: 56 },\r\n        { name: \"4x\", value: 56, max: 68 },\r\n        { name: \"5x\", value: 68, max: 80 },\r\n        { name: \"6x\", value: 80, max: 120 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -100, _type: \"plus\" }, // special value\r\n      ],\r\n      isActive: (d) =>\r\n        d.value && d.value <= this.barHeight.get() && d.max > this.barHeight.get(),\r\n      onDOM: (DOM) => {\r\n        DOM.root.classed(\"catSummary_ListOnly\", true);\r\n      },\r\n      preSet: async (v, opt) => {\r\n        if (v === -99) {\r\n          v = opt._value - 1;\r\n        } else if (v === -100) {\r\n          v = opt._value + 1;\r\n        }\r\n        return Math.min(85, Math.max(10, v));\r\n      },\r\n      onSet: () => {\r\n        if (this.block.isView_List) {\r\n          this.block.refreshHeight_Category();\r\n        } else {\r\n          this.block.heightRow_category_dirty = true;\r\n        }\r\n      },\r\n    });\r\n\r\n    let _timer;\r\n\r\n    this.minAggrSize = new Config<number>({\r\n      parent: this,\r\n      cfgClass: \"minAggrSize\",\r\n      cfgTitle: \"Show\",\r\n      iconClass: \"fa fa-eye-slash\",\r\n      default: 1,\r\n      itemOptions: [\r\n        { name: \"All\", value: 1 },\r\n        {\r\n          name: \"More than one\",\r\n          value: 10,\r\n        },\r\n      ],\r\n      UI: { disabled: true },\r\n      isActive: (d) => d.value\r\n        ? this.minAggrSize.get() > 1 \r\n        : this.minAggrSize.get() === 1,\r\n      onDOM: (DOM) => {\r\n        DOM.root\r\n          .select(\".minAggrSizeInput\")\r\n          .attr(\"value\", this.minAggrSize.get())\r\n          .attr(\r\n            \"max\",\r\n            d3.max(this._aggrs, (_cat) => _cat.records.length)\r\n          )\r\n          .on(\"input\", (event) => {\r\n            if (_timer) window.clearTimeout(_timer);\r\n            _timer = window.setTimeout(async () => {\r\n              await this.minAggrSize.set( Math.max(2, 1 * event.currentTarget.value) );\r\n            }, 500);\r\n          });\r\n      },\r\n      preSet: async (v) => Math.max(1, v),\r\n      onSet: (v) => this.setMinAggrSize(v),\r\n    });\r\n\r\n    this.setSortingOption();\r\n\r\n    this.finishTemplateSpecial();\r\n  }\r\n\r\n  // TODO incomplete\r\n  getAggrWithLabel(v: string): Aggregate_Category {\r\n    return this.catTable_id[v];\r\n  }\r\n\r\n  getAggregate(v: string): Aggregate_Category {\r\n    let aggr = this.catTable_id[v];\r\n    if (!aggr) {\r\n      aggr = new Aggregate_Category(this, v);\r\n      if(this.catLabel_attr[v]){\r\n        aggr.label = this.catLabel_attr[v];\r\n      }\r\n      this.catTable_id[v] = aggr;\r\n      this._aggrs.push(aggr);\r\n      this.browser.allAggregates.push(aggr);\r\n    }\r\n    return aggr;\r\n  }\r\n\r\n  initializeAggregates(): void {\r\n    if (this.aggr_initialized) return;\r\n\r\n    this.catTable_id = {};\r\n    this._aggrs = [];\r\n    this.removedAggrs = [];\r\n\r\n    var maxDegree = 0;\r\n\r\n    this.records.forEach((record) => {\r\n      var catValues = this.template.func.call(record.data, record);\r\n\r\n      // make catValues an array if it is not\r\n      if (!Array.isArray(catValues)) catValues = [catValues];\r\n\r\n      // trim whitespaces, remove invalid / empty string values\r\n      catValues = catValues\r\n        .map((e) => (e && e.trim ? e.trim() : e))\r\n        .filter((e) => e != null && e !== \"\")\r\n        .map((e) => \"\" + e); // convert to string\r\n\r\n      catValues = new Set(catValues); // remove duplicates\r\n\r\n      // Record is not mapped to any value (missing value)\r\n      if (catValues.size === 0) {\r\n        this.setRecordValueCacheToMissing(record);\r\n        return;\r\n      }\r\n\r\n      let cats: string[] = [];\r\n      catValues.forEach((id) => {\r\n        cats.push(id);\r\n        this.getAggregate(id).addRecord(record);\r\n      });\r\n      record.setValue(this, cats);\r\n\r\n      maxDegree = Math.max(maxDegree, catValues.size);\r\n    });\r\n\r\n    this.maxValueDegree = maxDegree;\r\n\r\n    this.aggr_initialized = true;\r\n  }\r\n\r\n  // Modified internal dataMap function - Skip rows with 0 active item count\r\n  setMinAggrSize(minSize) {\r\n    if (!this.aggr_initialized) return; // too early\r\n    var newAggrs = 0;\r\n    this.removedAggrs = this.removedAggrs.filter((cat) => {\r\n      if (cat.records.length >= minSize) {\r\n        this._aggrs.push(cat);\r\n        cat.usedAggr = true;\r\n        newAggrs++;\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n    this._aggrs = this._aggrs.filter((cat) => {\r\n      if (cat.records.length >= minSize) {\r\n        return true;\r\n      }\r\n      this.removedAggrs.push(cat);\r\n      cat.usedAggr = false;\r\n      cat.isActiveBefore = false;\r\n      cat.isActive = false;\r\n      cat.isVisibleBefore = false;\r\n      cat.isVisible = false;\r\n      delete cat.orderIndex;\r\n      if (cat.DOM.aggrGlyph) {\r\n        cat.DOM.aggrGlyph.remove();\r\n        delete cat.DOM.aggrGlyph;\r\n      }\r\n      return false;\r\n    });\r\n    if (!this.block.DOM.inited) return;\r\n    if (newAggrs) {\r\n      this.block.insertCategoryGlyphs();\r\n      this.block.refreshLabelWidth();\r\n    }\r\n    this.block.updateCats_IsActive();\r\n\r\n    this.block.refreshHeight_Category();\r\n    this.block.refreshConfigRowCount();\r\n    this.block.updateCatSorting_now();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Set summary / Maximum degree\r\n  // ********************************************************************\r\n\r\n  public setAttrib?: Attrib_Set | null = null;\r\n\r\n  private _maxValueDegree = 1;\r\n  get maxValueDegree() {\r\n    return this._maxValueDegree;\r\n  }\r\n  get isMultiValued() {\r\n    return this.maxValueDegree > 1;\r\n  }\r\n  set maxValueDegree(v) {\r\n    var _pre = this.maxValueDegree || 1;\r\n    this._maxValueDegree = v;\r\n\r\n    if (this._maxValueDegree !== _pre) {\r\n      this.block.DOM.root\r\n        ?.classed(\"isMultiValued\", this.isMultiValued)\r\n        .classed(\"supportsSetMatrix\", this.supportsSetMatrix);\r\n      // not ideal, need to generate the full list for now.\r\n      this.block.DOM.nugget\r\n        ?.select(\".fa-tags\")\r\n        .classed(\"active\", this.isMultiValued);\r\n    }\r\n  }\r\n  get supportsSetMatrix(): boolean {\r\n    // TODO: make this a configurable option?\r\n    return this.isMultiValued && this._aggrs.length >= 5;\r\n  }\r\n\r\n  showSetSummary() {\r\n    if (this.setAttrib) {\r\n      this.setAttrib.block.refreshPopupSide();\r\n      return;\r\n    }\r\n\r\n    this.setAttrib = new Attrib_Set(this.browser, this);\r\n    this.setAttrib.initializeAggregates();\r\n  }\r\n\r\n  onAggrClick(event, ctgry: Aggregate_Category) {\r\n    if (this.browser.adjustMode) return;\r\n    if (!this.isCatSelectable(ctgry)) return;\r\n\r\n    if (event && event.altKey) {\r\n      this.filterCategory(ctgry, \"NOT\");\r\n      //\r\n    } else if (event && event.shiftKey) {\r\n      this.browser.setSelect_Compare(ctgry, null, false);\r\n      this.browser.lockSelect_Compare();\r\n      //\r\n    } else if (this.dblClickTimer) {\r\n      this.unselectAllCategories();\r\n      this.filterCategory(ctgry, \"AND\", \"All\");\r\n      //\r\n    } else if (ctgry.isFiltered()) {\r\n      this.filterCategory(ctgry, \"NONE\");\r\n      //\r\n    } else if (this.isMultiValued || this.summaryFilter.selected_None()) {\r\n      this.filterCategory(ctgry, \"AND\");\r\n      //\r\n    } else {\r\n      // category not filtered, summary not multi-valued, and has some selection - remove all other selections.\r\n      this.summaryFilter.selected_AndOrNot().forEach((_) => _.set_NONE());\r\n\r\n      this.filterCategory(ctgry, \"AND\", \"All\");\r\n    }\r\n\r\n    if (this.isMultiValued) {\r\n      this.dblClickTimer = window.setTimeout(() => {\r\n        this.dblClickTimer = null;\r\n      }, 500);\r\n    }\r\n  }\r\n\r\n  onAggrHighlight(aggr: Aggregate_Category) {\r\n    if (this.browser.adjustMode) return;\r\n    if (!this.isCatSelectable(aggr)) return;\r\n    if (this.browser.mouseOverCompare.is(false)) return;\r\n\r\n    aggr.DOM.matrixRow?.setAttribute(\"selection\", \"selected\");\r\n\r\n    // Comes after setting select type of the category - visual feedback on selection...\r\n    if (!this.isMultiValued && this.summaryFilter.selected_AND.length !== 0)\r\n      return;\r\n\r\n    // Show the highlight\r\n    if (aggr.filtered_NOT()) return;\r\n    if (this.isMultiValued || this.summaryFilter.selected_AND.length === 0) {\r\n      this.browser.setSelect_Compare(aggr);\r\n    }\r\n  }\r\n\r\n  onAggrLeave(aggr: Aggregate_Category) {\r\n    if (this.browser.adjustMode) return;\r\n    if (aggr.locked) return;\r\n    aggr.unselectAggregate();\r\n    if (!this.isCatSelectable(aggr)) return;\r\n    this.browser.clearSelect_Compare();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering\r\n  // ********************************************************************\r\n\r\n  public summaryFilter: Filter_Categorical | null = null;\r\n\r\n  createSummaryFilter() {\r\n    this.summaryFilter = new Filter_Categorical(this.browser, this);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Sorting\r\n  // ********************************************************************\r\n\r\n  public catSortBy: CatSortSpec = \"Active\";\r\n  public catSortInverse = false;\r\n  public pleaseSort = false;\r\n\r\n  private _dirtySort = true;\r\n  set dirtySort(v) {\r\n    this._dirtySort = v;\r\n    this.block.DOM.catSortButton?.classed(\"resort\", v);\r\n  }\r\n  get dirtySort() {\r\n    return this._dirtySort || false;\r\n  }\r\n\r\n  setSortingOption(opt: CatSortSpec = \"Active\") {\r\n    this.catSortBy = opt;\r\n  }\r\n\r\n  get catOrder_Dynamic(): boolean {\r\n    if (typeof this.catSortBy === \"string\") {\r\n      if (this.catSortBy === \"alphanumeric\") return false;\r\n      if (this.catSortBy === \"id\") return false;\r\n      return true; // \"Active\", \"Compare_X\"\r\n    }\r\n    return false;\r\n  }\r\n  get catOrder_Fixed() {\r\n    return !this.catOrder_Dynamic;\r\n  }\r\n  setFixedCatOrder() {\r\n    // generates array of strings, from categorical aggregates, with the order of orderIndex\r\n    var m = this._aggrs.reduce((acc, aggr: Aggregate_Category) => {\r\n      acc[aggr.orderIndex] = aggr.label;\r\n      return acc;\r\n    }, []);\r\n\r\n    this.setSortingOption(m);\r\n    this.block.updateCatSorting_now();\r\n  }\r\n\r\n  _sortCategories() {\r\n    var compare_int = (a, b) => a - b;\r\n    var compare_str = (a, b) => Util.sortFunc_List_String(a, b);\r\n    var compare_func = (v) =>\r\n      typeof v === \"string\" ? compare_str : compare_int;\r\n\r\n    var theSortFunc: (a: Aggregate_Category, b: Aggregate_Category) => number =\r\n      null;\r\n    var valueFunc: Function = null;\r\n\r\n    if (typeof this.catSortBy === \"string\") {\r\n      if (this.catSortBy === \"alphanumeric\") {\r\n        valueFunc = (aggr) => aggr.label;\r\n      } else if (this.catSortBy === \"id\") {\r\n        valueFunc = (aggr) => aggr.id;\r\n      } else {\r\n        // Active, Compare_X\r\n        let getV = (aggr: Aggregate_Category) =>\r\n          this.browser.getChartValue(aggr, this.catSortBy);\r\n\r\n        // Dynamic sorting\r\n        theSortFunc = (\r\n          a: Aggregate_Category,\r\n          b: Aggregate_Category\r\n        ): number => {\r\n          // selected on top of the list\r\n          if (!a.isFiltered() && b.isFiltered()) return 1;\r\n          if (a.isFiltered() && !b.isFiltered()) return -1;\r\n          // usedAggr === false => on the bottom\r\n          if (!a.usedAggr && b.usedAggr) return 1;\r\n          if (a.usedAggr && !b.usedAggr) return -1;\r\n\r\n          var x = getV(b) - getV(a);\r\n          if (x === 0) x = b.measure(\"Total\") - a.measure(\"Total\");\r\n          return x;\r\n        };\r\n      }\r\n    } else {\r\n      if (Array.isArray(this.catSortBy)) {\r\n        // convert the array into a lookup table for sort-order of the category.\r\n        var _lookup: { [index: string]: number } = {};\r\n        this.catSortBy.forEach((s, i) => {\r\n          _lookup[s] = i + 1;\r\n        });\r\n        valueFunc = (aggr) => _lookup[aggr.id] || 99999;\r\n      } else {\r\n        valueFunc = this.catSortBy.valueFunc;\r\n        if (this.catSortBy.preSort) {\r\n          this.catSortBy.preSort.call(this);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (valueFunc) {\r\n      let getV = (aggr: Aggregate_Category): number => valueFunc(aggr);\r\n\r\n      var valueCompareFunc = compare_func(getV(this._aggrs[0])); // int or string comparison, based on first aggr\r\n\r\n      theSortFunc = (a: Aggregate_Category, b: Aggregate_Category): number =>\r\n        valueCompareFunc(getV(a), getV(b));\r\n    }\r\n\r\n    var idCompareFunc = compare_func(this._aggrs[0].label);\r\n\r\n    this._aggrs.sort((a, b) => {\r\n      var _ = theSortFunc(a, b);\r\n      if (_ === 0) _ = idCompareFunc(a.label, b.label);\r\n      return this.catSortInverse ? -_ : _;\r\n    });\r\n\r\n    this.dirtySort = false;\r\n    this.pleaseSort = false;\r\n  }\r\n\r\n  doSortInverse() {\r\n    if (this.dirtySort) {\r\n      this.dirtySort = false; // will refresh sorting on next updateCatSorting call\r\n    } else {\r\n      this.catSortInverse = !this.catSortInverse;\r\n    }\r\n    this.pleaseSort = true;\r\n    this.block.updateCatSorting(0); // no delay, animated\r\n  }\r\n\r\n  getSortMenuOpts() {\r\n    return {\r\n      name: \"Sorting\",\r\n      items: [\r\n        {\r\n          id: \"DynamicSort\",\r\n          name: \"Active\",\r\n          iconClass: \"fa fa-sort-amount-down\",\r\n          active: this.catSortBy === \"Active\",\r\n          helparticle: \"5e87dcde04286364bc97d08e\",\r\n          do: (summary, action) => {\r\n            this.setSortingOption();\r\n            this.pleaseSort = true;\r\n            this.block.updateCatSorting(0, true); // no delay, with animation\r\n          },\r\n        },\r\n        {\r\n          id: \"DynamicSort\",\r\n          name:\r\n            i18n[\"Compared\"] +\r\n            \": \" +\r\n            (this.browser.comparedAttrib\r\n              ? `<span class='comparedSummaryName'>${this.browser.comparedAttrib.attribName}</span>`\r\n              : \"\"),\r\n          iconClass: \"fa fa-sort-numeric-down\",\r\n          active:\r\n            typeof this.catSortBy === \"string\" &&\r\n            this.catSortBy.startsWith(\"Compare\"),\r\n          helparticle: \"5e87e12704286364bc97d09e\",\r\n          when: (_block) =>\r\n            _block.browser.activeComparisonsCount > 0 &&\r\n            (_block.attrib !== _block.browser.comparedSummary ||\r\n              _block.attrib.isMultiValued),\r\n          do: (_attrib, action) => {\r\n            // TODO: Take the selected comparison AND the breakdown type/values into account\r\n            this.setSortingOption(action);\r\n            this.pleaseSort = true;\r\n            this.block.updateCatSorting(0, true); // no delay, with animation\r\n          },\r\n          options: (_block) =>\r\n            this.browser.activeComparisons.map((cT) => ({\r\n              name: this.browser.selectedAggrs[cT].label,\r\n              iconClass: \"colorBox bg_\" + cT,\r\n              active: this.catSortBy === cT,\r\n              value: cT,\r\n            })),\r\n        },\r\n        {\r\n          id: \"AlphaNumSort\",\r\n          name: \"Alphabetical\",\r\n          iconClass: \"fa fa-sort-alpha-down\",\r\n          active: this.catSortBy === \"alphanumeric\",\r\n          helparticle: \"5e87df292c7d3a7e9aea6032\",\r\n          do: () => {\r\n            this.setSortingOption(\"alphanumeric\");\r\n            this.pleaseSort = true;\r\n            this.block.updateCatSorting(0, true); // no delay, with animation\r\n          },\r\n        },\r\n        {\r\n          id: \"CustomSort\",\r\n          name: \"Custom\",\r\n          active: Array.isArray(this.catSortBy),\r\n          iconClass: \"fa fa-sort-shapes-down\",\r\n          helparticle: \"5e87ddbf2c7d3a7e9aea602e\",\r\n          do: () => {\r\n            this.setFixedCatOrder();\r\n          },\r\n        },\r\n        {\r\n          id: \"SetMatrixSort\",\r\n          name: \"Relatedness\",\r\n          iconClass: \"fa fa-th\",\r\n          when: (summary) => summary.setSummary && summary.show_set_matrix,\r\n          do: () => {\r\n            // Update sorting options of setListSummary (adding relatednesness metric...)\r\n            this.setSortingOption({\r\n              valueFunc: (aggr) => -aggr.MST?.order,\r\n              preSort: () => this.setAttrib.updatePerceptualOrder(),\r\n            });\r\n            this.pleaseSort = true;\r\n            this.block.updateCatSorting_now(); // no delay, no animation\r\n          },\r\n        },\r\n        // *************************\r\n        {\r\n          id: \"reverseSort\",\r\n          name: \"Inverse\",\r\n          iconClass: \"fa fa-exchange reverseSortIcon\",\r\n          active: this.catSortInverse,\r\n          helparticle: \"5e87e22904286364bc97d0a9\",\r\n          do: () => this.doSortInverse(),\r\n        },\r\n      ],\r\n    };\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Filtering!\r\n  // ********************************************************************\r\n\r\n  unselectAllCategories() {\r\n    this._aggrs.forEach((cat) => cat.set_NONE());\r\n    this.summaryFilter.selected_All_clear();\r\n    this.block.DOM.noValueAggr?.classed(\"filtered\", false);\r\n  }\r\n\r\n  filterCategory(\r\n    ctgry: Aggregate_Category,\r\n    what: \"AND\" | \"OR\" | \"NOT\" | \"NONE\",\r\n    how = null,\r\n    update = true\r\n  ) {\r\n    if (!ctgry) {\r\n      return;\r\n    }\r\n\r\n    if (this.browser.skipSortingSummary) {\r\n      // you can now sort the last filtered summary, attention is no longer there.\r\n      this.browser.skipSortingSummary.dirtySort = false;\r\n    }\r\n\r\n    this.browser.skipSortingSummary = this;\r\n    this.dirtySort = true;\r\n\r\n    if (\r\n      this.summaryFilter.selected_OR.length > 0 &&\r\n      (this.summaryFilter.selected_AND.length > 0 ||\r\n        this.summaryFilter.selected_NOT.length > 0)\r\n    ) {\r\n      how = \"All\";\r\n    }\r\n\r\n    // if selection is in same mode, \"undo\" to NONE.\r\n    if (what === \"NOT\" && ctgry.filtered_NOT()) what = \"NONE\";\r\n    if (what === \"AND\" && ctgry.filtered_AND()) what = \"NONE\";\r\n    if (what === \"OR\" && ctgry.filtered_OR()) what = \"NONE\";\r\n\r\n    if (what === \"NONE\") {\r\n      if (ctgry.filtered_AND() || ctgry.filtered_NOT()) {\r\n        how = how ?? \"MoreResults\";\r\n      }\r\n      if (ctgry.filtered_OR()) {\r\n        how = how ?? \r\n          this.summaryFilter.selected_OR.length === 0\r\n            ? \"MoreResults\"\r\n            : \"LessResults\";\r\n      }\r\n      ctgry.set_NONE();\r\n      if (\r\n        this.summaryFilter.selected_OR.length === 1 &&\r\n        this.summaryFilter.selected_AND.length === 0\r\n      ) {\r\n        this.summaryFilter.selected_OR.forEach((a) => {\r\n          a.set_NONE();\r\n          a.set_AND(this.summaryFilter.selected_AND);\r\n        });\r\n      }\r\n      if (!this.summaryFilter.selected_Any()) this.dirtySort = false;\r\n      //\r\n    } else if (what === \"NOT\") {\r\n      if (!ctgry.isFiltered()) {\r\n        if (\r\n          ctgry.recCnt(\"Active\") ===\r\n          this.browser.allRecordsAggr.recCnt(\"Active\")\r\n        ) {\r\n          Modal.alert(i18n.DialogEmptyResultSet);\r\n          return;\r\n        }\r\n        how = how ?? \"LessResults\";\r\n      } else {\r\n        how = how ?? \"All\";\r\n      }\r\n      ctgry.set_NOT(this.summaryFilter.selected_NOT);\r\n      //\r\n    } else if (what === \"AND\") {\r\n      if (ctgry.filtered_NOT() || ctgry.filtered_OR()) {\r\n        how = how ?? \"All\"; // change from NOT to AND\r\n      } else {\r\n        how = how ?? \"LessResults\";\r\n      }\r\n      ctgry.set_AND(this.summaryFilter.selected_AND);\r\n      //\r\n    } else if (what === \"OR\") {\r\n      if (!this.isMultiValued && this.summaryFilter.selected_NOT.length > 0) {\r\n        var temp = [];\r\n        this.summaryFilter.selected_NOT.forEach((a) => temp.push(a));\r\n        temp.forEach((a) => a.set_NONE());\r\n      }\r\n      if (\r\n        this.summaryFilter.selected_OR.length === 0 &&\r\n        this.summaryFilter.selected_AND.length === 1\r\n      ) {\r\n        this.summaryFilter.selected_AND.forEach((a) => {\r\n          a.set_NONE();\r\n          a.set_OR(this.summaryFilter.selected_OR);\r\n        });\r\n      }\r\n      ctgry.set_OR(this.summaryFilter.selected_OR);\r\n      how = how ?? \"MoreResults\";\r\n    }\r\n\r\n    if (\r\n      this.summaryFilter.selected_OR.length > 0 &&\r\n      (this.summaryFilter.selected_AND.length > 0 ||\r\n        this.summaryFilter.selected_NOT.length > 0)\r\n    ) {\r\n      how = \"All\";\r\n    }\r\n    if (this.noValueAggr.filtered === \"in\") {\r\n      how = \"All\";\r\n    }\r\n\r\n    this.summaryFilter.how = how;\r\n\r\n    if (this.summaryFilter.selectedCount_Total() === 0) {\r\n      this.summaryFilter.clearFilter();\r\n      return;\r\n    }\r\n\r\n    this.block.clearCatTextSearch();\r\n\r\n    // if no-values were filtered in, this causes conflict, so reset to not filtered\r\n    if (this.noValueAggr.filtered === \"in\") {\r\n      this.noValueAggr.filtered = false;\r\n    }\r\n\r\n    this.block.DOM.root?.classed(\r\n      \"hasMultiAnd\",\r\n      this.summaryFilter.selected_AND.length > 1\r\n    );\r\n\r\n    this.summaryFilter.setFiltered(update);\r\n  }\r\n\r\n  isCatSelectable(category: Aggregate_Category) {\r\n    if (category.isFiltered()) return true;\r\n    if (category.recCnt(\"Active\") !== 0) return true;\r\n    // Show if multiple attributes are selected and the summary does not include multi value records\r\n    if (this.isFiltered() && !this.isMultiValued) return true;\r\n    // Hide\r\n    return false;\r\n  }\r\n\r\n  dblClickTimer: number = 0;\r\n\r\n  autoCompare() {\r\n    var _autoCompare = () => {\r\n      var _index = 0;\r\n      Base.Compare_List.forEach((cT) => {\r\n        if (this.browser.vizActive(cT)) return;\r\n        var aggr;\r\n        while (true) {\r\n          aggr = this._aggrs[_index];\r\n          if (!aggr) return;\r\n          if (!aggr.locked && aggr.Active.measure > 0) break;\r\n          _index++;\r\n        }\r\n        this.browser.setSelect_Compare(aggr, cT, false);\r\n        this.browser.lockSelect_Compare(false);\r\n      });\r\n\r\n      this.browser.refreshConfigs();\r\n    };\r\n\r\n    if (this.browser.comparedAttrib && !this.isComparedAttrib()) {\r\n      Modal.confirm(\r\n        i18n.DialogChangeCompare(\r\n          this.attribNameHTML,\r\n          this.browser.comparedAttrib.attribNameHTML\r\n        ),\r\n        i18n.Confirm\r\n      ).then(\r\n        () => {\r\n          this.browser.clearSelect_Compare(\r\n            this.browser.activeComparisons,\r\n            false,\r\n            true\r\n          ); // don't finalize yet\r\n          _autoCompare();\r\n        },\r\n        () => {}\r\n      );\r\n    } else {\r\n      _autoCompare();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Mapping\r\n  // ********************************************************************\r\n\r\n  public catGeo: string = null;\r\n\r\n  private mapTable: MapData = null;\r\n\r\n  public mapInitView: [number, number, number] = null;\r\n\r\n  public mapConfig: any; // leaflet\r\n\r\n  async loadMap() {\r\n    if (this.mapTable) return;\r\n\r\n    this.mapTable = Base.maps.get(this.catGeo);\r\n\r\n    if (!this.mapTable) {\r\n      throw new Error(i18n.Error_CannotFindMap(this.catGeo));\r\n    }\r\n\r\n    await this.mapTable.loadGeo();\r\n\r\n    // Call mapping function to store category geometry\r\n    this.catMap_storeCatGeo();\r\n\r\n    // Abort if none of the categories match to map data.\r\n    if (this._aggrs.length > 0 && this._aggrs.every((_cat) => !_cat._geo_)) {\r\n      this.removeCatGeo();\r\n      throw new Error(i18n.Error_CannotMatchMap(this.catGeo));\r\n    }\r\n  }\r\n\r\n  hasMap(): boolean {\r\n    return this.catGeo !== null;\r\n  }\r\n\r\n  catMap_storeCatGeo() {\r\n    this._aggrs.forEach((aggr) => {\r\n      aggr._geo_ =\r\n        this.mapTable.getFeature(aggr.id.toUpperCase()) ||\r\n        this.mapTable.getFeature(aggr.label.toUpperCase());\r\n\r\n      if (\r\n        // not found\r\n        !aggr._geo_ ||\r\n        // only accept geojson definitions. A crude approximation.\r\n        typeof aggr._geo_ !== \"object\" ||\r\n        typeof aggr._geo_.type === undefined\r\n      ) {\r\n        aggr._geo_ = null;\r\n      }\r\n    });\r\n  }\r\n\r\n  setCatGeo(template) {\r\n    this.catGeo = template;\r\n    this.block.DOM.root?.attr(\"hasMap\", true);\r\n  }\r\n\r\n  removeCatGeo() {\r\n    this.catGeo = null;\r\n    this._aggrs.forEach((_cat) => {\r\n      _cat._geo_ = null;\r\n    });\r\n    this.block.removeCatGeo();\r\n    this.mapTable = null;\r\n  }\r\n\r\n  async setCatGeo_(template) {\r\n    if (!this.uniqueCategories()) {\r\n      this.setCatGeo(template);\r\n      this.block.catViewAs(\"map\");\r\n\r\n    } else {\r\n      // Per-record map: Define new summary\r\n      this.browser.recordDisplay.setAttrib(\r\n        \"geo\",\r\n        this.browser.createAttrib(\r\n          \"_REGION\",\r\n          // replace [*] with [*.]\r\n          template\r\n            .replace(\"[*]\", \"[*.\" + this.template + \"]\")\r\n            .replace(\"[UPPERCASE(*)]\", \"[UPPERCASE(*.\" + this.template + \")]\"),\r\n          \"recordGeo\"\r\n        )\r\n      );\r\n\r\n      if (this.browser.recordChartType.is(\"none\")) {\r\n        await this.browser.recordChartType.set(\"map\");\r\n      }\r\n\r\n      this.browser.refreshAttribList();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Cat labels\r\n  // ********************************************************************\r\n\r\n  public catLabel_attr: CatLabelSpec = {};\r\n\r\n  setCatLabel(template: CatLabelSpec = {}) {\r\n    this.catLabel_attr = template;\r\n    this._aggrs.forEach((aggr) => {\r\n      aggr.label = this.catLabel_attr[aggr.id] || \"\";\r\n    });\r\n\r\n    this.block?.DOM.catLabel?.html((aggr: Aggregate_Category) => aggr.label);\r\n  }\r\n\r\n  getRecordValue(record: Record): string[] {\r\n    var r = record.getValue(this);\r\n    if (r == null) return r;\r\n    return r.map((_) => this.catLabel_attr[_] || _);\r\n  }\r\n\r\n  getFormattedValue(v: any, _isSVG: any): string {\r\n    return this.renderRecordValue(v);\r\n  }\r\n\r\n  renderRecordValue(v, d3_selection = null): string {\r\n    if (v instanceof Record) v = this.getRecordValue(v);\r\n\r\n    var getHTML = (_url) => {\r\n      var _href = _url.href;\r\n      if (_url.protocol === \"http:\" || _url.protocol === \"https:\") {\r\n        if (/\\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(_url.pathname)) {\r\n          // show as image\r\n          return `<img src='${_href}' class='autoDetectedImg'>`;\r\n        }\r\n        // show as link\r\n        return `<a class='linkInData' href='${_href}' rel='noopener noreferrer' target='_blank'>\" ${_href}</a>`;\r\n      }\r\n      return _href;\r\n    };\r\n\r\n    var _finalize = (_value) => {\r\n      if (d3_selection) d3_selection.html(_value);\r\n      else return _value;\r\n    };\r\n\r\n    var _value = v\r\n      .map((_) => {\r\n        if (this.catTable_id[_]) return this.catTable_id[_].label;\r\n        if (_ == null) return \"-\";\r\n        return _ + \"\";\r\n      })\r\n      .map((_) => {\r\n        try {\r\n          var _url = new URL(_);\r\n          if (_url.protocol === \"gs:\" && (window as any).firebase) {\r\n            return (window as any).firebase\r\n              .storage()\r\n              .refFromURL(_url.href)\r\n              .getDownloadURL()\r\n              .then((url) => {\r\n                var __url = new URL(url);\r\n                // update lookup table label to resolved URL\r\n                if (this.catTable_id[_]) this.catTable_id[_].label = __url.href;\r\n\r\n                return _finalize(getHTML(__url));\r\n              });\r\n          }\r\n          _ = getHTML(_url);\r\n        } catch (exception) {\r\n        } finally {\r\n          return _;\r\n        }\r\n      })\r\n      .join(\"<br>\");\r\n\r\n    return _finalize(_value);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Export / import\r\n  // ********************************************************************\r\n\r\n  async applyConfig(blockCfg: SummarySpec) {\r\n    super.applyConfig(blockCfg);\r\n\r\n    if (blockCfg.mapInitView) {\r\n      this.mapInitView = blockCfg.mapInitView;\r\n    }\r\n    if (blockCfg.mapConfig) {\r\n      this.mapConfig = blockCfg.mapConfig;\r\n    }\r\n\r\n    await this.measureScaleType.set(blockCfg.measureScaleType);\r\n    await this.barHeight.set(blockCfg.barHeight);\r\n    await this.minAggrSize.set(blockCfg.minAggrSize);\r\n\r\n    if (blockCfg.catLabel) {\r\n      this.setCatLabel(blockCfg.catLabel);\r\n    }\r\n    if (blockCfg.catGeo) {\r\n      this.setCatGeo(blockCfg.catGeo);\r\n    }\r\n    if (blockCfg.invertedColorTheme) {\r\n      this.block.catMap_invertColorTheme(blockCfg.invertedColorTheme);\r\n    }\r\n\r\n    if (blockCfg.splitOnSelfCompare === false) {\r\n      this.block.splitOnSelfCompare = false;\r\n    }\r\n\r\n    if ([\"SingleSelect\", \"MultiSelect\"].includes(blockCfg.dropdown_type)) {\r\n      this.block.dropdown_type = blockCfg.dropdown_type;\r\n    }\r\n\r\n    if (blockCfg.filter) {\r\n      this.summaryFilter.importFilter(blockCfg.filter);\r\n    } else if (this.isFiltered()) {\r\n      this.summaryFilter.clearFilter();\r\n    }\r\n\r\n    // SORTING RELATED CONFIGURATION\r\n    if (blockCfg.catSortInverse) {\r\n      this.catSortInverse = true;\r\n    }\r\n    if (blockCfg.catSortBy) {\r\n      this.setSortingOption(blockCfg.catSortBy);\r\n    }\r\n\r\n    if (blockCfg.viewAs) {\r\n      // map vs list\r\n      this.block.catViewAs(blockCfg.viewAs);\r\n    }\r\n    if (blockCfg.showSetMatrix) {\r\n      this.block.showSetMatrix(blockCfg.showSetMatrix);\r\n    }\r\n  }\r\n\r\n  exportConfig() {\r\n    var config = super.exportConfig();\r\n\r\n    var t: SummaryConfig_Categorical = {\r\n      viewAs: this.block.viewType,\r\n      catGeo: this.catGeo,\r\n      catLabel: this.catLabel_attr,\r\n      catSortBy: this.catSortBy,\r\n      catSortInverse: this.catSortInverse,\r\n      invertedColorTheme: this.block.invertedColorTheme,\r\n      barHeight: this.barHeight.exportValue(),\r\n      splitOnSelfCompare: this.block.splitOnSelfCompare,\r\n      dropdown_type: this.block.isView_Dropdown\r\n        ? this.block.dropdown_type\r\n        : undefined,\r\n      filter: this.summaryFilter.exportFilter()\r\n    };\r\n\r\n    return Object.assign({}, config, t);\r\n  }\r\n}\r\n","import { easePoly } from \"d3-ease\";\r\nimport { select } from \"./d3_select\";\r\n\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Base } from \"./Base\";\r\nimport { Browser } from \"./Browser\";\r\nimport { CompareType, RecordVisCoding } from \"./Types\";\r\nimport { i18n } from \"./i18n\";\r\nimport { RecordDisplay } from \"./RecordDisplay\";\r\nimport { Util } from \"./Util\";\r\nimport { Record } from \"./Record\";\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\n\r\nconst d3 = {\r\n  select,\r\n  easePoly,\r\n};\r\n\r\nexport abstract class RecordView {\r\n  /** For direct access to main record display */\r\n  readonly rd: RecordDisplay;\r\n\r\n  get browser(): Browser {\r\n    return this.rd.browser;\r\n  }\r\n\r\n  get textAttrib() {\r\n    return this.rd.codeBy.text;\r\n  }\r\n  get textBriefAttrib() {\r\n    return this.rd.codeBy.textBrief || this.rd.codeBy.text;\r\n  }\r\n  get sortAttrib() {\r\n    return this.rd.codeBy.sort;\r\n  }\r\n  get scatterXAttrib() {\r\n    return this.rd.codeBy.scatterX;\r\n  }\r\n  get scatterYAttrib() {\r\n    return this.rd.codeBy.scatterY;\r\n  }\r\n  get colorAttrib() {\r\n    return this.rd.codeBy.color;\r\n  }\r\n  get sizeAttrib() {\r\n    return this.rd.codeBy.size;\r\n  }\r\n  get geoAttrib() {\r\n    return this.rd.codeBy.geo;\r\n  }\r\n\r\n  get DOM() {\r\n    return this.rd.DOM;\r\n  }\r\n\r\n  initialized: boolean = false;\r\n\r\n  constructor(rd: RecordDisplay) {\r\n    this.rd = rd;\r\n  }\r\n\r\n  abstract updateAfterFilter(how): void;\r\n  abstract prepareAttribs(): Promise<boolean>;\r\n\r\n  abstract initView_DOM(): void;\r\n  abstract initView(): void;\r\n\r\n  // Signals that one of the vis codings have been updated\r\n  abstract finishSetAttrib(t: RecordVisCoding);\r\n\r\n  abstract refreshRecordVis(): void;\r\n  abstract extendRecordDOM(newRecords): void;\r\n\r\n  /** Called when the UI/window size is updated  */\r\n  abstract refreshViewSize(delayMS: number): void;\r\n\r\n  /** Called when the given attribute has unit name updated */\r\n  abstract refreshAttribUnitName(attrib: Attrib);\r\n\r\n  refreshRecordSizes(): void {}\r\n  refreshRecordColors(): void {}\r\n  refreshLabelOverlaps(): void {}\r\n\r\n  async refreshAttribScaleType(attrib: Attrib) {}\r\n  onRecordMouseOver(record: Record) {}\r\n  onRecordMouseLeave(record: Record) {}\r\n\r\n  // can be extended in sub-classes\r\n  refreshQueryBox_Filter(bounds) {}\r\n\r\n  zoomIn() {}\r\n  zoomOut() {}\r\n  zoomToFit() {}\r\n\r\n  // can be extended by subclasses\r\n  updateRecordVisibility() {}\r\n\r\n  getRecordsForDOM() {\r\n    return this.browser.records;\r\n  }\r\n\r\n  isComparable() {\r\n    // Scatterplot and Map views can share the same code here!\r\n    if (this.browser.activeComparisonsCount === 0) return false;\r\n    if (!this.browser.comparedAttrib) return false;\r\n    if (!this.DOM.kshfRecords) return false;\r\n    if (\r\n      this.rd.viewRecAs === \"map\" &&\r\n      this.rd.codeBy.geo?.geoType !== \"Point\"\r\n    ) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  animStepDelayMs: number = 1000;\r\n\r\n  stepTimeAnimation(stepSize: number): boolean {\r\n    if (this.rd.currentTimeKey.get() == null) return false;\r\n\r\n    // Iterates over potential time-series keys.\r\n    // When it finds one,starts animation, and returns (executed only for one coding)\r\n    [\"sort\", \"scatter\", \"color\", \"size\"].some((v) => {\r\n      var attrib = this.rd.codeBy[v];\r\n      if (!attrib) return false;\r\n      if (!(attrib instanceof Attrib_Numeric)) return false;\r\n      if (!attrib.hasTimeSeriesParent()) return false;\r\n\r\n      var tsParent = attrib.timeseriesParent;\r\n\r\n      this.rd.timeseriesAnimInterval = window.setInterval(() => {\r\n        let a = tsParent.getTimepointSummary_Next(attrib, stepSize);\r\n        if (attrib === null) {\r\n          this.rd.stopTimeseriesAnimation();\r\n        } else {\r\n          this.rd.currentTimeKey.set(attrib.timeKey);\r\n          attrib = a;\r\n        }\r\n      }, this.animStepDelayMs);\r\n\r\n      return true;\r\n    });\r\n  }\r\n  // no-op by default\r\n  stopTimeAnimation() {}\r\n\r\n  /** -- */\r\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\r\n    if (!this.isComparable()) return;\r\n\r\n    if (!this.rd.recordDrawArc) return;\r\n\r\n    var targetRecords = (record: Record) => {\r\n      if (!record.isIncluded) return false;\r\n      if (!record.DOM.record) return false;\r\n      if (cT && record.isSelected(cT) !== status) return false;\r\n      if (this.rd.viewRecAs === \"map\") {\r\n        if (!this.rd.codeBy.geo.getRecordValue(record)) return false;\r\n      }\r\n      return true;\r\n    };\r\n\r\n    let _do = (d, cT, arcGen) => {\r\n      d.select(\".glyph_\" + cT)\r\n        .transition()\r\n        .ease(d3.easePoly.exponent(3))\r\n        .duration(700)\r\n        .attr(\"d\", arcGen);\r\n    };\r\n\r\n    if (!this.browser.isComparedSummaryMultiValued()) {\r\n      // renders as point\r\n      this.DOM.kshfRecords.each((record: Record) => {\r\n        if (!targetRecords(record)) return;\r\n        var d = d3.select(record.DOM.record);\r\n        record.activeComparisons.forEach((cT) =>\r\n          _do(d, cT, (record) => this.rd.recordDrawArc(record)())\r\n        );\r\n      });\r\n      //\r\n    } else {\r\n      // renders as pies\r\n      this.DOM.kshfRecords.each((record: Record) => {\r\n        if (!targetRecords(record)) return;\r\n        var numPies = record.activeComparisons.length;\r\n        if (numPies === 0) return;\r\n\r\n        var arcGen = this.rd.recordDrawArc(record);\r\n        var arcLen = (2 * Math.PI) / numPies;\r\n\r\n        var d = d3.select(record.DOM.record);\r\n        record.activeComparisons.forEach((cT, i) => {\r\n          arcGen.startAngle(arcLen * i).endAngle(arcLen * (i + 1));\r\n          _do(d, cT, arcGen());\r\n        });\r\n      });\r\n    }\r\n\r\n    this.rd.refreshCompareLegend();\r\n  }\r\n\r\n  // Utility/ helper\r\n  protected extendRecordDOM_Point(newRecords) {\r\n    newRecords.classed(\"pointGeo\", true);\r\n\r\n    [\"Main\"]\r\n      .concat(Base.Compare_List)\r\n      .forEach((cT) => newRecords.append(\"path\").attr(\"class\", \"glyph_\" + cT));\r\n    newRecords.append(\"text\").attr(\"class\", \"sizeValueText\");\r\n\r\n    // initializes to tiny circles\r\n    newRecords.selectAll(\"path\").attr(\"d\", Util.getCirclePath());\r\n  }\r\n\r\n  /** -- */\r\n  insertQueryBoxes(parent, setSizeCb, dragCb, clearCb) {\r\n    var queryBoxes = parent\r\n      .selectAll(\".spatialQueryBox\")\r\n      .data([\"Filter\"].concat(Base.Compare_List))\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\r\n        \"class\",\r\n        (d) => `spatialQueryBox spatialQueryBox_${d} leaflet-zoom-hide`\r\n      );\r\n\r\n    queryBoxes\r\n      .selectAll(\".setSize\")\r\n      .data([\"l\", \"r\", \"t\", \"b\"])\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", (k) => \"setSize-\" + k)\r\n      .on(\"mousedown\", setSizeCb);\r\n\r\n    queryBoxes\r\n      .append(\"div\")\r\n      .attr(\"class\", \"dragSelection fa fa-arrows\")\r\n      .tooltip(\"Drag\")\r\n      .on(\"mousedown\", dragCb);\r\n\r\n    queryBoxes\r\n      .append(\"div\")\r\n      .attr(\"class\", \"clearFilterButton fa\")\r\n      .tooltip((_) => i18n[_ === \"Filter\" ? \"RemoveFilter\" : \"Unlock\"])\r\n      .on(\"mouseup\", (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      })\r\n      .on(\"mousedown\", (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      })\r\n      .on(\"click\", clearCb);\r\n  }\r\n}\r\n","import DOMPurify from \"dompurify/dist/purify.es\";\r\nimport noUiSlider from \"nouislider/dist/nouislider.mjs\";\r\nimport tippy from \"tippy.js\";\r\n\r\nimport { select, pointer, selection } from \"./d3_select\";\r\nimport { scaleLinear } from \"d3-scale\";\r\nimport { min, max, extent } from \"d3-array\";\r\nimport { line, curveLinear, curveMonotoneX } from \"d3-shape\";\r\nimport { easePoly } from \"d3-ease\";\r\nimport { schemeCategory10 } from \"d3-scale-chromatic\";\r\nimport { format } from \"d3-format\";\r\n\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\r\nimport { Config } from \"./Config\";\r\nimport { LinearOrLog, RecordVisCoding } from \"./Types\";\r\nimport { i18n } from \"./i18n\";\r\nimport { RecordDisplay } from \"./RecordDisplay\";\r\nimport { RecordView } from \"./RecordView\";\r\nimport { Record } from \"./Record\";\r\nimport { Base } from \"./Base\";\r\n\r\nimport { TimeData, TimeKey, TimeSeriesData } from \"./TimeSeriesData\";\r\n\r\nconst d3 = {\r\n  select,\r\n  selection,\r\n  pointer,\r\n  min,\r\n  max,\r\n  extent,\r\n  line,\r\n  curveMonotoneX,\r\n  curveLinear,\r\n  scaleLinear,\r\n  easePoly,\r\n  schemeCategory10,\r\n  format,\r\n};\r\n\r\n/** -- */\r\nclass LabelSpacer {\r\n  usedList: { _min: number; _max: number; _entity: Record }[];\r\n\r\n  constructor() {\r\n    this.clear();\r\n  }\r\n  clear() {\r\n    this.usedList = [];\r\n  }\r\n  isEmpty(pixel: number): boolean {\r\n    return !this.isUsed(pixel);\r\n  }\r\n  isUsed(pixel: number): boolean {\r\n    return this.usedList.some((_) => pixel < _._max && pixel > _._min);\r\n  }\r\n  /** returns the entity that hee given pixel intersects with */\r\n  intersectsWith(pixel: number) {\r\n    return this.usedList.find((_) => pixel < _._max && pixel > _._min);\r\n  }\r\n  insertUsed(pos: number, range: number, entity: Record) {\r\n    this.usedList.push({\r\n      _min: pos - range,\r\n      _max: pos + range,\r\n      _entity: entity,\r\n    });\r\n  }\r\n}\r\n\r\nfunction hideAllPoppers() {\r\n  var poppers = [].slice.call(document.querySelectorAll(\"[data-tippy-root]\"));\r\n\r\n  poppers.forEach(function (popper) {\r\n    var tippy = popper._tippy;\r\n    if (tippy) {\r\n      tippy.hide();\r\n      tippy.reference.classList.remove(\"visible\");\r\n    }\r\n  });\r\n}\r\n\r\nexport class RecordView_Timeseries extends RecordView {\r\n  ts_Type: Config<string>;\r\n  ts_timeKeysStep: Config<\"all\" | \"limits\">;\r\n  ts_valueAxisScale: Config<LinearOrLog>;\r\n  timeSeriesSelectMode: Config<\"record\" | \"time\">;\r\n  timeSeriesChangeVsTimeKey: Config<TimeKey>;\r\n  fitValueAxis: Config<boolean>;\r\n\r\n  private timeKeys_Active: TimeKey[] = [];\r\n\r\n  private timeRange: any;\r\n\r\n  private scale_Value: any = null;\r\n  private scale_Time: any = null;\r\n  private scale_Time_prev: any = null;\r\n\r\n  private timeseriesRange: any;\r\n  private timeseriesRange_noUpdate: boolean = false;\r\n\r\n  y_Generator: any; // TODO: check\r\n\r\n  private recordInView: (record: Record) => boolean;\r\n\r\n  get timeseriesAttrib() {\r\n    return this.rd.codeBy.timeSeries;\r\n  }\r\n\r\n  /** -- */\r\n  async prepareAttribs() {\r\n    if (!this.timeseriesAttrib) {\r\n      await this.rd.setAttrib(\"timeSeries\", this.rd.config.timeSeriesBy || 0);\r\n    }\r\n    return Promise.resolve(true);\r\n  }\r\n\r\n  constructor(rd: RecordDisplay, config) {\r\n    super(rd);\r\n\r\n    this.ts_Type = new Config<string>({\r\n      cfgClass: \"ts_Type\",\r\n      cfgTitle: \"Timeseries Plot\",\r\n      iconClass: \"fa fa-chart-line\",\r\n      default: \"Value\",\r\n      parent: this,\r\n      helparticle: \"5eaf64de042863474d1a0efc\",\r\n      tooltip: `Timeseries plot chart type`,\r\n      itemOptions: [\r\n        { name: \"# Value\", value: \"Value\" },\r\n        { name: \"⩔ Rank\", value: \"Rank\" },\r\n        { name: \"#-Change\", value: \"ChangeAbs\" },\r\n        { name: \"%-Change\", value: \"ChangePct\" },\r\n      ],\r\n      preSet: async (v) => v === \"Change\" ? \"ChangePct\" /* old value*/ : v,\r\n      onSet: () => this.refreshTimeSeriesPlotType(),\r\n    });\r\n\r\n    this.timeSeriesChangeVsTimeKey = new Config<TimeKey>({\r\n      parent: this,\r\n      cfgClass: \"ts_ChangeVsTimeKey\",\r\n      cfgTitle: \"Change vs.\",\r\n      iconClass: \"fa fa-calendar\",\r\n      default: null,\r\n      helparticle: \"5e87f81e2c7d3a7e9aea60a4\",\r\n      onDOM: (DOM) => {\r\n        var _ = DOM.root.select(\".configItem_Options\");\r\n        DOM.keySelect = _.append(\"select\")\r\n          .attr(\"class\", \"keySelect\")\r\n          .on(\"change\", async (event) => {\r\n            await this.timeSeriesChangeVsTimeKey.set(event.currentTarget.selectedOptions[0].__data__._time_src);\r\n          });\r\n      },\r\n      onRefreshDOM: (cfg: Config<TimeKey>) => {\r\n        if (!cfg.get()) return; // nothing to do!\r\n        cfg.DOM.root.classed(\"hidden\", !this.isTimeseriesChange());\r\n        cfg.DOM.keySelect\r\n          .selectAll(\"option\")\r\n          .data(this.timeKeys_Active || [], (d: TimeKey) => d._time_src)\r\n          .join(\r\n            (enter) => enter.append(\"option\").text((d) => d._time_src),\r\n            (update) => update,\r\n            (exit) => exit.remove()\r\n          )\r\n          .attr(\"selected\", (d: TimeKey) =>\r\n            d._time_src === cfg.get()._time_src ? true : null\r\n          );\r\n      },\r\n      preSet: async (v, obj) => {\r\n        if (!this.timeseriesAttrib) return; // NOT SET now\r\n\r\n        if (typeof v === \"string\") {\r\n          v = this.timeseriesAttrib.timeKeys.find((k) => k._time_src === v);\r\n        }\r\n\r\n        // if not set, use first timeKey\r\n        if (!v) return this.timeseriesAttrib.timeKeys[0];\r\n\r\n        return v;\r\n      },\r\n      onSet: (v, obj) => {\r\n        this.refreshScaleValue();\r\n        this.refreshKeyLine();\r\n      },\r\n    });\r\n\r\n    this.ts_timeKeysStep = new Config<\"all\" | \"limits\">({\r\n      parent: this,\r\n      cfgClass: \"ts_timeKeysStep\",\r\n      cfgTitle: \"Time Keys\",\r\n      iconClass: \"fa fa-calendar\",\r\n      UISeperator: {\r\n        title: \"Axis\",\r\n        className: \"ts_only\",\r\n      },\r\n      default: \"all\",\r\n      helparticle: \"5e891b8504286364bc97d544\",\r\n      itemOptions: [\r\n        { name: \"All\", value: \"all\" },\r\n        { name: \"1st &amp; Last (Slope)\", value: \"limits\" },\r\n      ],\r\n      forcedValue: () => {\r\n        if (!this.timeseriesAttrib) return;\r\n        if (this.timeseriesAttrib.timeKeys.length < 3) return \"limits\";\r\n      },\r\n      onSet: () => this.refreshTimeRange(),\r\n    });\r\n\r\n    this.ts_valueAxisScale = new Config<LinearOrLog>({\r\n      cfgClass: \"ts_valueAxisScale\",\r\n      cfgTitle: \"Value Axis Scale\",\r\n      iconClass: \"fa fa-arrows-v\",\r\n      default: config.ts_valueAxisScale || \"linear\",\r\n      parent: this,\r\n      helparticle: \"5f137b5304286306f8070db3\",\r\n      itemOptions: [\r\n        { name: i18n.Linear + \" \" + i18n.LinearSequence, value: \"linear\" },\r\n        { name: i18n.Log + \" \" + i18n.Log10Sequence, value: \"log\" },\r\n      ],\r\n      noExport: true,\r\n      forcedValue: () => {\r\n        if (this.ts_Type.get() !== \"Value\") return \"linear\";\r\n        if (this.timeseriesAttrib && !this.timeseriesAttrib.supportsLogScale())\r\n          return \"linear\";\r\n      },\r\n      onSet: async (v) => {\r\n        if (this.timeseriesAttrib) {\r\n          await this.timeseriesAttrib.valueScaleType.set(v);\r\n        }\r\n      },\r\n    });\r\n\r\n    // Timeseries-only?\r\n    this.fitValueAxis = new Config<boolean>({\r\n      cfgClass: \"fitValueAxis\",\r\n      cfgTitle: \"Fit Value Axis\",\r\n      iconClass: \"fa fa-arrows-v\",\r\n      default: false,\r\n      parent: this,\r\n      helparticle: \"5e891b992c7d3a7e9aea64fb\",\r\n      itemOptions: [\r\n        { name: \"Static\", value: false },\r\n        { name: \"Dynamic\", value: true },\r\n      ],\r\n      forcedValue: () => {\r\n        if (!this.browser.isFiltered()) return false; // full\r\n        if (this.ts_Type.is(\"Rank\")) return false; // full\r\n        if (this.isTimeseriesChange()) return true; // fit\r\n      },\r\n      onSet: () => {\r\n        this.refreshScaleValue();\r\n      },\r\n    });\r\n\r\n    this.timeSeriesSelectMode = new Config<\"record\" | \"time\">({\r\n      cfgClass: \"timeSeriesSelectMode\",\r\n      cfgTitle: \"Mouse Select\",\r\n      iconClass: \"fa fa-hand-pointer\",\r\n      UISeperator: {\r\n        title: \"Control\",\r\n        className: \"ts_only\",\r\n      },\r\n      default: \"record\", // not set\r\n      parent: this,\r\n      helparticle: \"5e88c11004286364bc97d3c0\",\r\n      itemOptions: [\r\n        { name: \"Nearest Record\", value: \"record\" },\r\n        { name: \"Nearest Time-Key\", value: \"time\" },\r\n        // {name: \"Filter\", value: \"filter\" },\r\n      ],\r\n      onSet: (v) => {\r\n        // TODO\r\n        // this.visMouseMode.val = (v==='filter')?'filter':'pan';\r\n      },\r\n    });\r\n\r\n    [\r\n      \"ts_Type\",\r\n      \"timeSeriesChangeVsTimeKey\",\r\n      \"timeSeriesSelectMode\",\r\n      \"ts_timeKeysStep\",\r\n      \"fitValueAxis\",\r\n      \"ts_valueAxisScale\",\r\n    ].forEach((t) => {\r\n      this[t].val = config[t];\r\n      this.rd.configs[t] = this[t];\r\n      this.rd.recordConfigPanel.insertConfigUI(this[t]);\r\n    });\r\n\r\n    var me = this;\r\n\r\n    this.timeRange = {\r\n      _src: {},\r\n      get min() {\r\n        return this.val(\"min\");\r\n      },\r\n      get max() {\r\n        return this.val(\"max\");\r\n      },\r\n      set min(v) {\r\n        this._src.min = v ? v._time_src : null;\r\n      },\r\n      set max(v) {\r\n        this._src.max = v ? v._time_src : null;\r\n      },\r\n      val: function (t) {\r\n        var v = this._src[t];\r\n        if (!v || !me.timeseriesAttrib || !me.timeseriesAttrib.timeKeys)\r\n          return null;\r\n        return me.timeseriesAttrib.timeKeys.find((_) => _._time_src === v);\r\n      },\r\n      minActive() {\r\n        return this.min._index > 0;\r\n      },\r\n      maxActive() {\r\n        return this.max._index < me.timeseriesAttrib.timeKeys.length - 1;\r\n      },\r\n      isActive(t) {\r\n        if (t === \"min\") return this.minActive();\r\n        if (t === \"max\") return this.maxActive();\r\n        return this.minActive() || this.maxActive();\r\n      },\r\n      exportConfig() {\r\n        var o = {};\r\n        if (this._src.min) o[\"min\"] = this._src.min;\r\n        if (this._src.max) o[\"max\"] = this._src.max;\r\n        return o;\r\n      },\r\n      importConfig(o) {\r\n        if (!o) return;\r\n        [\"min\", \"max\"].forEach((t) => {\r\n          if (o[t]) this._src[t] = o[t];\r\n        });\r\n      },\r\n    };\r\n\r\n    this.timeRange.importConfig(config.timeRange);\r\n  }\r\n\r\n  /** -- */\r\n  initView() {\r\n    this.recordInView = (record: Record) => {\r\n      var _ts = this.timeseriesAttrib.getRecordValue(record);\r\n      if (!_ts || _ts.isEmpty()) return false;\r\n      if (this.isTimeseriesChange()) {\r\n        var _compareKey = this.timeSeriesChangeVsTimeKey.get()._time_src;\r\n        var _index = _ts._keyIndex[_compareKey];\r\n        return _index != null && _index._value != null;\r\n      }\r\n      return true;\r\n    };\r\n\r\n    this.refreshTimeSeriesPlotType();\r\n\r\n    this.refreshScaleTime();\r\n\r\n    this.rd.refreshRecordDOM();\r\n\r\n    this.rd.refreshRecordVis();\r\n    this.refreshTimeseriesTicks();\r\n    this.refreshTicks_AxisY();\r\n\r\n    this.updateDotVisibility();\r\n\r\n    this.refreshFilterRanges();\r\n  }\r\n\r\n  /** -- */\r\n  async initView_DOM() {\r\n    if (this.DOM.recordBase_Timeseries) {\r\n      this.DOM.recordGroup =\r\n        this.DOM.recordBase_Timeseries.select(\".recordGroup\");\r\n      this.DOM.kshfRecords = this.DOM.recordGroup.selectAll(\".kshfRecord\");\r\n      return;\r\n    }\r\n\r\n    var me = this;\r\n\r\n    let prevClosestRecord: Record = null;\r\n    let prevClosestTime: TimeKey = null;\r\n\r\n    var changeFormat = d3.format(\"+.2\");\r\n\r\n    function refreshDotTooltip(d) {\r\n      var record: Record = d.DOM.parentNode.__data__;\r\n      var recordText = me.textBriefAttrib.getRecordValue(record) || \"\";\r\n      var recordValue = me.timeseriesAttrib.getFormattedValue(d._value);\r\n      var _recordRank =\r\n        me.ts_Type.is(\"Rank\")\r\n          ? ` <span class='extraInfo'>(#${d._rank})</span>`\r\n          : \"\";\r\n      var recordChange = \"\";\r\n      if (me.isTimeseriesChange()) {\r\n        var _key = me.timeSeriesChangeVsTimeKey.get()._time_src;\r\n        var ref =\r\n          me.timeseriesAttrib.getRecordValue(record)?._keyIndex[_key]?._value;\r\n        var _v = changeFormat((100 * (d._value - ref)) / (ref || 1)) + \"%\"; // avoid divide by zero\r\n        if (me.ts_Type.is(\"ChangeAbs\")) {\r\n          _v = me.timeseriesAttrib.getFormattedValue(d._value - ref);\r\n        }\r\n        recordChange = ` <span class='extraInfo'>(${_v} vs. ${_key})</span>`;\r\n      }\r\n      var x;\r\n      var fullValue = recordValue + _recordRank + recordChange;\r\n      if (me.timeSeriesSelectMode.is(\"time\")) {\r\n        x = `<span class='asdsdadsada'>${recordText}: <b>${fullValue}</b></span>`;\r\n      } else {\r\n        x =\r\n          `<span class='mapItemName'>${recordText}</span>` +\r\n          \"<div class='recordColorInfo'>\" +\r\n          \"<div class='mapTooltipLabel'>\" +\r\n          `<b>${me.timeseriesAttrib.attribName}</b>` +\r\n          ` <i class='fa fa-calendar'></i> ${d._time_src}` +\r\n          \"</div><br>\" +\r\n          `<span class='mapTooltipValue'>${fullValue}</span>` +\r\n          \"</div>\";\r\n      }\r\n      d.DOM.tippy.popper.children[0].children[0].innerHTML =\r\n        DOMPurify.sanitize(x);\r\n    }\r\n\r\n    var spacer_left = new LabelSpacer();\r\n    var spacer_right = new LabelSpacer();\r\n\r\n    function pofff(c, record, _placement = \"right\") {\r\n      if (!c.DOM) return; // no tooltip\r\n      c.DOM.tippy = tippy(\r\n        c.DOM,\r\n        Object.assign({}, d3.selection.tippyDefaultConfig, {\r\n          theme: \"dark kshf-tooltip kshf-record\",\r\n          placement: _placement,\r\n          animation: \"fade\",\r\n          trigger: \"manual\",\r\n          delay: 0,\r\n          duration: [500, 100],\r\n          appendTo: Base.browser.DOM.root.node(),\r\n        })\r\n      );\r\n      refreshDotTooltip(c);\r\n      c.DOM.tippy.show();\r\n    }\r\n\r\n    this.DOM.recordBase_Timeseries = this.DOM.recordDisplayWrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordBase_Timeseries\");\r\n\r\n    this.refreshTimeSeriesChartWidth();\r\n\r\n    // Y & X axis\r\n    [\"Y\", \"X\"].forEach((a) => {\r\n      var _ = this.DOM.recordBase_Timeseries\r\n        .append(\"div\")\r\n        .attr(\"class\", \"recordAxis recordAxis_\" + a);\r\n      _.append(\"div\").attr(\"class\", \"tickGroup\");\r\n      _.append(\"div\")\r\n        .attr(\"class\", \"keyLine\")\r\n        .style(\"display\", this.isTimeseriesChange() ? \"block\" : null);\r\n    });\r\n\r\n    // X-axis min/max time key setting\r\n    [\"min\", \"max\"].forEach((limit) => {\r\n      var __ = this.DOM.recordBase_Timeseries\r\n        .append(\"span\")\r\n        .attr(\"class\", \"timeLimit timeLimit-\" + limit);\r\n      __.append(\"select\").on(\"change\", (event) => {\r\n        this.setTimeRange({\r\n          [limit]: event.currentTarget.selectedOptions[0].__data__._index,\r\n        });\r\n      });\r\n      __.append(\"span\").attr(\r\n        \"class\",\r\n        limit === \"min\"\r\n          ? \"fa fa-angle-double-right\"\r\n          : \"fa fa-angle-double-left\"\r\n      );\r\n    });\r\n    this.refreshTimeSeriesRangeOpts();\r\n\r\n    // ******************************************************\r\n\r\n    this.DOM.recordGroup = this.DOM.recordBase_Timeseries\r\n      .append(\"svg\")\r\n      .attr(\"class\", \"recordGroup recordGroup_Timeseries\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n\r\n      .on(\"click\", () => {\r\n        if (this.rd.visMouseMode === \"filter\") return;\r\n        if (prevClosestRecord) {\r\n          hideAllPoppers();\r\n          this.browser.recordDetailsPopup.updateRecordDetailPanel(\r\n            prevClosestRecord\r\n          );\r\n          this.browser.recordDetailsPopup.updateFocusedTimeKey(prevClosestTime);\r\n        }\r\n        this.rd.setDimmed(false);\r\n      })\r\n\r\n      .on(\"mouseleave\", () => {\r\n        if (this.rd.visMouseMode === \"filter\") return;\r\n        if (this.timeSeriesSelectMode.is(\"time\")) {\r\n          hideAllPoppers();\r\n          this.browser.records.forEach((record) => {\r\n            // remove \"visible\" from dots\r\n            if (record.filteredOut) return;\r\n            if (!prevClosestTime) return;\r\n              this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\r\n                prevClosestTime._time_src\r\n              ]?.DOM?.classList.remove(\"visible\");\r\n          });\r\n          prevClosestTime = null;\r\n        }\r\n        this.rd.onRecordMouseLeave(prevClosestRecord);\r\n        prevClosestRecord = null;\r\n      })\r\n\r\n      .on(\"mousemove\", (event) => {\r\n        if (this.rd.visMouseMode === \"filter\") return;\r\n\r\n        var _m = d3.pointer(event);\r\n\r\n        if (_m[1] > event.currentTarget.offsetHeight || _m[1] < 0) {\r\n          // out of chart bounds\r\n          if (this.timeSeriesSelectMode.is(\"record\")) {\r\n            this.rd.onRecordMouseLeave(prevClosestRecord);\r\n            prevClosestRecord = null;\r\n          }\r\n          if (this.timeSeriesSelectMode.is(\"time\") && prevClosestTime) {\r\n            hideAllPoppers();\r\n            this.browser.records.forEach((record: Record) => {\r\n              if (record.filteredOut) return;\r\n              if (!prevClosestTime) return;\r\n              this.timeseriesAttrib\r\n                .getRecordValue(record)\r\n                ?._keyIndex[prevClosestTime._time_src]?.DOM?.classList.remove(\r\n                  \"visible\"\r\n                );\r\n            });\r\n          }\r\n\r\n          return;\r\n        }\r\n\r\n        var _m_Time = this.scale_Time.invert(_m[0]);\r\n        var _compareKey = this.timeSeriesChangeVsTimeKey.get()?._time_src || null;\r\n\r\n        var closestTimeKey = null;\r\n        if (\r\n          _m_Time.getTime() <= this.scale_Time.domain()[1].getTime() &&\r\n          _m_Time.getTime() >= this.scale_Time.domain()[0].getTime()\r\n        ) {\r\n          var closestTimeDist = 999999999999999;\r\n          this.timeKeys_Active.every((timeKey) => {\r\n            var _dist = Math.abs(timeKey._time.getTime() - _m_Time.getTime());\r\n            if (_dist < closestTimeDist) {\r\n              closestTimeKey = timeKey;\r\n              closestTimeDist = _dist;\r\n              return true;\r\n            }\r\n            return false; // getting farther away. We already found the closest\r\n          });\r\n        }\r\n\r\n        // Select closest time\r\n        if (this.timeSeriesSelectMode.is(\"time\")) {\r\n          if (closestTimeKey === prevClosestTime) return;\r\n\r\n          if (prevClosestTime) {\r\n            hideAllPoppers();\r\n            this.browser.records.forEach((record) => {\r\n              if (record.filteredOut) return;\r\n              this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\r\n                prevClosestTime._time_src\r\n              ]?.DOM?.classList.remove(\"visible\");\r\n            });\r\n          }\r\n\r\n          if (closestTimeKey) {\r\n            spacer_right.clear();\r\n            spacer_left.clear();\r\n\r\n            this.browser.records.forEach((record) => {\r\n              if (!this.recordInView(record) || record.filteredOut) return;\r\n              var c =\r\n                this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\r\n                  closestTimeKey._time_src\r\n                ];\r\n              if (!c) return;\r\n              c.DOM.classList.add(\"visible\"); // timeSeriesDot\r\n              var placement;\r\n              var ref = this.isTimeseriesChange()\r\n                ? this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\r\n                    _compareKey\r\n                  ]._value\r\n                : 0;\r\n              var top = this.y_Generator(c, ref);\r\n              if (spacer_right.isEmpty(top)) {\r\n                placement = \"right\";\r\n                spacer_right.insertUsed(top, 30, record);\r\n              } else if (spacer_left.isEmpty(top)) {\r\n                placement = \"left\";\r\n                spacer_left.insertUsed(top, 30, record);\r\n              } else {\r\n                return;\r\n              }\r\n              pofff(c, record, placement);\r\n            });\r\n          }\r\n          prevClosestTime = closestTimeKey;\r\n          return;\r\n        }\r\n\r\n        // Select closest point\r\n\r\n        var closestRecord = null;\r\n        if (!closestTimeKey) {\r\n          this.rd.onRecordMouseLeave(prevClosestRecord);\r\n          prevClosestRecord = null;\r\n          return;\r\n        }\r\n\r\n        var closestValueDist = 999999999999999;\r\n        this.browser.records.forEach((record) => {\r\n          if (!this.recordInView(record) || record.filteredOut) return;\r\n          var _ =\r\n            this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\r\n              closestTimeKey._time_src\r\n            ];\r\n          if (!_) return;\r\n          var ref = this.isTimeseriesChange()\r\n            ? this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\r\n                _compareKey\r\n              ]._value\r\n            : 0;\r\n          var _v = this.y_Generator(_, ref);\r\n          var _dist = Math.abs(_v - _m[1]);\r\n          if (_dist < 50 && _dist < closestValueDist) {\r\n            closestRecord = record;\r\n            closestValueDist = _dist;\r\n          }\r\n        });\r\n\r\n        if (prevClosestRecord !== closestRecord) {\r\n          this.rd.onRecordMouseLeave(prevClosestRecord);\r\n          prevClosestRecord = null;\r\n          if (closestRecord) {\r\n            this.rd.onRecordMouseOver(closestRecord);\r\n            var c =\r\n              this.timeseriesAttrib.getRecordValue(closestRecord)?._keyIndex[\r\n                closestTimeKey._time_src\r\n              ];\r\n            if (c) {\r\n              pofff(c, closestRecord);\r\n            }\r\n          }\r\n          prevClosestRecord = closestRecord;\r\n        } else if (closestRecord) {\r\n          // maybe record is the same, but the time changed?\r\n          if (prevClosestTime !== closestTimeKey) {\r\n            hideAllPoppers();\r\n            var c =\r\n              this.timeseriesAttrib.getRecordValue(closestRecord)?._keyIndex[\r\n                closestTimeKey._time_src\r\n              ];\r\n            if (c) {\r\n              pofff(c, closestRecord);\r\n            }\r\n          }\r\n        }\r\n\r\n        prevClosestTime = closestTimeKey;\r\n\r\n        this.rd.setDimmed(!!prevClosestRecord);\r\n      });\r\n\r\n    this.DOM.recordLineClippath = this.DOM.recordGroup\r\n      .append(\"clipPath\")\r\n      .attr(\"id\", \"recordLineClippath\")\r\n      .append(\"rect\")\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", 0)\r\n      .attr(\"height\", 4000);\r\n\r\n    // annotations\r\n    this.DOM.ts_annotations = this.DOM.recordBase_Timeseries\r\n      .append(\"span\")\r\n      .attr(\"class\", \"ts_annotations\");\r\n\r\n    this.DOM.recordBase_Timeseries\r\n      .append(\"div\")\r\n      .attr(\"class\", \"TimeseriesColorInfo\")\r\n      .html(i18n[\"Line colors are random\"]);\r\n\r\n    // ******************************************************\r\n\r\n    this.DOM.timeSeriesControlGroup = this.DOM.recordBase_Timeseries\r\n      .append(\"div\")\r\n      .attr(\"class\", \"timeSeriesControlGroup attribControlGroup\");\r\n\r\n    this.rd.initDOM_AttribSelect(\"timeSeries\");\r\n\r\n    // ******************************************************\r\n\r\n    this.DOM.timeAnimationClearRange.on(\"click\", () =>\r\n      this.setTimeRange({ min: 0, max: 10000 })\r\n    ); // max is just a very large number\r\n\r\n    noUiSlider.create(this.DOM.timeseriesRange.node(), {\r\n      start: [50, 50],\r\n      connect: true,\r\n      step: 1,\r\n      behaviour: \"tap-drag\",\r\n      margin: 1, // at least one step difference between the end/start point\r\n      range: {\r\n        min: 0,\r\n        max: 100,\r\n      },\r\n    });\r\n\r\n    this.timeseriesRange = this.DOM.timeseriesRange.node().noUiSlider;\r\n\r\n    var _update_2 = (_values, _handle, unencoded) => {\r\n      if (this.timeseriesRange_noUpdate) return;\r\n      unencoded = unencoded.map((_) => Math.round(_));\r\n      this.timeseriesRange_noUpdate = true;\r\n      this.setTimeRange({ min: unencoded[0], max: unencoded[1] });\r\n      delete this.timeseriesRange_noUpdate;\r\n    };\r\n    this.timeseriesRange.on(\"set\", _update_2);\r\n  }\r\n\r\n  /** -- */\r\n  isTimeseriesChange() {\r\n    return this.ts_Type.is(\"ChangePct\") || this.ts_Type.is(\"ChangeAbs\");\r\n  }\r\n\r\n  extendRecordDOM(newRecords) {\r\n    newRecords.append(\"path\");\r\n    newRecords.append(\"g\").attr(\"class\", \"dotGroup\");\r\n    newRecords\r\n      .append(\"foreignObject\")\r\n      .attr(\"width\", \"120\")\r\n      .attr(\"height\", \"1\")\r\n      .call((fO) => {\r\n        fO.append(\"xhtml:div\")\r\n          .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\r\n          .attr(\"class\", \"recordText_side\")\r\n          .html((record: Record) =>\r\n            this.textBriefAttrib?.renderRecordValue(record)\r\n          );\r\n        fO.append(\"xhtml:div\")\r\n          .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\r\n          .attr(\"class\", \"recordText_Dot\");\r\n      });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Time range\r\n  // ********************************************************************\r\n\r\n  /** -- Parameters are integer index of the active timeseries attribute timekeys */\r\n  setTimeRange({ min = -1, max = -1 } = {}) {\r\n    if (min >= 0) {\r\n      this.timeRange.min = this.timeseriesAttrib.timeKeys[min];\r\n    }\r\n    if (max >= 0) {\r\n      max = Math.min(max, this.timeseriesAttrib.timeKeys.length - 1);\r\n      this.timeRange.max = this.timeseriesAttrib.timeKeys[max];\r\n    }\r\n    this.refreshTimeRange();\r\n  }\r\n\r\n  /** -- */\r\n  refreshTimeRange() {\r\n    this.refreshScaleTime();\r\n    this.refreshTimeseriesTicks();\r\n\r\n    if (this.timeRange.min._time > this.timeSeriesChangeVsTimeKey.get()?._time) {\r\n      this.timeSeriesChangeVsTimeKey.set(this.timeRange.min);\r\n      this.refreshTimeSeriesRangeOpts(); // updates combobox for vs.\r\n\r\n    } else if (this.timeRange.max._time < this.timeSeriesChangeVsTimeKey.get()?._time) {\r\n      this.timeSeriesChangeVsTimeKey.set(this.timeRange.max);\r\n      this.refreshTimeSeriesRangeOpts(); // updates combobox for vs.\r\n\r\n    } else {\r\n      this.refreshScaleValue();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshTimeSeriesRangeOpts() {\r\n    [\"min\", \"max\"].forEach((limit) => {\r\n      this.DOM.root\r\n        .select(\".timeLimit-\" + limit)\r\n        .classed(\"filtered\", this.timeRange.isActive(limit));\r\n      this.DOM.root\r\n        .select(\".timeLimit-\" + limit + \" > select\")\r\n        .selectAll(\"option\")\r\n        .data(\r\n          this.timeseriesAttrib.timeKeys.filter(\r\n            limit === \"min\"\r\n              ? (key) => key._time < this.timeRange.max._time\r\n              : (key) => key._time > this.timeRange.min._time\r\n          ),\r\n          (d) => d._time_src\r\n        )\r\n        .join(\r\n          (enter) => enter.append(\"option\").text((d) => d._time_src),\r\n          (update) => update,\r\n          (exit) => exit.remove()\r\n        )\r\n        .attr(\"selected\", (d) =>\r\n          d._time_src === this.timeRange[limit]._time_src ? true : null\r\n        );\r\n    });\r\n  }\r\n\r\n  async refreshAttribScaleType(attrib: Attrib) {\r\n    if (\r\n      attrib instanceof Attrib_Timeseries &&\r\n      this.timeseriesAttrib === attrib\r\n    ) {\r\n      await this.ts_valueAxisScale.set(attrib.valueScaleType.get()); // apply it back to the attribute\r\n      if (this.ts_Type.is(\"Value\")) {\r\n        this.refreshScaleValue();\r\n      }\r\n    }\r\n  }\r\n\r\n  async finishSetAttrib(t: RecordVisCoding) {\r\n    if (t === \"textBrief\") {\r\n      this.DOM.kshfRecords\r\n        .selectAll(\"foreignObject > .recordText_side\")\r\n        .html((record: Record) =>\r\n          this.textBriefAttrib.renderRecordValue(record)\r\n        );\r\n      //\r\n    } else if (t === \"timeSeries\") {\r\n      this.scale_Time = this.timeseriesAttrib.timeSeriesScale_Time.copy();\r\n\r\n      if (\r\n        !this.timeRange.min ||\r\n        !this.timeseriesAttrib.timeKeys.some(\r\n          (_) => _._time_src === this.timeRange.min._time_src\r\n        ) ||\r\n        !this.timeRange.max ||\r\n        !this.timeseriesAttrib.timeKeys.some(\r\n          (_) => _._time_src === this.timeRange.max._time_src\r\n        )\r\n      ) {\r\n        this.setTimeRange({ min: 0, max: 10000 });\r\n      }\r\n\r\n      await this.ts_valueAxisScale.set(this.timeseriesAttrib.valueScaleType.get());\r\n\r\n      if (this.ts_Type.is(\"Rank\")) {\r\n        this.timeseriesAttrib.computeRecordRanks();\r\n      }\r\n\r\n      if (!this.timeSeriesChangeVsTimeKey.get()) {\r\n        await this.timeSeriesChangeVsTimeKey.set(this.rd.config.timeSeriesChangeVsTimeKey);\r\n      }\r\n\r\n      this.refreshScaleTime();\r\n      this.refreshScaleValue();\r\n      this.refreshFilterRanges();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshViewSize(_delayMS: number = 0) {\r\n    this.refreshScaleTime();\r\n    this.refreshRecordVis();\r\n    this.refreshTimeseriesTicks();\r\n    this.refreshTicks_AxisY();\r\n    this.updateDotVisibility();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Scale of time and values\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  refreshScaleTime() {\r\n    if (!this.timeseriesAttrib) return;\r\n    if (!this.timeseriesRange) return;\r\n\r\n    this.scale_Time_prev = this.scale_Time.copy();\r\n\r\n    this.scale_Time.domain([\r\n      this.timeRange.min._time,\r\n      this.timeRange.max._time,\r\n    ]);\r\n\r\n    var timeKeys = this.timeseriesAttrib.timeKeys;\r\n\r\n    this.timeKeys_Active = timeKeys.filter(\r\n      (key) =>\r\n        key._time >= this.timeRange.min._time &&\r\n        key._time <= this.timeRange.max._time\r\n    );\r\n\r\n    if (this.ts_timeKeysStep.is(\"limits\")) {\r\n      this.timeKeys_Active = [\r\n        this.timeKeys_Active[0],\r\n        this.timeKeys_Active[this.timeKeys_Active.length - 1],\r\n      ];\r\n      if (this.isTimeseriesChange()) {\r\n        this.timeKeys_Active.splice(1, 0, this.timeSeriesChangeVsTimeKey.get());\r\n      }\r\n    }\r\n\r\n    this.timeSeriesChangeVsTimeKey.refresh();\r\n\r\n    this.marginLeft = 85;\r\n    this.chartWidth = this.rd.curWidth - this.marginTotal;\r\n    this.expandMargin();\r\n    this.scale_Time.range([0, this.chartWidth]);\r\n\r\n    // first time setting scale_Time should also reset prev to current\r\n    if (!this.scale_Time_prev) {\r\n      this.scale_Time_prev = this.scale_Time.copy();\r\n    }\r\n\r\n    this.refreshTimeSeriesChartWidth();\r\n\r\n    this.refreshTimeSeriesRangeOpts();\r\n\r\n    this.timeseriesRange_noUpdate = true;\r\n    this.timeseriesRange.updateOptions({\r\n      range: {\r\n        min: 0,\r\n        max: timeKeys.length - 1,\r\n      },\r\n    });\r\n    delete this.timeseriesRange_noUpdate;\r\n\r\n    // \"false\" avoid firing the \"set\" event\r\n    this.timeseriesRange.setHandle(0, this.timeRange.min._index, false);\r\n    this.timeseriesRange.setHandle(1, this.timeRange.max._index, false);\r\n\r\n    this.DOM.timeAnimation.select(\".rangeTick-min\").html(timeKeys[0]._time_src);\r\n    this.DOM.timeAnimation\r\n      .select(\".rangeTick-max\")\r\n      .html(timeKeys[timeKeys.length - 1]._time_src);\r\n    this.DOM.timeAnimation\r\n      .select(\".clearRange\")\r\n      .classed(\"active\", this.timeRange.isActive());\r\n\r\n    this.addAnnotations();\r\n  }\r\n\r\n  /** -- */\r\n  refreshScaleValue() {\r\n    if (!this.ts_Type) return;\r\n    if (!this.timeseriesAttrib) return;\r\n\r\n    // RANK    *****************************************************\r\n    if (this.ts_Type.is(\"Rank\")) {\r\n      var timeDomain = this.scale_Time.domain();\r\n      var inTimeDomain = (d) => true;\r\n      if (timeDomain) {\r\n        inTimeDomain = (d) =>\r\n          d._time >= timeDomain[0] && d._time <= timeDomain[1];\r\n      }\r\n\r\n      // count number of records with data within the time domain\r\n      var maxNumRecords = this.browser.records.reduce(\r\n        (accumulator, currentRecord: Record) => {\r\n          if (currentRecord.filteredOut) return accumulator;\r\n\r\n          var _val = this.timeseriesAttrib.getRecordValue(currentRecord);\r\n          if (!_val) return accumulator;\r\n\r\n          // consider only values that are inTimeDomain\r\n          if (_val._timeseries_.filter(inTimeDomain).length === 0) {\r\n            return accumulator;\r\n          }\r\n\r\n          return accumulator + 1;\r\n        },\r\n        0\r\n      );\r\n\r\n      this.scale_Value = d3.scaleLinear().domain([maxNumRecords, 1]);\r\n    }\r\n\r\n    // VALUE   *****************************************************\r\n    if (this.ts_Type.is(\"Value\")) {\r\n      this.scale_Value = this.timeseriesAttrib.timeSeriesScale_Value\r\n        .copy()\r\n        .nice();\r\n\r\n      var new_domain = this.timeseriesAttrib.getExtent_Value(\r\n        this.fitValueAxis.get(), // onlyFiltered\r\n        this.scale_Time.domain() // in current domain\r\n      );\r\n\r\n      var _domain = this.scale_Value.domain();\r\n      if (_domain[0] > _domain[1]) new_domain = [new_domain[1], new_domain[0]]; // flip domain\r\n\r\n      this.scale_Value.domain(new_domain);\r\n    }\r\n\r\n    // CHANGE   *****************************************************\r\n    if (this.isTimeseriesChange()) {\r\n      if (!this.timeSeriesChangeVsTimeKey.get()) {\r\n        this.timeSeriesChangeVsTimeKey.set(this.timeKeys_Active[0]);\r\n      }\r\n\r\n      var _key = this.timeSeriesChangeVsTimeKey.get()._time_src;\r\n\r\n      var timeDomain = this.scale_Time.domain();\r\n      var inTimeDomain = (d) =>\r\n        d._time >= timeDomain[0] && d._time <= timeDomain[1];\r\n\r\n      var vizVal;\r\n      if (this.ts_Type.is(\"ChangeAbs\")) {\r\n        vizVal = (v, ref) => v._value - ref;\r\n      } else if (this.ts_Type.is(\"ChangePct\")) {\r\n        vizVal = (v, ref) => 100 * ((v._value - ref) / ref);\r\n      }\r\n\r\n      var x = this.browser.records.map((record: Record) => {\r\n        if (!this.recordInView(record) || record.filteredOut) {\r\n          return [0, 0];\r\n        }\r\n\r\n        var r_ts = this.timeseriesAttrib.getRecordValue(record);\r\n        var ref = r_ts._keyIndex[_key]._value;\r\n        if (!ref) return [0, 0];\r\n        return d3.extent(r_ts._timeseries_, (v) =>\r\n          inTimeDomain(v) ? vizVal(v, ref) : null\r\n        );\r\n      });\r\n\r\n      this.scale_Value = d3\r\n        .scaleLinear()\r\n        .domain([d3.min(x, (x) => x[0]), d3.max(x, (x) => x[1])])\r\n        .nice();\r\n    }\r\n\r\n    // FINALIZE ******************************************************\r\n    this.refreshRecordVis();\r\n    this.refreshTicks_AxisY();\r\n    this.refreshFilterRanges();\r\n  }\r\n\r\n  /** -- */\r\n  refreshYGenerator() {\r\n    this.y_Generator = {\r\n      Value: (d: TimeData) => this.scale_Value(d._value),\r\n      ChangePct: (d: TimeData, ref) =>\r\n        this.scale_Value(ref ? (100 * (d._value - ref)) / ref : 0),\r\n      ChangeAbs: (d: TimeData, ref) => this.scale_Value(d._value - ref),\r\n      Rank: (d: TimeData) => this.scale_Value(d._rank),\r\n    }[this.ts_Type.get()];\r\n  }\r\n\r\n  /** VALUE AXIS */\r\n  refreshTicks_AxisY() {\r\n    var screenHeight = Math.abs(\r\n      this.scale_Value.range()[1] - this.scale_Value.range()[0]\r\n    );\r\n    var targetNumTicks = Math.floor(screenHeight / 40); // one tickevery 40 pixels\r\n    var _scale = this.scale_Value.copy();\r\n    if (_scale.base) _scale.base(10);\r\n    var ticks = _scale.ticks(targetNumTicks);\r\n\r\n    // if the values are integer only, keep only integer values here.\r\n    if (!this.timeseriesAttrib.hasFloat || this.ts_Type.is(\"Rank\")) {\r\n      ticks = ticks.filter((d) => d % 1 === 0);\r\n    }\r\n\r\n    if (this.ts_Type.is(\"Rank\")) {\r\n      ticks.unshift(1);\r\n      ticks = ticks\r\n        .sort((a, b) => b - a)\r\n        // keep unique values onlu=y\r\n        .reduce((accumulator, currentValue) => {\r\n          if (accumulator[accumulator.length - 1] !== currentValue)\r\n            accumulator.push(currentValue);\r\n          return accumulator;\r\n        }, []);\r\n    }\r\n\r\n    var tickTextFunc = {\r\n      Rank: (tick) => \"# \" + d3.format(\"d\")(tick),\r\n      ChangePct: (tick) => (tick > 0 ? \"+\" : \"\") + d3.format(\".3s\")(tick) + \"%\",\r\n      ChangeAbs: (tick) =>\r\n        (tick > 0 ? \"+\" : \"\") + this.timeseriesAttrib.printAbbr(tick, true),\r\n      Value: (tick) => this.timeseriesAttrib.getFormattedValue(tick, true),\r\n    }[this.ts_Type.get()];\r\n\r\n    var timeAxisDOM = this.DOM.root.select(\r\n      \".recordBase_Timeseries .recordAxis_Y > .tickGroup\"\r\n    );\r\n\r\n    var visiblePos = 0;\r\n\r\n    timeAxisDOM\r\n      .selectAll(\".hmTicks\")\r\n      .data(ticks.reverse(), (t) => t) // reverse from decreasing to increasing order\r\n      .join(\r\n        (enter) =>\r\n          enter\r\n            .append(\"div\")\r\n            .attr(\"class\", \"hmTicks\")\r\n            .classed(\"zero\", (tick) => tick === 0)\r\n            .style(\"opacity\", 0)\r\n            .call((hmTicks) => {\r\n              hmTicks.append(\"div\").attr(\"class\", \"tickLine\");\r\n              hmTicks.append(\"div\").attr(\"class\", \"tickText tickText_1\");\r\n              hmTicks.transition().delay(500).duration(0).style(\"opacity\", 1);\r\n            }),\r\n        (update) => update,\r\n        (exit) => {\r\n          exit\r\n            .style(\r\n              \"transform\",\r\n              (tick) =>\r\n                \"translateY(\" + this.scale_Value(tick) + \"px) translateZ(0)\"\r\n            )\r\n            .style(\"opacity\", 0)\r\n            .transition()\r\n            .duration(0)\r\n            .delay(500)\r\n            .remove();\r\n        }\r\n      )\r\n      .style(\r\n        \"transform\",\r\n        (tick) => \"translateY(\" + this.scale_Value(tick) + \"px) translateZ(0)\"\r\n      )\r\n      .classed(\"hideLabel\", (tick) => {\r\n        var pos = this.scale_Value(tick);\r\n        if (pos >= visiblePos) {\r\n          visiblePos = pos + 20;\r\n          return false;\r\n        }\r\n        return true;\r\n      })\r\n      .call((ticks) => {\r\n        ticks.selectAll(\".tickText\").html(tickTextFunc);\r\n      });\r\n  }\r\n\r\n  refreshFilterRanges() {\r\n    this.DOM.root\r\n      .selectAll(\".recordBase_Timeseries .recordAxis_X > .tickGroup > .hmTicks\")\r\n      .each((tick: TimeKey) => {\r\n        tick._histogram = this.timeseriesAttrib.timeKeyAttribs[tick._time_src];\r\n      })\r\n      .classed(\r\n        \"isFiltered\",\r\n        (tick: TimeKey) => tick._histogram?.isFiltered() && this.ts_Type.is(\"Value\")\r\n      )\r\n      .filter(\r\n        (tick: TimeKey) => tick._histogram?.isFiltered() && this.ts_Type.is(\"Value\")\r\n      )\r\n      .selectAll(\".filterArea\")\r\n      .style(\"height\", (event) => {\r\n        var d = _DOM.parentNode.__data__ as TimeKey;\r\n        var _DOM = event.currentTarget;\r\n        var attrib = d._histogram;\r\n        var _a = this.scale_Value(attrib.summaryFilter.active.minV);\r\n        var _b = this.scale_Value(attrib.summaryFilter.active.maxV);\r\n        var _domain = this.scale_Value.domain();\r\n        var flipped = _domain[0] > _domain[1];\r\n        _DOM._minn = flipped ? _b : _a;\r\n        _DOM._maxx = flipped ? _a : _b;\r\n        // That's where printing happens\r\n        d3.select(_DOM.childNodes[flipped ? 1 : 0]).html(\r\n          attrib.printAbbr(attrib.summaryFilter.active.minV)\r\n        );\r\n        d3.select(_DOM.childNodes[flipped ? 0 : 1]).html(\r\n          attrib.printAbbr(attrib.summaryFilter.active.maxV)\r\n        );\r\n        return Math.abs(_DOM._maxx - _DOM._minn) + 14 + \"px\";\r\n      })\r\n      .style(\"top\", (event) => {\r\n        var _domain = this.scale_Value.domain();\r\n        if (_domain[0] > _domain[1])\r\n          return event.currentTarget._minn - 5 + \"px\";\r\n        return event.currentTarget._maxx - 5 + \"px\";\r\n      });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Size / width / height / margins\r\n  // ********************************************************************\r\n\r\n  // is dyanmically updated, needs a setter too, so setting this as regular var.\r\n  marginLeft: number = 85;\r\n  chartWidth: number;\r\n\r\n  /** -- */\r\n  get marginRight() {\r\n    return 150;\r\n  }\r\n  /** -- */\r\n  get marginTotal() {\r\n    return this.marginLeft + this.marginRight;\r\n  }\r\n  /** -- */\r\n  isMarginExpandable() {\r\n    var maxWidth = 200 * (this.timeKeys_Active.length - 1);\r\n    return maxWidth < this.rd.curWidth - this.marginTotal;\r\n  }\r\n  /** -- */\r\n  expandMargin() {\r\n    if (this.wideTimeScale) return;\r\n    // shrink the width if there are few time keys active\r\n    var maxWidth = 200 * (this.timeKeys_Active.length - 1);\r\n    if (maxWidth < this.chartWidth) {\r\n      this.marginLeft += (this.chartWidth - maxWidth) / 2;\r\n      this.chartWidth = maxWidth;\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshTimeSeriesChartWidth() {\r\n    this.DOM.recordBase_Timeseries\r\n      ?.style(\"width\", this.chartWidth + \"px\")\r\n      .style(\"left\", this.marginLeft + \"px\");\r\n\r\n    this.DOM.recordLineClippath?.attr(\"width\", this.chartWidth);\r\n  }\r\n\r\n  /** -- */\r\n  updateRecordVisibility() {\r\n    this.refreshLabelOverlaps();\r\n  }\r\n\r\n  /** -- */\r\n  refreshKeyLine() {\r\n    if (!this.timeseriesAttrib) return;\r\n\r\n    if (!this.timeSeriesChangeVsTimeKey.get()) return;\r\n    this.DOM.root\r\n      .select(\".recordAxis_X > .keyLine\")\r\n      .style(\r\n        \"transform\",\r\n        `translateX(${this.scale_Time(\r\n          this.timeSeriesChangeVsTimeKey.get()._time\r\n        )})`\r\n      );\r\n  }\r\n\r\n  /** -- */\r\n  onRecordMouseLeave() {\r\n    hideAllPoppers();\r\n  }\r\n  /** -- */\r\n  onRecordMouseOver(record) {\r\n    record.moveDOMtoTop();\r\n  }\r\n\r\n  /** -- */\r\n  refreshTimeseriesTicks() {\r\n    if (!this.timeseriesAttrib) return;\r\n\r\n    var me = this;\r\n\r\n    var timeAxisDOM = this.DOM.root.select(\r\n      \".recordBase_Timeseries .recordAxis_X > .tickGroup\"\r\n    );\r\n\r\n    var lastTickPos = -300;\r\n\r\n    var maxChar = this.timeseriesAttrib.timeKeys.reduce(\r\n      (accum, key) => Math.max(accum, key._time_src.length),\r\n      0\r\n    );\r\n    var tickGapWidth = maxChar * 9;\r\n\r\n    timeAxisDOM\r\n      .selectAll(\".hmTicks\")\r\n      .data(this.timeKeys_Active, (t: TimeKey) => t._time_src)\r\n      .join(\r\n        (enter) => {\r\n          var tk = enter\r\n            .append(\"div\")\r\n            .attr(\"class\", \"hmTicks\")\r\n            .style(\"opacity\", 1)\r\n            .style(\r\n              \"transform\",\r\n              (tick) =>\r\n                `translateX(${this.scale_Time_prev(\r\n                  tick._time\r\n                )}px) translateZ(0)`\r\n            )\r\n            .call((tk) =>\r\n              tk\r\n                .transition()\r\n                .delay(0)\r\n                .duration(0)\r\n                .style(\r\n                  \"transform\",\r\n                  (tick) =>\r\n                    `translateX(${this.scale_Time(tick._time)}px) translateZ(0)`\r\n                )\r\n            );\r\n\r\n          var tickText = tk.append(\"div\").attr(\"class\", \"tickText\");\r\n\r\n          tk.append(\"div\").attr(\"class\", \"tickLine\");\r\n          tk.append(\"div\")\r\n            .attr(\"class\", \"timeSelectArea\")\r\n            .on(\"mousedown\", (event, tick) => {\r\n              if (event.which !== 1) return; // only respond to left-click\r\n              me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n              var DOM = event.currentTarget;\r\n              var initPos = me.scale_Value.invert(d3.pointer(event)[1]);\r\n              var histSummary = me.timeseriesAttrib.getTimepointSummary(tick);\r\n              d3.select(\"body\")\r\n                .on(\"mousemove.test\", () => {\r\n                  var targetPos = me.scale_Value.invert(\r\n                    d3.pointer(event, DOM)[1]\r\n                  );\r\n                  var _min = initPos > targetPos ? targetPos : initPos;\r\n                  var _max = initPos > targetPos ? initPos : targetPos;\r\n                  if (me.ts_Type.is(\"Rank\")) {\r\n                    var _minRank = Math.floor(_min);\r\n                    var _maxRank = Math.ceil(_max);\r\n                    me.browser.records.forEach((r) => {\r\n                      var mm = r.getValue(this.timeseriesAttrib)._keyIndex;\r\n                      if (mm) {\r\n                        var dasds = mm[tick._time_src];\r\n                        if (dasds) {\r\n                          if (dasds._rank === _minRank) _min = dasds._value;\r\n                          if (dasds._rank === _maxRank) _max = dasds._value;\r\n                        }\r\n                      }\r\n                    });\r\n                    // find records with these limit ranks\r\n                  }\r\n                  histSummary.setRangeFilter_Custom(_min, _max);\r\n                  me.refreshFilterRanges();\r\n                })\r\n                .on(\"mouseup.test\", () => {\r\n                  me.browser.DOM.root.classed(\"noPointerEvents\", false);\r\n                  d3.select(\"body\")\r\n                    .on(\"mousemove.test\", null)\r\n                    .on(\"mouseup.test\", null);\r\n                });\r\n              event.preventDefault();\r\n            });\r\n\r\n          var filterArea = tk\r\n            .append(\"div\")\r\n            .attr(\"class\", \"filterArea\")\r\n            .on(\"mousedown\", (event, tick) => {\r\n              if (event.which !== 1) return; // only respond to left-click\r\n              me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n              var e = event.currentTarget.parentNode.childNodes[2]; // selectArea. TODO: Make this harder to fail!\r\n              var DOM = event.currentTarget;\r\n              DOM.classList.add(\"dragging\");\r\n\r\n              var histSummary = me.timeseriesAttrib.getTimepointSummary(tick);\r\n\r\n              var initPos = me.scale_Value.invert(d3.pointer(event, e)[1]);\r\n              d3.select(\"body\")\r\n                .on(\"mousemove.test\", () => {\r\n                  var curPos = me.scale_Value.invert(d3.pointer(event, e)[1]);\r\n                  histSummary.setRangeFilter_Custom(\r\n                    Math.min(initPos, curPos),\r\n                    Math.max(initPos, curPos)\r\n                  );\r\n                })\r\n                .on(\"mouseup.test\", () => {\r\n                  me.browser.DOM.root.classed(\"noPointerEvents\", false);\r\n                  DOM.classList.remove(\"dragging\");\r\n                  d3.select(\"body\")\r\n                    .on(\"mousemove.test\", null)\r\n                    .on(\"mouseup.test\", null);\r\n                });\r\n              event.preventDefault();\r\n            });\r\n\r\n          tickText\r\n            .append(\"span\")\r\n            .attr(\"class\", \"clearFilterButton fa\")\r\n            .tooltip(i18n.RemoveFilter)\r\n            .on(\"click\", (tick) => {\r\n              var _ = this.timeseriesAttrib.getTimepointSummary(tick);\r\n              if (_) _.summaryFilter.clearFilter();\r\n            });\r\n          tickText\r\n            .append(\"span\")\r\n            .attr(\"class\", \"theTextText\")\r\n            .html((tick) => tick._time_src);\r\n          tickText\r\n            .append(\"span\")\r\n            .attr(\"class\", \"openTimepointSummary fa fa-external-link-square\")\r\n            .tooltip(\"Create Time-Key<br>Histogram\")\r\n            .on(\"click\", (tick) => {\r\n              var newSummary = this.timeseriesAttrib.getTimepointSummary(tick);\r\n              newSummary.block.addToPanel(this.browser.panels.left);\r\n              this.browser.updateLayout();\r\n            });\r\n\r\n          [\"min\", \"max\"].forEach(function (endType) {\r\n            filterArea\r\n              .append(\"div\")\r\n              .attr(\"class\", \"filterRangeValue filterRangeValue_\" + endType)\r\n              .on(\"mousedown\", function (event, tick) {\r\n                if (event.which !== 1) return; // only respond to left-click\r\n                me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n                var e = this.parentNode.parentNode.childNodes[2]; // selectArea. TODO: Make this harder to fail!\r\n                var _ = this.parentNode;\r\n                _.classList.add(\"dragging\");\r\n\r\n                var histSummary = me.timeseriesAttrib.getTimepointSummary(tick);\r\n\r\n                d3.select(\"body\")\r\n                  .on(\"mousemove.range\", function () {\r\n                    var curVal = me.scale_Value.invert(d3.pointer(event, e)[1]);\r\n                    histSummary.summaryFilter.active[endType] = curVal;\r\n                    histSummary.summaryFilter.setFiltered(true);\r\n                    me.refreshFilterRanges();\r\n                  })\r\n                  .on(\"mouseup.range\", function () {\r\n                    _.classList.remove(\"dragging\");\r\n                    me.browser.DOM.root\r\n                      .attr(\"adjustWidth\", null)\r\n                      .classed(\"noPointerEvents\", false);\r\n                    d3.select(\"body\")\r\n                      .style(\"cursor\", \"auto\")\r\n                      .on(\"mousemove.range\", null)\r\n                      .on(\"mouseup.range\", null);\r\n                  });\r\n\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n              });\r\n          });\r\n          return tk;\r\n        },\r\n\r\n        (update) => {\r\n          return update.style(\r\n            \"transform\",\r\n            (tick) =>\r\n              `translateX(${this.scale_Time(tick._time)}px) translateZ(0)`\r\n          );\r\n        },\r\n\r\n        (exit) => {\r\n          return exit\r\n            .transition()\r\n            .duration(0)\r\n            .delay(500)\r\n            .style(\r\n              \"transform\",\r\n              (tick) =>\r\n                `translateX(${this.scale_Time(tick._time)}px) translateZ(0)`\r\n            )\r\n            .style(\"opacity\", 0)\r\n            .remove();\r\n        }\r\n      )\r\n      .selectAll(\".tickText\")\r\n      .style(\"display\", (tick) => {\r\n        var newTickPos = this.scale_Time(tick._time);\r\n        if (newTickPos - lastTickPos < tickGapWidth) return \"none\";\r\n        lastTickPos = newTickPos;\r\n        return null;\r\n      });\r\n\r\n    this.refreshKeyLine();\r\n  }\r\n\r\n  /** -- */\r\n  updateDotVisibility() {\r\n    // based on chart size (width, height) and active (or truly visible) record count\r\n    var recCount =\r\n      this.browser.records.length -\r\n      this.DOM.root.selectAll(\".noTimeSeries, .filteredOut\").nodes().length;\r\n    this.browser.DOM.root.classed(\r\n      \"noRecordDots\",\r\n      this.rd.curHeight / recCount < 100 ||\r\n        this.rd.curWidth / this.timeKeys_Active.length < 30\r\n    );\r\n  }\r\n\r\n  private wideTimeScale: boolean = false;\r\n  private wideTimeScaleTimer: number;\r\n\r\n  timeseriesWiden() {\r\n    if (!this.isMarginExpandable()) return;\r\n    this.wideTimeScaleTimer = window.setTimeout(() => {\r\n      this.wideTimeScale = true;\r\n      this.refreshTimeRange();\r\n    }, 500);\r\n  }\r\n  timeseriesWidenOff() {\r\n    if (!this.wideTimeScaleTimer) return;\r\n    window.clearTimeout(this.wideTimeScaleTimer);\r\n    this.wideTimeScaleTimer = 0;\r\n    if (this.wideTimeScale && !this.rd.timeseriesAnimInterval) {\r\n      this.wideTimeScale = false;\r\n      this.refreshTimeRange();\r\n    }\r\n  }\r\n\r\n  stepTimeAnimation(stepSize: number): boolean {\r\n    this.wideTimeScale = true;\r\n\r\n    var maxIndex = this.timeseriesAttrib.timeKeys.length - 1;\r\n\r\n    // start from beginning\r\n    if (this.timeRange.max._index >= maxIndex) {\r\n      this.setTimeRange({ max: this.timeRange.min._index + 1 });\r\n      window.setTimeout(\r\n        () => this.rd.startTimeseriesAnimation(stepSize),\r\n        this.animStepDelayMs\r\n      ); // adds double-wait, but works fine\r\n      return true;\r\n    }\r\n\r\n    this.rd.timeseriesAnimInterval = window.setInterval(() => {\r\n      if (this.timeRange.max._index >= maxIndex) {\r\n        this.rd.stopTimeseriesAnimation();\r\n      } else {\r\n        this.setTimeRange({ max: this.timeRange.max._index + stepSize });\r\n      }\r\n    }, this.animStepDelayMs);\r\n\r\n    return true;\r\n  }\r\n  stopTimeAnimation() {\r\n    this.refreshTimeRange();\r\n    this.wideTimeScale = false;\r\n  }\r\n\r\n  updateAfterFilter() {\r\n    this.updateRecordVisibility();\r\n\r\n    this.updateDotVisibility();\r\n\r\n    this.fitValueAxis.refresh();\r\n\r\n    if (this.ts_Type.is(\"Rank\")) {\r\n      this.timeseriesAttrib.computeRecordRanks();\r\n      this.refreshScaleValue();\r\n      //\r\n    } else if (this.ts_Type.is(\"Value\")) {\r\n      if (!this.browser.isFiltered() || this.fitValueAxis.get()) {\r\n        // resets to default scale\r\n        this.refreshScaleValue();\r\n      } else {\r\n        this.rd.refreshRecordVis();\r\n      }\r\n    } else if (this.isTimeseriesChange()) {\r\n      this.refreshScaleValue();\r\n    }\r\n\r\n    this.refreshLineOpacity();\r\n  }\r\n\r\n  /** -- */\r\n  addAnnotations() {\r\n    if (!this.rd.config.timeSeriesAnnotations) return;\r\n\r\n    this.DOM.ts_annotations\r\n      .selectAll(\"div.annotation\")\r\n      .data(\r\n        this.rd.config.timeSeriesAnnotations\r\n          .filter((_) => _._time <= this.timeRange.max._time)\r\n          .filter((_) => _._time >= this.timeRange.min._time),\r\n        (_) => _._time\r\n      )\r\n      .join(\r\n        (enter) =>\r\n          enter\r\n            .append(\"div\")\r\n            .attr(\"class\", \"annotation\")\r\n            .call((annotation) => {\r\n              annotation.append(\"div\").attr(\"class\", \"line\");\r\n              annotation.append(\"div\").attr(\"class\", \"annotIcon fa fa-clock\");\r\n              annotation\r\n                .append(\"div\")\r\n                .attr(\"class\", \"textBox\")\r\n                .call((textBox) => {\r\n                  textBox\r\n                    .append(\"div\")\r\n                    .attr(\"class\", \"timeText\")\r\n                    .text((_) => _._time_src);\r\n                  textBox\r\n                    .append(\"div\")\r\n                    .attr(\"class\", \"freeText\")\r\n                    .text((_) => _._text);\r\n                });\r\n            }),\r\n        (update) => update,\r\n        (exit) => exit.remove()\r\n      )\r\n      .style(\"left\", (_) => this.scale_Time(_._time) + \"px\");\r\n  }\r\n\r\n  refreshLineOpacity() {\r\n    var screenHeight = Math.abs(\r\n      this.scale_Value.range()[1] - this.scale_Value.range()[0]\r\n    );\r\n    var _ratio = screenHeight / this.browser.allRecordsAggr.recCnt(\"Active\");\r\n\r\n    var _opacity = Math.max(0.4, Math.min(1.0, _ratio / 25)); // between 0.2 and 1\r\n\r\n    var colorScheme = d3.schemeCategory10;\r\n\r\n    var strokeWidth = 2;\r\n    if (_ratio < 50) {\r\n      strokeWidth = 2;\r\n    } else if (_ratio < 70) {\r\n      strokeWidth = 3;\r\n    } else if (_ratio < 100) {\r\n      strokeWidth = 4;\r\n    } else {\r\n      strokeWidth = 5;\r\n    }\r\n\r\n    this.DOM.kshfRecords\r\n      .selectAll(\"path\")\r\n      .style(\r\n        \"opacity\",\r\n        (r: Record) => (((r.recordOrder % 3) + 10) / 11) * _opacity\r\n      ) // slight variation opacity to differentiate\r\n      .style(\"stroke\", (r: Record) => colorScheme[r.recordOrder % 12])\r\n      .style(\"stroke-width\", strokeWidth);\r\n\r\n    this.DOM.kshfRecords\r\n      .selectAll(\".recordText_Dot\")\r\n      .style(\r\n        \"background-color\",\r\n        (r: Record) => colorScheme[r.recordOrder % 12]\r\n      );\r\n  }\r\n\r\n  /** -- */\r\n  refreshLabelOverlaps() {\r\n    if (!this.timeseriesAttrib) return;\r\n\r\n    var maxTime: number = this.scale_Time.domain()[1].getTime();\r\n    var lastTime: string = this.timeseriesAttrib.timeKeys.find(\r\n      (tk: TimeKey) => tk._time.getTime() === maxTime\r\n    )._time_src;\r\n\r\n    var spacer = new LabelSpacer();\r\n\r\n    var _compareKey: string = this.timeSeriesChangeVsTimeKey.get()?._time_src || null;\r\n\r\n    this.browser.records.forEach((record) => {\r\n      record._view._labelHidden = true;\r\n      record._view._labelPos = 0;\r\n\r\n      if (!record.filteredOut && this.recordInView(record)) {\r\n        var _keyIndex = this.timeseriesAttrib.getRecordValue(record)?._keyIndex;\r\n        var v = _keyIndex[lastTime];\r\n        if (v) {\r\n          var m = this.scale_Value(v._value);\r\n          if (m !== null && isFinite(m) && !isNaN(m)) {\r\n            record._view._labelHidden = false;\r\n            var ref = this.isTimeseriesChange()\r\n              ? _keyIndex[_compareKey]._value\r\n              : 0;\r\n            record._view._labelPos = this.y_Generator(v, ref);\r\n          }\r\n        }\r\n      }\r\n\r\n      d3.select(record.DOM.record)\r\n        .select(\"foreignObject\")\r\n        .classed(\"hidden\", record._view._labelHidden);\r\n    });\r\n\r\n    var gapOffset = 14;\r\n\r\n    Array.from(\r\n      this.browser.records.filter((record) => !record._view._labelHidden)\r\n    )\r\n      .sort((r1, r2) => r1._view._labelPos - r2._view._labelPos)\r\n      .forEach((record) => {\r\n        var fo = d3.select(record.DOM.record).select(\"foreignObject\");\r\n\r\n        var intersectsWith = spacer.intersectsWith(record._view._labelPos);\r\n\r\n        var overlaps;\r\n\r\n        if (intersectsWith) {\r\n          let intersectsWithRecord = intersectsWith._entity;\r\n\r\n          // intersectsWith is above current record\r\n          // try to move it above to create extra space\r\n          spacer.usedList = spacer.usedList.filter(\r\n            (_) => _._entity !== intersectsWithRecord\r\n          );\r\n\r\n          var _temp = Math.max(\r\n            record._view._labelPos - gapOffset,\r\n            intersectsWithRecord._view._labelPos - gapOffset / 2\r\n          );\r\n\r\n          if (spacer.isEmpty(_temp)) {\r\n            d3.select(intersectsWithRecord.DOM.record)\r\n              .select(\"foreignObject\")\r\n              .attr(\"y\", _temp - 8);\r\n            intersectsWithRecord._view._labelPos = _temp;\r\n          }\r\n\r\n          // insert back\r\n          spacer.insertUsed(\r\n            intersectsWithRecord._view._labelPos,\r\n            gapOffset,\r\n            intersectsWithRecord\r\n          );\r\n\r\n          var targetPos = Math.min(\r\n            intersectsWithRecord._view._labelPos + gapOffset\r\n          );\r\n          if (\r\n            spacer.isEmpty(targetPos) &&\r\n            targetPos <= record._view._labelPos + 10\r\n          ) {\r\n            record._view._labelPos = targetPos;\r\n          } else {\r\n            overlaps = true;\r\n          }\r\n        }\r\n\r\n        fo.classed(\"overlapping\", overlaps);\r\n\r\n        fo.attr(\"y\", record._view._labelPos - 8);\r\n        if (!overlaps) {\r\n          spacer.insertUsed(record._view._labelPos, gapOffset, record);\r\n        }\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  refreshTimeSeriesPlotType() {\r\n    if (!this.ts_Type) return;\r\n    if (!this.timeseriesAttrib) return;\r\n\r\n    this.DOM.root.attr(\"data-ts_Type\", this.ts_Type);\r\n    this.refreshYGenerator();\r\n\r\n    if (this.ts_Type.is(\"Rank\")) {\r\n      this.timeseriesAttrib.computeRecordRanks();\r\n    }\r\n\r\n    if (this.isTimeseriesChange()) {\r\n      this.DOM.root.select(\".MouseMode-filter\").style(\"display\", \"none\");\r\n      if (this.rd.visMouseMode === \"filter\") {\r\n        this.rd.visMouseMode = \"pan\";\r\n        this.DOM.root.attr(\"visMouseMode\", this.rd.visMouseMode);\r\n      }\r\n    } else {\r\n      this.DOM.root.select(\".MouseMode-filter\").style(\"display\", null);\r\n    }\r\n\r\n    this.DOM.root\r\n      .select(\".recordAxis_X > .keyLine\")\r\n      .style(\"display\", this.isTimeseriesChange() ? \"block\" : null);\r\n\r\n    this.refreshScaleValue();\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordVis() {\r\n    if (!this.ts_Type) return;\r\n    if (!this.timeseriesAttrib) return;\r\n    if (!this.DOM.recordBase_Timeseries) return;\r\n    if (!this.DOM.kshfRecords) return;\r\n    if (!this.y_Generator) return;\r\n    if (!this.timeseriesAttrib.aggr_initialized) return;\r\n\r\n    var x_Generator = (d) => this.scale_Time(d._time);\r\n\r\n    var timeDomain = this.scale_Time.domain();\r\n    var inTimeDomain = (d) =>\r\n      d._time >= timeDomain[0] && d._time <= timeDomain[1];\r\n\r\n    // This basically extends the draw area +/- time keys. These are out of the screen, but helps\r\n    // generate smooth looking animations.\r\n    var timeKeys = this.timeseriesAttrib.timeKeys;\r\n    var drawMinTime =\r\n      timeKeys[Math.max(this.timeRange.min._index - 5, 0)]._time;\r\n    var drawMaxTime =\r\n      timeKeys[Math.min(this.timeRange.max._index + 5, timeKeys.length - 1)]\r\n        ._time;\r\n    var inWiderTimeDomain = (d) =>\r\n      d._time >= drawMinTime && d._time <= drawMaxTime;\r\n\r\n    var _compareKey = this.timeSeriesChangeVsTimeKey.get()?._time_src || \"\";\r\n\r\n    var _refVal;\r\n\r\n    var lineGenerator = d3\r\n      .line()\r\n      .curve(this.ts_Type.is(\"Rank\") ? d3.curveLinear : d3.curveMonotoneX)\r\n      .x(x_Generator)\r\n      .y((d) => this.y_Generator(d, _refVal))\r\n      .defined((d) => {\r\n        if (!inWiderTimeDomain(d)) return false;\r\n        var v = this.y_Generator(d, _refVal);\r\n        return v != null && isFinite(v) && !isNaN(v);\r\n      });\r\n\r\n    var topGap = 15;\r\n\r\n    this.scale_Value.rangeRound([this.rd.curHeight - (topGap + 100), topGap]);\r\n\r\n    var slopeOnly = this.ts_timeKeysStep.is(\"limits\");\r\n\r\n    var timeKeys_src = {};\r\n    this.timeKeys_Active.forEach((_) => {\r\n      timeKeys_src[_._time_src] = true;\r\n    });\r\n\r\n    var lineSelect = this.DOM.kshfRecords\r\n      .attr(\"transform\", null)\r\n      .style(\"transform\", null)\r\n      .classed(\"noTimeSeries\", (record) => !this.recordInView(record))\r\n      .each((record, i, nodes) => {\r\n        if (!this.recordInView(record) || record.filteredOut) return;\r\n\r\n        var ts = this.timeseriesAttrib.getRecordValue(record);\r\n        if (!ts) return;\r\n\r\n        _refVal = ts._timeseries_.find(\r\n          (x: TimeData) => x._time_src === _compareKey\r\n        )?._value;\r\n\r\n        var td: TimeData[] = ts._timeseries_.filter(inTimeDomain);\r\n\r\n        if (slopeOnly) {\r\n          td = td.filter((d: TimeData) => timeKeys_src[d._time_src]);\r\n        }\r\n\r\n        d3.select(nodes[i])\r\n          .select(\".dotGroup\")\r\n          .selectAll(\".timeSeriesDot\")\r\n          .data(td, (d: TimeData) => d._time.getTime())\r\n          .join(\r\n            (enter) =>\r\n              enter\r\n                .append(\"circle\")\r\n                .attr(\"class\", \"timeSeriesDot\")\r\n                .attr(\"r\", 3),\r\n            (update) => update,\r\n            (exit) => exit.remove()\r\n          )\r\n          .each((d: TimeData, i, nodes) => {\r\n            d.DOM = nodes[i];\r\n          })\r\n          .attr(\"cx\", x_Generator)\r\n          .attr(\"cy\", (d: TimeData) => this.y_Generator(d, _refVal))\r\n          .style(\"display\", (d: TimeData) => {\r\n            var v = this.y_Generator(d, _refVal);\r\n            return v != null && isFinite(v) && !isNaN(v) ? null : \"none\";\r\n          });\r\n      })\r\n      .call((rec) => {\r\n        rec\r\n          .selectAll(\"foreignObject\")\r\n          .attr(\"x\", this.scale_Time.range()[1] + 16)\r\n          .on(\"mouseenter\", (_event, record) =>\r\n            this.rd.onRecordMouseOver(record)\r\n          )\r\n          .on(\"mouseleave\", (_event, record) =>\r\n            this.rd.onRecordMouseLeave(record)\r\n          );\r\n      })\r\n      .selectAll(\"path\")\r\n      .attr(\"fill\", \"none\");\r\n\r\n    var dPath = (record) => {\r\n      if (record.filteredOut) return;\r\n      var _td: TimeData[] =\r\n        this.timeseriesAttrib.getRecordValue(record)?._timeseries_;\r\n      if (!_td) return;\r\n\r\n      _refVal = _td.find((x) => x._time_src === _compareKey)?._value;\r\n\r\n      if (slopeOnly) {\r\n        _td = _td.filter((d) => timeKeys_src[d._time_src]);\r\n      }\r\n      return lineGenerator(_td);\r\n    };\r\n\r\n    if (this.rd.timeseriesAnimInterval) {\r\n      var x_Generator_store = x_Generator;\r\n      x_Generator = (d) => this.scale_Time_prev(d._time);\r\n      lineGenerator.x(x_Generator);\r\n      // no transition\r\n      lineSelect.transition().duration(200).attr(\"d\", dPath);\r\n      x_Generator = x_Generator_store;\r\n      lineGenerator.x(x_Generator);\r\n    }\r\n\r\n    // with transition\r\n    lineSelect\r\n      .transition()\r\n      .duration(700)\r\n      .ease(d3.easePoly.exponent(3))\r\n      .delay(0)\r\n      .attr(\"d\", dPath);\r\n\r\n    this.refreshLabelOverlaps();\r\n\r\n    this.refreshLineOpacity();\r\n  }\r\n\r\n  refreshAttribUnitName(attrib: Attrib) {\r\n    this.refreshTicks_AxisY();\r\n  }\r\n}\r\n","import { select, pointer } from \"./d3_select\";\r\nimport { easePoly, easePolyOut } from \"d3-ease\";\r\nimport { interpolate } from \"d3-interpolate\";\r\nimport { geoPath, geoTransform } from \"d3-geo\";\r\nimport { hsl } from \"d3-color\";\r\nimport { arc } from \"d3-shape\";\r\n\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Aggregate_PointCluster } from \"./Attrib_RecordGeo\";\r\nimport { Base } from \"./Base\";\r\nimport { RecordVisCoding, CompareType } from \"./Types\";\r\nimport { RecordDisplay } from \"./RecordDisplay\";\r\nimport { RecordView } from \"./RecordView\";\r\nimport { Util } from \"./Util\";\r\nimport { Record } from \"./Record\";\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  geoPath,\r\n  geoTransform,\r\n  easePolyOut,\r\n  easePoly,\r\n  interpolate,\r\n  hsl,\r\n  arc,\r\n};\r\n\r\ndeclare let L: any;\r\n\r\nexport class RecordView_Map extends RecordView {\r\n  extendRecordDOM(newRecords) {\r\n    if (this.geoAttrib.geoType === \"Point\") {\r\n      if (this.rd.config.mapUsePins) {\r\n        newRecords\r\n          .append(\"path\")\r\n          .attr(\"class\", \"glyph_Main\")\r\n          .attr(\"d\", Base.map.pinGlyphPath)\r\n          .attr(\"transform\", \"scale(0.0001)\");\r\n      } else {\r\n        this.extendRecordDOM_Point(newRecords);\r\n      }\r\n    } else {\r\n      newRecords.append(\"path\").attr(\"class\", \"glyph_Main\");\r\n    }\r\n  }\r\n\r\n  mapConfig: any;\r\n\r\n  recordGeoPath: any;\r\n\r\n  /** -- */\r\n  updateAfterFilter(how: any) {\r\n    this.updateRecordVisibility();\r\n    this.refreshRecordColors();\r\n    if (this.geoAttrib.geoType === \"Point\") {\r\n      this.refreshRecordVis();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordSizes() {\r\n    if (this.geoAttrib.geoType !== \"Point\") return;\r\n    if (!this.DOM.recordGroup) return;\r\n\r\n    var pathSelection = this.DOM.recordGroup\r\n      .selectAll(\".kshfRecord > path\")\r\n      .transition()\r\n      .duration(700)\r\n      .ease(d3.easePolyOut.exponent(3));\r\n\r\n    if (!this.rd.config.mapUsePins) {\r\n      pathSelection.attr(\"d\", (record) => this.rd.recordDrawArc(record)());\r\n      //\r\n    } else {\r\n      pathSelection.attr(\r\n        \"transform\",\r\n        `scale(${this.rd.getMaxSizeScaleRange() / 15})`\r\n      );\r\n    }\r\n\r\n    this.DOM.recordGroup\r\n      .selectAll(\".kshfRecord > .sizeValueText\")\r\n      .html((record) => record.measure_Self);\r\n\r\n    this.refreshPointClusterVis();\r\n  }\r\n\r\n  /** -- */\r\n  async prepareAttribs() {\r\n    if (!this.rd.codeBy.geo) {\r\n      await this.rd.setAttrib(\"geo\", this.rd.config.geoBy || 0);\r\n    }\r\n    if (!this.rd.codeBy.color && this.rd.config.colorBy) {\r\n      await this.rd.setAttrib(\"color\", this.rd.config.colorBy);\r\n    }\r\n    if (!this.rd.codeBy.size && this.rd.config.sizeBy) {\r\n      await this.rd.setAttrib(\"size\", this.rd.config.sizeBy);\r\n    }\r\n    return Promise.resolve(true);\r\n  }\r\n\r\n  initView() {\r\n    if (!this.initialized) {\r\n      this.zoomToFit();\r\n    }\r\n\r\n    if (this.geoAttrib.geoType === \"Point\") {\r\n      this.refreshPointClusters();\r\n    }\r\n    this.refreshPointDOM();\r\n\r\n    this.refreshRecordVis();\r\n    this.refreshRecordColors();\r\n    this.refreshRecordSizes();\r\n    // width of color legend area may change, so refresh this\r\n    this.rd.refreshColorLegend();\r\n    this.rd.refreshSizeLegend(); // needed to reset usesSizeAttrib class\r\n  }\r\n\r\n  async initView_DOM() {\r\n    // Do not initialize twice\r\n    if (this.DOM.recordBase_Map) {\r\n      this.DOM.recordGroup = this.DOM.recordMap_SVG.select(\".recordGroup\");\r\n      this.DOM.kshfRecords = this.DOM.recordGroup.selectAll(\".kshfRecord\");\r\n      this.DOM.kshfRecords_Path = this.DOM.recordGroup.selectAll(\r\n        \".kshfRecord > path.glyph_Main\"\r\n      );\r\n\r\n      this.leafletRecordMap.invalidateSize(); // chart area may have changed\r\n      return;\r\n    }\r\n\r\n    if (!(window as any).L) {\r\n      await import(\"leaflet\");\r\n    }\r\n\r\n    var me = this;\r\n\r\n    this.DOM.recordBase_Map = this.rd.DOM.recordDisplayWrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordBase_Map\");\r\n\r\n    this.mapConfig = Util.mergeConfig(Base.map, this.rd.config.mapConfig || {});\r\n\r\n    function resetPointSizes() {\r\n      if (this.geoAttrib.geoType === \"Point\") {\r\n        if (!this.rd.config.mapUsePins) {\r\n          this.DOM.recordGroup\r\n            .selectAll(\".kshfRecord > path\")\r\n            .attr(\"d\", Util.getCirclePath());\r\n        } else {\r\n          this.DOM.recordGroup\r\n            .selectAll(\".kshfRecord > path\")\r\n            .attr(\"transform\", \"scale(0.0001)\");\r\n        }\r\n      }\r\n    }\r\n\r\n    this.leafletRecordMap = L.map(\r\n      this.DOM.recordBase_Map.node(),\r\n      this.mapConfig.leafConfig\r\n    )\r\n      .on(\"viewreset\", function () {\r\n        if (!this._zoomInit_) return;\r\n        this._zoomInit_ = null;\r\n        me.rd.DOM.recordDisplayWrapper.classed(\"dragging\", false);\r\n        me.refreshRecordVis();\r\n      })\r\n      .on(\"movestart\", function () {\r\n        me.rd.DOM.recordDisplayWrapper.classed(\"dragging\", true);\r\n        me.browser.DOM.root.classed(\"noPointerEvents\", true);\r\n        resetPointSizes.call(me);\r\n        this._zoomInit_ = this.getZoom();\r\n      })\r\n      .on(\"moveend\", function () {\r\n        me.rd.DOM.recordDisplayWrapper.classed(\"dragging\", false);\r\n        me.browser.DOM.root.classed(\"noPointerEvents\", false);\r\n        me.rd.refreshViz_Compare_All();\r\n        me.rd.refreshRecordVis();\r\n        this._zoomInit_ = null;\r\n      })\r\n      // When zoom is triggered by fly, the leaflet-zoom-anim is not set.\r\n      .on(\"zoomstart\", () => {\r\n        resetPointSizes.call(this);\r\n        var _ = d3.select(this.leafletRecordMap.getPane(\"mapPane\"));\r\n        _.classed(\"leaflet-zoom-anim\", true);\r\n      })\r\n      .on(\"zoomend\", () => {\r\n        var _ = d3.select(this.leafletRecordMap.getPane(\"mapPane\"));\r\n        _.classed(\"leaflet-zoom-anim\", false);\r\n      });\r\n\r\n    if (!this.mapConfig.tileConfig.disabled) {\r\n      let leafletTileLayer = new L.TileLayer(\r\n        this.mapConfig.tileTemplate,\r\n        this.mapConfig.tileConfig\r\n      );\r\n      this.leafletRecordMap.addLayer(leafletTileLayer);\r\n    }\r\n\r\n    this.leafletRecordMap.attributionControl.setPosition(\"topright\");\r\n\r\n    this.recordGeoPath = d3.geoPath().projection(\r\n      d3.geoTransform({\r\n        point: function (x, y) {\r\n          var point = me.leafletRecordMap.latLngToLayerPoint(\r\n            new L.latLng(y, x)\r\n          );\r\n          this.stream.point(point.x, point.y);\r\n        },\r\n      })\r\n    );\r\n\r\n    this.recordGeoPath.pointRadius(this.rd.recordPointSize.get());\r\n\r\n    this.DOM.recordBase_Map.select(\".leaflet-tile-pane\");\r\n\r\n    this.DOM.recordMap_SVG = d3\r\n      .select(this.leafletRecordMap.getPanes().overlayPane)\r\n      .append(\"svg\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n      .attr(\"class\", \"recordMap_SVG\");\r\n\r\n    var _defs = this.DOM.recordMap_SVG.append(\"defs\");\r\n\r\n    _defs\r\n      .append(\"filter\")\r\n      .attr(\"id\", \"pointDropShadow\")\r\n      .attr(\"height\", \"200%\")\r\n      .attr(\"width\", \"200%\")\r\n      .call((filter) => {\r\n        filter\r\n          .append(\"feGaussianBlur\")\r\n          .attr(\"in\", \"SourceAlpha\")\r\n          .attr(\"stdDeviation\", 3);\r\n        filter\r\n          .append(\"feOffset\")\r\n          .attr(\"dx\", 2)\r\n          .attr(\"dy\", 2)\r\n          .attr(\"result\", \"offsetblur\");\r\n        filter\r\n          .append(\"feComponentTransfer\")\r\n          .append(\"feFuncA\")\r\n          .attr(\"type\", \"linear\")\r\n          .attr(\"slope\", 0.5);\r\n        filter.append(\"feMerge\").call((merge) => {\r\n          merge.append(\"feMergeNode\");\r\n          merge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\");\r\n        });\r\n      });\r\n\r\n    // The fill pattern definition in SVG, used to denote geo-objects with no data.\r\n    // http://stackoverflow.com/questions/17776641/fill-rect-with-pattern\r\n    _defs\r\n      .append(\"pattern\")\r\n      .attr(\"id\", \"diagonalHatch\")\r\n      .attr(\"patternUnits\", \"userSpaceOnUse\")\r\n      .attr(\"width\", 4)\r\n      .attr(\"height\", 4)\r\n      .append(\"path\")\r\n      .attr(\"d\", \"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2\")\r\n      .attr(\"stroke\", \"gray\")\r\n      .attr(\"stroke-width\", 1);\r\n\r\n    this.DOM.clusterGroup = this.DOM.recordMap_SVG\r\n      .append(\"g\")\r\n      .attr(\"class\", \"leaflet-zoom-hide clusterGroup\");\r\n\r\n    this.DOM.recordGroup = this.DOM.recordMap_SVG\r\n      .append(\"g\")\r\n      .attr(\"class\", \"leaflet-zoom-hide recordGroup\");\r\n  }\r\n\r\n  async finishSetAttrib(t: RecordVisCoding) {\r\n    if (t === \"color\") {\r\n      this.refreshRecordColors();\r\n      //\r\n    } else if (t === \"geo\") {\r\n      this.rd.config.geo = this.geoAttrib.attribName;\r\n\r\n      this.DOM.root.attr(\"data-geotype\", this.geoAttrib.geoType);\r\n\r\n      this.DOM.root\r\n        .select(\".mapView-UnmatchedData\")\r\n        .classed(\"active\", this.geoAttrib.noValueAggr.records.length > 0);\r\n\r\n      if (this.geoAttrib.geoType === \"Point\") {\r\n        // size\r\n        if (!this.rd.codeBy.size && this.rd.config.sizeBy) {\r\n          await this.rd.setAttrib(\"size\", this.rd.config.sizeBy);\r\n        } else {\r\n          this.rd.refreshAttribOptions(\"size\");\r\n        }\r\n        // color\r\n        this.rd.refreshAttribOptions(\"color\");\r\n        // prapare color cache\r\n        await this.geoAttrib.prepPointCluster(this.leafletRecordMap);\r\n      }\r\n    }\r\n  }\r\n\r\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\r\n    if (!this.isComparable()) return;\r\n\r\n    // update rendering of point clusters\r\n    if (this.rd.hasAggregates()) {\r\n      var sideBySide = this.browser.stackedCompare.is(false);\r\n\r\n      // compute \"offset\" for each aggregate\r\n      this.geoAttrib._aggrs.forEach((aggr: Aggregate_PointCluster) => {\r\n        var _offset = 0;\r\n        aggr._glyphOrder = {};\r\n        // re-order the comparisons so that the larger ones come first\r\n        this.browser.activeComparisons\r\n          .slice()\r\n          .sort((a, b) => aggr.measure(b) - aggr.measure(a))\r\n          .forEach((cT2, i_cT) => {\r\n            aggr._glyphOrder[cT2] = i_cT;\r\n            aggr.setOffset(cT2, _offset);\r\n            _offset += aggr.measure(cT2);\r\n          });\r\n      });\r\n\r\n      var numComparisons = this.browser.activeComparisonsCount;\r\n      this.browser.activeComparisons.forEach((cT2) => {\r\n        this.DOM[\"clusterGlyphs_\" + cT2]\r\n          .style(\"stroke-width\", (aggr) => {\r\n            if (!sideBySide) return 0;\r\n            return aggr.cluster._radius / numComparisons;\r\n          })\r\n          .transition()\r\n          .ease(d3.easePoly.exponent(3))\r\n          .duration(700)\r\n          .attrTween(\"d\", (aggr, i, nodes) => {\r\n            var DOM = nodes[i];\r\n            var offset = sideBySide\r\n              ? 0\r\n              : aggr.offset(cT2) / (aggr.measure(\"Active\") || 1);\r\n            var angleInterp = d3.interpolate(\r\n              DOM._currentPreviewAngle,\r\n              aggr.ratioToActive(cT2)\r\n            );\r\n            var r = aggr.cluster._radius;\r\n            if (sideBySide) {\r\n              r -=\r\n                (aggr._glyphOrder[cT2] + 0.5) *\r\n                (aggr.cluster._radius / numComparisons);\r\n            }\r\n            return (t) => {\r\n              var newAngle = angleInterp(t);\r\n              DOM._currentPreviewAngle = newAngle;\r\n              return Util.getPieSVGPath(offset, newAngle, r - 1, sideBySide);\r\n            };\r\n          });\r\n      });\r\n    }\r\n\r\n    // normal comparison rendering\r\n    super.refreshSelect_Compare(cT, status);\r\n  }\r\n  // map / point\r\n\r\n  leafletRecordMap: any;\r\n\r\n  constructor(rd: RecordDisplay, config) {\r\n    super(rd);\r\n  }\r\n\r\n  refreshQueryBox_Filter(bounds = null) {\r\n    if (this.rd.collapsed) return;\r\n    var _left, _right, _top, _bottom, temp;\r\n\r\n    var isVisible: boolean = false;\r\n\r\n    if (typeof L === \"undefined\") {\r\n      throw Error(\"Leaflet not initialized\");\r\n    }\r\n\r\n    var north_west, south_east;\r\n    if (bounds === null) {\r\n      isVisible = this.geoAttrib.isFiltered();\r\n      if (!isVisible) return;\r\n      north_west = this.leafletRecordMap.latLngToLayerPoint(\r\n        this.geoAttrib.summaryFilter.bounds.getNorthWest()\r\n      );\r\n      south_east = this.leafletRecordMap.latLngToLayerPoint(\r\n        this.geoAttrib.summaryFilter.bounds.getSouthEast()\r\n      );\r\n    } else if (!(bounds instanceof L.LatLngBounds)) {\r\n      north_west = this.leafletRecordMap.latLngToLayerPoint(\r\n        bounds.getNorthWest()\r\n      );\r\n      south_east = this.leafletRecordMap.latLngToLayerPoint(\r\n        bounds.getSouthEast()\r\n      );\r\n    } else {\r\n      throw Error(\"Invalud value\");\r\n    }\r\n    _left = north_west.x;\r\n    _right = south_east.x;\r\n    _top = north_west.y;\r\n    _bottom = south_east.y;\r\n\r\n    this.rd.DOM.recordDisplayWrapper\r\n      .select(\".recordBase_Map  .spatialQueryBox_Filter\")\r\n      .classed(\"active\", bounds || isVisible)\r\n      .style(\"left\", _left + \"px\")\r\n      .style(\"top\", _top + \"px\")\r\n      .style(\"width\", Math.abs(_right - _left) + \"px\")\r\n      .style(\"height\", Math.abs(_bottom - _top) + \"px\");\r\n  }\r\n\r\n  /** -- */\r\n  refreshViewSize(delayMs = 500) {\r\n    this.rd.refreshColorLegendTicks();\r\n    setTimeout(() => this.leafletRecordMap.invalidateSize(), delayMs);\r\n  }\r\n\r\n  /** -- */\r\n  refreshAttribUnitName(attrib: Attrib) {\r\n    this.rd.refreshColorLegendTicks();\r\n  }\r\n\r\n  zoomedBefore = false;\r\n  /** -- */\r\n  zoomIn() {\r\n    this.leafletRecordMap.zoomIn();\r\n  }\r\n  /** -- */\r\n  zoomOut() {\r\n    this.leafletRecordMap.zoomOut();\r\n  }\r\n  /** -- */\r\n  zoomToFit() {\r\n    if (!this.zoomedBefore) {\r\n      if (this.rd.config.mapInitView) {\r\n        var _c = this.rd.config.mapInitView;\r\n        if (_c[3] === undefined || _c[3] === false) {\r\n          this.zoomedBefore = true;\r\n        }\r\n        this.leafletRecordMap.setView(L.latLng(_c[0], _c[1]), _c[2]);\r\n        return;\r\n      }\r\n    }\r\n    this.zoomToBounds(\r\n      Util.addMarginToBounds(this.geoAttrib.getRecordBounds(true))\r\n    );\r\n  }\r\n  /** -- */\r\n  zoomToBounds(bounds) {\r\n    this.rd.DOM.recordDisplayWrapper.classed(\"dragging\", true);\r\n    this.leafletRecordMap.fitBounds(bounds);\r\n  }\r\n  /** -- */\r\n  setMaxBounds() {\r\n    if (this.rd.config.map_NoFitBounds) return;\r\n    this.leafletRecordMap.setMaxBounds(\r\n      Util.addMarginToBounds(this.geoAttrib.getRecordBounds(false))\r\n    );\r\n  }\r\n\r\n  translate_glyph(v) {\r\n    var point = this.leafletRecordMap.latLngToLayerPoint(\r\n      new L.latLng(v[1], v[0])\r\n    );\r\n    return `translate(${point.x},${point.y})`;\r\n  }\r\n\r\n  /** -- */\r\n  refreshPointClusters() {\r\n    if (!this.geoAttrib) return;\r\n    if (this.geoAttrib?.geoType !== \"Point\") return;\r\n    if (!this.geoAttrib.PointCluster) return;\r\n\r\n    this.geoAttrib.updateClusters(\r\n      this.leafletRecordMap.getBounds(),\r\n      this.leafletRecordMap.getZoom()\r\n    );\r\n\r\n    this.DOM.clusterGlyphs = this.DOM.clusterGroup\r\n      .selectAll(\".clusterGlyph\")\r\n      .data(this.geoAttrib._aggrs)\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr(\"class\", \"clusterGlyph aggrGlyph\")\r\n      .each((aggr: Aggregate_PointCluster, i, nodes) => {\r\n        aggr.setAggrGlyph(nodes[i]);\r\n      })\r\n      .tooltip((aggr: Aggregate_PointCluster) => aggr.getTooltipHTML(), {\r\n        theme: \"dark kshf-tooltip kshf-record\",\r\n        placement: \"right\",\r\n        animation: \"fade\",\r\n        followCursor: true,\r\n        offset: [0, 5],\r\n      })\r\n      .attr(\"transform\", (aggr) =>\r\n        this.translate_glyph(aggr.cluster.geometry.coordinates)\r\n      )\r\n      //.on(\"mouseenter\", aggr => this.browser.setSelect_Compare(aggr) )\r\n      //.on(\"mouseleave\", aggr => this.browser.clearSelect_Compare() )\r\n      .on(\"click\", (event, aggr) => {\r\n        if (event.shiftKey) {\r\n          // filter - TODO needs to have its own filter logic\r\n          return;\r\n        }\r\n        var latlong = aggr.cluster.geometry.coordinates;\r\n        this.leafletRecordMap.setZoomAround(\r\n          new L.latLng(latlong[1], latlong[0]),\r\n          this.leafletRecordMap.getZoom() + 1\r\n        );\r\n      })\r\n      .call((clusterGlyph) => {\r\n        clusterGlyph\r\n          .append(\"g\")\r\n          .attr(\"class\", \"measureGroup\")\r\n          .call((measureGroup) => {\r\n            [\"Active\"].concat(Base.Compare_List).forEach((cT) => {\r\n              this.DOM[\"clusterGlyphs_\" + cT] = measureGroup\r\n                .append(\"path\")\r\n                .attr(\"class\", \"measure_\" + cT)\r\n                .each((aggr, i, nodes) => {\r\n                  nodes[i]._currentPreviewAngle = 0;\r\n                });\r\n            });\r\n          });\r\n        clusterGlyph\r\n          .append(\"text\")\r\n          .attr(\"class\", \"sizeValueText\")\r\n          .html((aggr) => \"\" + aggr.Active.measure);\r\n      });\r\n\r\n    // reset circle size\r\n    this.DOM.clusterGlyphs_Active.attr(\"d\", Util.getCirclePath());\r\n  }\r\n\r\n  /** -- */\r\n  private refreshPointDOM() {\r\n    this.rd.refreshRecordDOM();\r\n    this.rd.updateRecordSizeScale();\r\n    this.rd.updateRecordColorScale();\r\n  }\r\n\r\n  /** --  */\r\n  refreshRecordVis() {\r\n    if (!this.geoAttrib) return;\r\n\r\n    if (this.geoAttrib.geoType === \"Point\") {\r\n      // POINT MAPS\r\n      this.refreshPointClusters();\r\n      this.refreshPointDOM();\r\n\r\n      this.DOM.kshfRecords?.attr(\"transform\", (record: Record) =>\r\n        this.translate_glyph(\r\n          this.geoAttrib.getRecordValue(record).geoFeat.coordinates\r\n        )\r\n      );\r\n      this.DOM.clusterGlyphs?.attr(\r\n        \"transform\",\r\n        (aggr: Aggregate_PointCluster) =>\r\n          this.translate_glyph(aggr.cluster.geometry.coordinates)\r\n      );\r\n    } else {\r\n      // POLYGON MAPS\r\n      this.DOM.kshfRecords_Path?.attr(\"d\", (record) =>\r\n        this.recordGeoPath(this.geoAttrib.getRecordValue(record).geoFeat)\r\n      );\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshPointClusterVis() {\r\n    if (!this.rd.hasAggregates()) return;\r\n    if (!this.rd.recordRadiusScale) return;\r\n\r\n    var clusterArc = d3\r\n      .arc()\r\n      .innerRadius(0)\r\n      .startAngle(0)\r\n      .endAngle(2 * Math.PI);\r\n    var circleDraw = (aggr) => clusterArc.outerRadius(aggr.cluster._radius)();\r\n\r\n    this.DOM.clusterGlyphs\r\n      .each((aggr) => {\r\n        aggr.cluster._radius = this.rd.recordRadiusScale(aggr.Active.measure);\r\n      })\r\n      .classed(\"tinyCluster\", (aggr) => aggr.cluster._radius < 8)\r\n      .classed(\r\n        \"clampedCluster\",\r\n        (aggr) => aggr.cluster._radius >= Base.maxRecordPointSize\r\n      );\r\n\r\n    this.DOM.clusterGlyphs_Active\r\n      .transition()\r\n      .duration(700)\r\n      .ease(d3.easePolyOut.exponent(3))\r\n      .attr(\"d\", circleDraw);\r\n\r\n    // update fill color of clusters\r\n    if (!this.colorAttrib) {\r\n      this.DOM.clusterGlyphs_Active.style(\"fill\", null);\r\n      this.DOM.clusterGlyphs.classed(\"darkBg\", false);\r\n      //\r\n    } else {\r\n      this.DOM.clusterGlyphs_Active.each((cluster, i, nodes) => {\r\n        var v = cluster.Active.measure;\r\n        var _fill =\r\n          v != null ? this.rd.recordColorScale(v) : \"url(#diagonalHatch)\";\r\n        var darkBg = v != null ? d3.hsl(_fill).l < 0.6 : false;\r\n\r\n        nodes[i].style.fill = _fill;\r\n\r\n        // to adjust text color by background luminance\r\n        nodes[i].parentNode.parentNode.classList[darkBg ? \"add\" : \"remove\"](\r\n          \"darkBg\"\r\n        );\r\n      });\r\n    }\r\n\r\n    this.refreshSelect_Compare();\r\n  }\r\n\r\n  /** --\r\n   * Returns the records that fit/intersect within the bounds (if point) or has geofeat (if polygon)\r\n   **/\r\n  getRecordsForDOM() {\r\n    var bounds = this.leafletRecordMap.getBounds();\r\n    return this.browser.records.filter((record) => {\r\n      var _feat = this.geoAttrib.getRecordValue(record)?.geoFeat;\r\n      if (!_feat) return false;\r\n      // not in a cluster - not rendered separately\r\n      if (_feat.type===\"Point\" && _feat.coordinates) {\r\n        if(record._view.inCluster) return false;\r\n        return bounds.contains(L.latLng(_feat.coordinates.slice().reverse()));\r\n      }\r\n      return true;\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordColors() {\r\n    if (!this.DOM.kshfRecords_Path) return;\r\n\r\n    if (this.colorAttrib) {\r\n      if (!this.rd.recordColorScale) return;\r\n\r\n      var s_f;\r\n      var s_log = false;\r\n      var s_ts = (_record) => false;\r\n\r\n      if (this.colorAttrib instanceof Attrib_Interval) {\r\n        s_f = this.colorAttrib.template.func;\r\n        s_log = this.colorAttrib.isValueScale_Log;\r\n        if (this.colorAttrib.hasTimeSeriesParent()) {\r\n          var f_ps = this.colorAttrib.timeseriesParent.template.func;\r\n          s_ts = function (record) {\r\n            var _ = f_ps.call(this, record);\r\n            if (!_ || !_._timeseries_) return false;\r\n            return _._timeseries_.length === 0;\r\n          };\r\n        }\r\n      } else if (this.colorAttrib === \"_measure_\") {\r\n        s_f = (record) => record.measure_Self;\r\n      } else {\r\n        console.log(\"IMPOSSIBLE\");\r\n      }\r\n\r\n      this.DOM.kshfRecords_Path.each((record, i, nodes) => {\r\n        if (record.filteredOut) return;\r\n        var DOM = nodes[i];\r\n        var _fill = \"url(#diagonalHatch)\";\r\n        var _stroke = \"#111111\";\r\n        var darkBg = false;\r\n\r\n        var v = s_f.call(record.data, record);\r\n\r\n        if (v === \"\" || v == null || typeof v !== \"number\" || (s_log && v <= 0))\r\n          v = null;\r\n\r\n        if (v != null) {\r\n          _fill = this.rd.recordColorScale(v);\r\n          darkBg = d3.hsl(_fill).l < 0.6;\r\n          _stroke = darkBg ? \"#EEEEEE\" : \"#111111\";\r\n        }\r\n\r\n        if (record.isSelected()) {\r\n          _stroke = null;\r\n        }\r\n\r\n        DOM.style.fill = _fill;\r\n        DOM.style.stroke = _stroke;\r\n        DOM.parentNode.classList[darkBg ? \"add\" : \"remove\"](\"darkBg\");\r\n        DOM.classList[s_ts.call(record.data, record) ? \"add\" : \"remove\"](\r\n          \"noData\"\r\n        );\r\n      });\r\n    } else {\r\n      this.DOM.kshfRecords_Path\r\n        .style(\"fill\", null)\r\n        .style(\"stroke\", null)\r\n        .classed(\"noData\", false);\r\n    }\r\n\r\n    this.refreshPointClusterVis();\r\n  }\r\n}\r\n","import { zoom, zoomTransform, zoomIdentity } from \"d3-zoom\";\r\nimport { easePolyOut } from \"d3-ease\";\r\nimport { line, curveNatural, curveCatmullRomOpen } from \"d3-shape\";\r\nimport { select, pointer } from \"./d3_select\";\r\n\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Base } from \"./Base\";\r\nimport { Config } from \"./Config\";\r\nimport { i18n } from \"./i18n\";\r\nimport { RecordDisplay } from \"./RecordDisplay\";\r\nimport { RecordView } from \"./RecordView\";\r\nimport { Util } from \"./Util\";\r\nimport { Record } from \"./Record\";\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { CompareType, LinearOrLog, RecordVisCoding } from \"./Types\";\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  zoom,\r\n  zoomTransform,\r\n  zoomIdentity,\r\n  line,\r\n  curveNatural,\r\n  curveCatmullRomOpen,\r\n  easePolyOut,\r\n};\r\n\r\nexport class RecordView_Scatter extends RecordView {\r\n  // ********************************************************************\r\n  // Configurations\r\n  // ********************************************************************\r\n\r\n  configs: { [index: string]: Config<any> } = {};\r\n\r\n  scatter_showTrails: Config<boolean>;\r\n  scatter_xAxisScale: Config<LinearOrLog | \"auto\">;\r\n  scatter_yAxisScale: Config<LinearOrLog | \"auto\">;\r\n\r\n  private scatterZoom: any; // d3 zoom control obj\r\n  scatterTransform: { x: number; y: number; z: number } = { x: 0, y: 0, z: 1 };\r\n\r\n  scatterAxisScale_X: any; // d3 stuff\r\n  scatterAxisScale_Y: any; // d3 stuff\r\n\r\n  async prepareAttribs() {\r\n    if (!this.scatterYAttrib) {\r\n      await this.rd.setAttrib(\r\n        \"scatterY\",\r\n        this.rd.config.scatterYBy ||\r\n          (this.rd.codeBy.sort instanceof Attrib_Numeric\r\n            ? this.rd.codeBy.sort\r\n            : 0)\r\n      );\r\n    }\r\n    if (!this.scatterXAttrib) {\r\n      await this.rd.setAttrib(\"scatterX\", this.rd.config.scatterXBy || 0);\r\n    }\r\n    if (!this.rd.codeBy.color && this.rd.config.colorBy) {\r\n      await this.rd.setAttrib(\"color\", this.rd.config.colorBy);\r\n    }\r\n    if (!this.rd.codeBy.size && this.rd.config.sizeBy) {\r\n      await this.rd.setAttrib(\"size\", this.rd.config.sizeBy);\r\n    }\r\n    return Promise.resolve(true);\r\n  }\r\n\r\n  constructor(rd: RecordDisplay, config) {\r\n    super(rd);\r\n\r\n    this.scatter_showTrails = new Config<boolean>({\r\n      cfgClass: \"scatter_showTrails\",\r\n      cfgTitle: \"Scatter Trails\",\r\n      iconXML: Base.custom_icons.trails,\r\n      default: true,\r\n      parent: this,\r\n      helparticle: \"5e89138704286364bc97d51f\",\r\n      itemOptions: [\r\n        { name: \"Show\", value: true },\r\n        { name: \"Hide\", value: false },\r\n      ],\r\n      forcedValue: () => {\r\n        // No trails if both of the axis are not a part of time-series.\r\n        if (\r\n          !this.scatterXAttrib?.hasTimeSeriesParent() ||\r\n          !this.scatterYAttrib?.hasTimeSeriesParent()\r\n        )\r\n          return false;\r\n      },\r\n    });\r\n\r\n    this.scatter_xAxisScale = new Config<LinearOrLog | \"auto\">({\r\n      parent: this,\r\n      cfgClass: \"scatter_xAxisScale\",\r\n      cfgTitle: \"X Axis Scale\",\r\n      iconClass: \"fa fa-arrows-h\",\r\n      default: \"linear\",\r\n      helparticle: \"5f137ac32c7d3a10cbaaf048\",\r\n      itemOptions: [\r\n        { name: i18n.Linear + \" \" + i18n.LinearSequence, value: \"linear\" },\r\n        { name: i18n.Log + \" \" + i18n.Log10Sequence, value: \"log\" },\r\n      ],\r\n      noExport: true,\r\n      forcedValue: () => {\r\n        if (!this.scatterXAttrib?.supportsLogScale()) return \"linear\";\r\n      },\r\n      onSet: async (v) => {\r\n        if (!this.scatterXAttrib) return;\r\n        if (!this.scatterXAttrib.hasTimeSeriesParent()) {\r\n          await this.scatterXAttrib.valueScaleType.set(v);\r\n        } else if (v !== \"auto\"){\r\n          await this.scatterXAttrib.timeseriesParent.valueScaleType.set(v);\r\n        }\r\n      },\r\n    });\r\n\r\n    this.scatter_yAxisScale = new Config<LinearOrLog | \"auto\">({\r\n      parent: this,\r\n      cfgClass: \"scatter_yAxisScale\",\r\n      cfgTitle: \"Y Axis Scale\",\r\n      iconClass: \"fa fa-arrows-v\",\r\n      default: \"linear\",\r\n      helparticle: \"5f137ac32c7d3a10cbaaf048\",\r\n      itemOptions: [\r\n        { name: `${i18n.Linear} ${i18n.LinearSequence}`, value: \"linear\" },\r\n        { name: `${i18n.Log} ${i18n.Log10Sequence}`, value: \"log\" },\r\n      ],\r\n      noExport: true,\r\n      forcedValue: () => {\r\n        if (!this.scatterYAttrib?.supportsLogScale()) return \"linear\";\r\n      },\r\n      onSet: async (v) => {\r\n        if (!this.scatterYAttrib) return;\r\n        if (!this.scatterYAttrib.hasTimeSeriesParent()) {\r\n          await this.scatterYAttrib.valueScaleType.set(v);\r\n        } else if (v !== \"auto\"){\r\n          await this.scatterYAttrib.timeseriesParent.valueScaleType.set(v);\r\n        }\r\n      },\r\n    });\r\n\r\n    [\"scatter_showTrails\", \"scatter_xAxisScale\", \"scatter_yAxisScale\"].forEach(\r\n      (t) => {\r\n        this[t].val = config[t];\r\n        this.rd.configs[t] = this[t];\r\n        this.rd.recordConfigPanel.insertConfigUI(this[t]);\r\n      }\r\n    );\r\n\r\n    this.scatterZoom = d3\r\n      .zoom()\r\n      .filter(() => this.rd.visMouseMode === \"pan\" && this.rd.curHeight)\r\n      .scaleExtent([1, 8]) // 1 covers the whole dataset. 2 is double-zoom-in.\r\n      .on(\"start\", () => {\r\n        this.DOM.recordDisplayWrapper.classed(\"dragging\", true);\r\n      })\r\n      .on(\"end\", () => {\r\n        this.DOM.recordDisplayWrapper.classed(\"dragging\", false);\r\n        this.refreshLabelOverlaps();\r\n      })\r\n      .on(\"zoom\", () => {\r\n        let t = d3.zoomTransform(this.DOM.recordBase_Scatter.node());\r\n        this.scatterTransform = { x: t.x, y: t.y, z: t.k };\r\n        this.DOM.recordGroup_Scatter.style(\r\n          \"transform\",\r\n          `translate(${this.scatterTransform.x}px, ${this.scatterTransform.y}px) scale(${this.scatterTransform.z})`\r\n        );\r\n        this.refreshRecordVis();\r\n      });\r\n\r\n    this.refreshZoomScaleExtent();\r\n  }\r\n\r\n  /** -- */\r\n  initView() {\r\n    this.rd.refreshAttribOptions(\"scatterX\");\r\n    this.rd.refreshAttribOptions(\"scatterY\");\r\n\r\n    this.rd.refreshRecordDOM();\r\n\r\n    this.refreshScales();\r\n\r\n    this.zoomToFit();\r\n\r\n    this.refreshQueryBox_Filter();\r\n\r\n    this.rd.updateRecordSizeScale();\r\n    this.rd.updateRecordColorScale();\r\n  }\r\n\r\n  /** -- */\r\n  async initView_DOM() {\r\n    // set CSS variables\r\n    this.browser.DOM.root\r\n      .node()\r\n      .style.setProperty(\r\n        \"--width_scatter_margin_left\",\r\n        Base.width_scatter_margin_left + \"px\"\r\n      );\r\n\r\n    this.browser.DOM.root\r\n      .node()\r\n      .style.setProperty(\r\n        \"--height_scatter_margin_bottom\",\r\n        Base.height_scatter_margin_bottom + \"px\"\r\n      );\r\n\r\n    if (this.DOM.recordBase_Scatter) {\r\n      this.DOM.recordGroup = this.DOM.recordBase_Scatter.select(\".recordGroup\");\r\n      this.DOM.kshfRecords =\r\n        this.DOM.recordGroup_Scatter.selectAll(\".kshfRecord\");\r\n      this.DOM.kshfRecords_Path = this.DOM.recordGroup.selectAll(\r\n        \".kshfRecord > path.glyph_Main\"\r\n      );\r\n      this.DOM.linkGroup = this.DOM.recordGroup_Scatter.select(\".linkGroup\");\r\n      return; // Do not initialize twice\r\n    }\r\n\r\n    this.DOM.recordBase_Scatter = this.DOM.recordDisplayWrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordBase_Scatter\")\r\n      .call(this.scatterZoom);\r\n\r\n    this.DOM.recordBase_Scatter\r\n      .append(\"span\")\r\n      .attr(\"class\", \"ScatterControl-SwapAxis\")\r\n      .tooltip(i18n.SwapAxis)\r\n      .on(\"mousedown\", (event) => event.stopPropagation() )\r\n      .on(\"mouseup\", (event) => event.stopPropagation() )\r\n      .on(\"dblclick\", (event) => event.stopPropagation() )\r\n      .on(\"wheel\", (event) => event.stopPropagation() )\r\n      .on(\"click\", (event) => {\r\n        this.swapAxis();\r\n        event.stopPropagation();\r\n      })\r\n      .append(\"i\")\r\n      .attr(\"class\", \"fa fa-exchange\");\r\n\r\n    // recordAxis_X, recordAxis_Y\r\n    [\"X\", \"Y\"].forEach((a) => {\r\n      this.DOM[\"recordAxis_\" + a] = this.DOM.recordBase_Scatter\r\n        .append(\"div\")\r\n        .attr(\"class\", \"recordAxis recordAxis_\" + a)\r\n        .html(\"<div class='tickGroup'></div><div class='onRecordLine'><div class='tickLine'></div><div class='tickText'></div></div>\");\r\n    });\r\n\r\n    this.DOM.recordGroup_Scatter = this.DOM.recordBase_Scatter\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordGroup_Scatter_Wrapper\")\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordGroup_Scatter\");\r\n\r\n    [\"X\", \"Y\"].forEach((axis) => {\r\n      this.DOM[\"scatter\" + axis + \"ControlGroup\"] = this.DOM.recordBase_Scatter\r\n        .append(\"div\")\r\n        .attr(\"class\", \"recordGroup_Scatter_\" + axis + \"Axis_Options\")\r\n        .on(\"mousedown\", (event) => event.stopPropagation() )\r\n        .on(\"mouseup\", (event) => event.stopPropagation() )\r\n        .on(\"dbclick\", (event) => event.stopPropagation() )\r\n        .on(\"wheel\", (event) => event.stopPropagation() )\r\n        .append(\"span\")\r\n        .attr(\"class\", \"scatter\" + axis + \"ControlGroup attribControlGroup\");\r\n\r\n      this.rd.initDOM_AttribSelect(axis === \"X\" ? \"scatterX\" : \"scatterY\");\r\n    });\r\n\r\n    var _svg = this.DOM.recordGroup_Scatter\r\n      .append(\"svg\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\");\r\n\r\n    this.DOM.recordGroup = _svg.append(\"g\").attr(\"class\", \"recordGroup\");\r\n\r\n    this.DOM.recordTrail = _svg.append(\"g\").attr(\"class\", \"recordTrail\");\r\n    this.DOM.recordTrail_Path = this.DOM.recordTrail\r\n      .append(\"path\")\r\n      .attr(\"class\", \"recordTrail_Path\");\r\n\r\n    this.insertQueryBoxes(\r\n      this.DOM.recordGroup_Scatter,\r\n      // setSizeCb\r\n      (event, t) => {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        this.DOM.recordDisplayWrapper\r\n          .classed(\"dragging\", true)\r\n          .classed(\"drawSelecting\", true);\r\n        d3.select(\"body\")\r\n          .on(\"mousemove\", (event2) => {\r\n            var targetPos: number = d3\r\n              .pointer(event2, this.DOM.recordGroup_Scatter.node().parentNode)\r\n              .map((_, i) => this[\"scatterAxisScale_\" + (i ? \"Y\" : \"X\")].invert(_) );\r\n            if (t === \"l\") {\r\n              this.scatterXAttrib.setRangeFilter_Custom(\r\n                targetPos[0],\r\n                this.scatterXAttrib.summaryFilter.active.maxV\r\n              );\r\n            }\r\n            if (t === \"r\") {\r\n              this.scatterXAttrib.setRangeFilter_Custom(\r\n                this.scatterXAttrib.summaryFilter.active.minV,\r\n                targetPos[0]\r\n              );\r\n            }\r\n            if (t === \"t\") {\r\n              this.scatterYAttrib.setRangeFilter_Custom(\r\n                this.scatterYAttrib.summaryFilter.active.minV,\r\n                targetPos[1]\r\n              );\r\n            }\r\n            if (t === \"b\") {\r\n              this.scatterYAttrib.setRangeFilter_Custom(\r\n                targetPos[1],\r\n                this.scatterYAttrib.summaryFilter.active.minV\r\n              );\r\n            }\r\n            this.refreshQueryBox_Filter();\r\n          })\r\n          .on(\"mouseup\", () => {\r\n            this.DOM.recordDisplayWrapper\r\n              .classed(\"dragging\", false)\r\n              .classed(\"drawSelecting\", false);\r\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\r\n          });\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      },\r\n      // drag callback\r\n      (event) => {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        this.DOM.recordDisplayWrapper.classed(\"dragging\", true);\r\n        var initScreenPos = d3.pointer(\r\n          event,\r\n          this.DOM.recordGroup_Scatter.node().parentNode\r\n        );\r\n\r\n        var initMin_X = this.scatterAxisScale_X( this.scatterXAttrib.summaryFilter.active.minV );\r\n        var initMax_X = this.scatterAxisScale_X( this.scatterXAttrib.summaryFilter.active.maxV );\r\n        var initMin_Y = this.scatterAxisScale_Y( this.scatterYAttrib.summaryFilter.active.minV );\r\n        var initMax_Y = this.scatterAxisScale_Y( this.scatterYAttrib.summaryFilter.active.maxV );\r\n\r\n        d3.select(\"body\")\r\n          .on(\"mousemove\", (event3) => {\r\n            var curScreenPos = d3.pointer(\r\n              event3,\r\n              this.DOM.recordGroup_Scatter.node().parentNode\r\n            );\r\n            var diffX = initScreenPos[0] - curScreenPos[0];\r\n            var diffY = initScreenPos[1] - curScreenPos[1];\r\n            this.scatterYAttrib.setRangeFilter_Custom(\r\n              this.scatterAxisScale_Y.invert(initMin_Y - diffY),\r\n              this.scatterAxisScale_Y.invert(initMax_Y - diffY)\r\n            );\r\n            this.scatterXAttrib.setRangeFilter_Custom(\r\n              this.scatterAxisScale_X.invert(initMin_X - diffX),\r\n              this.scatterAxisScale_X.invert(initMax_X - diffX)\r\n            );\r\n            this.refreshQueryBox_Filter();\r\n          })\r\n          .on(\"mouseup\", () => {\r\n            this.DOM.recordDisplayWrapper.classed(\"dragging\", false);\r\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\r\n          });\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      },\r\n      // click callback\r\n      (event, d) => {\r\n        if (d === \"Filter\") {\r\n          this.scatterXAttrib.summaryFilter.clearFilter();\r\n          this.scatterYAttrib.summaryFilter.clearFilter();\r\n        } else {\r\n          this.browser.clearSelect_Compare(d);\r\n          this.displayQueryBox(d, false);\r\n        }\r\n        event.currentTarget.tippy.hide();\r\n      }\r\n    );\r\n  }\r\n\r\n  async refreshAttribScaleType(attrib: Attrib) {\r\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\r\n\r\n    if (\r\n      this.scatterXAttrib === attrib ||\r\n      this.scatterXAttrib.timeseriesParent === attrib\r\n    ) {\r\n      await this.scatter_xAxisScale.set(this.scatterXAttrib.valueScaleType.get());\r\n      this.refreshRecordVis();\r\n    }\r\n\r\n    if (\r\n      this.scatterYAttrib === attrib ||\r\n      this.scatterYAttrib.timeseriesParent === attrib\r\n    ) {\r\n      await this.scatter_yAxisScale.set(this.scatterYAttrib.valueScaleType.get());\r\n      this.refreshRecordVis();\r\n    }\r\n  }\r\n\r\n  refreshAttribUnitName(attrib: Attrib) {\r\n    this.refreshScatterTicks();\r\n  }\r\n\r\n  async finishSetAttrib(t: RecordVisCoding) {\r\n    if (t === \"text\") {\r\n      this.DOM.kshfRecords\r\n        .selectAll(\"foreignObject .recordText\")\r\n        .html((record: Record) =>\r\n          this.textBriefAttrib.renderRecordValue(record)\r\n        );\r\n      this.refreshRecordBounds();\r\n      this.refreshLabelOverlaps();\r\n      //\r\n    } else if (t === \"scatterX\" || t === \"scatterY\") {\r\n      if (t === \"scatterX\") {\r\n        this.scatter_xAxisScale.set(this.scatterXAttrib.valueScaleType.get());\r\n      }\r\n      if (t === \"scatterY\") {\r\n        this.scatter_yAxisScale.set(this.scatterYAttrib.valueScaleType.get());\r\n      }\r\n      this.refreshScales();\r\n      this.refreshLabelOverlaps();\r\n      this.refreshRecordVis();\r\n      //\r\n    } else if (t === \"color\") {\r\n      this.refreshRecordColors();\r\n      //\r\n    } else if (t === \"size\") {\r\n      //\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshViewSize(_delayMS: number = 0) {\r\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\r\n\r\n    this.refreshZoomScaleExtent();\r\n    this.refreshRecordVis();\r\n    this.rd.refreshColorLegendTicks();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Scale of X and Y attributes\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  get realWidth() {\r\n    return this.rd.curWidth - Base.width_scatter_margin_left;\r\n  }\r\n  /** -- */\r\n  get realHeight() {\r\n    return (\r\n      this.rd.curHeight -\r\n      Base.height_scatter_margin_bottom -\r\n      (this.rd.hasTimeKey ? Base.timeKeyHeight : 0)\r\n    );\r\n  }\r\n\r\n  scatterScaleX: any; // d3 scale\r\n  scatterScaleY: any; // d3 scale\r\n\r\n  /** -- */\r\n  getScale(attrib) {\r\n    return Util.getD3Scale(attrib.isValueScale_Log)\r\n      .domain(attrib.getVizDomain())\r\n      .clamp(false);\r\n  }\r\n\r\n  /** -- */\r\n  refreshScales() {\r\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\r\n    if (this.rd.timeseriesAnimInterval) return; // do not refresh scale during animation\r\n\r\n    this.scatterScaleX = this.getScale(this.scatterXAttrib).range([\r\n      this.realWidth * 0.05,\r\n      this.realWidth * 0.9,\r\n    ]);\r\n    this.scatterScaleY = this.getScale(this.scatterYAttrib).range([\r\n      this.realHeight * 0.9,\r\n      this.realHeight * 0.05,\r\n    ]);\r\n  }\r\n\r\n  /** -- */\r\n  swapAxis() {\r\n    var _ = this.scatterXAttrib;\r\n    this.rd.codeBy.scatterX = this.scatterYAttrib;\r\n    this.rd.codeBy.scatterY = _;\r\n\r\n    this.rd.refreshAttribOptions(\"scatterX\");\r\n    this.rd.refreshAttribOptions(\"scatterY\");\r\n\r\n    this.refreshScales();\r\n\r\n    this.refreshRecordVis();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Zoom control\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  zoomIn() {\r\n    this.scatterZoom.scaleBy(this.DOM.recordBase_Scatter, 2);\r\n  }\r\n  /** -- */\r\n  zoomOut() {\r\n    this.scatterZoom.scaleBy(this.DOM.recordBase_Scatter, 1 / 2);\r\n  }\r\n  /** -- */\r\n  zoomToFit() {\r\n    this.scatterZoom.transform(this.DOM.recordBase_Scatter, d3.zoomIdentity);\r\n  }\r\n  /** -- */\r\n  refreshZoomScaleExtent() {\r\n    this.scatterZoom.translateExtent([\r\n      [0, 0],\r\n      [this.realWidth, this.realHeight],\r\n    ]);\r\n  }\r\n\r\n  /** -- */\r\n  refreshLabelOverlaps() {\r\n    if (!this.initialized) return;\r\n    if (!this.DOM.kshfRecords) return;\r\n    if (this.rd.timeseriesAnimInterval) return;\r\n    var activeComparisons = this.browser.activeComparisons;\r\n\r\n    var relevantRecords = this.browser.records.filter((record: Record) => {\r\n      // hide text labels of all records by default\r\n      record._view.hideTextLabel = true;\r\n      return (\r\n        record.DOM.record &&\r\n        record._view.textBounds &&\r\n        record._view.isInScatterPlot &&\r\n        record._view.isInRange &&\r\n        record.isIncluded &&\r\n        (activeComparisons.length === 0 || record.isSelected())\r\n      );\r\n    });\r\n\r\n    var maxNumOfRecords = (this.realWidth * this.realHeight) / 7000;\r\n    var numOfLabels = 0;\r\n\r\n    relevantRecords.forEach((record: Record, i) => {\r\n      if (numOfLabels > maxNumOfRecords) return;\r\n      delete record._view.hideTextLabel; // ok, now inverse logic: show by default\r\n      // simple transformation on bounds to detect intersecting text labels\r\n      var _ = record._view.textBounds;\r\n      var _w = _.width / this.scatterTransform.z;\r\n      var _h = _.height / this.scatterTransform.z;\r\n      record._view.viewBounds = {\r\n        width: _w,\r\n        height: _h,\r\n        left: record._view.x,\r\n        right: record._view.x + _w,\r\n        top: record._view.y,\r\n        bottom: record._view.y + _h,\r\n      };\r\n\r\n      for (var j = 0; j < i; j++) {\r\n        var record_2 = relevantRecords[j];\r\n        if (\r\n          !record_2._view.hideTextLabel &&\r\n          Util.intersectsDOMRect(\r\n            record._view.viewBounds,\r\n            record_2._view.viewBounds\r\n          )\r\n        ) {\r\n          record._view.hideTextLabel = true;\r\n          return;\r\n        }\r\n      }\r\n      numOfLabels++;\r\n    });\r\n\r\n    this.DOM.kshfRecords.classed(\r\n      \"hideTextLabel\",\r\n      (record: Record) => record._view.hideTextLabel\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordSizes(): void {\r\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\r\n    if (!this.DOM.recordGroup) return;\r\n\r\n    this.DOM.recordGroup\r\n      .selectAll(\".kshfRecord > path\")\r\n      .transition()\r\n      .duration(700)\r\n      .ease(d3.easePolyOut.exponent(3))\r\n      .attr(\"d\", (record) => this.rd.recordDrawArc(record)());\r\n    this.refreshSelect_Compare(); // skip label overlap\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordColors(): void {\r\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\r\n\r\n    if (!this.DOM.kshfRecords) return;\r\n    if (!this.DOM.kshfRecords_Path) return;\r\n\r\n    var _fill = null;\r\n\r\n    if (this.colorAttrib instanceof Attrib_Interval) {\r\n      var c = this.colorAttrib;\r\n      var s_log = this.colorAttrib.isValueScale_Log;\r\n      _fill = (record) => {\r\n        if (record.filteredOut) return;\r\n        var v = c.getRecordValue(record);\r\n        return isNaN(v) || v == null || (s_log && v <= 0)\r\n          ? \"url(#diagonalHatch)\"\r\n          : this.rd.recordColorScale(v);\r\n      };\r\n    }\r\n\r\n    this.DOM.kshfRecords_Path.style(\"fill\", _fill);\r\n  }\r\n\r\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\r\n    this.refreshLabelOverlaps();\r\n    super.refreshSelect_Compare(cT, status);\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordVis() {\r\n    if (!this.initialized) return;\r\n\r\n    if (!this.DOM.recordBase_Scatter) return;\r\n    if (!this.DOM.kshfRecords) return;\r\n    if (!this.rd.curHeight) return;\r\n\r\n    // running this first, as it also computes scatterAxisScale_X & scatterAxisScale_Y\r\n    this.refreshScatterTicks();\r\n\r\n    var visibleX = this.scatterAxisScale_X.domain();\r\n    var visibleY = this.scatterAxisScale_Y.domain();\r\n    visibleY.reverse();\r\n    var inRange = (x, range) => x > range[0] && x < range[1];\r\n\r\n    this.DOM.kshfRecords.each((record: Record) => {\r\n      record._view.wasInScatterPlot = record._view.isInScatterPlot || false;\r\n      var _x = this.scatterXAttrib.getRecordValue(record);\r\n      var _y = this.scatterYAttrib.getRecordValue(record);\r\n      record._view.isInScatterPlot = _x != null && _y != null;\r\n      record._view.isInRange = inRange(_x, visibleX) && inRange(_y, visibleY);\r\n    });\r\n\r\n    // was in scatterplot, is in scatterplot\r\n    this.DOM.kshfRecords\r\n      .filter((record: Record) => record._view.isInScatterPlot)\r\n      .classed(\r\n        \"noTransition\",\r\n        (record: Record) => !record._view.wasInScatterPlot\r\n      )\r\n      .style(\"transform\", (record: Record) => {\r\n        record._view.x = this.scatterScaleX(\r\n          record.getValue(this.scatterXAttrib)\r\n        );\r\n        record._view.y = this.scatterScaleY(\r\n          record.getValue(this.scatterYAttrib)\r\n        );\r\n        // scale is just based on zoom level - it reverses the affect of the zoom on parent node\r\n        return `translate(${record._view.x}px, ${record._view.y}px) scale(${\r\n          1 / this.scatterTransform.z\r\n        })`;\r\n      });\r\n\r\n    this.DOM.kshfRecords.classed(\r\n      \"hidden\",\r\n      (record: Record) => !record._view.isInScatterPlot\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshScatterTicks() {\r\n    // Compute bounds in SVG coordinates after transform is applied.\r\n    var minX_real = -this.scatterTransform.x / this.scatterTransform.z;\r\n    var maxX_real = minX_real + this.realWidth / this.scatterTransform.z;\r\n    var minY_real = -this.scatterTransform.y / this.scatterTransform.z;\r\n    var maxY_real = minY_real + this.realHeight / this.scatterTransform.z;\r\n\r\n    this.scatterAxisScale_X = this.scatterScaleX\r\n      .copy()\r\n      .range([0, this.realWidth])\r\n      .domain([\r\n        this.scatterScaleX.invert(minX_real),\r\n        this.scatterScaleX.invert(maxX_real),\r\n      ]);\r\n    this.scatterAxisScale_Y = this.scatterScaleY\r\n      .copy()\r\n      .range([0, this.realHeight])\r\n      .domain([\r\n        this.scatterScaleY.invert(minY_real),\r\n        this.scatterScaleY.invert(maxY_real),\r\n      ]);\r\n\r\n    if (this.scatterAxisScale_X.base) this.scatterAxisScale_X.base(10);\r\n    if (this.scatterAxisScale_Y.base) this.scatterAxisScale_Y.base(10);\r\n\r\n    var tickSpacing = {\r\n      X: 60,\r\n      Y: 40,\r\n    };\r\n    if (this.scatterXAttrib.unitName) {\r\n      tickSpacing.X += 2 + this.scatterXAttrib.unitName.length * 8;\r\n    }\r\n\r\n    // TODO: add translateZ to reduce redraw (but causes flickering on chrome)\r\n    var addTicks = (axis, axisScale, chartSize, attrib) => {\r\n      var numTicks = Math.min(15, Math.floor(chartSize / tickSpacing[axis])); // no more than 15 ticks.\r\n\r\n      var ticks = axisScale\r\n        .ticks(numTicks)\r\n        .filter((t) => attrib.hasFloat || t % 1 === 0);\r\n\r\n      var visiblePos = 0;\r\n\r\n      this.DOM[\"recordAxis_\" + axis]\r\n        .select(\".tickGroup\")\r\n        .selectAll(\".hmTicks\")\r\n        .data(ticks, (t) => t)\r\n        .join(\r\n          (enter) =>\r\n            enter\r\n              .append(\"div\")\r\n              .attr(\"class\", \"hmTicks\")\r\n              .call((newDOM) => {\r\n                newDOM\r\n                  .transition()\r\n                  .delay(100)\r\n                  .on(\"start\", function () {\r\n                    this.style.opacity = 1;\r\n                  });\r\n                newDOM.append(\"div\").attr(\"class\", \"tickText\");\r\n                newDOM.append(\"div\").attr(\"class\", \"tickLine\");\r\n              }),\r\n          (update) => update,\r\n          (exit) => exit.remove()\r\n        )\r\n        .classed(\"lineAtZero\", (tick) => (tick === 0 ? true : false))\r\n        .style(\r\n          \"transform\",\r\n          (tick) => `translate${axis}(${axisScale(tick)}px) translateZ(0)`\r\n        )\r\n        .classed(\"hideLabel\", (tick) => {\r\n          var pos = axisScale(tick);\r\n          if (pos >= visiblePos) {\r\n            visiblePos = pos + tickSpacing[axis] / 2;\r\n            return false;\r\n          }\r\n          return true;\r\n        })\r\n        // unit name may change, don't just rely on inserting tick text on new ticks.\r\n        .selectAll(\".tickText\")\r\n        .html((tick) => attrib.printAbbr(tick));\r\n\r\n      // sort ticks from large to small\r\n    };\r\n\r\n    addTicks(\"X\", this.scatterAxisScale_X, this.realWidth, this.scatterXAttrib);\r\n    addTicks(\r\n      \"Y\",\r\n      this.scatterAxisScale_Y,\r\n      this.realHeight,\r\n      this.scatterYAttrib\r\n    );\r\n\r\n    this.refreshQueryBox_Filter();\r\n  }\r\n  /** -- */\r\n  updateAfterFilter(how) {\r\n    this.updateRecordVisibility();\r\n    this.refreshLabelOverlaps();\r\n    if (how) {\r\n      this.refreshRecordVis();\r\n    }\r\n    this.refreshRecordColors();\r\n  }\r\n\r\n  /** -- */\r\n  extendRecordDOM(newRecords) {\r\n    newRecords.classed(\"noTransition\", true);\r\n    this.extendRecordDOM_Point(newRecords);\r\n    newRecords\r\n      .append(\"foreignObject\")\r\n      .attr(\"width\", \"120\")\r\n      .attr(\"height\", \"1\")\r\n      .append(\"xhtml:div\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\r\n      .attr(\"class\", \"recordText\");\r\n  }\r\n\r\n  /** -- */\r\n  displayQueryBox(cT, show) {\r\n    if (!this.initialized) return;\r\n\r\n    this.DOM.recordDisplayWrapper\r\n      .select(\".spatialQueryBox_\" + cT)\r\n      .style(\"display\", show ? \"block\" : null);\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordBounds() {\r\n    if (!this.initialized) return;\r\n\r\n    // needed to make labels visible so that bounds can be computed correctly\r\n    this.DOM.kshfRecords.classed(\"hideTextLabel\", false);\r\n\r\n    this.DOM.kshfRecords.selectAll(\".recordText\").each((record, i, nodes) => {\r\n      if (!record.DOM.record) {\r\n        delete record.textBounds;\r\n        return;\r\n      }\r\n      var DOM = nodes[i];\r\n      var recordTextBounds = DOM.getBoundingClientRect();\r\n      DOM.parentNode.setAttribute(\"width\", recordTextBounds.width * 1.07);\r\n      DOM.parentNode.setAttribute(\"height\", recordTextBounds.height);\r\n      var _ = recordTextBounds; // record.DOM.record.getBoundingClientRect();\r\n      record.textBounds = {\r\n        width: _.width,\r\n        height: _.height,\r\n        left: _.left,\r\n        right: _.right,\r\n        top: _.top,\r\n        bottom: _.bottom,\r\n      };\r\n    });\r\n  }\r\n\r\n  refreshQueryBox_Filter(bounds: { left; right; top; bottom } = null) {\r\n    if (this.rd.collapsed) return;\r\n    var _left, _right, _top, _bottom, temp;\r\n\r\n    var isVisible: boolean = false;\r\n\r\n    if (bounds === null) {\r\n      isVisible =\r\n        this.scatterXAttrib.isFiltered() || this.scatterYAttrib.isFiltered();\r\n\r\n      if (!this.scatterXAttrib.isFiltered()) {\r\n        _left = this.scatterXAttrib.rangeOrg[0];\r\n        if (_left === 0) _left = -1000;\r\n        _left = _left > 0 ? -_left * 100 : _left * 100;\r\n        _right = this.scatterXAttrib.rangeOrg[1];\r\n        if (_right === 0) _right = 1000;\r\n        _right = _right > 0 ? _right * 100 : -_right * 100;\r\n      } else {\r\n        _left = this.scatterXAttrib.summaryFilter.active[0];\r\n        _right = this.scatterXAttrib.summaryFilter.active[1];\r\n        if (this.scatterXAttrib.stepTicks) {\r\n          _left -= 0.5;\r\n          _right -= 0.5;\r\n        }\r\n      }\r\n\r\n      if (!this.scatterYAttrib.isFiltered()) {\r\n        _top = this.scatterYAttrib.rangeOrg[1];\r\n        if (_top === 0) _top = 1000;\r\n        _top = _top > 0 ? _top * 100 : -_top * 100;\r\n        _bottom = this.scatterYAttrib.rangeOrg[0];\r\n        if (_bottom === 0) _bottom = -1000;\r\n        _bottom = _bottom > 0 ? -_bottom * 100 : _bottom * 100;\r\n      } else {\r\n        _top = this.scatterYAttrib.summaryFilter.active[1];\r\n        _bottom = this.scatterYAttrib.summaryFilter.active[0];\r\n        if (this.scatterYAttrib.stepTicks) {\r\n          _top -= 0.5;\r\n          _bottom -= 0.5;\r\n        }\r\n      }\r\n    } else {\r\n      // use provided bounds\r\n      if (bounds.left > bounds.right) {\r\n        temp = bounds.left;\r\n        bounds.left = bounds.right;\r\n        bounds.right = temp;\r\n      }\r\n      if (bounds.top < bounds.bottom) {\r\n        temp = bounds.top;\r\n        bounds.top = bounds.bottom;\r\n        bounds.bottom = temp;\r\n      }\r\n      _left = bounds.left;\r\n      _right = bounds.right;\r\n      _top = bounds.top;\r\n      _bottom = bounds.bottom;\r\n    }\r\n\r\n    // convert from domain to screen coordinates\r\n    _left = this.scatterScaleX(_left);\r\n    if (isNaN(_left)) _left = -1000; // log scale fix\r\n    _right = this.scatterScaleX(_right);\r\n    _top = this.scatterScaleY(_top);\r\n    _bottom = this.scatterScaleY(_bottom);\r\n    if (isNaN(_bottom)) _bottom = 1000; // log scale fix\r\n\r\n    // give more room\r\n    _left -= 3;\r\n    _right += 3;\r\n    _top -= 3;\r\n    _bottom += 3;\r\n\r\n    this.DOM.recordDisplayWrapper\r\n      .select(\".recordGroup_Scatter .spatialQueryBox_Filter\")\r\n      .classed(\"active\", bounds ? true : isVisible)\r\n      .style(\"left\", _left + \"px\")\r\n      .style(\"top\", _top + \"px\")\r\n      .style(\"width\", Math.abs(_right - _left) + \"px\")\r\n      .style(\"height\", Math.abs(_bottom - _top) + \"px\");\r\n  }\r\n\r\n  /** -- */\r\n  onRecordMouseOver(record) {\r\n    record.moveDOMtoTop();\r\n\r\n    [\"X\", \"Y\"].forEach((axis, i) => {\r\n      var attrib: Attrib = this[\"scatter\" + axis + \"Attrib\"];\r\n      var acc = attrib.attribID;\r\n      var pos: number = this[\"scatterAxisScale_\" + axis](\r\n        record._valueCache[acc]\r\n      );\r\n      var dom = this.DOM[\"recordAxis_\" + axis];\r\n      dom\r\n        .select(\".onRecordLine\")\r\n        .style(\r\n          \"transform\",\r\n          \"translate(\" + pos * (i ? 0 : 1) + \"px,\" + pos * (i ? 1 : 0) + \"px)\"\r\n        )\r\n        .style(\"opacity\", 1);\r\n      dom\r\n        .select(\".onRecordLine > .tickText\")\r\n        .html(attrib.getFormattedValue(record._valueCache[acc], false));\r\n    });\r\n\r\n    if (this.scatter_showTrails.is(false)) return;\r\n\r\n    if (\r\n      this.scatterYAttrib.hasTimeSeriesParent() &&\r\n      this.scatterXAttrib.hasTimeSeriesParent()\r\n    ) {\r\n      var _ts_X =\r\n        this.scatterXAttrib.timeseriesParent.getRecordValue(record)._keyIndex;\r\n      var _ts_Y =\r\n        this.scatterYAttrib.timeseriesParent.getRecordValue(record)._keyIndex;\r\n\r\n      // merge the two\r\n      var _ts = [];\r\n      for (let _time_src in _ts_X) {\r\n        if (_ts_Y[_time_src]) {\r\n          _ts.push({\r\n            x: _ts_X[_time_src]._value,\r\n            y: _ts_Y[_time_src]._value,\r\n          });\r\n        }\r\n      }\r\n\r\n      var lineGenerator = d3\r\n        .line()\r\n        .curve(d3.curveNatural || d3.curveCatmullRomOpen)\r\n        .x((d) => this.scatterScaleX(d.x))\r\n        .y((d) => this.scatterScaleY(d.y));\r\n\r\n      this.DOM.recordTrail.style(\"opacity\", 1);\r\n\r\n      this.DOM.recordTrail_Path\r\n        .style(\"stroke-width\", 2 / this.scatterTransform.z + \"px\")\r\n        .attr(\"d\", lineGenerator(_ts));\r\n\r\n      this.DOM.recordTrail\r\n        .selectAll(\"circle\")\r\n        .data(_ts)\r\n        .join(\"circle\")\r\n        .attr(\"r\", 3)\r\n        .style(\"transform\", (d) => {\r\n          var x = this.scatterScaleX(d.x);\r\n          var y = this.scatterScaleY(d.y);\r\n          return `translate(${x}px,${y}px) scale(${\r\n            1 / this.scatterTransform.z\r\n          })`;\r\n        });\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  onRecordMouseLeave() {\r\n    this.DOM.root.selectAll(\".onRecordLine\").style(\"opacity\", null);\r\n    // hide the trail\r\n    this.DOM.recordTrail?.style(\"opacity\", 0);\r\n  }\r\n}\r\n","import { DateTime } from \"luxon/build/es6/luxon\";\r\n\r\nimport \"pikaday/css/pikaday.css\";\r\nimport * as Pikaday from \"pikaday\";\r\n\r\nimport { area, curveMonotoneX } from \"d3-shape\";\r\nimport { easePoly } from \"d3-ease\";\r\n\r\nimport { Block_Interval, ZoomableStatus } from \"./Block_Interval\";\r\nimport { CompareType, MeasureType } from \"./Types\";\r\nimport { Attrib_Timestamp } from \"./Attrib_Timestamp\";\r\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\r\nimport { Base } from \"./Base\";\r\n\r\nconst d3 = {\r\n  area,\r\n  curveMonotoneX,\r\n  easePoly,\r\n};\r\n\r\n// All dates are based on UTC.\r\n// Since dates are created with zone offset by default, need to offset them back sometimes\r\nvar offsetUTC = DateTime.now().offset;\r\n\r\nexport class Block_Timestamp extends Block_Interval<Date> {\r\n  // specific attribute type\r\n  public readonly attrib: Attrib_Timestamp;\r\n  constructor(attrib: Attrib_Timestamp) {\r\n    super(attrib);\r\n  }\r\n\r\n  /** -- */\r\n  dragRange(initPos, curPos, initMin, initMax) {\r\n    // no-op - not supported\r\n  }\r\n\r\n  /** - */\r\n  refreshViz_Active() {\r\n    if (!this.isVisible() || !this.DOM.aggrGlyphs) return;\r\n    super.refreshViz_Active();\r\n\r\n    this.updateViz_Areas(\r\n      \"Active\",\r\n      !this.browser.stackedCompare && this.browser.activeComparisonsCount > 0\r\n    );\r\n  }\r\n  /** - */\r\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\r\n    if (!this.isVisible() || !this.DOM.aggrGlyphs) return;\r\n    super.refreshViz_Compare(cT, curGroup, totalGroups, prevCts);\r\n\r\n    if (\r\n      this.browser.stackedCompare &&\r\n      this.browser.addedCompare &&\r\n      curGroup === totalGroups - 1\r\n    ) {\r\n      // smoother animation, sets it as a chart-line at offset first - instead of area chart\r\n      this.DOM[\"measure_Area_\" + cT].attr(\"d\", this.getVizArea(cT, true));\r\n    }\r\n    this.updateViz_Areas(cT, !this.browser.stackedCompare);\r\n  }\r\n\r\n  /** -- */\r\n  insertVizDOM() {\r\n    // insert these elements only once\r\n    if (!this.DOM.timeSVG) {\r\n      this.DOM.timeSVG = this.DOM.histogram\r\n        .append(\"svg\")\r\n        .attr(\"class\", \"timeSVG\")\r\n        .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n        .style(\"margin-left\", Base.width_HistBarGap / 2 + \"px\");\r\n\r\n      this.DOM.timeSVG\r\n        .append(\"defs\")\r\n        .selectAll(\"marker\")\r\n        .data(Base.Active_Compare_List.map((x) => \"kshfLineChartTip_\" + x))\r\n        .enter()\r\n        .append(\"marker\")\r\n        .attr(\"id\", (d) => d)\r\n        .attr(\"patternUnits\", \"userSpaceOnUse\")\r\n        .attr(\"viewBox\", \"0 0 20 20\")\r\n        .attr(\"refX\", 10)\r\n        .attr(\"refY\", 10)\r\n        .attr(\"markerUnits\", \"strokeWidth\")\r\n        .attr(\"markerWidth\", 9)\r\n        .attr(\"markerHeight\", 9)\r\n        .attr(\"orient\", \"auto\")\r\n        .append(\"circle\")\r\n        .attr(\"r\", 4)\r\n        .attr(\"cx\", 10)\r\n        .attr(\"cy\", 10);\r\n\r\n      [\"Total\", \"Active\"]\r\n        .concat(Array.from(Base.Compare_List).reverse())\r\n        .forEach((cT) => {\r\n          this.DOM[\"measure_Area_\" + cT] = this.DOM.timeSVG\r\n            .append(\"path\")\r\n            .attr(\"class\", \"measure_Area_\" + cT + \" measure_\" + cT)\r\n            .attr(\"marker-mid\", \"url(#kshfLineChartTip_\" + cT + \")\")\r\n            .attr(\"marker-end\", \"url(#kshfLineChartTip_\" + cT + \")\")\r\n            .attr(\"marker-start\", \"url(#kshfLineChartTip_\" + cT + \")\");\r\n        });\r\n    }\r\n\r\n    Base.Total_Active_Compare_List.forEach((cT) => {\r\n      this.DOM[\"measure_Area_\" + cT].datum(this._aggrs).attr(\r\n        \"d\",\r\n        d3\r\n          .area()\r\n          .curve(d3.curveMonotoneX)\r\n          .x(this.attrib.timeAxis_XFunc)\r\n          .y0(this.height_hist - this.measureLineZero + 2)\r\n          .y1(this.height_hist - this.measureLineZero + 2)\r\n      );\r\n    });\r\n\r\n    super.insertVizDOM();\r\n  }\r\n\r\n  /** -- */\r\n  getVizArea(sT: MeasureType, asLine) {\r\n    if(sT===\"Other\") return;\r\n\r\n    var _area = d3\r\n      .area()\r\n      .curve(d3.curveMonotoneX)\r\n      .x(this.attrib.timeAxis_XFunc)\r\n      .y(\r\n        // sets y0 and y1\r\n        (aggr: Aggregate_Interval<Date>) =>\r\n          this.height_hist - aggr.sumOffsetScale(sT)\r\n      );\r\n\r\n    if (!asLine) {\r\n      _area.y1((aggr) => this.height_hist - aggr.offset(sT));\r\n    }\r\n\r\n    /*\r\n    // Removed, bc having all points defined help with smoother transitions between breakdown modes\r\n    if (this.isFiltered()) {\r\n      _area.defined(aggr => {\r\n        if(this.summaryFilter.active.min && this.summaryFilter.active.min > aggr.maxV) return false;\r\n        if(this.summaryFilter.active.max && this.summaryFilter.active.max < aggr.minV) return false;\r\n        return true;\r\n      });\r\n    }\r\n    */\r\n\r\n    return _area;\r\n  }\r\n  /** - */\r\n  updateViz_Areas(sT: MeasureType, asLine) {\r\n    if(sT===\"Other\") return;\r\n\r\n    return this.DOM[\"measure_Area_\" + sT]\r\n      .classed(\"asLine\", asLine)\r\n      .transition()\r\n      .duration(this.browser.noAnim ? 0 : 800)\r\n      .ease(d3.easePoly.exponent(3))\r\n      .attr(\"d\", this.getVizArea(sT, asLine));\r\n  }\r\n\r\n  /** -- */\r\n  showValuePicker(DOM, d: \"min\" | \"max\") {\r\n    if (typeof Pikaday === \"undefined\") return;\r\n    var skipSelect = false;\r\n\r\n    var pikaday = DOM.pikaday;\r\n\r\n    var refreshPikadayDate = () => {\r\n      var aggr = this.attrib.summaryFilter.active;\r\n      var _date = DateTime.fromJSDate(d===\"min\" ? aggr.minV : aggr.maxV)\r\n        .plus({ minutes: -offsetUTC })\r\n        .toJSDate();\r\n      skipSelect = true;\r\n      pikaday.setDate(_date);\r\n    };\r\n    if (!pikaday) {\r\n      var me = this;\r\n      DOM.pikaday = pikaday = new (window as any).Pikaday({\r\n        field: DOM,\r\n        firstDay: 1,\r\n        minDate: this.attrib.rangeOrg[0],\r\n        maxDate: this.attrib.rangeOrg[1],\r\n        onSelect: function () {\r\n          if (skipSelect) {\r\n            skipSelect = false;\r\n            return;\r\n          }\r\n          var selectedDate: Date = this.getDate();\r\n          selectedDate = DateTime.fromJSDate(selectedDate)\r\n            // need to convert value to UTC\r\n            .plus({ minutes: offsetUTC })\r\n            .toJSDate();\r\n          if (\r\n            (d === \"min\" && selectedDate < me.attrib.summaryFilter.active.minV) ||\r\n            (d === \"max\" && selectedDate > me.attrib.summaryFilter.active.maxV)\r\n          ) {\r\n            me.zoomed.set(false);\r\n          }\r\n\r\n          var minV = me.attrib.summaryFilter.active.minV;\r\n          var maxV = me.attrib.summaryFilter.active.minV;\r\n          if(d===\"min\") minV = selectedDate;\r\n          if(d===\"max\") maxV = selectedDate;\r\n          me.attrib.setRangeFilter_Custom( minV, maxV);\r\n          refreshPikadayDate();\r\n        },\r\n      });\r\n    }\r\n\r\n    refreshPikadayDate();\r\n    pikaday.show();\r\n  }\r\n\r\n  getScaleNicing(): number {\r\n    return this.width_histogram / (this.inDashboard ? this.optimumBinWidth.get() : 10) * 1;\r\n  }\r\n\r\n  hasStaticHeight() {\r\n    return this.showHistogram.is(false);\r\n  }\r\n\r\n  zoomableStatus(): ZoomableStatus {\r\n    if (this.attrib.stepTicks) {\r\n      if (\r\n        this.attrib.timeTyped.finestRes() ===\r\n        this.attrib.timeTyped.activeRes.type\r\n      ) {\r\n        return this.zoomed.get() ? \"minus\" : \"\";\r\n      }\r\n    }\r\n    return \"plus\";\r\n  }\r\n}\r\n","import { DateTime, Interval } from \"luxon/build/es6/luxon\";\r\nimport { utcFormat } from \"d3-time-format\";\r\n\r\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\r\n\r\nconst d3 = { utcFormat };\r\n\r\nexport class Aggregate_Interval_Date extends Aggregate_Interval<Date> {\r\n  get label(): string {\r\n    if (this.minV == null || this.maxV == null) return \"-\";\r\n\r\n    // if time selection covers a full year/ month, print as a single year/month\r\n    var m_max = DateTime.fromJSDate(this.maxV, { zone: \"UTC\" });\r\n    var m_min = DateTime.fromJSDate(this.minV, { zone: \"UTC\" });\r\n\r\n    var interval = Interval.fromDateTimes(m_min, m_max);\r\n\r\n    var daysInBetween = interval.toDuration(\"days\").toObject().days;\r\n\r\n    if (\r\n      Math.abs(daysInBetween - 365) < 2 &&\r\n      m_max.month === 1 &&\r\n      m_max.day === 1\r\n    ) {\r\n      return d3.utcFormat(\"%Y\")(this.minV);\r\n    }\r\n\r\n    if (\r\n      Math.abs(daysInBetween - 30) < 3 &&\r\n      m_min.day === 1 &&\r\n      m_max.day === 1\r\n    ) {\r\n      return d3.utcFormat(\"%b %Y\")(this.minV);\r\n    }\r\n\r\n    var minStr = this.attrib.getFormattedValue(this.minV, false);\r\n    var maxStr = this.attrib.getFormattedValue(this.maxV, false);\r\n\r\n    return `${this.isMinLarger() ? minStr : \"\"} ... ${\r\n      this.isMaxSmaller() ? maxStr : \"\"\r\n    }`;\r\n  }\r\n}\r\n","import { scaleUtc } from \"d3-scale\";\r\nimport { utcFormat } from \"d3-time-format\";\r\nimport {\r\n  utcSecond,\r\n  utcMinute,\r\n  utcHour,\r\n  utcDay,\r\n  utcWeek,\r\n  utcMonth,\r\n  utcYear,\r\n} from \"d3-time\";\r\nimport { DateTime } from \"luxon/build/es6/luxon\";\r\n\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { RecordVisCoding } from \"./Types\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Block_Timestamp } from \"./Block_Timestamp\";\r\nimport { AttribTemplate } from \"./AttribTemplate\";\r\nimport { Aggregate_Interval_Date } from \"./Aggregate_Interval_Date\";\r\n\r\nconst d3 = {\r\n  scaleUtc,\r\n  utcFormat,\r\n  utcSecond,\r\n  utcMinute,\r\n  utcHour,\r\n  utcDay,\r\n  utcWeek,\r\n  utcMonth,\r\n  utcYear,\r\n};\r\n\r\ntype DateRes = \"Second\" | \"Minute\" | \"Hour\" | \"Day\" | \"Month\" | \"Year\";\r\n\r\ntype TTTT = {\r\n  type: DateRes;\r\n  step: number;\r\n  format: (any) => string;\r\n  twoLine?: boolean;\r\n};\r\n\r\n// All dates are based on UTC.\r\n// Since dates are created with zone offset by default, need to offset them back sometimes\r\nvar offsetUTC = DateTime.now().offset;\r\n\r\nexport class Attrib_Timestamp extends Attrib_Interval<Date> {\r\n  timeTyped?: {\r\n    activeRes?: TTTT;\r\n    second?: boolean;\r\n    minute?: boolean;\r\n    hour?: boolean;\r\n    day?: boolean;\r\n    month?: boolean;\r\n    year?: boolean;\r\n    print?: (any) => string;\r\n    finestRes?: () => DateRes;\r\n  };\r\n\r\n  /** -- */\r\n  initTimeTyped() {\r\n    // Check time resolutions\r\n    this.timeTyped.year = false;\r\n    this.timeTyped.month = false;\r\n    this.timeTyped.day = false;\r\n    this.timeTyped.hour = false;\r\n    this.timeTyped.minute = false;\r\n    this.timeTyped.second = false;\r\n\r\n    var tempYear = null;\r\n\r\n    this.records.forEach((record) => {\r\n      var v = this.getRecordValue(record);\r\n      if (!v) return;\r\n      if (v.getUTCMonth() !== 0) this.timeTyped.month = true;\r\n      if (v.getUTCHours() !== 0) this.timeTyped.hour = true;\r\n      if (v.getUTCMinutes() !== 0) this.timeTyped.minute = true;\r\n      if (v.getUTCDate() !== 1) this.timeTyped.day = true;\r\n      if (!this.timeTyped.year) {\r\n        if (tempYear === null) {\r\n          tempYear = v.getUTCFullYear();\r\n        } else {\r\n          if (tempYear !== v.getUTCFullYear()) this.timeTyped.year = true;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  timeAxis_XFunc: any;\r\n\r\n  constructor(browser: Browser, name: string, template: AttribTemplate) {\r\n    super(\r\n      browser,\r\n      name,\r\n      template,\r\n      \"timestamp\",\r\n      \"kshfSummary_Timestamp\",\r\n      \"fa fa-calendar-day\"\r\n    );\r\n\r\n    this._block = new Block_Timestamp(this);\r\n\r\n    this.timeAxis_XFunc = (aggr) =>\r\n      (this.valueScale(aggr.minV) + this.valueScale(aggr.maxV)) / 2;\r\n\r\n    this.configs.showHistogram.cfgTitle = \"Line Chart\"; // customize from \"Histogram\"\r\n\r\n    this.timeTyped = {\r\n      // Finest level of resolution\r\n      finestRes: function () {\r\n        if (this.second) return \"Second\";\r\n        if (this.minute) return \"Minute\";\r\n        if (this.hour) return \"Hour\";\r\n        if (this.day) return \"Day\";\r\n        if (this.month) return \"Month\";\r\n        if (this.year) return \"Year\";\r\n      },\r\n    };\r\n  }\r\n\r\n  createAggregate(minV: Date, maxV: Date) {\r\n    return new Aggregate_Interval_Date(this, minV, maxV);\r\n  }\r\n\r\n  /** -- */\r\n  supportsRecordEncoding(coding: RecordVisCoding) {\r\n    if (this.isEmpty()) return false;\r\n    if (coding === \"sort\") return true;\r\n    if (coding === \"text\") return true;\r\n    if (coding === \"textBrief\") return true;\r\n    return false;\r\n  }\r\n\r\n  /** -- */\r\n  getFormattedValue(v) {\r\n    return v instanceof Date ? this.intervalTickPrint(v) : v;\r\n  }\r\n\r\n  getValuePosX(v: Date): number {\r\n    var offset = 0;\r\n    if (this.stepTicks) {\r\n      offset += this.block.aggrWidth / 2;\r\n    }\r\n    return this.valueScale(v) + offset;\r\n  }\r\n\r\n  /** -- */\r\n  getValueScaleObj() {\r\n    return d3.scaleUtc();\r\n  }\r\n  refreshScaleType() {\r\n    return;\r\n  }\r\n\r\n  /** -- */\r\n  fillValueCache() {\r\n    this.records.forEach((record) => {\r\n      var v = this.template.func.call(record.data, record);\r\n      if (v === undefined) v = null;\r\n      if (!(v instanceof Date)) v = null;\r\n      record.setValue(this, v);\r\n      if (v == null) {\r\n        this.noValueAggr.addRecord(record);\r\n      }\r\n    });\r\n\r\n    this.initTimeTyped();\r\n  }\r\n\r\n  /** -- */\r\n  pofffff() {\r\n    this.updateScaleAndBins();\r\n  }\r\n\r\n  refreshValueScale() {\r\n    super.refreshValueScale();\r\n\r\n    var maxScale: (Date) => Date = d3[\"utc\" + this.timeTyped.finestRes()];\r\n\r\n    if (this.intervalTicks.some((tick: Date) => maxScale(tick) < tick)) {\r\n      var nicing = maxScale;\r\n\r\n      this.valueScale = this.getValueScaleObj()\r\n        .domain(this.rangeActive)\r\n        .range([0, this.block.width_histogram])\r\n        .nice(nicing);\r\n\r\n      this.intervalTicks = this.valueScale.ticks(nicing);\r\n    }\r\n  }\r\n\r\n  updateTickPrintFunc() {\r\n    const formatSecond = d3.utcFormat(\":%S\"),\r\n      formatMinute = d3.utcFormat(\"%I:%M\"),\r\n      formatHour = d3.utcFormat(\"%I %p\"),\r\n      formatDay = d3.utcFormat(\"%a %d\"),\r\n      formatWeek = d3.utcFormat(\"%b %d\"),\r\n      formatMonth = d3.utcFormat(\"%b\"),\r\n      formatYear = d3.utcFormat(\"%Y\");\r\n\r\n    this.intervalTickPrint = (date) => {\r\n      return (\r\n        d3.utcMinute(date) < date\r\n          ? formatSecond\r\n          : d3.utcHour(date) < date\r\n          ? formatMinute\r\n          : d3.utcDay(date) < date\r\n          ? formatHour\r\n          : d3.utcMonth(date) < date\r\n          ? d3.utcWeek(date) < date\r\n            ? formatDay\r\n            : formatWeek\r\n          : d3.utcYear(date) < date\r\n          ? formatMonth\r\n          : formatYear\r\n      )(date);\r\n    };\r\n  }\r\n}\r\n","import { select, pointer } from \"./d3_select\";\r\nimport { scaleTime, scaleLinear } from \"d3-scale\";\r\nimport { extent } from \"d3-array\";\r\nimport { arc } from \"d3-shape\";\r\n\r\nimport { Base } from \"./Base\";\r\nimport { Config } from \"./Config\";\r\nimport { RecordDisplay } from \"./RecordDisplay\";\r\nimport { RecordView } from \"./RecordView\";\r\nimport { Attrib_Timestamp } from \"./Attrib_Timestamp\";\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\nimport { Util } from \"./Util\";\r\nimport { Record } from \"./Record\";\r\nimport { i18n } from \"./i18n\";\r\nimport { CompareType, RecordVisCoding } from \"./Types\";\r\nimport { Attrib } from \"./Attrib\";\r\n\r\nconst d3 = { select, pointer, scaleTime, scaleLinear, extent, arc };\r\n\r\nexport class RecordView_List extends RecordView {\r\n  // ********************************************************************\r\n  // Configurations\r\n  // ********************************************************************\r\n\r\n  list_showRank: Config<boolean>;\r\n  list_sortVizRange: Config<\"dynamic\" | \"static\">;\r\n  list_ViewType: Config<\"List\" | \"Grid\">;\r\n  list_sortInverse: Config<boolean>;\r\n  list_sortColWidth: Config<number>;\r\n  list_sortVizWidth: Config<number>;\r\n  list_sparklineVizWidth: Config<number>;\r\n  list_gridRecordWidth: Config<number>;\r\n\r\n  listSortVizScale: any; // d3 scale\r\n\r\n  /** -- */\r\n  async prepareAttribs() {\r\n    if (!this.sortAttrib) {\r\n      await this.rd.setAttrib(\"sort\", this.rd.config.sortBy || 0);\r\n    }\r\n    return Promise.resolve(this.sortAttrib !== null);\r\n  }\r\n\r\n  constructor(rd: RecordDisplay, config) {\r\n    super(rd);\r\n\r\n    this.list_showRank = new Config<boolean>({\r\n      cfgClass: \"list_showRank\",\r\n      cfgTitle: \"Ranking\",\r\n      iconXML: \"⩔\",\r\n      default: false,\r\n      parent: this,\r\n      helparticle: \"5e88d84d04286364bc97d40f\",\r\n      tooltip: `The ranking column`,\r\n      itemOptions: [\r\n        { name: \"Hide\", value: false },\r\n        { name: \"Show\", value: true },\r\n      ],\r\n      onSet: () => {\r\n        if (!this.initialized) return;\r\n        this.refreshShowRank();\r\n      },\r\n    });\r\n\r\n    this.list_sortVizRange = new Config<\"dynamic\" | \"static\">({\r\n      cfgClass: \"list_sortVizRange\",\r\n      cfgTitle: \"Sorting Vis Axis\",\r\n      iconClass: \"fa fa-long-arrow-right\",\r\n      default: \"dynamic\",\r\n      parent: this,\r\n      //helparticle: \"5e88d84d04286364bc97d40f\",\r\n      tooltip: `The viz scale used for sorting column`,\r\n      itemOptions: [\r\n        { name: \"Static\", value: \"static\" },\r\n        { name: \"Dynamic\", value: \"dynamic\" },\r\n      ],\r\n      onSet: () => {\r\n        if (!this.initialized) return;\r\n        this.refreshSortVizScale();\r\n      },\r\n    });\r\n\r\n    this.list_ViewType = new Config<\"List\" | \"Grid\">({\r\n      cfgClass: \"list_ViewType\",\r\n      cfgTitle: \"List Type\",\r\n      iconClass: \"fa fa-list\",\r\n      default: \"List\",\r\n      parent: this,\r\n      helparticle: \"5f107e492c7d3a10cbaacc43\",\r\n      itemOptions: [\r\n        { name: \"List <i class='fa fa-bars'></i>\", value: \"List\" },\r\n        { name: \"Grid <i class='fa fa-th'></i>\", value: \"Grid\" },\r\n      ],\r\n      onSet: async (v) => {\r\n        this.DOM.root.attr(\"data-list_ViewType\", v);\r\n        if (!this.initialized) return;\r\n        this.refreshWidthControls();\r\n        if (v === \"List\") {\r\n          await this.list_sortVizWidth?.reset();\r\n          await this.list_sparklineVizWidth?.reset();\r\n        } else {\r\n          this.refreshSparklineViz();\r\n        }\r\n      },\r\n    });\r\n\r\n    this.list_sortInverse = new Config<boolean>({\r\n      cfgClass: \"list_sortInverse\",\r\n      cfgTitle: \"Sorting Order\",\r\n      iconClass: \"fa fa-sort-amount-asc\",\r\n      default: false,\r\n      parent: this,\r\n      helparticle: \"5e87f08e2c7d3a7e9aea6081\",\r\n      itemOptions: [\r\n        { name: \"Large to small\", value: false },\r\n        { name: \"Small to large\", value: true },\r\n      ],\r\n      onSet: () => {\r\n        if (!this.initialized) return;\r\n        this.reverseOrder();\r\n        this.DOM.root\r\n          ?.select(\".recordReverseSortButton\")\r\n          .classed(\"sortInverse\", this.list_sortInverse.is(true));\r\n      },\r\n    });\r\n\r\n    this.list_sortColWidth = new Config<number>({\r\n      cfgClass: \"list_sortColWidth\",\r\n      cfgTitle: \"Sorting Value Width\",\r\n      iconClass: \"fa fa-arrows-h\",\r\n      default: 60,\r\n      parent: this,\r\n      helparticle: \"5f107eb904286306f806ec35\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\r\n        { _type: \"_range_\", minValue: 40, maxValue: 120 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\r\n      ],\r\n      preSet: async (v, obj) => {\r\n        if (v === -99) {\r\n          v = obj._value - 5;\r\n        } else if (v === -199) {\r\n          v = obj._value + 5;\r\n        }\r\n        return Math.max(40, Math.min(120, v));\r\n      },\r\n      onSet: (v) => {\r\n        this.browser.DOM.root\r\n          .node()\r\n          .style.setProperty(\"--list_sortColWidth\", v + \"px\");\r\n        this.refreshSortColumnWidth();\r\n      },\r\n    });\r\n\r\n    this.list_sortVizWidth = new Config<number>({\r\n      cfgClass: \"list_sortVizWidth\",\r\n      cfgTitle: \"Sorting Bar Width\",\r\n      iconClass: \"fa fa-arrows-h\",\r\n      default: 80,\r\n      parent: this,\r\n      helparticle: \"5e87f23c04286364bc97d0e3\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\r\n        { name: \"Off\", value: 0 },\r\n        { _type: \"_range_\", minValue: 40, maxValue: 400 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\r\n      ],\r\n      forcedValue: (obj) => {\r\n        if (this.sortAttrib instanceof Attrib_Timestamp) return 0;\r\n        if (this.list_ViewType.is(\"Grid\") && obj._value !== 0)\r\n          return this.list_gridRecordWidth.get() - 10;\r\n      },\r\n      preSet: async (v, obj) => {\r\n        if (v === -99) {\r\n          v = obj._value - 5;\r\n        } else if (v === -199) {\r\n          v = obj._value + 5;\r\n        }\r\n        if (v < 40) return 0;\r\n        return Math.min(400, v);\r\n      },\r\n      onSet: (v) => {\r\n        if (!this.initialized) return;\r\n        this.browser.DOM.root\r\n          .node()\r\n          .style.setProperty(\"--list_sortVizWidth\", v + \"px\");\r\n        this.browser.DOM.root.classed(\"noAnim\", true);\r\n\r\n        this.refreshSortVizWidth();\r\n        setTimeout(() => this.browser.DOM.root.classed(\"noAnim\", false), 1000);\r\n      },\r\n    });\r\n\r\n    this.list_sparklineVizWidth = new Config<number>({\r\n      cfgClass: \"list_sparklineVizWidth\",\r\n      cfgTitle: \"Sparkline Width\",\r\n      iconClass: \"fa fa-chart-line\",\r\n      default: 120,\r\n      parent: this,\r\n      helparticle: \"5e87f16904286364bc97d0e2\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\r\n        { name: \"Off\", value: 0 },\r\n        { _type: \"_range_\", minValue: 50, maxValue: 300 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\r\n      ],\r\n      forcedValue: (obj) => {\r\n        if (!this.sortAttrib?.hasTimeSeriesParent()) return 0;\r\n        if (this.list_ViewType.is(\"Grid\") && obj._value !== 0)\r\n          return this.list_gridRecordWidth.get() - 10;\r\n      },\r\n      preSet: async (v, obj) => {\r\n        if (v === -99) {\r\n          v = obj._value - 5;\r\n        } else if (v === -199) {\r\n          v = obj._value + 5;\r\n        }\r\n        if (v < 50) return 0;\r\n        return Math.min(300, v);\r\n      },\r\n      onSet: (v) => {\r\n        if (!this.initialized) return;\r\n        this.browser.DOM.root\r\n          .node()\r\n          .style.setProperty(\"--list_sparklineVizWidth\", v + \"px\");\r\n        this.refreshSparklineVizWidth();\r\n      },\r\n    });\r\n\r\n    this.list_gridRecordWidth = new Config<number>({\r\n      cfgClass: \"list_gridRecordWidth\",\r\n      cfgTitle: \"Grid Record Width\",\r\n      iconClass: \"fa fa-arrows-h\",\r\n      default: 200,\r\n      parent: this,\r\n      helparticle: \"5f10800c04286306f806ee67\",\r\n      itemOptions: [\r\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\r\n        { _type: \"_range_\", minValue: 100, maxValue: 400 },\r\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\r\n      ],\r\n      preSet: async (v, obj) => {\r\n        if (v === -99) {\r\n          v = obj._value - 5;\r\n        } else if (v === -199) {\r\n          v = obj._value + 5;\r\n        }\r\n        return Math.max(100, Math.min(500, v));\r\n      },\r\n      onSet: (v) => {\r\n        if (!this.initialized) return;\r\n        this.browser.DOM.root\r\n          .node()\r\n          .style.setProperty(\"--list_gridRecordWidth\", v + \"px\");\r\n        this.refreshSparklineViz();\r\n      },\r\n    });\r\n\r\n    [\r\n      \"list_ViewType\",\r\n      \"list_sortInverse\",\r\n      \"list_showRank\",\r\n      \"list_sortColWidth\",\r\n      \"list_sortVizWidth\",\r\n      \"list_sortVizRange\",\r\n      \"list_sparklineVizWidth\",\r\n      \"list_gridRecordWidth\",\r\n    ].forEach((t) => {\r\n      this[t].val = config[t];\r\n      this.rd.configs[t] = this[t];\r\n      this.rd.recordConfigPanel.insertConfigUI(this[t]);\r\n    });\r\n\r\n    // Used in list view\r\n    this.maxVisibleItems_Default =\r\n      config.maxVisibleItems_Default || Base.maxVisibleItems_Default;\r\n    this.maxVisibleRecords = this.maxVisibleItems_Default; // This is the dynamic property\r\n  }\r\n\r\n  /** -- */\r\n  initView() {\r\n    this.rd.refreshAttribOptions(\"sort\");\r\n\r\n    this.DOM.root.attr(\"data-list_ViewType\", this.list_ViewType.get());\r\n\r\n    this.refreshSortColumnWidth();\r\n    this.refreshSortVizWidth();\r\n    this.refreshSparklineVizWidth();\r\n\r\n    this.DOM.kshfRecords = this.DOM.recordGroup_List.selectAll(\".kshfRecord\");\r\n\r\n    this.updateRecordSortScale();\r\n\r\n    this.refreshRecordVis();\r\n  }\r\n\r\n  async initView_DOM() {\r\n    var browserRootStyle = this.browser.DOM.root.node().style;\r\n\r\n    browserRootStyle.setProperty(\r\n      \"--list_sortColWidth\",\r\n      this.list_sortColWidth.get() + \"px\"\r\n    );\r\n    browserRootStyle.setProperty(\r\n      \"--list_sortVizWidth\",\r\n      this.list_sortVizWidth.get() + \"px\"\r\n    );\r\n    browserRootStyle.setProperty(\r\n      \"--list_sparklineVizWidth\",\r\n      this.list_sparklineVizWidth.get() + \"px\"\r\n    );\r\n    browserRootStyle.setProperty(\r\n      \"--list_gridRecordWidth\",\r\n      this.list_gridRecordWidth.get() + \"px\"\r\n    );\r\n\r\n    if (this.DOM.recordGroup_List) {\r\n      this.DOM.recordGroup = this.DOM.recordGroup_List.select(\".recordGroup\");\r\n      this.DOM.kshfRecords = this.DOM.recordGroup.selectAll(\".kshfRecord\");\r\n\r\n      this.DOM.tableHeaderGroup\r\n        .node()\r\n        .insertBefore(\r\n          this.DOM.sortControlGroup.node(),\r\n          this.DOM.tableConfigGap.node()\r\n        );\r\n\r\n      return;\r\n    }\r\n\r\n    this.DOM.recordGroup_List = this.rd.DOM.recordDisplayWrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordGroup_List\");\r\n\r\n    this.DOM.tableHeaderGroup = this.DOM.recordGroup_List\r\n      .append(\"div\")\r\n      .attr(\"class\", \"tableHeaderGroup\");\r\n\r\n    this.DOM.tableHeaderGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"showRecordRank\")\r\n      .append(\"span\")\r\n      .html(\"Rank\");\r\n\r\n    this.rd.DOM.sortControlGroup = this.DOM.tableHeaderGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"sortControlGroup attribControlGroup\");\r\n\r\n    this.rd.initDOM_AttribSelect(\"sort\");\r\n\r\n    this.rd.DOM.sortControlGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordReverseSortButton sortButton\")\r\n      .classed(\"sortInverse\", this.list_sortInverse.is(true))\r\n      .tooltip(i18n.ReverseOrder)\r\n      .on(\"click\", async () => await this.list_sortInverse.set(!this.list_sortInverse.get()) )\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa\");\r\n\r\n    this.DOM.tableConfigGap = this.DOM.tableHeaderGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"gap\");\r\n\r\n    var addMoreVisibleItems = () => {\r\n      this.maxVisibleRecords += this.maxVisibleItems_Default;\r\n      this.rd.refreshRecordDOM();\r\n    };\r\n\r\n    this.DOM.recordGroup = this.DOM.recordGroup_List\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordGroup\")\r\n      .on(\"scroll\", () => {\r\n        if (\r\n          this.maxVisibleRecords <= this.browser.allRecordsAggr.recCnt(\"Active\")\r\n        ) {\r\n          var DOM = this.DOM.recordGroup.node();\r\n          if (!this._recordGroupScroll) {\r\n            var s = window.getComputedStyle(DOM);\r\n            if (s.overflowY === \"hidden\" && s.overflowX === \"scroll\")\r\n              this._recordGroupScroll = \"left-right\";\r\n            else if (s.overflowX === \"hidden\" && s.overflowY === \"scroll\")\r\n              this._recordGroupScroll = \"top-down\";\r\n          }\r\n\r\n          if (this._recordGroupScroll === \"left-right\") {\r\n            if (DOM.scrollWidth - DOM.scrollLeft - DOM.offsetWidth < 500)\r\n              addMoreVisibleItems();\r\n          }\r\n          if (this._recordGroupScroll === \"top-down\") {\r\n            if (DOM.scrollHeight - DOM.scrollTop - DOM.offsetHeight < 10)\r\n              addMoreVisibleItems();\r\n          }\r\n        }\r\n      });\r\n\r\n    var adjustWidth = (event, configObj) => {\r\n      if (event.which !== 1) return; // only respond to left-click\r\n      var mouseDown_width = configObj.val - d3.pointer(event, document.body)[0];\r\n\r\n      this.browser.activateWidthDrag(event.currentTarget, event, (event2) => {\r\n        configObj.val = mouseDown_width + d3.pointer(event2, document.body)[0];\r\n      });\r\n    };\r\n\r\n    this.DOM.adjustSortColumnWidth = this.DOM.recordGroup_List\r\n      .append(\"div\")\r\n      .attr(\"class\", \"adjustSortColumnWidth dragWidthHandle\")\r\n      .on(\"mousedown\", (event) => adjustWidth(event, this.list_sortColWidth));\r\n\r\n    this.DOM.adjustSortVizWidth = this.DOM.recordGroup_List\r\n      .append(\"div\")\r\n      .attr(\"class\", \"adjustSortVizWidth dragWidthHandle\")\r\n      .on(\"mousedown\", (event) => adjustWidth(event, this.list_sortVizWidth));\r\n\r\n    this.DOM.adjustSparklineVizWidth = this.DOM.recordGroup_List\r\n      .append(\"div\")\r\n      .attr(\"class\", \"adjustSparklineVizWidth dragWidthHandle\")\r\n      .on(\"mousedown\", (event) =>\r\n        adjustWidth(event, this.list_sparklineVizWidth)\r\n      );\r\n\r\n    this.refreshSortVizWidth();\r\n    this.refreshWidthControls();\r\n  }\r\n\r\n  /** -- */\r\n  extendRecordDOM(newRecords) {\r\n    if (this.animatedList) {\r\n      newRecords.style(\r\n        \"transform\",\r\n        `translateY(${this.maxVisibleRecords * this.animatedRecordHeight}px)`\r\n      );\r\n    }\r\n\r\n    // RANKINGS\r\n    var _ = newRecords\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordRank\")\r\n      .tooltip(\"-\")\r\n      .on(\"mouseenter\", (event, record) => {\r\n        event.currentTarget.setAttribute(\r\n          \"title\",\r\n          Util.ordinal_suffix_of(record.recordRank + 1)\r\n        );\r\n      })\r\n      .append(\"span\");\r\n    this.refreshRecordRanks(_);\r\n    this.DOM.recordRanks = this.DOM.recordGroup.selectAll(\".recordRank > span\");\r\n\r\n    // RECORD CLICK CALLBACK - Used by multiple DOM nodes\r\n    var onRecordClick = (_event, record) => {\r\n      this.browser.recordDetailsPopup.updateRecordDetailPanel(record);\r\n      if (\r\n        this.sortAttrib instanceof Attrib_Numeric &&\r\n        this.sortAttrib.timeKey\r\n      ) {\r\n        this.browser.recordDetailsPopup.updateFocusedTimeKey(\r\n          this.sortAttrib.timeKey\r\n        );\r\n      }\r\n    };\r\n\r\n    // SORTING VALUE LABELS AND BARS\r\n\r\n    newRecords.append(\"div\").attr(\"class\", \"recordSparklineVizHost\");\r\n    newRecords\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordSortValue\")\r\n      .on(\"click\", onRecordClick);\r\n    newRecords\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordSortVizHost\")\r\n      .on(\"click\", onRecordClick)\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordSortViz\");\r\n\r\n    this.DOM.recordSortValue =\r\n      this.DOM.recordGroup.selectAll(\".recordSortValue\");\r\n    this.DOM.recordSortVizHost =\r\n      this.DOM.recordGroup.selectAll(\".recordSortVizHost\");\r\n    this.DOM.recordSortViz = this.DOM.recordGroup.selectAll(\".recordSortViz\");\r\n    this.DOM.recordSparklineVizHost = this.DOM.recordGroup.selectAll(\r\n      \".recordSparklineVizHost\"\r\n    );\r\n\r\n    this.refreshSortViz(newRecords);\r\n    this.refreshSparklineViz();\r\n\r\n    this.refreshSortingLabels(newRecords);\r\n\r\n    // Insert the content\r\n    newRecords\r\n      .append(\"div\")\r\n      .attr(\"class\", \"content\")\r\n      .html((record) => this.textAttrib.renderRecordValue(record))\r\n      .on(\"click\", onRecordClick);\r\n\r\n    newRecords\r\n      .append(\"svg\")\r\n      .attr(\"class\", \"compareBoxes\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n      .attr(\"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\r\n      .attr(\"viewBox\", \"-100 -100 200 200\")\r\n      .call((compareBoxes) => {\r\n        Base.Compare_List.forEach((cT) => {\r\n          compareBoxes.append(\"path\").attr(\"class\", \"glyph_\" + cT);\r\n        });\r\n      });\r\n\r\n    // Fixes ordering problem when new records are made visible on the list\r\n    // TO-DO: Try to avoid this.\r\n    this.DOM.recordGroup\r\n      .selectAll(\".kshfRecord\")\r\n      .data(this.getRecordsForDOM(), (record: Record) => record.id)\r\n      .order();\r\n  }\r\n\r\n  // temporary / internal\r\n  private _recordGroupScroll: string = null;\r\n\r\n  async finishSetAttrib(t: RecordVisCoding) {\r\n    if (t === \"sort\") {\r\n      this.sortRecords();\r\n\r\n      this.refreshSortVizWidth();\r\n\r\n      if (this.DOM.recordGroup_List) {\r\n        this.rd.refreshRecordDOM();\r\n        this.refreshRecordDOMOrder();\r\n        this.refreshRecordRanks();\r\n        this.refreshSortingLabels();\r\n        this.refreshSparklineViz();\r\n        if (this.rd.config.recordRefresh) {\r\n          this.DOM.kshfRecords.each((r) => {\r\n            this.rd.config.recordRefresh.call(r.data, r, this);\r\n          });\r\n        }\r\n      }\r\n    }\r\n    if (t === \"text\") {\r\n      this.DOM.kshfRecords\r\n        .selectAll(\".content\")\r\n        .html((record) => this.textAttrib.renderRecordValue(record));\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Record sorting\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  reverseOrder() {\r\n    this.browser.records.reverse();\r\n\r\n    var arr = this.browser.records;\r\n    var maxLoop = arr.length;\r\n    for (var i = 0; i < maxLoop; i++) {\r\n      var v = this.sortAttrib.getRecordValue(arr[0]);\r\n      if (v === null || v === undefined) {\r\n        arr.push(arr.shift());\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n\r\n    this.refreshRecordVis();\r\n    this.refreshRecordDOMOrder();\r\n  }\r\n\r\n  /** Sort all records given the active sort option\r\n   *  Records are only sorted on init & when active sorting option changes.\r\n   *  They are not resorted on filtering.\r\n   */\r\n  sortRecords() {\r\n    var attrib = this.sortAttrib;\r\n    if (!attrib) return;\r\n\r\n    var sortFunc = this.getSortFunc(attrib.template.func);\r\n\r\n    var inverse = this.list_sortInverse.is(true);\r\n\r\n    this.browser.records.sort((record_A, record_B) => {\r\n      var v_a = attrib.getRecordValue(record_A);\r\n      var v_b = attrib.getRecordValue(record_B);\r\n\r\n      if (v_a == null && v_b != null) return 1;\r\n      if (v_b == null && v_a != null) return -1;\r\n      if (v_b == null && v_a == null) return 0;\r\n\r\n      // Don't move filtered-out records to end of the list, keep them in sorted order\r\n      // This way, you don't need to re-order after filtering, which is a nice property to have.\r\n\r\n      var dif = sortFunc(v_a, v_b);\r\n      return inverse ? -dif : dif;\r\n    });\r\n\r\n    this.updateRecordRanks();\r\n  }\r\n\r\n  /** Returns the sort value type for given sort Value function */\r\n  getSortFunc(sortValueFunc) {\r\n    // 0: string, 1: date, 2: others\r\n    var sortValueFunction = Util.sortFunc_List_Number;\r\n\r\n    // find appropriate sortvalue type\r\n    for (var k = 0, same = 0; true; k++) {\r\n      if (same === 3 || k === this.browser.records.length) break;\r\n      var item = this.browser.records[k];\r\n      var f = sortValueFunc.call(item.data, item);\r\n      if (f == null || f === \"\") continue;\r\n      var sortValueType_temp2;\r\n      switch (typeof f) {\r\n        case \"string\":\r\n          sortValueType_temp2 = Util.sortFunc_List_String;\r\n          break;\r\n        case \"number\":\r\n          sortValueType_temp2 = Util.sortFunc_List_Number;\r\n          break;\r\n        case \"object\":\r\n          if (f instanceof Date) sortValueType_temp2 = Util.sortFunc_List_Date;\r\n          else sortValueType_temp2 = Util.sortFunc_List_Number;\r\n          break;\r\n        default:\r\n          sortValueType_temp2 = Util.sortFunc_List_Number;\r\n          break;\r\n      }\r\n\r\n      if (sortValueType_temp2 === sortValueFunction) {\r\n        same++;\r\n      } else {\r\n        sortValueFunction = sortValueType_temp2;\r\n        same = 0;\r\n      }\r\n    }\r\n    return sortValueFunction;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Record ranking\r\n  // ********************************************************************\r\n\r\n  private maxVisibleItems_Default: number;\r\n  maxVisibleRecords: number;\r\n\r\n  /** -- */\r\n  updateRecordRanks() {\r\n    var wantedRank = 0;\r\n    var unwantedRank = -1;\r\n    var lastValue = null;\r\n    var lastRank = null;\r\n\r\n    // records are sorted, and iterated from top to bottom\r\n    this.browser.records.forEach((record: Record) => {\r\n      var v = this.sortAttrib.getRecordValue(record);\r\n\r\n      if (v instanceof Date) v = v.getTime();\r\n\r\n      // Records with the same value have the same \"rank\".\r\n      // Once there value changes, ranking resumes from \"total\" ranks, counting each same-rank record separately.\r\n      record.recordRank = record.isIncluded\r\n        ? v === lastValue\r\n          ? lastRank\r\n          : wantedRank\r\n        : unwantedRank;\r\n\r\n      record.recordRank_Unique = record.isIncluded ? wantedRank : unwantedRank;\r\n\r\n      if (record.isIncluded && v !== lastValue) {\r\n        lastValue = v;\r\n        lastRank = record.recordRank;\r\n      }\r\n\r\n      if (record.isIncluded) {\r\n        wantedRank++;\r\n      } else {\r\n        unwantedRank--;\r\n      }\r\n    });\r\n\r\n    this.maxVisibleRecords = this.maxVisibleItems_Default;\r\n  }\r\n\r\n  /** -- */\r\n  refreshShowRank() {\r\n    this.DOM.root.classed(\"showRank\", this.list_showRank.is(true));\r\n    this.refreshRecordRanks();\r\n    this.refreshWidthControls();\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordRanks(d3_selection = null) {\r\n    if (this.list_showRank.is(false)) return;\r\n    if (d3_selection === null) d3_selection = this.DOM.recordRanks;\r\n    d3_selection.text((record) =>\r\n      record.recordRank < 0 ? \"\" : record.recordRank + 1\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  updateRecordVisibility() {\r\n    this.DOM.kshfRecords.classed(\r\n      \"rankBeyondListRange\",\r\n      (record) =>\r\n        record.recordRank < 0 || record.recordRank >= this.maxVisibleRecords\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  getRecordsForDOM() {\r\n    return this.browser.records.filter(\r\n      (record: Record) =>\r\n        !record.filteredOut && record.recordRank < this.maxVisibleRecords\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshWidthControls() {\r\n    if (!this.rd.codeBy.sort) return;\r\n\r\n    var w_Rank = this.list_showRank.is(true) ? Base.recordRankWidth : 0;\r\n    var w_sortCol = this.list_sortColWidth.get();\r\n    var w_sortViz = this.list_sortVizWidth.get();\r\n    var w_sparkLine = this.list_sparklineVizWidth.get()\r\n      ? this.list_sparklineVizWidth.get() + 8\r\n      : 0;\r\n\r\n    this.DOM.adjustSparklineVizWidth?.style(\r\n      \"transform\",\r\n      `translateX(${w_Rank + w_sparkLine}px`\r\n    );\r\n    this.DOM.adjustSortColumnWidth?.style(\r\n      \"transform\",\r\n      `translateX(${w_Rank + w_sparkLine + w_sortCol}px)`\r\n    );\r\n    this.DOM.adjustSortVizWidth?.style(\r\n      \"transform\",\r\n      `translateX(${w_Rank + w_sparkLine + w_sortCol + w_sortViz}px)`\r\n    );\r\n\r\n    var w = Math.max(\r\n      150,\r\n      Math.min(500, w_sparkLine + w_sortCol + w_sortViz + 2)\r\n    ); // 2 pixel: margin\r\n    if (this.list_ViewType.is(\"Grid\")) {\r\n      w = 200;\r\n    }\r\n\r\n    this.DOM.sortControlGroup?.select(\".choices\").style(\"width\", w + \"px\");\r\n  }\r\n\r\n  /** -- */\r\n  refreshSortVizScale() {\r\n    var attrib = this.sortAttrib;\r\n    if (!(attrib instanceof Attrib_Numeric)) {\r\n      return; // invalid if not sorting using numeric attribute\r\n    }\r\n\r\n    this.listSortVizScale = d3\r\n      .scaleLinear()\r\n      .range([0, this.list_sortVizWidth.get()]);\r\n\r\n    if (attrib.isPercentageUnit()) {\r\n      // always 0-100 if percentage unit\r\n      this.listSortVizScale.domain([0, 100]);\r\n      //\r\n    } else if (this.list_sortVizRange.is(\"dynamic\")) {\r\n      // dynamic - based on filtered data\r\n      var [minV, maxV] = d3.extent(this.browser.records, (record) => {\r\n        return record.filteredOut\r\n          ? null\r\n          : this.sortAttrib.getRecordValue(record);\r\n      });\r\n      this.listSortVizScale.domain([Math.min(0, minV), Math.max(0, maxV)]);\r\n      //\r\n    } else if (this.list_sortVizRange.is(\"static\")) {\r\n      // static - based on original domain\r\n      this.listSortVizScale.domain(this.sortAttrib.rangeOrg);\r\n    }\r\n\r\n    this.refreshSortViz();\r\n  }\r\n\r\n  /** -- */\r\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\r\n    if (!this.isComparable()) return;\r\n\r\n    // Shows evenly spaces pies next to records, filling in colors of all comparisons\r\n    var arcGen = d3.arc().innerRadius(10).outerRadius(100).padAngle(0.15);\r\n\r\n    var records = this.DOM.kshfRecords.filter((record: Record) => {\r\n      if (!record.isIncluded) return false;\r\n      if (!record.DOM.record) return false;\r\n      if (cT && record.isSelected(cT) !== status) return false;\r\n      return true;\r\n    });\r\n\r\n    if (cT) {\r\n      records = records.filter(\r\n        (record: Record) => record.isSelected(cT) !== status\r\n      );\r\n    }\r\n\r\n    records.each((record: Record) => {\r\n      var numPies = record.activeComparisons.length || 1;\r\n\r\n      var arcLen = (2 * Math.PI) / numPies;\r\n\r\n      var d = d3.select(record.DOM.record);\r\n      record.activeComparisons.forEach((cT, i) => {\r\n        d.select(\".glyph_\" + cT).attr(\r\n          \"d\",\r\n          arcGen({\r\n            startAngle: arcLen * i,\r\n            endAngle: arcLen * (i + 1),\r\n          })\r\n        );\r\n      });\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  refreshSortColumnWidth() {\r\n    this.refreshWidthControls();\r\n  }\r\n\r\n  /** -- */\r\n  refreshSortVizWidth() {\r\n    this.refreshSortVizScale();\r\n\r\n    this.DOM.root.classed(\"showSortBars\", this.list_sortVizWidth.get() > 0);\r\n\r\n    this.refreshWidthControls();\r\n  }\r\n\r\n  /** -- */\r\n  refreshSparklineVizWidth() {\r\n    if (!this.DOM.recordSparklineVizHost) return;\r\n    this.DOM.recordSparklineVizHost.style(\r\n      \"display\",\r\n      this.list_sparklineVizWidth.get() === 0 ? \"none\" : null\r\n    );\r\n\r\n    this.refreshSparklineViz();\r\n    this.refreshWidthControls();\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordVis() {\r\n    this.updateRecordRanks();\r\n    this.rd.refreshRecordDOM();\r\n    this.animateList();\r\n    this.refreshRecordRanks();\r\n    this.refreshSortViz();\r\n    this.refreshSparklineViz();\r\n  }\r\n\r\n  /** -- */\r\n  refreshSortViz(d3_selection = null) {\r\n    var dom = d3_selection\r\n      ? d3_selection.select(\".recordSortViz\")\r\n      : this.DOM.recordSortViz;\r\n\r\n    if (!dom || dom.nodes().length === 0) return;\r\n\r\n    if (!(this.sortAttrib instanceof Attrib_Numeric)) {\r\n      dom.style(\"width\", \"0px\").style(\"left\", null);\r\n      return;\r\n    }\r\n\r\n    var zeroPos = this.listSortVizScale(0);\r\n\r\n    dom.style(\"transform\", (record) => {\r\n      var v = this.sortAttrib.getRecordValue(record);\r\n      return `translate(${\r\n        v >= 0 ? zeroPos : this.listSortVizScale(v)\r\n      }px, 0px) scale(${\r\n        v == null ? 0 : Math.abs(this.listSortVizScale(v) - zeroPos)\r\n      },1)`;\r\n    });\r\n  }\r\n\r\n  refreshSparklineViz() {\r\n    var attrib = this.sortAttrib;\r\n    if (!attrib) return;\r\n    if (!(attrib instanceof Attrib_Numeric)) return;\r\n    if (!attrib.hasTimeSeriesParent()) return;\r\n    if (!this.DOM.recordSparklineVizHost) return;\r\n\r\n    this.DOM.recordSparklineVizHost.style(\r\n      \"display\",\r\n      this.list_sparklineVizWidth.get() === 0 ? \"none\" : null\r\n    );\r\n    if (this.list_sparklineVizWidth.get() === 0) return;\r\n\r\n    var ts = attrib.timeseriesParent;\r\n\r\n    var timeScale = d3\r\n      .scaleTime()\r\n      .domain(ts.timeSeriesScale_Time.domain())\r\n      .range([0, this.list_sparklineVizWidth.get()]);\r\n\r\n    var valueScale = d3\r\n      .scaleLinear()\r\n      .domain(ts.timeSeriesScale_Value.domain())\r\n      .rangeRound([27, 3]);\r\n\r\n    var activeTime = attrib.timeKey._time;\r\n\r\n    var dotPosition = (record, i, nodes) => {\r\n      var v = attrib.getRecordValue(record);\r\n      if (v == null) return \"translate(-1000,0)\"; // not visible\r\n      var x = timeScale(activeTime);\r\n      var lineData = ts.getRecordValue(record);\r\n      valueScale.domain(lineData.extent_Value_raw);\r\n      var y = valueScale(v);\r\n      nodes[i].classList[y > 13 ? \"add\" : \"remove\"](\"upper\");\r\n      return `translate(${x},${y})`;\r\n    };\r\n\r\n    this.DOM.recordSparklineVizHost.selectAll(\"*\").remove();\r\n    var _ = this.DOM.recordSparklineVizHost\r\n      .append(\"svg\")\r\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n      .on(\"mouseleave\", (event) => {\r\n        d3.select(event.currentTarget.children[1]).attr(\r\n          \"transform\",\r\n          dotPosition\r\n        );\r\n      })\r\n      .on(\"mousemove\", (event) => {\r\n        var _time = timeScale.invert(d3.pointer(event, event.currentTarget)[0]);\r\n        var currentDif = 9999999999999; // large number\r\n        var nearestTimeKey = ts.timeKeys[0];\r\n        ts.timeKeys.some((_key) => {\r\n          // _keys are sorted from early to late\r\n          var timeDif = Math.abs(+_key._time - +_time);\r\n          if (timeDif > currentDif) return true; // difference increases, we had just found the right key\r\n          currentDif = timeDif;\r\n          nearestTimeKey = _key;\r\n          return false;\r\n        });\r\n        d3.select(event.currentTarget.children[1]).attr(\r\n          \"transform\",\r\n          (record, i, nodes) => {\r\n            var x = timeScale(nearestTimeKey._time);\r\n            var _ = ts.getRecordValue(record);\r\n            valueScale.domain(_.extent_Value_raw);\r\n            var tk = _._timeseries_.find(\r\n              (x) => x._time_src === nearestTimeKey._time_src\r\n            );\r\n            let v = tk ? tk._value : null;\r\n            var y = valueScale(v);\r\n            if (y == null) return \"translate(-100,-100)\"; // No value / no dot / out of screen\r\n            var DOM = nodes[i];\r\n            if (y > 13) DOM.classList.add(\"upper\");\r\n            else DOM.classList.remove(\"upper\");\r\n            return `translate(${x},${y})`;\r\n          }\r\n        );\r\n        d3.select(event.currentTarget.children[1].children[1]).text(\r\n          nearestTimeKey._time_src\r\n        );\r\n      });\r\n\r\n    _.append(\"path\")\r\n      .attr(\"class\", \"timeline\")\r\n      .attr(\"d\", (record) => {\r\n        var lineData = ts.getRecordValue(record);\r\n        if (!lineData || !lineData.extent_Value_raw) return;\r\n        valueScale.domain(lineData.extent_Value_raw);\r\n        return Util.getLineGenerator(\r\n          timeScale,\r\n          valueScale\r\n        )(ts.getRecordValue(record)?._timeseries_);\r\n      });\r\n\r\n    var __ = _.append(\"g\")\r\n      .attr(\"transform\", dotPosition)\r\n      .on(\"click\", async (event) => {\r\n        var _time = timeScale.invert(\r\n          d3.pointer(event, event.currentTarget.parentNode)[0]\r\n        );\r\n        var currentDif = 9999999999999; // large number\r\n        var nearestTimeKey = ts.timeKeys[0];\r\n        ts.timeKeys.some((_key) => {\r\n          // _keys are sorted from early to late\r\n          var timeDif = Math.abs(+_key._time - _time);\r\n          if (timeDif > currentDif) return true; // difference increases, we had just found the right key\r\n          currentDif = timeDif;\r\n          nearestTimeKey = _key;\r\n          return false;\r\n        });\r\n        await this.rd.currentTimeKey.set(nearestTimeKey);\r\n      });\r\n\r\n    __.append(\"circle\").attr(\"class\", \"activeDot\").attr(\"r\", 3);\r\n    __.append(\"text\")\r\n      .attr(\"class\", \"timekeyText\")\r\n      .attr(\"y\", 15)\r\n      .text(attrib.timeKey._time_src);\r\n  }\r\n\r\n  animatedList: boolean = false; // TEMP\r\n  animatedRecordHeight: 40;\r\n\r\n  /** -- */\r\n  animateList() {\r\n    if (!this.animatedList) return;\r\n    this.DOM.recordGroup_List.classed(\"animatedList\", true);\r\n    this.DOM.kshfRecords.style(\r\n      \"transform\",\r\n      (record) =>\r\n        `translateY(${record.recordRank_Unique * this.animatedRecordHeight}px)`\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordDOMOrder() {\r\n    if (!this.animatedList) {\r\n      this.DOM.kshfRecords = this.DOM.recordGroup\r\n        .selectAll(\".kshfRecord\")\r\n        .data(this.browser.records, (record) => record.id)\r\n        .order();\r\n    }\r\n    Util.scrollToPos_do(this.DOM.recordGroup, 0);\r\n    this.animateList();\r\n  }\r\n\r\n  /** -- */\r\n  refreshSortingLabels(d3_selection = null) {\r\n    if (!this.sortAttrib) return;\r\n    var sortLabel = this.sortAttrib.sortLabel;\r\n    var dom = d3_selection\r\n      ? d3_selection.selectAll(\".recordSortValue\")\r\n      : this.DOM.recordSortValue;\r\n    if (!dom) return;\r\n    dom.html((record) => {\r\n      var v = sortLabel.call(this, record);\r\n      return v === \"\" || v === null || v === \"NaN\" ? \"N/A\" : v;\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  updateAfterFilter() {\r\n    this.DOM.recordGroup.node().scrollTop = 0;\r\n    if (this.list_sortVizRange.is(\"dynamic\")) {\r\n      this.refreshSortVizScale();\r\n    }\r\n    this.refreshRecordVis();\r\n  }\r\n\r\n  /** -- */\r\n  updateRecordSortScale() {\r\n    this.DOM.root.attr(\r\n      \"sortAttribType\",\r\n      this.sortAttrib instanceof Attrib_Numeric ? \"numeric\" : \"time\"\r\n    );\r\n    this.DOM.root.classed(\r\n      \"sortAttribOnTimeseries\",\r\n      (this.sortAttrib instanceof Attrib_Numeric &&\r\n        this.sortAttrib.timeseriesParent?.timeKeys.length > 1) ||\r\n        null\r\n    );\r\n  }\r\n\r\n  refreshAttribUnitName(attrib: Attrib) {\r\n    if (\r\n      attrib === this.sortAttrib ||\r\n      (this.sortAttrib instanceof Attrib_Numeric &&\r\n        attrib === this.sortAttrib.timeseriesParent)\r\n    ) {\r\n      this.refreshSortingLabels();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // No-op's\r\n  // ********************************************************************\r\n\r\n  refreshViewSize(_delayMS: number): void {}\r\n}\r\n","import noUiSlider from \"nouislider/dist/nouislider.mjs\";\r\nimport \"nouislider/dist/nouislider.css\";\r\nimport { DateTime } from \"luxon/build/es6/luxon\";\r\n\r\nimport { select } from \"./d3_select\";\r\nimport { scaleLinear, scaleSqrt, scaleThreshold, scaleTime } from \"d3-scale\";\r\nimport { max, extent, quantile } from \"d3-array\";\r\nimport { easePolyInOut } from \"d3-ease\";\r\nimport { format } from \"d3-format\";\r\nimport { hsl } from \"d3-color\";\r\nimport { arc } from \"d3-shape\";\r\n\r\nimport { TimeData, TimeKey } from \"./TimeSeriesData\";\r\n\r\nimport { Filter_Record, Filter_Text } from \"./Filter\";\r\nimport { Config } from \"./Config\";\r\nimport { Util } from \"./Util\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Modal } from \"./UI/Modal\";\r\nimport { AttribDropdown } from \"./UI/AttribDropdown\";\r\nimport { ConfigPanel } from \"./UI/ConfigPanel\";\r\nimport { Browser, ColorThemeType } from \"./Browser\";\r\nimport { Base } from \"./Base\";\r\nimport { Aggregate_PointCluster, Attrib_RecordGeo } from \"./Attrib_RecordGeo\";\r\n\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\n\r\nimport { Record } from \"./Record\";\r\nimport { RecordView } from \"./RecordView\";\r\nimport { RecordView_Timeseries } from \"./RecordView_Timeseries\";\r\nimport { RecordView_Map } from \"./RecordView_Map\";\r\nimport { RecordView_Scatter } from \"./RecordView_Scatter\";\r\nimport { RecordView_List } from \"./RecordView_List\";\r\n\r\nimport {\r\n  CompareType,\r\n  IntervalT,\r\n  RecordDisplayType,\r\n  RecordVisCoding,\r\n} from \"./Types\";\r\n\r\nconst d3 = {\r\n  select,\r\n  scaleLinear,\r\n  scaleSqrt,\r\n  scaleThreshold,\r\n  scaleTime,\r\n  max,\r\n  extent,\r\n  quantile,\r\n  easePolyInOut,\r\n  format,\r\n  hsl,\r\n  arc,\r\n};\r\n\r\ndeclare let L: any;\r\n\r\n/** -- */\r\nexport class RecordDisplay {\r\n  readonly browser: Browser;\r\n\r\n  // ********************************************************************\r\n  // record vis mapping attributes\r\n  // ********************************************************************\r\n\r\n  codeBy: {\r\n    text: Attrib_Categorical;\r\n    textBrief: Attrib_Categorical;\r\n    // numeric\r\n    sort: Attrib_Interval<IntervalT>;\r\n    scatterX: Attrib_Numeric;\r\n    scatterY: Attrib_Numeric;\r\n    // if coloring aggregates, can be set to \"_measure_\", whioch links to active measure attrib\r\n    size: Attrib_Numeric | \"_measure_\";\r\n    color: Attrib_Numeric | \"_measure_\";\r\n    // timeseries\r\n    timeSeries: Attrib_Timeseries;\r\n    // geo\r\n    geo: Attrib_RecordGeo;\r\n  } = {\r\n    text: null,\r\n    textBrief: null,\r\n    sort: null,\r\n    scatterX: null,\r\n    scatterY: null,\r\n    size: null,\r\n    color: null,\r\n    timeSeries: null,\r\n    geo: null,\r\n  };\r\n\r\n  // ********************************************************************\r\n  // Color control (shared)\r\n  // ********************************************************************\r\n\r\n  invertedColorTheme: boolean = false;\r\n  recordColorStepTicks: boolean = false;\r\n  recordColorScale: any = null;\r\n  recordColorScaleTicks: any = null;\r\n  mapColorScalePos: any = null;\r\n\r\n  // ********************************************************************\r\n  // Time keys / current key (used for synchronizing time keys)\r\n  // ********************************************************************\r\n\r\n  timeKeys: TimeKey[] = [];\r\n  currentTimeKey: Config<TimeKey>;\r\n  timeKeySlider: any;\r\n  timeKeySlider_PauseUpdate: boolean = true;\r\n\r\n  // ********************************************************************\r\n  // Point-based records\r\n  // ********************************************************************\r\n\r\n  recordPointSize: Config<number>;\r\n  recordRadiusScale: any;\r\n  recordDrawArc: any;\r\n  drawArc: any;\r\n\r\n  // ********************************************************************\r\n  // ...\r\n  // ********************************************************************\r\n\r\n  // general text filter (on text attribute)\r\n  textFilter: Filter_Text = null;\r\n  // record filter: to filter out individual records\r\n  recordFilter: Filter_Record = null;\r\n\r\n  collapsed: boolean = false;\r\n\r\n  DOM: { [index: string]: any } = {};\r\n\r\n  View: RecordView; // TODO\r\n  Views: { [index: string]: RecordView } = {};\r\n\r\n  config: any; // TODO\r\n\r\n  recordConfigPanel: ConfigPanel; // TODO\r\n\r\n  configs: { [index: string]: Config<any> } = {};\r\n\r\n  visMouseMode: \"pan\" | \"draw\" | \"filter\" = \"pan\";\r\n\r\n  async setView(_type: RecordDisplayType) {\r\n    if (_type === \"none\") {\r\n      this.View = null;\r\n      return;\r\n    }\r\n\r\n    // Create the view object if it does not exist.\r\n    if (!this.Views[_type]) {\r\n      var recordDisplayOptions = this.browser.options.recordDisplay || {};\r\n      if (_type === \"list\") {\r\n        this.Views[_type] = new RecordView_List(this, recordDisplayOptions);\r\n      } else if (_type === \"map\") {\r\n        this.Views[_type] = new RecordView_Map(this, recordDisplayOptions);\r\n      } else if (_type === \"scatter\") {\r\n        this.Views[_type] = new RecordView_Scatter(this, recordDisplayOptions);\r\n      } else if (_type === \"timeseries\") {\r\n        this.Views[_type] = new RecordView_Timeseries(\r\n          this,\r\n          recordDisplayOptions\r\n        );\r\n      }\r\n    }\r\n\r\n    this.View = this.Views[_type];\r\n\r\n    if (!this.codeBy.text) {\r\n      var potentials = this.browser.attribs.filter(\r\n        (attrib) => attrib instanceof Attrib_Categorical\r\n      ) as Attrib_Categorical[];\r\n\r\n      if (potentials.length === 0) {\r\n        throw new Error(\"Data must have at least one categorical attribute.\");\r\n      }\r\n\r\n      // find the categorical attribute with most number of categories (i.e. most unique)\r\n      var mostUnique = potentials[0];\r\n      potentials.forEach((catAttr) => {\r\n        if (mostUnique._aggrs.length < catAttr._aggrs.length) {\r\n          mostUnique = catAttr;\r\n        }\r\n      });\r\n\r\n      this.codeBy.text = mostUnique;\r\n    }\r\n\r\n    this.recordConfigPanel.hide();\r\n\r\n    await this.View.initView_DOM();\r\n\r\n    await this.View.prepareAttribs();\r\n\r\n    this.refreshViewAsOptions();\r\n\r\n    this.View.initView();\r\n\r\n    this.View.initialized = true;\r\n\r\n    this.View.updateRecordVisibility();\r\n\r\n    this.refreshWidth();\r\n    this.View.refreshViewSize(10);\r\n  }\r\n\r\n  /** -- */\r\n  constructor(browser: Browser, config) {\r\n    this.browser = browser;\r\n\r\n    this.recordFilter = new Filter_Record(this.browser);\r\n\r\n    this.config = Object.assign({}, config);\r\n\r\n    if (this.config.mapUsePins !== false) {\r\n      this.config.mapUsePins = true;\r\n    }\r\n\r\n    this.recordPointSize = new Config<number>({\r\n      cfgClass: \"recordPointSize\",\r\n      cfgTitle: \"Point Size\",\r\n      iconClass: \"fa fa-dot\",\r\n      UI: { disabled: true },\r\n      default: Base.defaultRecordPointSize,\r\n      parent: this,\r\n      helparticle: \"5e8907cf2c7d3a7e9aea6499\",\r\n      preSet: async (v) => Math.max(0.5, Math.min(v, Base.maxRecordPointSize)),\r\n      onSet: async () => {\r\n        if (!this.recordPointSize) return;\r\n        this.updateRecordSizeScale();\r\n      },\r\n    });\r\n\r\n    this.currentTimeKey = new Config<TimeKey>({\r\n      cfgClass: \"currentTimeKey\",\r\n      cfgTitle: \"Focused Time Key\",\r\n      iconClass: \"fa fa-arrows-v\",\r\n      default: null,\r\n      parent: this,\r\n      UI: { disabled: true },\r\n      helparticle: \"5b37053a2c7d3a0fa9a3a30c\",\r\n      onRefreshDOM: () => {\r\n        if (!this.DOM.root) return;\r\n        this.DOM.root.classed(\"hasTimeKey\", this.hasTimeKey);\r\n\r\n        if (!this.currentTimeKey.get()) return;\r\n        if (!this.DOM.timeAnimation) return;\r\n        if (!this.hasTimeKey) return;\r\n\r\n        this.DOM.timeAnimation\r\n          .select(\".rangeTick-min\")\r\n          .text(this.timeKeys[0]._time_src);\r\n        this.DOM.timeAnimation\r\n          .select(\".rangeTick-max\")\r\n          .text(this.timeKeys[this.timeKeys.length - 1]._time_src);\r\n        this.DOM.timeAnimation\r\n          .select(\".rangeTick-cur\")\r\n          .text(this.currentTimeKey.get()._time_src)\r\n          .style(\r\n            \"left\",\r\n            (100 * this.currentTimeKey.get()._index) /\r\n              (this.timeKeys.length - 1) +\r\n              \"%\"\r\n          );\r\n\r\n        this.timeKeySlider_PauseUpdate = true;\r\n        this.timeKeySlider.updateOptions({\r\n          range: {\r\n            min: 0,\r\n            max: Math.max(1, this.timeKeys.length - 1),\r\n          },\r\n        });\r\n        this.timeKeySlider.setHandle(0, this.currentTimeKey.get()._index, false);\r\n        this.timeKeySlider_PauseUpdate = false;\r\n\r\n        this.DOM.timeAnimation\r\n          .select(\".timeKeySelect\")\r\n          .selectAll(\"option\")\r\n          .data(this.timeKeys, (d) => d._time)\r\n          .join(\r\n            (enter) => enter.append(\"option\").text((d) => d._time_src),\r\n            (update) => update,\r\n            (exit) => exit.remove()\r\n          )\r\n          .attr(\"selected\", (timeKey) =>\r\n            timeKey._time_src === this.currentTimeKey.get()._time_src\r\n              ? true\r\n              : null\r\n          );\r\n      },\r\n      preSet: async (v, obj) => {\r\n        if (v === \"previous\" && obj._value) {\r\n          v = this.timeKeys[obj._value._index - 1];\r\n        }\r\n\r\n        if (v === \"next\" && obj._value) {\r\n          v = this.timeKeys[obj._value._index + 1];\r\n        }\r\n\r\n        if (!v || !v._time_src) return;\r\n\r\n        // _index may have been updated. Better to refresh\r\n        v = this.timeKeys.find((_) => _._time_src === v._time_src);\r\n\r\n        if (!v) return;\r\n        return v;\r\n      },\r\n      onSet: async (v: TimeKey) => {\r\n        if (!v) return;\r\n\r\n        // sync timekey across all vis attributes\r\n        this.skipRefreshRecordVis = true;\r\n\r\n        (\r\n          [\"sort\", \"scatterX\", \"scatterY\", \"color\", \"size\"] as RecordVisCoding[]\r\n        ).forEach((_type) => {\r\n          var targetAttrib = this.codeBy[_type];\r\n          if (\r\n            targetAttrib instanceof Attrib_Numeric &&\r\n            targetAttrib.timeKey?._time_src !== v._time_src\r\n          ) {\r\n            // record visualizations are updated through these setting updates\r\n            this.setAttrib(\r\n              _type,\r\n              targetAttrib.timeseriesParent.getTimepointSummary({\r\n                _time_src: v._time_src,\r\n              })\r\n            );\r\n          }\r\n        });\r\n\r\n        this.skipRefreshRecordVis = false;\r\n\r\n        this.refreshRecordVis(); // refresh visualization ONCE after all attributes are updated.\r\n\r\n        // update measure attrib to use the same time key\r\n        if (this.measureSummary?.hasTimeSeriesParent()) {\r\n          var newMeasureSummary =\r\n            this.measureSummary.timeseriesParent.getTimepointSummary(v);\r\n          if (newMeasureSummary)\r\n            await this.browser.measureSummary.set(newMeasureSummary);\r\n        }\r\n\r\n        // timeKeyStep timeKeyNext\r\n        this.DOM.timeAnimation\r\n          .select(\".timeKeyPrev\")\r\n          .classed(\"active\", v._time_src !== this.timeKeys[0]._time_src);\r\n        this.DOM.timeAnimation\r\n          .select(\".timeKeyNext\")\r\n          .classed(\r\n            \"active\",\r\n            v._time_src !== this.timeKeys[this.timeKeys.length - 1]._time_src\r\n          );\r\n      },\r\n    });\r\n\r\n    [\"currentTimeKey\", \"recordPointSize\"].forEach((t) => {\r\n      this.configs[t] = this[t];\r\n      this[t].val = config[t];\r\n    });\r\n\r\n    if (config.timeSeriesAnnotations) {\r\n      var _converted = [];\r\n      Object.keys(config.timeSeriesAnnotations).forEach((_k) => {\r\n        var _v = config.timeSeriesAnnotations[_k];\r\n        var _t = DateTime.fromFormat(_v, DateTime.DATE_SHORT, { zone: \"UTC\" });\r\n        if (_t.isValid) {\r\n          _converted.push({ _time: _t.toJSDate(), _time_src: _k, _text: _v });\r\n        }\r\n      });\r\n      this.config.timeSeriesAnnotations = _converted;\r\n    }\r\n\r\n    config.timeseriesWidth = config.timeseriesWidth || 400;\r\n  }\r\n\r\n  /** Shortcut to access browser record chart type */\r\n  get viewRecAs(): RecordDisplayType {\r\n    return this.browser.recordChartType.get();\r\n  }\r\n\r\n  kshfRecords_Type: RecordDisplayType = \"none\";\r\n\r\n  async initialize() {\r\n    \"use strict\";\r\n    var config = this.config;\r\n\r\n    // **********************************************************************************\r\n    // **********************************************************************************\r\n    // **********************************************************************************\r\n\r\n    this.DOM.root = this.browser.DOM.root\r\n      .select(\".recordDisplay\")\r\n      .attr(\"visMouseMode\", this.visMouseMode);\r\n\r\n    this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"dropZone\")\r\n      .on(\"mouseenter\", function () {\r\n        this.classList.add(\"onReadyToDrop\");\r\n      })\r\n      .on(\"mouseleave\", function () {\r\n        this.classList.remove(\"onReadyToDrop\");\r\n      })\r\n      .on(\"mouseup\", async () => {\r\n        if (this.viewRecAs !== \"none\") {\r\n          return;\r\n        }\r\n        var attrib = this.browser.movedAttrib;\r\n        if (!attrib) return;\r\n\r\n        if (attrib instanceof Attrib_Categorical) {\r\n          await this.setAttrib(\"text\", attrib);\r\n          if (this.viewRecAs === \"none\") {\r\n            await this.browser.recordChartType.set(\"list\");\r\n          }\r\n        } else if (attrib instanceof Attrib_Timeseries) {\r\n          await this.setAttrib(\"timeSeries\", attrib);\r\n          await this.browser.recordChartType.set(\"timeseries\");\r\n          //\r\n        } else if (attrib instanceof Attrib_RecordGeo) {\r\n          await this.setAttrib(\"geo\", attrib);\r\n          await this.browser.recordChartType.set(\"map\");\r\n          //\r\n        } else if (attrib instanceof Attrib_Interval) {\r\n          await this.setAttrib(\"sort\", attrib);\r\n          if (this.viewRecAs === \"none\") {\r\n            await this.browser.recordChartType.set(\"list\");\r\n          }\r\n        }\r\n\r\n        this.browser.updateLayout();\r\n      })\r\n      .call((x) => {\r\n        x.append(\"div\").attr(\"class\", \"dropIcon fa fa-list-ul\");\r\n        x.append(\"span\")\r\n          .attr(\"class\", \"dropZoneText\")\r\n          .text(i18n[\"Add Record Panel\"]);\r\n      });\r\n\r\n    this.initDOM_RecordDisplayHeader();\r\n\r\n    // **************************************************\r\n    // TIME ANIMATION\r\n    this.DOM.timeAnimation = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"timeAnimation\");\r\n\r\n    this.DOM.recordDisplayWrapper = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordDisplayWrapper\");\r\n\r\n    this.initDOM_CustomControls();\r\n\r\n    this.recordConfigPanel = new ConfigPanel(\r\n      this.DOM.root,\r\n      \"Record Chart Configuration\",\r\n      \"recordDisplayConfig\",\r\n      Object.values(this.configs),\r\n      this.browser,\r\n      this.DOM.recordDisplayConfigButton\r\n    );\r\n\r\n    // always set record text attribute\r\n    await this.setAttrib(\"text\", config.textBy);\r\n    if (!this.codeBy.text) {\r\n      await this.setAttrib(\"text\", this.browser.idSummaryName);\r\n    }\r\n    await this.setAttrib(\"textBrief\", config.textBriefBy);\r\n\r\n    // *************************************************************************\r\n    // Initialize config options\r\n\r\n    for (var v in [\r\n      \"sort\",\r\n      \"scatterX\",\r\n      \"scatterY\",\r\n      \"color\",\r\n      \"size\",\r\n      \"link\",\r\n      \"timeSeries\",\r\n    ]) {\r\n      var _attrib: string = config[v + \"By\"];\r\n      if (_attrib) await this.setAttrib(v as RecordVisCoding, _attrib);\r\n    }\r\n\r\n    this.textFilter = new Filter_Text(this.browser);\r\n\r\n    if (config.colorTheme) {\r\n      this.setRecordColorTheme(config.colorTheme);\r\n    }\r\n\r\n    if (config.recordPointSize) {\r\n      await this.recordPointSize.set(config.recordPointSize);\r\n    }\r\n\r\n    if (config.colorInvert) {\r\n      this.invertColorTheme(true);\r\n    }\r\n\r\n    if (config.filter) {\r\n      this.recordFilter.importFilter(config.filter);\r\n    } else {\r\n      this.recordFilter.clearFilter();\r\n    }\r\n    \r\n    config.viewAs ??= \"none\";\r\n\r\n    if (config.viewAs !== this.viewRecAs) {\r\n      await this.browser.recordChartType.set(config.viewAs);\r\n    }\r\n\r\n    if (config.collapsed) {\r\n      this.collapseRecordViewSummary(true);\r\n    } else {\r\n      this.collapseRecordViewSummary(false);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshConfigs() {\r\n    Object.values(this.configs).forEach((cfg) => cfg.refresh());\r\n  }\r\n\r\n  curWidth: number;\r\n  curHeight: number;\r\n\r\n  setHeight(v) {\r\n    var oldHeight = this.curHeight;\r\n    this.curHeight = v;\r\n    if (this.viewRecAs === \"none\") return;\r\n    if (this.curHeight !== oldHeight) this.View.refreshViewSize(0);\r\n  }\r\n\r\n  setWidth(v) {\r\n    var oldWidth = this.curWidth;\r\n    this.curWidth = v;\r\n    if (this.viewRecAs === \"none\") return;\r\n    if (this.curWidth !== oldWidth) {\r\n      this.refreshWidth();\r\n      this.View.refreshViewSize(0);\r\n    }\r\n  }\r\n\r\n  refreshWidth() {\r\n    this.DOM.root\r\n      ?.classed(\"narrow\", this.curWidth < 500)\r\n      .classed(\"wide\", this.curWidth > 700)\r\n      .style(\"width\", this.curWidth + \"px\");\r\n  }\r\n\r\n  /** -- */\r\n  getNumOfColorScaleBins() {\r\n    return this.recordColorScale.range().length - 2;\r\n  }\r\n\r\n  /** -- */\r\n  get textAttrib_Brief(): Attrib_Categorical {\r\n    return this.codeBy.textBrief || this.codeBy.text;\r\n  }\r\n\r\n  /** -- */\r\n  get height_Header() {\r\n    if (!this.DOM.recordDisplayHeader) return 0;\r\n    return this.DOM.recordDisplayHeader.node().offsetHeight;\r\n  }\r\n\r\n  /** -- */\r\n  refreshCompareLegend() {\r\n    if (!this.DOM.colorCompareGroup) return;\r\n\r\n    this.DOM.colorCompareGroup.classed(\"active\", !!this.browser.comparedAttrib);\r\n\r\n    if (\r\n      !this.browser.comparedAttrib ||\r\n      !this.browser.comparedAttrib.attribName\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    var str =\r\n      \"<div class='comparedSummaryName'>\" +\r\n      this.browser.comparedAttrib.attribNameHTML +\r\n      \"</div>\";\r\n    str += \"<div class='compareBlocks'>\";\r\n    this.browser.activeComparisons.forEach((cT: CompareType) => {\r\n      str += `<div class='compareBlock'><span class='colorBox bg_${cT}'></span> \r\n        <span class='theText'>${this.browser.selectedAggrs[cT].label}</span></div>`;\r\n    });\r\n\r\n    // \"Other group\"\r\n    if (\r\n      this.browser.records.filter(\r\n        // TODO: depending on view type certain records may be excluded\r\n        // Example: Map: records with no geo. Timeseries : records with no timeseries, etc.\r\n        (x: Record) => !x.isSelected() && x.isIncluded\r\n      ).length\r\n    ) {\r\n      str +=\r\n        \"<div class='compareBlock'><span class='colorBox bg_Active'></span> \" +\r\n        `<span class='theText'>(${this.browser.otherNameInCompare})</span></div>`;\r\n    }\r\n    str += \"</div>\";\r\n    this.DOM.colorCompareGroup.html(str).classed(\"active\", true);\r\n  }\r\n\r\n  getColorValue(v) {\r\n    if (this.codeBy.color instanceof Attrib_Numeric) {\r\n      return this.codeBy.color.getFormattedValue(v);\r\n    } else {\r\n      return v;\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshColorLegend() {\r\n    if (!this.DOM.mapColorScaleGroup) return;\r\n\r\n    this.DOM.root\r\n      .select(\".editColorTheme.fa-adjust\")\r\n      .classed(\"rotatedY\", this.invertedColorTheme);\r\n\r\n    this.DOM.root.classed(\"usesColorAttrib\", this.codeBy.color != null);\r\n\r\n    if (!this.recordColorScale) return;\r\n    if (!this.codeBy.color) return;\r\n\r\n    var colorBins = this.recordColorScale.range();\r\n    // remove first and last color elements\r\n    colorBins = colorBins.slice(1, colorBins.length - 1);\r\n\r\n    var logScale = false;\r\n    if (this.codeBy.color === \"_measure_\") {\r\n      if (this.measureSummary?.isValueScale_Log) {\r\n        logScale = true;\r\n      }\r\n    } else {\r\n      if (this.codeBy.color.isValueScale_Log) {\r\n        logScale = true;\r\n      }\r\n    }\r\n\r\n    this.mapColorScalePos = Util.getD3Scale(logScale);\r\n\r\n    var totalDomain = this.recordColorScale.domain();\r\n    this.mapColorScalePos\r\n      .domain([totalDomain[0], totalDomain[totalDomain.length - 1]])\r\n      .range([0, 100]);\r\n\r\n    this.DOM.mapColorScaleBins.selectAll(\".mapColorThemeBin\").remove();\r\n    this.DOM.mapColorScaleBins\r\n      .selectAll(\".mapColorThemeBin\")\r\n      .data(colorBins)\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorThemeBin\")\r\n      .tooltip(\r\n        (_) => {\r\n          var d = this.recordColorScale.invertExtent(_);\r\n          return this.recordColorStepTicks\r\n            ? d[0]\r\n            : this.getColorValue(d[0]) + \" &mdash; \" + this.getColorValue(d[1]);\r\n        },\r\n        {\r\n          placement: \"bottom\",\r\n        }\r\n      )\r\n      .style(\"background-color\", (d) => d)\r\n      .style(\"transform\", (d, i) => {\r\n        var d = this.recordColorScale.invertExtent(d);\r\n        var left = this.mapColorScalePos(d[0]);\r\n        var right = this.mapColorScalePos(d[1]);\r\n        return `translateX(${left}%) scaleX(${Math.abs(right - left) / 100})`;\r\n      });\r\n\r\n    this.refreshColorLegendTicks();\r\n  }\r\n\r\n  /** -- */\r\n  refreshColorLegendTicks() {\r\n    if (!this.codeBy.color) return;\r\n    if (!this.recordColorScaleTicks) return;\r\n\r\n    var legendWidth = this.DOM.mapColorScaleLabels.node().offsetWidth;\r\n    var lastTickPos = -200;\r\n\r\n    var tickWidthGap = 30;\r\n\r\n    let c: Attrib_Numeric = null;\r\n\r\n    if (this.codeBy.color === \"_measure_\") {\r\n      var attrib = !this.browser.measureFunc_Count && this.measureSummary;\r\n      if (attrib) {\r\n        c = attrib;\r\n        tickWidthGap += attrib.unitName.length * 6;\r\n      }\r\n    } else {\r\n      c = this.codeBy.color;\r\n      tickWidthGap += this.codeBy.color.unitName.length * 6;\r\n    }\r\n\r\n    var _print = (v) => (c ? c.printAbbr(v) : v);\r\n\r\n    var ticks = this.recordColorScaleTicks.slice();\r\n    var offset = 0;\r\n    if (this.recordColorStepTicks) {\r\n      ticks.pop();\r\n      offset = 50 / ticks.length;\r\n    }\r\n\r\n    this.DOM.mapColorScaleLabels.selectAll(\".mapColorScaleLabel\").remove();\r\n    this.DOM.mapColorScaleLabels\r\n      .selectAll(\".mapColorScaleLabel\")\r\n      .data(ticks)\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorScaleLabel\")\r\n      .style(\"left\", (i) => offset + this.mapColorScalePos(i) + \"%\")\r\n      .classed(\"hidden\", (i) => {\r\n        var curTickPos = (legendWidth * this.mapColorScalePos(i)) / 100;\r\n        var visible = curTickPos - lastTickPos > tickWidthGap;\r\n        if (visible) lastTickPos = curTickPos;\r\n        return !visible;\r\n      })\r\n      .call((tick) => {\r\n        tick\r\n          .append(\"div\")\r\n          .attr(\"class\", \"tickLabel\")\r\n          .html((i) => \"\" + _print(i));\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  invertColorTheme(v = null) {\r\n    this.invertedColorTheme = v == null ? !this.invertedColorTheme : v;\r\n    this.updateRecordColorScale();\r\n  }\r\n\r\n  /** -- */\r\n  setRecordColorTheme(v: ColorThemeType) {\r\n    this.browser.activeColorTheme = v;\r\n    this.updateRecordColorScale();\r\n  }\r\n\r\n  /** -- */\r\n  initDOM_RecordDisplayHeader() {\r\n    this.DOM.recordDisplayHeader = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordDisplayHeader\");\r\n\r\n    // Remove record display button\r\n    this.DOM.removeRecordPanelButton = this.DOM.recordDisplayHeader\r\n      .append(\"div\")\r\n      .attr(\"class\", \"removeRecordPanelButton fa fa-times-circle\")\r\n      .tooltip(i18n.RemoveRecordPanel, { placement: \"bottom\" })\r\n      .on(\"click\", async () => await this.browser.recordChartType.set(\"none\") );\r\n\r\n    // Expand record display button\r\n    this.DOM.recordDisplayHeader\r\n      .append(\"div\")\r\n      .attr(\"class\", \"buttonRecordViewExpand fa fa-expand-alt\")\r\n      .tooltip(i18n.OpenSummary, { placement: \"bottom\" })\r\n      .on(\"click\", () => this.collapseRecordViewSummary(false));\r\n\r\n    // Collapse record display button\r\n    this.DOM.recordDisplayHeader\r\n      .append(\"div\")\r\n      .attr(\"class\", \"buttonRecordViewCollapse fa fa-compress-alt\")\r\n      .tooltip(i18n.CollapseSummary, { placement: \"bottom\" })\r\n      .on(\"click\", () => this.collapseRecordViewSummary(true));\r\n\r\n    this.initDOM_GlobalTextSearch();\r\n\r\n    // Record Name\r\n    this.DOM.recordDisplayHeader\r\n      .append(\"div\")\r\n      .attr(\"class\", \"recordName recordDisplayName\")\r\n      .html(this.browser.recordName);\r\n\r\n    this.DOM.recordDisplayConfigButton = this.DOM.recordDisplayHeader\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordDisplayConfigButton fa fa-cog\")\r\n      .tooltip(i18n.Configure)\r\n      .on(\"click\", (event) => {\r\n        this.recordConfigPanel.showAtPos(\r\n          event.target.offsetLeft + 25,\r\n          event.target.offsetTop + 25\r\n        );\r\n      });\r\n\r\n    // Change record display view\r\n    var x = this.DOM.recordDisplayHeader\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordDisplay_ViewGroup\");\r\n    x.selectAll(\"span.fa\")\r\n      .data([\r\n        {\r\n          v: \"list\",\r\n          t: i18n.ListButton,\r\n          i: \"<span class='fa fa-list-ul'></span>\",\r\n        },\r\n        {\r\n          v: \"map\",\r\n          t: i18n.MapButton,\r\n          i: \"<span class='fa fa-globe'></span>\",\r\n        },\r\n        {\r\n          v: \"node\",\r\n          t: i18n.NodeButton,\r\n          i: \"<span class='fa fa-share-alt'></span>\",\r\n        },\r\n        {\r\n          v: \"timeseries\",\r\n          t: i18n.TimeSeriesButton,\r\n          i: \"<span class='fa fa-chart-line'></span>\",\r\n        },\r\n        {\r\n          v: \"scatter\",\r\n          t: i18n.ScatterButton,\r\n          i: \"<span class='fa fa-chart-scatter'></span>\",\r\n        },\r\n      ])\r\n      .enter()\r\n      .append(\"span\")\r\n      .attr(\"class\", (d) => \"recordDisplay_ViewAs_\" + d.v + \" disabled\")\r\n      .tooltip((_) => i18n.RecordViewTypeTooltip(_.t), { placement: \"bottom\" })\r\n      .on(\"click\", async (_event, d) => await this.browser.recordChartType.set(d.v) )\r\n      .html((d) => d.i + \"<span class='ViewTitle'>\" + d.t + \"</span>\");\r\n  }\r\n\r\n  /** -- */\r\n  initDOM_GlobalTextSearch() {\r\n    this.DOM.recordTextSearch = this.DOM.recordDisplayHeader\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordTextSearch textSearchBox\");\r\n\r\n    this.DOM.recordTextSearch.append(\"span\").attr(\"class\", \"fa fa-search\");\r\n    this.DOM.recordTextSearch\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa fa-times-circle\")\r\n      .tooltip(i18n.RemoveFilter)\r\n      .on(\"click\", () => this.textFilter.clearFilter());\r\n    this.DOM.recordTextSearch\r\n      .append(\"input\")\r\n      .attr(\"type\", \"text\")\r\n      .attr(\"class\", \"textSearchInput\")\r\n      .tooltip(i18n.TextSearchForRecords)\r\n      .on(\"keydown\", (event) => event.stopPropagation())\r\n      .on(\"keypress\", (event) => event.stopPropagation())\r\n      .on(\"keyup\", (event) => {\r\n        var dom = event.currentTarget;\r\n        if (event.key === \"Enter\") {\r\n          dom.tippy.hide();\r\n          if (dom.timer) clearTimeout(dom.timer);\r\n          dom.timer = null;\r\n          this.textFilter.queryString = dom.value;\r\n          if (this.textFilter.queryString === \"\") {\r\n            this.textFilter.clearFilter();\r\n            return;\r\n          }\r\n          this.browser.clearSelect_Compare();\r\n          this.textFilter.setFiltered();\r\n          return;\r\n        }\r\n        event.stopPropagation();\r\n      });\r\n  }\r\n\r\n  getMaxSizeScaleRange() {\r\n    if (this.codeBy.size === \"_measure_\" && this.isPointMap()) {\r\n      return Math.max(\r\n        10,\r\n        Math.min(\r\n          this.recordPointSize.get(),\r\n          this.codeBy.geo.pointClusterRadius / 2\r\n        )\r\n      );\r\n    } else if (this.codeBy.size instanceof Attrib_Interval) {\r\n      return this.recordPointSize.get();\r\n    }\r\n    throw Error(\"Unexpected status\");\r\n  }\r\n\r\n  getMaxSizeDomainRange(): number {\r\n    if (this.codeBy.size === \"_measure_\" && this.isPointMap()) {\r\n      return (\r\n        d3.max(this.codeBy.geo._aggrs, (_: Aggregate_PointCluster) =>\r\n          _.measure(\"Active\")\r\n        ) || 1 // || 1: there may be no clusters\r\n      );\r\n    } else if (this.codeBy.size instanceof Attrib_Interval) {\r\n      return this.codeBy.size.valueScale.domain()[1];\r\n    }\r\n    throw Error(\"Unexpected status\");\r\n  }\r\n\r\n  /** -- */\r\n  updateRecordSizeScale() {\r\n    var constPointSize = Math.max(this.recordPointSize.get(), 4); // const size must be 4 or larger\r\n\r\n    this.drawArc = d3\r\n      .arc()\r\n      .outerRadius(constPointSize) // fixed radius arc by default\r\n      .innerRadius(0)\r\n      .startAngle(0)\r\n      .endAngle(2 * Math.PI);\r\n\r\n    var getArc = (v) => this.drawArc.outerRadius(this.recordRadiusScale(v));\r\n\r\n    if (this.codeBy.size === null) {\r\n      // Constant size, constant shape - both are functions returning constant values\r\n      this.recordRadiusScale = () => constPointSize;\r\n      this.recordDrawArc = () => this.drawArc;\r\n      //\r\n    } else {\r\n      this.recordRadiusScale = d3\r\n        .scaleSqrt()\r\n        .clamp(false)\r\n        .range([0, this.getMaxSizeScaleRange() * 2])\r\n        .domain([0, this.getMaxSizeDomainRange()]);\r\n\r\n      if (this.codeBy.size === \"_measure_\" && this.isPointMap()) {\r\n        // point map using measure as a size attribute\r\n        this.recordDrawArc = (record) => getArc(record.measure_Self);\r\n        //\r\n      } else if (this.codeBy.size instanceof Attrib_Interval) {\r\n        // point map usig regular numeric size attribute\r\n        var m = this.codeBy.size;\r\n        this.recordDrawArc = (record) => {\r\n          var v = m.template.func.call(record.data, record);\r\n          // in cases where point would be invisible/negligable, set very small so that it has a path\r\n          if (isNaN(v) || v == null || (m.isValueScale_Log && v <= 0))\r\n            v = 0.0001;\r\n          return getArc(v);\r\n        };\r\n      }\r\n    }\r\n\r\n    this.refreshSizeLegend();\r\n    this.View?.refreshRecordSizes();\r\n  }\r\n\r\n  /** -- */\r\n  initDOM_CustomControls() {\r\n    if (this.DOM.visViewControl) return;\r\n    var me = this;\r\n\r\n    var X, _;\r\n\r\n    // Scale legend\r\n    X = this.DOM.recordDisplayWrapper\r\n      .append(\"span\")\r\n      .attr(\"class\", \"mapGlyphColorSetting\");\r\n    this.DOM.mapGlyphColorSetting = X;\r\n\r\n    // Record point size\r\n    var sizeGroup = this.DOM.mapGlyphColorSetting\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attribGroup sizeGroup\")\r\n      .classed(\"active\", this.codeBy.size != null);\r\n\r\n    // Gap\r\n    this.DOM.mapGlyphColorSetting.append(\"div\").attr(\"class\", \"attribGap\");\r\n\r\n    // Record color (attrib)\r\n    this.DOM.colorCompareGroup = this.DOM.mapGlyphColorSetting\r\n      .append(\"div\")\r\n      .attr(\"class\", \"colorCompareGroup attribGroup\");\r\n\r\n    // Record color (compare)\r\n    var colorGroup = this.DOM.mapGlyphColorSetting\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attribGroup colorGroup\")\r\n      .classed(\"active\", this.codeBy.color != null);\r\n\r\n    // ****************************************************************\r\n    // ** SIZE ********************************************************\r\n\r\n    this.DOM.sizeControlGroup = sizeGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"sizeControlGroup attribControlGroup\");\r\n    sizeGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"dotSizes\")\r\n      .call((dom) => {\r\n        dom\r\n          .append(\"i\")\r\n          .attr(\"class\", \"dotSize dotSize-expand-alt fa fa-plus\")\r\n          .tooltip(i18n.Larger, { placement: \"top\" })\r\n          .on(\"click\", async () => {\r\n            await this.recordPointSize.set(this.recordPointSize.get() * Math.sqrt(2));\r\n          });\r\n        dom\r\n          .append(\"i\")\r\n          .attr(\"class\", \"dotSize dotSize-compress-alt fa fa-minus\")\r\n          .tooltip(i18n.Smaller, { placement: \"top\" })\r\n          .on(\"click\", async () => {\r\n            await this.recordPointSize.set(this.recordPointSize.get() / Math.sqrt(2));\r\n          });\r\n      });\r\n    this.DOM.sizeLegendGroup = sizeGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attribLegendGroup sizeLegendGroup\");\r\n\r\n    this.DOM.sizeControlGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"header\")\r\n      .text(i18n.Size + \" \");\r\n    this.initDOM_AttribSelect(\"size\");\r\n\r\n    // ****************************************************************\r\n    // ** COLOR *******************************************************\r\n\r\n    // Control\r\n    this.DOM.colorControlGroup = colorGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"colorControlGroup attribControlGroup\");\r\n    this.DOM.colorControlGroup\r\n      .append(\"span\")\r\n      .attr(\"class\", \"header\")\r\n      .text(i18n.Color + \" \");\r\n    this.initDOM_AttribSelect(\"color\");\r\n\r\n    this.DOM.mapColorScaleGroup = colorGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attribLegendGroup mapColorScaleGroup\");\r\n\r\n    // Invert color theme\r\n    colorGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"editColorTheme fa fa-paint-brush\")\r\n      .tooltip(i18n.ChangeColorTheme, { placement: \"left\" })\r\n      .on(\"click\", (event) => {\r\n        var addLegend = function (dom) {\r\n          var _theme = me.browser.activeColorTheme;\r\n          var _temp = me.browser.colorTheme[_theme];\r\n          me.browser.colorTheme[_theme] = this.value;\r\n          var colors = me.browser.colorTheme.getDiscrete(9);\r\n          me.browser.colorTheme[_theme] = _temp;\r\n          if (me.invertedColorTheme) colors = colors.reverse();\r\n\r\n          d3.select(dom)\r\n            .append(\"div\")\r\n            .attr(\"class\", \"colorLegend\")\r\n            .selectAll(\".colorLegendBox\")\r\n            .data(colors)\r\n            .enter()\r\n            .append(\"span\")\r\n            .attr(\"class\", \"colorLegendBox\")\r\n            .style(\"background-color\", (_) => _);\r\n        };\r\n\r\n        Modal.popupMenu(\r\n          event,\r\n          {\r\n            name: \"Color Theme\",\r\n            items: [\r\n              {\r\n                id: \"colorThemeInverse\",\r\n                name: \"Invert\",\r\n                iconClass: \"fa fa-adjust\",\r\n                active: this.invertedColorTheme,\r\n                do: () => this.invertColorTheme(),\r\n              },\r\n              {\r\n                id: \"colorScaleScale\",\r\n                name: \"BinScale\",\r\n                iconClass: \"fa fa-arrows-h\",\r\n                when: () =>\r\n                  this.codeBy.color &&\r\n                  this.codeBy.color instanceof Attrib_Numeric &&\r\n                  this.codeBy.color.supportsLogScale(),\r\n                do: async (_, opt) => {\r\n                  var attrib = this.codeBy.color as Attrib_Numeric; // checked by when\r\n                  if (!attrib) return;\r\n                  if (attrib.timeseriesParent) {\r\n                    await attrib.timeseriesParent.valueScaleType.set(opt);\r\n                  } else {\r\n                    await attrib.valueScaleType.set(opt);\r\n                  }\r\n                },\r\n                options: [\r\n                  {\r\n                    name: \"Linear\",\r\n                    value: \"linear\",\r\n                    active:\r\n                      this.codeBy.color instanceof Attrib_Numeric &&\r\n                      this.codeBy.color.isValueScale_Linear,\r\n                  },\r\n                  {\r\n                    name: \"Log\",\r\n                    value: \"log\",\r\n                    active:\r\n                      this.codeBy.color instanceof Attrib_Numeric &&\r\n                      !this.codeBy.color.isValueScale_Linear,\r\n                  },\r\n                ],\r\n              },\r\n              {\r\n                id: \"colorThemeSwitch\",\r\n                name: \"Switch (Seq. ↔ Div.)\",\r\n                iconClass: \"fa fa-exchange\",\r\n                do: () =>\r\n                  this.setRecordColorTheme(\r\n                    this.browser.activeColorTheme === \"sequential\"\r\n                      ? \"diverging\"\r\n                      : \"sequential\"\r\n                  ),\r\n              },\r\n              {\r\n                id: \"colorThemeSequential\",\r\n                name: \"Sequential\",\r\n                iconClass: \"fa fa-long-arrow-right\",\r\n                do: (_, opt) => {\r\n                  this.browser.colorTheme.sequential = opt;\r\n                  this.setRecordColorTheme(\"sequential\");\r\n                },\r\n                // todo: highlight the active one\r\n                options: [\r\n                  { name: \"Greys\", value: \"Greys\", onName: addLegend },\r\n                  { name: \"Blues\", value: \"Blues\", onName: addLegend },\r\n                  { name: \"Green-Blue\", value: \"GnBu\", onName: addLegend },\r\n                  {\r\n                    name: \"Yellow-Green-Blue\",\r\n                    value: \"YlGnBu\",\r\n                    onName: addLegend,\r\n                  },\r\n                  { name: \"Greens\", value: \"Greens\", onName: addLegend },\r\n                  { name: \"Yellow-Green\", value: \"YlGn\", onName: addLegend },\r\n                  { name: \"Blue-Green\", value: \"BuGn\", onName: addLegend },\r\n                  {\r\n                    name: \"Purple-Blue-Green\",\r\n                    value: \"PuBuGn\",\r\n                    onName: addLegend,\r\n                  },\r\n                  { name: \"Purple-Blue\", value: \"PuBu\", onName: addLegend },\r\n                  { name: \"Purples\", value: \"Purples\", onName: addLegend },\r\n                  { name: \"Blue-Purple\", value: \"BuPu\", onName: addLegend },\r\n                  { name: \"Purple-Red\", value: \"PuRd\", onName: addLegend },\r\n\r\n                  { name: \"Oranges\", value: \"Oranges\", onName: addLegend },\r\n                  { name: \"Orange-Red\", value: \"OrRd\", onName: addLegend },\r\n                  {\r\n                    name: \"Yellow-Orange-Red\",\r\n                    value: \"YlOrRd\",\r\n                    onName: addLegend,\r\n                  },\r\n                  {\r\n                    name: \"Yellow-Orange-Brown\",\r\n                    value: \"YlOrBr\",\r\n                    onName: addLegend,\r\n                  },\r\n\r\n                  { name: \"Inferno\", value: \"Inferno\", onName: addLegend }, // no discrete version\r\n                  { name: \"Magma\", value: \"Magma\", onName: addLegend }, // no discrete version\r\n                  { name: \"Plasma\", value: \"Plasma\", onName: addLegend }, // no discrete version\r\n\r\n                  { name: \"Cividis\", value: \"Cividis\", onName: addLegend }, // no discrete version\r\n                  { name: \"Viridis\", value: \"Viridis\", onName: addLegend }, // no discrete version\r\n                  { name: \"Warm\", value: \"Warm\", onName: addLegend }, // no discrete version\r\n                  { name: \"Cool\", value: \"Cool\", onName: addLegend }, // no discrete version\r\n                ],\r\n              },\r\n              {\r\n                id: \"colorThemeDiverging\",\r\n                name: \"Diverging\",\r\n                iconClass: \"fa fa-arrows-h\",\r\n                do: (_, opt) => {\r\n                  this.browser.colorTheme.diverging = opt;\r\n                  this.setRecordColorTheme(\"diverging\");\r\n                },\r\n                options: [\r\n                  { name: \"Spectral\", value: \"Spectral\", onName: addLegend },\r\n                  { name: \"Brown-Green\", value: \"BrBG\", onName: addLegend },\r\n                  { name: \"Purple-Green\", value: \"PRGn\", onName: addLegend },\r\n                  {\r\n                    name: \"Pink-Yellow-Green\",\r\n                    value: \"PiYG\",\r\n                    onName: addLegend,\r\n                  },\r\n                  { name: \"Purple-Orange\", value: \"PuOr\", onName: addLegend },\r\n                  { name: \"Red-Blue\", value: \"RdBu\", onName: addLegend },\r\n                  { name: \"Red-Gray\", value: \"RdGy\", onName: addLegend },\r\n                  {\r\n                    name: \"Red-Yellow-Blue\",\r\n                    value: \"RdYlBu\",\r\n                    onName: addLegend,\r\n                  },\r\n                  {\r\n                    name: \"Red-Yellow-Green\",\r\n                    value: \"RdYlGn\",\r\n                    onName: addLegend,\r\n                  },\r\n                ],\r\n              },\r\n            ],\r\n          },\r\n          null,\r\n          { placement: \"top\" }\r\n        );\r\n      });\r\n\r\n    // Scale\r\n    this.DOM.mapColorHighlightedValue = this.DOM.mapColorScaleGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorHighlightedValue fa fa-caret-down\");\r\n    this.DOM.mapColorScaleBins = this.DOM.mapColorScaleGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorScaleBins\");\r\n    this.DOM.mapColorScaleLabels = this.DOM.mapColorScaleGroup\r\n      .append(\"div\")\r\n      .attr(\"class\", \"mapColorScaleLabels\");\r\n\r\n    // play/pause buttons\r\n    var x = this.DOM.timeAnimation\r\n      .append(\"span\")\r\n      .attr(\"class\", \"detailPlay attribDetailPlay\");\r\n    x.append(\"i\")\r\n      .attr(\"class\", \"fa fa-play-circle\")\r\n      .tooltip(i18n.AutoPlay)\r\n      .on(\"click\", (event) =>\r\n        this.startTimeseriesAnimation(event.shiftKey ? 5 : 1)\r\n      )\r\n      .on(\"mouseover\", () => {\r\n        if (this.View instanceof RecordView_Timeseries) {\r\n          this.View.timeseriesWiden();\r\n        }\r\n      })\r\n      .on(\"mouseout\", () => {\r\n        if (this.View instanceof RecordView_Timeseries) {\r\n          this.View.timeseriesWidenOff();\r\n        }\r\n      });\r\n    x.append(\"i\")\r\n      .attr(\"class\", \"fa fa-pause-circle\")\r\n      .tooltip(i18n.StopAutoPlay)\r\n      .on(\"click\", () => this.stopTimeseriesAnimation());\r\n\r\n    this.DOM.timeAnimation\r\n      .append(\"div\")\r\n      .attr(\"class\", \"timeKeyStep timeKeyPrev\")\r\n      .tooltip(i18n.Previous)\r\n      .on(\"click\", () => this.currentTimeKey.set(this.timeKeys[this.currentTimeKey.get()._index - 1]) )\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa fa-caret-left\");\r\n\r\n    this.DOM.timeAnimation\r\n      .append(\"select\")\r\n      .attr(\"class\", \"timeKeySelect\")\r\n      .on(\"change\", async (event) => await this.currentTimeKey.set(event.currentTarget.selectedOptions[0].__data__) );\r\n\r\n    this.DOM.timeAnimation\r\n      .append(\"div\")\r\n      .attr(\"class\", \"timeKeyStep timeKeyNext\")\r\n      .tooltip(i18n.Next)\r\n      .on(\"click\", async () => await this.currentTimeKey.set(this.timeKeys[this.currentTimeKey.get()._index + 1]) )\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa fa-caret-right\");\r\n\r\n    this.DOM.timeAnimation\r\n      .append(\"div\")\r\n      .attr(\"class\", \"timeKeyRange\")\r\n      .call((timeKeyRange) => {\r\n        timeKeyRange.append(\"span\").attr(\"class\", \"rangeTick-min\").text(\"min\");\r\n\r\n        // SINGLE-KEY SLIDER (MAP, SCATTERPLOT, LIST)\r\n        var attribDetailRange = timeKeyRange\r\n          .append(\"div\")\r\n          .attr(\"class\", \"attribDetailRange\");\r\n\r\n        noUiSlider.create(attribDetailRange.node(), {\r\n          connect: true,\r\n          step: 1,\r\n          behaviour: \"tap-drag\",\r\n          range: {\r\n            min: 0,\r\n            max: this.hasTimeKey ? this.timeKeys.length - 1 : 100,\r\n          },\r\n          start: this.currentTimeKey.get()?._index ?? 0,\r\n        });\r\n\r\n        attribDetailRange.append(\"span\").attr(\"class\", \"rangeTick-cur\");\r\n\r\n        this.timeKeySlider = attribDetailRange.node().noUiSlider;\r\n        var _update_1 = async (v) => {\r\n          if (this.timeKeySlider_PauseUpdate) return;\r\n          var _node = this.DOM.timeAnimation\r\n            .selectAll(\".timeKeySelect > option\")\r\n            .nodes()[Math.round(1 * v)];\r\n          if (_node) {\r\n            this.timeKeySlider_PauseUpdate = true;\r\n            await this.currentTimeKey.set(_node.__data__);\r\n            this.timeKeySlider_PauseUpdate = false;\r\n          }\r\n        };\r\n        this.timeKeySlider.on(\"set\", _update_1);\r\n\r\n        // DOUBLE-KEY SLIDER (TIMESERIES)\r\n        this.DOM.timeseriesRange = timeKeyRange\r\n          .append(\"div\")\r\n          .attr(\"class\", \"timeseriesRange\");\r\n\r\n        timeKeyRange.append(\"span\").attr(\"class\", \"rangeTick-max\");\r\n      });\r\n\r\n    this.DOM.timeAnimationClearRange = this.DOM.timeAnimation\r\n      .append(\"span\")\r\n      .attr(\"class\", \"clearRange fa fa-times\")\r\n      .tooltip(i18n.Reset);\r\n    // handled added in TimeSeries view\r\n\r\n    this.currentTimeKey.refresh();\r\n\r\n    // View control...\r\n    this.DOM.visViewControl = this.DOM.recordDisplayWrapper\r\n      .append(\"span\")\r\n      .attr(\"class\", \"visViewControl\");\r\n\r\n    // **************************************************\r\n    // ZOOM IN / OUT / RESET\r\n    this.DOM.visViewControl\r\n      .append(\"span\")\r\n      .attr(\"class\", \"ChartControlGroup ViewControlGroup\")\r\n      .call((_) => {\r\n        _.append(\"span\")\r\n          .attr(\"class\", \"ChartControlGroupTitle\")\r\n          .html(i18n.Zoom);\r\n        _.append(\"span\")\r\n          .attr(\"class\", \"visViewControlButton fa fa-plus\")\r\n          .tooltip(i18n.ZoomIn)\r\n          .on(\"click\", () => this.View.zoomIn());\r\n        _.append(\"span\")\r\n          .attr(\"class\", \"visViewControlButton fa fa-minus\")\r\n          .tooltip(i18n.ZoomOut)\r\n          .on(\"click\", () => this.View.zoomOut());\r\n        _.append(\"span\")\r\n          .attr(\"class\", \"visViewControlButton fa fa-expand-arrows-alt\")\r\n          .tooltip(i18n.ZoomToFit)\r\n          .on(\"click\", () => this.View.zoomToFit());\r\n      });\r\n\r\n    // MOUSE SELECT MODE\r\n    var _m = (t) =>\r\n      t === \"filter\"\r\n        ? \"Filter\"\r\n        : \"Select nearest \" + (t === \"record\" ? \"point\" : \"time\");\r\n\r\n    // Maps only\r\n    this.DOM.visViewControl\r\n      .append(\"div\")\r\n      .attr(\"class\", \"visViewControlButton mapView-UnmatchedData\")\r\n      .tooltip(i18n.MissingLocations)\r\n      .text(\"∅\")\r\n      .on(\"click\", () => {\r\n        Modal.alert(\r\n          \"The following records do not appear on the map.<br><br>\" +\r\n            this.codeBy.geo.noValueAggr.records.map((_) => _._id).join(\", \") +\r\n            (this.codeBy.geo.geoType !== \"Point\"\r\n              ? \"<br><br>\" +\r\n                \"<span style='font-size: 0.9em; color: gray; font-weight: 300'>\" +\r\n                \"Please see the list of standard region names \" +\r\n                \"<a style='color: gray; text-decoration: underline;' href='https://docs.google.com/spreadsheets/d/1DKNXwsJy6_Mdy3ofwbBIZeBGrxSItYOJXNZgLyu0IM4' target='_blank'>here</a>.<br>\" +\r\n                \"If the place names above are misspelled, please update your data source.<span>\"\r\n              : \"\")\r\n        );\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  refreshTimeKeys() {\r\n    this.timeKeys = [];\r\n\r\n    [\"sort\", \"scatterX\", \"scatterY\", \"color\", \"size\"].forEach((_type) => {\r\n      var targetAttrib = this.codeBy[_type];\r\n      if (\r\n        targetAttrib instanceof Attrib_Numeric &&\r\n        targetAttrib.hasTimeSeriesParent()\r\n      ) {\r\n        // make a copy of timeKeys of the timeseries summary\r\n        var timeKeyOptions = Array.from(targetAttrib.timeseriesParent.timeKeys);\r\n        // finds the shared subset of keys across all timeseries variables\r\n        if (this.timeKeys.length === 0) {\r\n          this.timeKeys = timeKeyOptions;\r\n        } else {\r\n          this.timeKeys = this.timeKeys.filter((k) =>\r\n            timeKeyOptions.find((_) => _._time_src === k._time_src)\r\n          );\r\n        }\r\n      }\r\n    });\r\n\r\n    // From 0 (oldest) to last (newest)\r\n    this.timeKeys = this.timeKeys.sort(\r\n      (a, b) => a._time.getTime() - b._time.getTime()\r\n    );\r\n\r\n    // re-assign index numbers\r\n    this.timeKeys.forEach((key, i) => {\r\n      key._index = i;\r\n      delete key._histogram; // not needed - does not apply\r\n    });\r\n\r\n    this.currentTimeKey.refresh();\r\n  }\r\n\r\n  /** -- */\r\n  get hasTimeKey() {\r\n    return this.timeKeys.length > 1; // must be at least two - single time-key has no control\r\n  }\r\n\r\n  filterStatusUpdated(attrib: Attrib) {\r\n    if (attrib instanceof Attrib_Numeric) {\r\n      if (\r\n        this.viewRecAs === \"scatter\" &&\r\n        (this.codeBy.scatterX === attrib || this.codeBy.scatterY === attrib)\r\n      ) {\r\n        this.View?.refreshQueryBox_Filter(null);\r\n      }\r\n      if (\r\n        attrib.timeseriesParent === this.codeBy.timeSeries &&\r\n        this.View instanceof RecordView_Timeseries\r\n      ) {\r\n        this.View.refreshFilterRanges();\r\n      }\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  collapseRecordViewSummary(collapsed) {\r\n    this.collapsed = collapsed;\r\n    this.DOM.root.classed(\"collapsed\", this.collapsed);\r\n    if (this.browser.finalized) this.browser.updateLayout_Height();\r\n  }\r\n\r\n  /** -- */\r\n  refreshViz_Compare_All() {\r\n    this.DOM.root\r\n      .selectAll(\"[class*='spatialQueryBox_Compare']\")\r\n      .classed(\r\n        \"active\",\r\n        (d) => this.browser.vizActive(d) && this.browser.selectedAggrs[d].bounds\r\n      );\r\n  }\r\n\r\n  /** -- */\r\n  refreshViewAsOptions() {\r\n    var activeCount = 0;\r\n    [\"list\", \"map\", \"timeseries\", \"scatter\"].forEach((viewType) => {\r\n      var t = this.browser.recordChartType.itemOptions.find(\r\n        (_) => _.value === viewType\r\n      );\r\n      var disabled = !t.activeWhen || !t.activeWhen();\r\n      activeCount += !disabled ? 1 : 0;\r\n      this.DOM.recordDisplayHeader\r\n        .select(\".recordDisplay_ViewAs_\" + viewType)\r\n        .classed(\"disabled\", disabled)\r\n        .classed(\"active\", viewType.toLowerCase() == this.viewRecAs);\r\n    });\r\n\r\n    this.DOM.recordDisplayHeader\r\n      .select(\".recordDisplay_ViewGroup\")\r\n      .classed(\"disabled\", activeCount <= 1);\r\n  }\r\n\r\n  private attribDropdowns: {\r\n    [index: string /* RecordVisCoding */]: AttribDropdown;\r\n  } = {};\r\n\r\n  /** -- */\r\n  refreshAttribOptions(_type) {\r\n    if (!this.attribDropdowns[_type]) return;\r\n    this.attribDropdowns[_type].refresh();\r\n  }\r\n\r\n  /** -- */\r\n  initDOM_AttribSelect(_type: RecordVisCoding) {\r\n    this.attribDropdowns[_type] = new AttribDropdown(_type, this);\r\n    this.refreshAttribOptions(_type);\r\n  }\r\n\r\n  /** -- */\r\n  getAttribOptions_UI(_type: RecordVisCoding): Attrib[] {\r\n    var opts = this.browser.attribs.filter(\r\n      (attrib) =>\r\n        attrib.supportsRecordEncoding(_type) && !attrib.hasTimeSeriesParent()\r\n    );\r\n\r\n    // scatterX / scatterY options cannot include the same active attribute\r\n    if ([\"scatterX\", \"scatterY\"].includes(_type)) {\r\n      var other: Attrib =\r\n        _type === \"scatterX\" ? this.codeBy.scatterY : this.codeBy.scatterX;\r\n      if (other) {\r\n        if (other.hasTimeSeriesParent()) other = other.parent;\r\n        opts = opts.filter((s) => s.attribID != other.attribID);\r\n      }\r\n    }\r\n\r\n    // generate new attribute if there's no sortable attribute\r\n    if (_type === \"sort\" && opts.length === 0) {\r\n      var newAttrib: Attrib_Numeric;\r\n      if (this.browser.idSummaryName === \"id\") {\r\n        newAttrib = this.browser.createAttrib(\"Sort by id\", function () {\r\n          return 1 * this.id;\r\n        }) as Attrib_Numeric;\r\n      } else {\r\n        newAttrib = this.browser.createAttrib(\"Sort (random)\", function () {\r\n          return Math.random();\r\n        }) as Attrib_Numeric;\r\n      }\r\n      newAttrib._metricFuncs = [];\r\n      newAttrib.initializeAggregates();\r\n      // calls the function again, but this time we have a numeric summary\r\n      return this.getAttribOptions_UI(\"sort\");\r\n    }\r\n\r\n    opts.sort((s1, s2) =>\r\n      Util.sortFunc_List_String(s1.attribName, s2.attribName)\r\n    );\r\n\r\n    if ([\"color\", \"size\"].includes(_type)) {\r\n      opts.unshift(null); // The first option is no color/size attribute.\r\n    }\r\n\r\n    return opts;\r\n  }\r\n\r\n  timeseriesAnimInterval: number = 0;\r\n\r\n  /** -- */\r\n  startTimeseriesAnimation(stepSize = 1) {\r\n    if (this.timeseriesAnimInterval) {\r\n      this.stopTimeseriesAnimation();\r\n    }\r\n\r\n    if (this.View?.stepTimeAnimation(stepSize)) {\r\n      this.DOM.root.classed(\"animatingTime\", true);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  stopTimeseriesAnimation() {\r\n    this.DOM.root.classed(\"animatingTime\", false);\r\n\r\n    this.View?.stopTimeAnimation();\r\n\r\n    this.View.refreshLabelOverlaps();\r\n\r\n    if (!this.timeseriesAnimInterval) return;\r\n    window.clearInterval(this.timeseriesAnimInterval);\r\n    this.timeseriesAnimInterval = 0;\r\n  }\r\n\r\n  isPointMap() {\r\n    return this.viewRecAs === \"map\" && this.codeBy.geo?.geoType === \"Point\";\r\n  }\r\n\r\n  /** -- */\r\n  hasAggregates() {\r\n    return (\r\n      this.isPointMap() &&\r\n      this.DOM.clusterGlyphs &&\r\n      this.codeBy.geo.pointClusterRadius > 0 &&\r\n      this.codeBy.geo._aggrs.length > 0\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  async setAttrib(\r\n    _type: RecordVisCoding,\r\n    _attrib: number | string | Function | Attrib,\r\n    stopAnimation = false\r\n  ): Promise<boolean> {\r\n    let attrib: Attrib = null;\r\n\r\n    // if integer, index by integer among potential options\r\n    if (typeof _attrib === \"number\") {\r\n      attrib = this.getAttribOptions_UI(_type)[_attrib];\r\n      //\r\n    } else if (typeof _attrib === \"function\") {\r\n      attrib = this.browser.createAttrib(\"_Records\", _attrib, \"categorical\"); // create from function\r\n      //\r\n    } else if (typeof _attrib === \"string\") {\r\n      if (_attrib !== \"_measure_\") {\r\n        attrib = this.browser.createAttrib(_attrib); // create from string\r\n      }\r\n      //\r\n    } else if (_attrib) {\r\n      attrib = _attrib;\r\n    }\r\n\r\n    if ([\"sort\", \"scatterX\", \"scatterY\", \"size\", \"color\"].includes(_type)) {\r\n      var timeSrc;\r\n      if (attrib instanceof Attrib_Numeric && attrib.timeseriesParent) {\r\n        timeSrc = attrib.timeKey._time_src;\r\n        attrib = attrib.timeseriesParent;\r\n      }\r\n      if (attrib instanceof Attrib_Timeseries) {\r\n        timeSrc = this.currentTimeKey.get()?._time_src || timeSrc;\r\n        attrib = attrib.getTimepointSummary(\r\n          attrib.timeKeys.find((x) => x._time_src === timeSrc) || // current time-key\r\n            attrib.timeKeys[attrib.timeKeys.length - 1] // most recent time-key\r\n        );\r\n      }\r\n    }\r\n\r\n    // if (attrib instanceof Attrib) {\r\n    //   if (!attrib.supportsRecordEncoding(_type)) return;\r\n    // }\r\n\r\n    var prevTimeSeriesParent: Attrib_Timeseries = null;\r\n\r\n    if (_type === \"text\") {\r\n      if (!(attrib instanceof Attrib_Categorical)) return;\r\n      this.codeBy.text = attrib;\r\n\r\n    } else if (_type === \"textBrief\") {\r\n      if (!(attrib instanceof Attrib_Categorical)) return;\r\n      this.codeBy.textBrief = attrib;\r\n\r\n    } else if (_type === \"sort\") {\r\n      if (!(attrib instanceof Attrib_Interval)) return;\r\n      if (this.codeBy.sort instanceof Attrib_Numeric)\r\n        prevTimeSeriesParent = this.codeBy.sort.timeseriesParent;\r\n      this.codeBy.sort = attrib;\r\n\r\n    } else if (_type === \"scatterX\") {\r\n      if (!(attrib instanceof Attrib_Numeric)) return;\r\n      if (this.codeBy.scatterX)\r\n        prevTimeSeriesParent = this.codeBy.scatterX.timeseriesParent;\r\n      this.codeBy.scatterX = attrib;\r\n\r\n    } else if (_type === \"scatterY\") {\r\n      if (!(attrib instanceof Attrib_Numeric)) return;\r\n      if (this.codeBy.scatterY) {\r\n        prevTimeSeriesParent = this.codeBy.scatterY.timeseriesParent;\r\n      }\r\n      this.codeBy.scatterY = attrib;\r\n\r\n    } else if (_type === \"size\") {\r\n      prevTimeSeriesParent = this.codeBy.size instanceof Attrib_Numeric\r\n        ? this.codeBy.size.timeseriesParent\r\n        : null;\r\n\r\n      if (_attrib === \"_measure_\") {\r\n        this.codeBy.size = _attrib;\r\n      } else if (attrib instanceof Attrib_Numeric) {\r\n        this.codeBy.size = attrib;\r\n      } else if (_attrib === null) {\r\n        this.codeBy.size = null;\r\n      } else {\r\n        return;\r\n      }\r\n\r\n    } else if (_type === \"color\") {\r\n      prevTimeSeriesParent = this.codeBy.color instanceof Attrib_Numeric\r\n        ? this.codeBy.color.timeseriesParent\r\n        : null;\r\n      if (_attrib === \"_measure_\") {\r\n        this.codeBy.color = _attrib;\r\n      } else if (attrib instanceof Attrib_Numeric) {\r\n        this.codeBy.color = attrib;\r\n      } else if (_attrib === null) {\r\n        this.codeBy.color = null;\r\n      } else {\r\n        return;\r\n      }\r\n\r\n    } else if (_type === \"timeSeries\") {\r\n      if (!(attrib instanceof Attrib_Timeseries)) return;\r\n      this.codeBy.timeSeries = attrib;\r\n\r\n    } else if (_type === \"geo\") {\r\n      if (!(attrib instanceof Attrib_RecordGeo)) return;\r\n      this.codeBy.geo = attrib;\r\n      await this.codeBy.geo.loadGeo();\r\n\r\n    } else {\r\n      return;\r\n    }\r\n\r\n    if (stopAnimation) {\r\n      this.stopTimeseriesAnimation(); // hard-stop any existing animation\r\n    }\r\n\r\n    var timeKeysChange = false;\r\n\r\n    if (_type !== \"timeSeries\") {\r\n      if( attrib instanceof Attrib_Numeric &&\r\n        attrib.timeseriesParent &&\r\n        prevTimeSeriesParent !== attrib.timeseriesParent\r\n      ) {\r\n        timeKeysChange = true;\r\n      }\r\n    }\r\n\r\n    if (timeKeysChange) {\r\n      this.refreshTimeKeys();\r\n      if (attrib instanceof Attrib_Numeric)\r\n        await this.currentTimeKey.set(attrib.timeKey);\r\n    }\r\n\r\n    if (!this.DOM.root) return;\r\n\r\n    if (attrib instanceof Attrib) {\r\n      attrib.initializeAggregates();\r\n    }\r\n\r\n    if (_type === \"text\") {\r\n      this.DOM.recordTextSearch\r\n        .attr(\"active\", true)\r\n        .select(\"input\")\r\n        .attr(\"placeholder\", this.textAttrib_Brief?.attribName);\r\n\r\n      // Call the onDOM function for all the records that have been inserted to the page\r\n      if (this.config.onDOM) {\r\n        this.DOM.kshfRecords.each((record) => {\r\n          this.config.onDOM.call(record.data, record);\r\n        });\r\n      }\r\n\r\n    } else if (_type === \"textBrief\") {\r\n      this.DOM.recordTextSearch\r\n        .attr(\"active\", true)\r\n        .select(\"input\")\r\n        .attr(\"placeholder\", this.textAttrib_Brief.attribName);\r\n\r\n    } else if (_type === \"color\") {\r\n      this.updateRecordColorScale();\r\n\r\n    } else if (_type === \"size\") {\r\n      if (this.codeBy.size instanceof Attrib_Numeric) {\r\n        if (\r\n          this.viewRecAs === \"scatter\" ||\r\n          (this.viewRecAs === \"map\" && this.codeBy.geo?.geoType === \"Point\")\r\n        ) {\r\n          var s_f = this.codeBy.size.template.func;\r\n          var s_log = this.codeBy.size.isValueScale_Log;\r\n\r\n          var sortVal = (r) => {\r\n            var v = s_f.call(r.data, r);\r\n            return isNaN(v) || v == null || (s_log && v <= 0) ? -1 : v;\r\n          };\r\n\r\n          // need to apply delay to sorting (z-order) because we want the elements to animate to first\r\n          if (this.sortRecordDomTimer) clearTimeout(this.sortRecordDomTimer);\r\n          this.sortRecordDomTimer = window.setTimeout(() => {\r\n            this.DOM.kshfRecords = this.DOM.recordGroup\r\n              .selectAll(\".kshfRecord\")\r\n              .sort((r_a, r_b) => sortVal(r_b) - sortVal(r_a));\r\n            this.View.refreshLabelOverlaps();\r\n          }, 1000);\r\n        }\r\n      }\r\n\r\n      this.updateRecordSizeScale();\r\n\r\n      this.refreshSizeLegend();\r\n    }\r\n\r\n    await this.View?.finishSetAttrib(_type);\r\n\r\n    this.refreshAttribOptions(_type);\r\n  }\r\n\r\n  sortRecordDomTimer: number;\r\n\r\n  // ********************************************************************\r\n  // MAPPING\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  getMaxPointSize(): number {\r\n    if (!(this.codeBy.size instanceof Attrib_Numeric)) {\r\n      return 1; // only 1 point max\r\n    }\r\n\r\n    return this.codeBy.size.timeseriesParent // use timeseries parents domain...\r\n      ? d3.max(this.codeBy.size.timeseriesParent.timeSeriesScale_Value.domain())\r\n      : this.codeBy.size.rangeActive[1];\r\n  }\r\n\r\n  /** -- */\r\n  sanitizeTicks(ticks, attrib: Attrib_Numeric | \"_measure_\", numTicks: number) {\r\n    if (ticks.domain) {\r\n      var _scale = ticks.copy().nice(numTicks);\r\n      ticks = _scale.ticks(numTicks);\r\n      // d3 error ? make sure the ticks cover the full attrib Range\r\n      var domain = _scale.domain();\r\n      if (ticks[0] > domain[0]) ticks.unshift(domain[0]);\r\n      if (ticks[ticks.length - 1] < domain[1]) ticks.push([domain[1]]);\r\n    }\r\n\r\n    // when ticks must be integer values, round them\r\n    if (attrib === \"_measure_\" || !attrib.hasFloat) {\r\n      ticks = ticks.map((v) => Math.round(v));\r\n    }\r\n\r\n    // avoid repeated tick values\r\n    return ticks.filter((_, i) => i == 0 || _ !== ticks[i - 1]);\r\n  }\r\n\r\n  /** -- */\r\n  refreshSizeLegend() {\r\n    if(this.DOM.root == null) return;\r\n\r\n    this.DOM.root.classed(\"usesSizeAttrib\", hasSizeLegend);\r\n\r\n    var hasSizeLegend =\r\n      this.codeBy.size != null &&\r\n      (this.viewRecAs === \"scatter\" ||\r\n        (this.viewRecAs === \"map\" && this.codeBy.geo.geoType === \"Point\"));\r\n\r\n    if (!hasSizeLegend) return;\r\n\r\n    if (!this.DOM.sizeLegendGroup) return;\r\n\r\n    var maxValue;\r\n\r\n    if (this.viewRecAs === \"map\") {\r\n      maxValue = this.recordRadiusScale.domain()[1];\r\n      if (isNaN(maxValue)) {\r\n        this.DOM.root.classed(\"usesSizeAttrib\", false);\r\n        return;\r\n      }\r\n    } else {\r\n      maxValue = this.getMaxPointSize();\r\n    }\r\n\r\n    var markRatios = [0.2, 0.4, 0.6, 0.8, 1];\r\n\r\n    if (this.recordPointSize.get() > 25) {\r\n      markRatios = [0.1, 0.4, 0.7, 1];\r\n    }\r\n\r\n    var ticks = this.sanitizeTicks(\r\n      markRatios.map((v) => maxValue * v * v),\r\n      this.codeBy.size,\r\n      10\r\n    );\r\n    ticks = ticks.filter((_) => _ !== 0);\r\n\r\n    var printLabel;\r\n    if (this.codeBy.size instanceof Attrib_Numeric) {\r\n      let y = this.codeBy.size;\r\n      printLabel = (v) => y.getFormattedValue(v);\r\n    } else {\r\n      printLabel = d3.format(\"~s\");\r\n    }\r\n\r\n    maxValue = ticks[ticks.length - 1];\r\n\r\n    ticks = ticks.map((_) => ({ size: 2 * this.recordRadiusScale(_), val: _ })); // size\r\n\r\n    this.DOM.sizeLegendGroup.selectAll(\"div\").remove();\r\n    this.DOM.sizeLegendGroup\r\n      .selectAll(\"div\")\r\n      .data(ticks)\r\n      .join((enter) =>\r\n        enter\r\n          .append(\"div\")\r\n          .attr(\"class\", \"sizeGlyph\")\r\n          .call((sizeGlyphs) =>\r\n            sizeGlyphs\r\n              .append(\"span\")\r\n              .attr(\"class\", \"glyphWrapper\")\r\n              .append(\"span\")\r\n              .attr(\"class\", \"theGlyph\")\r\n              .style(\"width\", (d) => d.size + \"px\")\r\n              .style(\"height\", (d) => d.size + \"px\")\r\n          )\r\n          .call((sizeGlyphs) =>\r\n            sizeGlyphs\r\n              .append(\"span\")\r\n              .attr(\"class\", \"glyphLabel\")\r\n              .html((_) => printLabel(_.val))\r\n          )\r\n      );\r\n  }\r\n\r\n  /** -- */\r\n  linkedTimeKey() {\r\n    if (this.codeBy.scatterY == null) return false;\r\n    if (this.codeBy.scatterX == null) return false;\r\n    var yTs = this.codeBy.scatterY.timeseriesParent;\r\n    var xTs = this.codeBy.scatterX.timeseriesParent;\r\n    if (!xTs || !yTs) return false;\r\n    return (\r\n      yTs.attribName !== xTs.attribName &&\r\n      yTs.timeKeys.length === xTs.timeKeys.length &&\r\n      this.codeBy.scatterY.timeKey !== this.codeBy.scatterX.timeKey\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  flipSelected(f, cT) {\r\n    if (!cT) cT = this.browser.Compare_Highlight;\r\n    this.DOM.kshfRecords.each((record) => record.flipSelected(f, cT));\r\n  }\r\n\r\n  skipRefreshRecordVis: boolean = false;\r\n\r\n  /** -- */\r\n  refreshRecordVis() {\r\n    if (!this.DOM.recordGroup) return;\r\n    if (this.skipRefreshRecordVis) return;\r\n    if (this.kshfRecords_Type !== this.viewRecAs) return;\r\n    if (!this.View) return;\r\n    this.View.refreshRecordVis();\r\n  }\r\n\r\n  /** -- */\r\n  isSummaryUsedInRecordChart(summary) {\r\n    return {\r\n      list: [\"sort\"],\r\n      map: [\"color\", \"size\"],\r\n      scatter: [\"scatterX\", \"scatterY\", \"color\", \"size\"],\r\n      timeseries: [\"timeSeries\"],\r\n      none: [],\r\n    }[this.viewRecAs].some((t) => {\r\n      var _ = this[t + \"Attrib\"];\r\n      return _ && (summary === _ || summary === _.parentSummary);\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  async refreshAttribScaleType(attrib) {\r\n    if (this.codeBy.color instanceof Attrib) {\r\n      if (\r\n        this.codeBy.color === attrib ||\r\n        this.codeBy.color.timeseriesParent === attrib\r\n      ) {\r\n        this.updateRecordColorScale();\r\n      }\r\n    }\r\n\r\n    await this.View?.refreshAttribScaleType(attrib);\r\n  }\r\n\r\n  /** Instead of overall maximum, we can also get a quantile value */\r\n  private getMaxMeasureValue(quantile = null): number {\r\n    // maximum of records that are not in a special cluster - using measure_Self values\r\n    var _list: number[] = this.browser.records.reduce((accum: number[], record: Record) => {\r\n      if (record.isIncluded && !record._view.inCluster && record.measure_Self)\r\n        accum.push(record.measure_Self);\r\n      return accum;\r\n    }, []);\r\n\r\n    // add maximum active of all the clisters\r\n    if (this.codeBy.geo) {\r\n      _list = this.codeBy.geo._aggrs.reduce(\r\n        (accum, aggr: Aggregate_PointCluster) => {\r\n          accum.push(aggr.measure(\"Active\"));\r\n          return accum;\r\n        },\r\n        _list\r\n      );\r\n    }\r\n\r\n    _list.sort((a, b) => b - a);\r\n\r\n    if (quantile) return d3.quantile(_list, quantile);\r\n\r\n    return _list[0];\r\n  }\r\n\r\n  get measureSummary() {\r\n    return this.browser.measureSummary.get();\r\n  }\r\n\r\n  updateRecordColorScale() {\r\n    if (!this.codeBy.color) {\r\n      this.recordColorScale = null;\r\n      this.recordColorScaleTicks = null;\r\n      this.recordColorStepTicks = null;\r\n      this.refreshColorLegend();\r\n      return;\r\n    }\r\n\r\n    var c: Attrib_Numeric, domain: [number, number];\r\n\r\n    if (this.codeBy.color === \"_measure_\") {\r\n      domain = [1, this.getMaxMeasureValue()];\r\n      c = this.measureSummary;\r\n    } else {\r\n      domain = this.codeBy.color.valueScale.domain();\r\n      c = this.codeBy.color;\r\n    }\r\n\r\n    const _colorLegendScale = Util.getD3Scale(c?.isValueScale_Log).domain(domain);\r\n\r\n    var numTicks = 10;\r\n    while (true) {\r\n      this.recordColorScaleTicks = this.sanitizeTicks(\r\n        _colorLegendScale,\r\n        c ?? \"_measure_\",\r\n        numTicks\r\n      );\r\n      if (this.recordColorScaleTicks.length <= 10) break;\r\n      numTicks--;\r\n    }\r\n\r\n    this.recordColorStepTicks = false;\r\n\r\n    if (\r\n      (!c || !c.hasFloat) &&\r\n      Util.isStepTicks(this.recordColorScaleTicks) &&\r\n      this.recordColorScaleTicks.length < 10\r\n    ) {\r\n      this.recordColorStepTicks = true;\r\n      this.recordColorScaleTicks.push(\r\n        this.recordColorScaleTicks[this.recordColorScaleTicks.length - 1] + 1\r\n      );\r\n    }\r\n\r\n    // How many number of bins are we going to support?\r\n    // Options are from 3 to 9!\r\n    var numBins = Math.max(\r\n      Math.min(this.recordColorScaleTicks.length - 1, 9),\r\n      1\r\n    );\r\n\r\n    // from quantized scale to discrete colors\r\n    var colors = this.browser.colorTheme.getDiscrete(numBins);\r\n    if (this.invertedColorTheme) colors.reverse();\r\n    // replicates first and last colors to match the ticks\r\n    // needed because we are using threshold scale, which also considers below/above the scale limits\r\n    // using slightl different colors so invertExtent would function well\r\n    colors = [d3.hsl(colors[0]).brighter(0.1).formatHex()]\r\n      .concat(colors)\r\n      .concat(\r\n        d3\r\n          .hsl([colors[colors.length - 1]])\r\n          .darker(0.1)\r\n          .formatHex()\r\n      );\r\n\r\n    this.recordColorScale = d3\r\n      .scaleThreshold()\r\n      .domain(this.recordColorScaleTicks)\r\n      .range(colors);\r\n\r\n    this.refreshColorLegend();\r\n  }\r\n\r\n  /** -- */\r\n  onRecordMouseOver(record: Record) {\r\n    record.highlightRecord();\r\n    this.setDimmed(true);\r\n\r\n    this.View.onRecordMouseOver(record);\r\n\r\n    // manage color mapping here. can apply to map / scatterplot\r\n    if (\r\n      this.codeBy.color &&\r\n      (this.viewRecAs === \"map\" || this.viewRecAs === \"scatter\")\r\n    ) {\r\n      var v;\r\n      if (this.codeBy.color === \"_measure_\") {\r\n        v = record.measure_Self;\r\n      } else {\r\n        v = this.codeBy.color.getRecordValue(record);\r\n      }\r\n      // Set opacity, and position\r\n\r\n      var offset = 0;\r\n      if (this.recordColorStepTicks) {\r\n        offset = 50 / (this.recordColorScaleTicks.length - 1);\r\n      }\r\n\r\n      this.DOM.mapColorHighlightedValue\r\n        .style(\"opacity\", v === null ? null : 1)\r\n        .style(\"left\", offset + this.mapColorScalePos(v) + \"%\");\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  onRecordMouseLeave(record) {\r\n    this.setDimmed(false);\r\n\r\n    if (!record) return;\r\n    record.unhighlightRecord();\r\n    this.View.onRecordMouseLeave(record);\r\n    if (\r\n      this.codeBy.color &&\r\n      (this.viewRecAs === \"map\" || this.viewRecAs === \"scatter\")\r\n    ) {\r\n      this.DOM.mapColorHighlightedValue.style(\"opacity\", null);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshTextAttrib() {}\r\n\r\n  sparklineCounter: number = 0;\r\n\r\n  getRecordTitle(record: Record) {\r\n    var recordName = `<span class='mapItemName'>${this.textAttrib_Brief.renderRecordValue(\r\n      record\r\n    )}</span>`;\r\n\r\n    var catColorText = \"\";\r\n    if (this.browser.comparedAttrib) {\r\n      let a = this.browser.comparedAttrib;\r\n      let compare_Color = \"Active\";\r\n      Base.Compare_List.forEach((cX) => {\r\n        if (record.isSelected(cX)) compare_Color = cX;\r\n      });\r\n      catColorText = `<div class='recordColorInfo'>\r\n        <span class='mapTooltipLabel'>${a.attribName}</span>\r\n        <div class='mapTooltipValue'><span class='colorBox bg_${compare_Color}'></span>${a.getRecordValue(\r\n        record\r\n      )}</div>\r\n        </div>`;\r\n    }\r\n\r\n    if (!this.codeBy.color) return recordName + catColorText;\r\n\r\n    var a = this.codeBy.color;\r\n\r\n    if (a === \"_measure_\" || !a.hasTimeSeriesParent()) {\r\n      var _value, _label;\r\n      if (a === \"_measure_\") {\r\n        _label = i18n.measureText(this.browser);\r\n        _value = record.measure_Self;\r\n      } else {\r\n        _label = a.attribName;\r\n        _value = a.getFormattedValue(a.template.func.call(record.data, record));\r\n      }\r\n      // Just a single value / not timeseries\r\n      return (\r\n        recordName +\r\n        catColorText +\r\n        \"<div class='recordColorInfo'>\" +\r\n        `<span class='mapTooltipLabel'>${_label}</span>: ` +\r\n        `<span class='mapTooltipValue'>${_value}</span>` +\r\n        \"</div>\"\r\n      );\r\n    }\r\n\r\n    var a2 = a;\r\n\r\n    var activeVal = a.template.func.call(record.data, record);\r\n\r\n    // Timeseries popup\r\n    var ts = a.timeseriesParent;\r\n    var timeseriesData = ts.getRecordValue(record);\r\n    var chart_width = 150;\r\n    var chart_height = 40;\r\n\r\n    // converts the object into simple array\r\n    var tsd = timeseriesData._timeseries_;\r\n\r\n    if (tsd.length === 0) {\r\n      // Just a single value / not timeseries\r\n      return (\r\n        recordName +\r\n        catColorText +\r\n        \"<div class='recordColorInfo'> - \" +\r\n        `<span class='timeseriesName blockName'>${ts.attribNameHTML}</span>` +\r\n        \"</div>\"\r\n      );\r\n    }\r\n\r\n    // filter out the invalid values from beginning and end\r\n    while (tsd[0]._value === undefined) {\r\n      tsd = tsd.slice(1);\r\n    }\r\n    while (tsd[tsd.length - 1]._value === undefined) {\r\n      tsd = tsd.slice(0, tsd.length - 1);\r\n    }\r\n\r\n    // **********************************\r\n    // Time scale ***********************\r\n    var timeScale = d3\r\n      .scaleTime()\r\n      .domain(d3.extent(tsd, (x: TimeData) => x._time))\r\n      .range([0, chart_width]);\r\n\r\n    // **********************************\r\n    // Value scale **********************\r\n    // compute the min-max of the tooltip using the real record values\r\n    var [value_min, value_max] = d3.extent(tsd, (_: TimeData) => _._value);\r\n    var steadyValue = false;\r\n    if (value_min === value_max) {\r\n      steadyValue = value_min;\r\n      value_min -= 0.0001;\r\n      value_max += 0.0001;\r\n    }\r\n    if (ts.hasFlippedDomain()) {\r\n      [value_max, value_min] = [value_min, value_max];\r\n    }\r\n    var valueScale = d3\r\n      .scaleLinear()\r\n      .domain([value_min, value_max])\r\n      .rangeRound([chart_height, 0]);\r\n\r\n    // get activeTime\r\n    var tsDots = \"\";\r\n    var activeTime = null;\r\n    if (activeVal != null) {\r\n      activeTime = ts.timeKeys.filter(\r\n        (tk) => tk._time_src === a2.timeKey._time_src\r\n      )[0];\r\n      tsDots =\r\n        `<g transform='translate(${timeScale(activeTime._time)} ${valueScale(\r\n          activeVal\r\n        )})'><circle class='activeValueDot' r='4' fill='${this.recordColorScale(\r\n          activeVal\r\n        )}'/><text class='activeValueText' y='-5'>${a.printAbbr(\r\n          activeVal,\r\n          true\r\n        )}</text>` + \"</g>\";\r\n    }\r\n\r\n    var colorOut = this.browser.colorTheme.getContinuous();\r\n    var mapp = this.mapColorScalePos\r\n      .copy()\r\n      .range(this.invertedColorTheme ? [1, 0] : [0, 1]);\r\n\r\n    this.sparklineCounter++;\r\n\r\n    // add the time extent\r\n    [tsd[0], tsd[tsd.length - 1]].forEach((t) => {\r\n      tsDots += `<g transform='translate(${timeScale(\r\n        t._time\r\n      )} ${chart_height})'><text class='limitText activeValueTime' y='16'>${\r\n        t._time_src\r\n      }</text></g>`;\r\n    });\r\n\r\n    // add the value extent\r\n    if (!steadyValue) {\r\n      var onLeft = activeTime && activeTime._index > ts.timeKeys.length / 2;\r\n      [value_max, value_min].forEach((v) => {\r\n        tsDots +=\r\n          \"<g transform='translate(\" +\r\n          (onLeft ? 0 : chart_width) +\r\n          \" \" +\r\n          valueScale(v) +\r\n          \")'>\" +\r\n          \"<text class='limitText activeRangeText' x='\" +\r\n          (onLeft ? \"-\" : \"\") +\r\n          \"3' y='5' \" +\r\n          \"style='text-anchor: \" +\r\n          (onLeft ? \"end\" : \"start\") +\r\n          \";'>\" +\r\n          ts.printAbbr(v, true) +\r\n          \"</text>\" +\r\n          \"</g>\";\r\n      });\r\n    }\r\n\r\n    var _stroke = steadyValue ? colorOut(mapp(value_max)) : \"\";\r\n\r\n    return (\r\n      recordName +\r\n      catColorText +\r\n      `<div class='sparklineWrapper'>\r\n        <svg class='tooltipSparkline' xmlns='http://www.w3.org/2000/svg'>\r\n          <defs>\r\n            <clipPath id='SparklineClipPath${this.sparklineCounter}'>\r\n              <rect x='-20' y='-25' height='100' class='sparkLineClipPath'></rect>\r\n            </clipPath>\r\n          </defs>\r\n          <g>\r\n            <path class='timeline' d='${Util.getLineGenerator(\r\n              timeScale,\r\n              valueScale\r\n            )(tsd)}' stroke='${_stroke}' />\r\n            ${tsDots}\r\n          </g>\r\n        </svg>\r\n      </div>\r\n      <span class='timeseriesName blockName'>${ts.attribNameHTML}</span>`\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshRecordDOM() {\r\n    var isCanvasView = [\"map\", \"node\", \"scatter\", \"timeseries\"].includes(\r\n      this.viewRecAs\r\n    );\r\n\r\n    this.DOM.recordGroup\r\n      .selectAll(\".kshfRecord\")\r\n      .data(this.View.getRecordsForDOM(), (record: Record) => record.id)\r\n      .join(\r\n        (enter) => {\r\n          // argh. removing this causes some weird animation problem..\r\n          if (enter.nodes().length === 0) return enter;\r\n\r\n          return (\r\n            enter\r\n              .append(\r\n                {\r\n                  map: \"g\",\r\n                  node: \"g\",\r\n                  scatter: \"g\",\r\n                  timeseries: \"g\",\r\n                  list: \"div\",\r\n                }[this.viewRecAs]\r\n              )\r\n              // kshfRecord_XYZ can be used to apply custom CSS\r\n              .attr(\r\n                \"class\",\r\n                (record: Record) =>\r\n                  \"kshfRecord kshfRecord_#\" +\r\n                  // record.id may not be string with dynamic data loading\r\n                  (\"\" + record.id).replace(/\\s/g, \"_\")\r\n              )\r\n              .tooltip((record: Record) => this.getRecordTitle(record), {\r\n                theme: \"dark kshf-tooltip kshf-record\",\r\n                placement: \"right\",\r\n                animation: \"fade\",\r\n                followCursor: this.viewRecAs === \"map\",\r\n                offset: [0, this.viewRecAs === \"map\" ? 10 : 0],\r\n                onShown: (instance) => {\r\n                  d3.select(instance.popper)\r\n                    .select(\".sparkLineClipPath\")\r\n                    .attr(\"width\", 2)\r\n                    .transition()\r\n                    .duration(1000)\r\n                    .delay(0)\r\n                    .ease(d3.easePolyInOut)\r\n                    .attr(\"width\", 200);\r\n                },\r\n              })\r\n              .on(\"mouseenter\", (event, record) => {\r\n                if (this.viewRecAs === \"timeseries\") return;\r\n                var DOM = event.currentTarget;\r\n                if (DOM.highlightTimeout) clearTimeout(DOM.highlightTimeout);\r\n                DOM.highlightTimeout = window.setTimeout(() => {\r\n                  clearTimeout(DOM.highlightTimeout);\r\n                  this.onRecordMouseOver(record);\r\n                }, this.browser.movingMouseDelay);\r\n              })\r\n              .on(\"mouseleave\", (event, record) => {\r\n                if (this.viewRecAs === \"timeseries\") return;\r\n                var DOM = event.currentTarget;\r\n                if (DOM.highlightTimeout)\r\n                  window.clearTimeout(DOM.highlightTimeout);\r\n                this.onRecordMouseLeave(record);\r\n              })\r\n              .on(\"mousedown\", (event) => {\r\n                if (!isCanvasView) return;\r\n                event.currentTarget._mousemove = false;\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n              })\r\n              .on(\"mousemove\", (event) => {\r\n                if (!isCanvasView) return;\r\n                event.currentTarget._mousemove = true;\r\n              })\r\n              .on(\"click\", (event, record) => {\r\n                if (!isCanvasView) return;\r\n                var DOM = event.currentTarget;\r\n                if (DOM._mousemove) return; // Do not show the detail view if the mouse was used to drag the canvas\r\n                this.browser.recordDetailsPopup.updateRecordDetailPanel(record);\r\n\r\n                if (\r\n                  this.viewRecAs === \"map\" &&\r\n                  this.codeBy.color instanceof Attrib_Numeric\r\n                ) {\r\n                  this.browser.recordDetailsPopup.updateFocusedTimeKey(\r\n                    this.codeBy.color.timeKey\r\n                  );\r\n                }\r\n\r\n                if (DOM.highlightTimeout)\r\n                  window.clearTimeout(DOM.highlightTimeout);\r\n                if (DOM.tippy.state.visible) DOM.tippy.hide();\r\n                this.onRecordMouseLeave(record);\r\n              })\r\n              .call((newRecords) => {\r\n                this.View.extendRecordDOM(newRecords);\r\n              })\r\n          );\r\n        },\r\n        (_update) => null,\r\n        (exit) => exit.each((record) => record.assignDOM(null)).remove()\r\n      );\r\n\r\n    this.DOM.kshfRecords = this.DOM.recordGroup\r\n      .selectAll(\".kshfRecord\")\r\n      .each((record, i, nodes) => {\r\n        var DOM = nodes[i];\r\n        record.assignDOM(DOM);\r\n\r\n        if (this.viewRecAs === \"list\" || this.viewRecAs === \"timeseries\") {\r\n          DOM.tippy.disable();\r\n        } else {\r\n          DOM.tippy.enable();\r\n        }\r\n      });\r\n\r\n    if (isCanvasView) {\r\n      this.DOM.kshfRecords_Path = this.DOM.recordGroup.selectAll(\r\n        \".kshfRecord > path.glyph_Main\"\r\n      );\r\n    }\r\n\r\n    if (this.View instanceof RecordView_Map) {\r\n      this.View.setMaxBounds();\r\n      // continue executing below... no break\r\n    } else if (this.View instanceof RecordView_Scatter) {\r\n      this.View.finishSetAttrib(\"size\"); // TODO: Check / can be removed.\r\n      this.View?.refreshRecordColors();\r\n      //\r\n    }\r\n\r\n    this.View?.refreshSelect_Compare();\r\n    this.View?.updateRecordVisibility();\r\n    this.refreshTextAttrib();\r\n\r\n    this.kshfRecords_Type = this.viewRecAs;\r\n  }\r\n\r\n  /** -- */\r\n  refreshAfterHighlight(v) {\r\n    this.setDimmed(v);\r\n    this.View.refreshLabelOverlaps();\r\n  }\r\n\r\n  /** -- */\r\n  setDimmed(v) {\r\n    this.DOM.root?.classed(\"dimmed\", v);\r\n  }\r\n\r\n  /** -- */\r\n  updateAfterFilter(how) {\r\n    if (this.viewRecAs === \"none\") return;\r\n    this.refreshCompareLegend();\r\n    this.View.updateAfterFilter(how);\r\n  }\r\n\r\n  /** -- */\r\n  getRecordGeoAttributes() {\r\n    return this.browser.attribs.filter(\r\n      (attrib) => attrib instanceof Attrib_RecordGeo\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  exportConfig() {\r\n    var config = {\r\n      viewAs: this.viewRecAs,\r\n      collapsed: this.collapsed,\r\n      colorInvert: this.invertColorTheme,\r\n      filter: this.recordFilter.isFiltered\r\n        ? this.recordFilter.exportFilter()\r\n        : undefined,\r\n    };\r\n\r\n    var attribName: string;\r\n\r\n    [\r\n      \"sort\",\r\n      \"scatterX\",\r\n      \"scatterY\",\r\n      \"color\",\r\n      \"size\",\r\n      \"link\",\r\n      \"timeSeries\",\r\n      \"geo\",\r\n      \"text\",\r\n      \"textBrief\",\r\n    ].forEach((v) => {\r\n      var attrib = this[v + \"Attrib\"];\r\n      if (!attrib) return;\r\n\r\n      if (attrib === \"_measure_\") {\r\n        attribName = \"_measure_\";\r\n      } else if (attrib instanceof Attrib) {\r\n        attribName = attrib.template.str || attrib.attribName;\r\n        if (attrib.hasTimeSeriesParent()) attribName = attrib.template.str;\r\n      } else {\r\n        return;\r\n      }\r\n\r\n      config[v + \"By\"] = attribName;\r\n    });\r\n\r\n    Object.values(this.configs).forEach((_cfg) => _cfg.exportConfigTo(config));\r\n\r\n    return config;\r\n  }\r\n\r\n  /** -- */\r\n  // TO-DO: Improve, A LOT.\r\n  async importConfig(config) {\r\n    if (config == null) return;\r\n\r\n    await this.browser.recordChartType.set(config.viewAs);\r\n\r\n    if (config.colorTheme) {\r\n      this.setRecordColorTheme(config.colorTheme);\r\n    }\r\n    if (config.colorInvert) {\r\n      this.invertColorTheme(true);\r\n    }\r\n    if (config.recordPointSize) {\r\n      await this.recordPointSize.set(config.recordPointSize);\r\n    }\r\n\r\n    if (config.collapsed) {\r\n      this.collapseRecordViewSummary(true);\r\n    } else {\r\n      this.collapseRecordViewSummary(false);\r\n    }\r\n  }\r\n}\r\n","export class MapData {\r\n  // name of the mapdata object\r\n  public readonly name: string;\r\n\r\n  // cache for filename\r\n  private readonly fileName: string;\r\n\r\n  // cache for loaded state\r\n  private _geoLoaded = false;\r\n\r\n  private featureCb?: Function;\r\n  private alternatives: { [index: string]: any[] };\r\n  private defaultIndexedProps: string[];\r\n\r\n  private features: { [index: string]: any } = {};\r\n  // main external access to geometric feature (polygon, etc.) given an indexed key\r\n  getFeature(key: string) {\r\n    return this.features[key];\r\n  }\r\n\r\n  /** -- */\r\n  constructor(name: string, fileName: string, processCfg) {\r\n    this.name = name;\r\n\r\n    this.fileName = fileName + \"?ma\";\r\n\r\n    processCfg = processCfg || {};\r\n    this.featureCb = processCfg.featureCb;\r\n    this.alternatives = processCfg.alternatives || {};\r\n\r\n    this.defaultIndexedProps = [\"id\", \"ISO3166-2\", \"ISO3166-1\"];\r\n    if (processCfg.indexedProps) {\r\n      if (!Array.isArray(processCfg.indexedProps)) {\r\n        processCfg.indexedProps = [processCfg.indexedProps];\r\n      }\r\n      this.defaultIndexedProps = this.defaultIndexedProps.concat(\r\n        processCfg.indexedProps\r\n      );\r\n    }\r\n\r\n    this._processAlternatives(); // calling this to register the names for boost-detection\r\n  }\r\n\r\n  /** -- */\r\n  get geoLoaded() {\r\n    return this._geoLoaded;\r\n  }\r\n\r\n  /** -- */\r\n  _processAlternatives() {\r\n    for (var _from in this.alternatives) {\r\n      var _target = this.alternatives[_from];\r\n\r\n      if (_from === \"expand\") {\r\n        for (var name in this.features) {\r\n          _target.forEach((expander: {from: string, to:string, replace:boolean}) => {\r\n            var _newKey = name.replace(expander.from, expander.to || \"\");\r\n            if (_newKey === name || this.features[_newKey]) {\r\n              return; // same, or key exists\r\n            }\r\n            this.features[_newKey] = this.features[name];\r\n            if (expander.replace) {\r\n              delete this.features[name];\r\n            }\r\n          });\r\n        }\r\n      } else if (Array.isArray(_target)) {\r\n        _target\r\n          .filter((_to) => typeof _to === \"string\")\r\n          .forEach((_to) => {\r\n            this.features[_to] =\r\n              this.features[_to] || this.features[_from] || null;\r\n          });\r\n      }\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  async loadGeo() {\r\n    if (this._geoLoaded) return true;\r\n\r\n    return (\r\n      fetch(this.fileName, { credentials: \"same-origin\" })\r\n        .then((response) => response.json())\r\n\r\n        // if topojson format, load library and parse to geojson\r\n        .then(async (data) => {\r\n          if (!data.objects) return data;\r\n          await import(\"topojson-client\");\r\n          return (window as any).topojson.feature(data, data.objects.regions);\r\n        })\r\n\r\n        .then((geojsonData) => {\r\n          geojsonData.features.forEach((feature) => {\r\n            // move features from .properties.alltags to the .properties so they can be indexed\r\n            if (feature.properties.alltags) {\r\n              for (var k in feature.properties.alltags)\r\n                feature.properties[k] = feature.properties.alltags[k];\r\n              delete feature.properties.alltags;\r\n            }\r\n\r\n            if (this.featureCb) feature = this.featureCb(feature);\r\n\r\n            feature.properties.id = feature.properties.id || feature.id;\r\n\r\n            // detect all properties that include \"name\", but not \"fix\" + indexed properties\r\n            this.defaultIndexedProps\r\n              .concat(\r\n                Object.keys(feature.properties).filter(\r\n                  (x) =>\r\n                    x.toUpperCase().includes(\"NAME\") &&\r\n                    !x.toUpperCase().includes(\"FIX\")\r\n                )\r\n              )\r\n              .forEach((indexProp) => {\r\n                var _index = feature.properties[indexProp];\r\n                if (!_index) return;\r\n                _index = \"\" + _index;\r\n                this.features[_index.toUpperCase()] = feature;\r\n                // index version with \"-\" replaced with \" \"\r\n                if (_index.includes(\"-\")){\r\n                  this.features[_index.replace(/-/g, \" \").toUpperCase()] = feature;\r\n                }\r\n              });\r\n          });\r\n\r\n          this._geoLoaded = true;\r\n          this._processAlternatives();\r\n        })\r\n    );\r\n  }\r\n}\r\n","import { Attrib } from \"./Attrib\";\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Base } from \"./Base\";\r\nimport { MapData } from \"./MapData\";\r\n\r\nvar mapStandardsMenuOpts = {\r\n  id: \"cat_addMap\",\r\n  name: \"Add map\",\r\n  iconClass: \"fa fa-globe\",\r\n  when: (attrib: Attrib) => attrib instanceof Attrib_Categorical && !attrib.catGeo,\r\n  do: async (attrib: Attrib_Categorical, action, path) => {\r\n    path = path.slice(path[1] === \"World\" ? 1 : 2);\r\n    var mapIndex =\r\n      \"Map_\" +\r\n      path.map((_) => _.replace(/ /g, \"\").replace(/-/g, \"\")).join(\"_\") +\r\n      \"_\" +\r\n      action.level;\r\n    await attrib.setCatGeo_(mapIndex + \"[UPPERCASE(*)]\");\r\n  },\r\n  options: [\r\n    {\r\n      name: \"World\",\r\n      options: [\r\n        {\r\n          name: \"Country\",\r\n          value: {\r\n            level: \"Adm2\",\r\n            indexedProps: [\r\n              \"ISO3166-1:alpha2\",\r\n              \"ISO3166-1:alpha3\",\r\n              \"ISO3166-1:numeric\",\r\n            ],\r\n            alternatives: {\r\n              \"BOSNIA AND HERZEGOVINA\": [\"BOSNIA-HERZEGOVINA\"],\r\n              BRUNEI: [\"BRUNEI DARUSSALAM\"],\r\n              BOLIVIA: [\r\n                \"BOLIVARIAN REPUBLIC OF VENEZUELA\",\r\n                \"BOLIVIA, PLURINATIONAL STATE OF\",\r\n              ],\r\n              BAHAMAS: [\"BAHAMAS, THE\", \"THE BAHAMAS\"],\r\n              \"DEMOCRATIC REPUBLIC OF THE CONGO\": [\r\n                \"CONGO, DEM. REP.\",\r\n                \"CONGO, THE DEMOCRATIC REPUBLIC OF THE\",\r\n                \"CONGO, DEMOCRATIC REPUBLIC\",\r\n              ],\r\n              CONGO: [\"CONGO, REP.\", \"CONGO, REPUBLIC OF\"],\r\n              \"CÔTE D'IVOIRE\": [\"COTE D'IVOIRE\", \"IVORY COAST\"],\r\n              CHINA: [\"CHINA, PEOPLE'S REPUBLIC OF\"],\r\n              \"CABO VERDE\": [\"CAPE VERGE\"],\r\n              EGYPT: [\"EGYPT, ARAB REP.\"],\r\n              \"SAHRAWI ARAB DEMOCRATIC REPUBLIC\": [\r\n                \"WESTERN SAHARA\",\r\n                \"Saharawi\",\r\n                \"Sahrawi Republic\",\r\n              ],\r\n              MICRONESIA: [\r\n                \"MICRONESIA, FEDERATED STATES OF\",\r\n                \"MICRONESIA, FED. STS.\",\r\n              ],\r\n              \"UNITED KINGDOM OF GREAT BRITAIN AND NORTHERN IRELAND\": [\r\n                \"UNITED KINGDOM\",\r\n                \"BRITAIN\",\r\n              ],\r\n              GAMBIA: [\"GAMBIA, THE\", \"THE GAMBIA\"],\r\n              IRAN: [\"IRAN, ISLAMIC REPUBLIC OF\", \"IRAN, ISLAMIC REP.\"],\r\n              KOSOVO: [\"XKX\", \"XXK\"],\r\n              KYRGYZSTAN: [\"KYRGYZ REPUBLIC\"],\r\n              \"SAINT KITTS AND NEVIS\": [\"ST. KITTS AND NEVIS\"],\r\n              \"NORTH KOREA\": [\r\n                \"KOREA, DEMOCRATIC PEOPLE'S REPUBLIC OF\",\r\n                \"KOREA, NORTH\",\r\n              ],\r\n              \"SOUTH KOREA\": [\r\n                \"KOREA, REPUBLIC OF\",\r\n                \"KOREA, REP.\",\r\n                \"KOREA, SOUTH\",\r\n              ],\r\n              \"LAO PEOPLE'S DEMOCRATIC REPUBLIC\": [\"LAOS\", \"LAO PDR\"],\r\n              \"SAINT LUCIA\": [\"ST. LUCIA\"],\r\n              MOLDOVA: [\"MOLDOVA, REPUBLIC OF\"],\r\n              MACEDONIA: [\r\n                \"MACEDONIA, THE FORMER YUGOSLAV REPUBLIC OF\",\r\n                \"NORTH MACEDONIA\",\r\n                \"REPUBLIC OF MACEDONIA\",\r\n                \"MACEDONIA, FYR\",\r\n              ],\r\n              MYANMAR: [\"BURMA\"],\r\n              \"PALESTINIAN TERRITORIES\": [\r\n                \"PALESTINE\",\r\n                \"PALESTINE, STATE OF\",\r\n                \"WEST BANK AND GAZA\",\r\n              ],\r\n              REUNION: [\"RÉUNION\"],\r\n              \"RUSSIAN FEDERATION\": [\"RUSSIA\"],\r\n              SLOVAKIA: [\"SLOVAK REPUBLIC\"],\r\n              \"SOUTH SUDAN\": [\"REPUBLIC OF SOUTH SUDAN\"],\r\n              \"SÃO TOMÉ AND PRÍNCIPE\": [\"SAO TOME AND PRINCIPE\"],\r\n              \"SYRIAN ARAB REPUBLIC\": [\"SYRIA\"],\r\n              ESWATINI: [\"SWAZILAND\"],\r\n              TAIWAN: [\"TAIWAN, PROVINCE OF CHINA\", \"TAIWAN (POC)\"],\r\n              TANZANIA: [\"TANZANIA, UNITED REPUBLIC OF\"],\r\n              \"UNITED STATES OF AMERICA\": [\"USA\", \"UNITED STATES\"],\r\n              VATIKAN: [\"HOLY SEE (VATIKAN)\", \"HOLY SEE\"],\r\n              \"SAINT VINCENT AND THE GRENADINES\": [\r\n                \"ST. VINCENT AND GRENADINES\",\r\n                \"ST. VINCENT AND THE GRENADINES\",\r\n              ],\r\n              VIETNAM: [\"VIET NAM\"],\r\n              YEMEN: [\"YEMEN, REP.\", \"REPUBLIC OF YEMEN\", \"YEMEN, REPUBLIC OF\"],\r\n              VENEZUELA: [\"BOLIVARIAN REPUBLIC OF VENEZUELA\", \"VENEZUELA, RB\"],\r\n            },\r\n            featureCb: (feature) => {\r\n              var wrap, adj = 9;\r\n              switch (feature.properties[\"ISO3166-1\"]) {\r\n                case \"RU\":\r\n                case \"NZ\":\r\n                case \"FJ\":\r\n                  wrap = (x) => x < 0;\r\n                  adj = 360;\r\n                  break;\r\n                case \"US\":\r\n                  wrap = (x) => x > 0;\r\n                  adj = -360;\r\n                  break;\r\n              }\r\n              if (wrap) {\r\n                feature.geometry.coordinates.forEach((a, i1) => {\r\n                  a.forEach((b, i2) => {\r\n                    b.forEach((c, i3) => {\r\n                      if (wrap(c[0]))\r\n                        feature.geometry.coordinates[i1][i2][i3][0] = c[0] +=\r\n                          adj;\r\n                    });\r\n                  });\r\n                });\r\n              }\r\n              return feature;\r\n            },\r\n          },\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Central America and the Caribbean\",\r\n      options: [\r\n        {\r\n          name: \"Belize\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Costa Rica\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Canton\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Cuba\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Dominican Republic\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"El Salvador\",\r\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Guatemala\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Haiti\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Arrondissement\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Honduras\",\r\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Jamaica\",\r\n          options: [{ name: \"Parish\", value: { level: \"Adm6\" } }],\r\n        },\r\n        {\r\n          name: \"Nicaragua\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Panama\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Puerto Rico\",\r\n          options: [{ name: \"Municipality\", value: { level: \"Adm6\" } }],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Central Asia\",\r\n      options: [\r\n        {\r\n          name: \"Armenia\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Azerbaijan\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Cyprus\",\r\n          options: [{ name: \"District\", value: { level: \"Adm6\" } }],\r\n        },\r\n        {\r\n          name: \"Georgia\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality / District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Kazakhstan\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Kyrgyzstan\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Russia\",\r\n          options: [{ name: \"Oblast\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Tajikistan\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Turkmenistan\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Uzbekistan\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"East Asia and Pacific\",\r\n      options: [\r\n        {\r\n          name: \"Australia\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            { name: \"LGA\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Brunei\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Cambodia\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"China\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Cities\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Indonesia\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Japan\",\r\n          options: [\r\n            { name: \"Prefecture\", value: { level: \"Adm4\" } },\r\n            { name: \"Subprefecture\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Laos\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Malaysia\",\r\n          options: [{ name: \"State_Territory\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Mongolia\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Myanmar\",\r\n          options: [\r\n            { name: \"Region / State\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"New Zealand\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"North Korea\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"City\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Papua New Guinea\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm3\" } },\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Philippines\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm3\" } },\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Singapore\",\r\n          options: [{ name: \"CDC\", value: { level: \"Adm6\" } }],\r\n        },\r\n        {\r\n          name: \"South Korea\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"City\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Thailand\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Vietnam\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"City\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Europe\",\r\n      options: [\r\n        {\r\n          name: \"Albania\",\r\n          options: [\r\n            { name: \"Counties\", value: { level: \"Adm6\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Austria\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            { name: \"District &amp; S. Cities\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Belarus\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Belgium\",\r\n          options: [\r\n            { name: \"Regions\", value: { level: \"Adm4\" } },\r\n            { name: \"Province\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Bosnia-Herzegovina\",\r\n          options: [\r\n            { name: \"District\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Bulgaria\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm6\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Croatia\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm6\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Czech Republic\",\r\n          options: [\r\n            { name: \"Regions\", value: { level: \"Adm6\" } },\r\n            { name: \"District\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Denmark\",\r\n          options: [{ name: \"Regions\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Estonia\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm6\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Finland\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm6\" } },\r\n            { name: \"Subregion\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"France\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Department\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Germany\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            {\r\n              name: \"District\",\r\n              value: {\r\n                level: \"Adm6\",\r\n                indexedProps: \"de:regionalschluessel\",\r\n                alternatives: { expand: [{ from: /LANDKREIS /g }] },\r\n              },\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Greece\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm5\" } },\r\n            { name: \"Regional Unit\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Hungary\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm6\" } },\r\n            { name: \"District\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Iceland\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm5\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Ireland\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm6\" } },\r\n            { name: \"District\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Italy\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Province\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Kosovo\",\r\n          options: [\r\n            {\r\n              name: \"District\",\r\n              value: {\r\n                level: \"Adm4\",\r\n                alternatives: {\r\n                  PRISHTINA: [\"PRISHTINË\", \"PRISTINA\"],\r\n                  PEJA: [\"PEĆ\", \"PEJE\", \"PEJË\"],\r\n                  GJAKOVA: [\"GJAKOVË\"],\r\n                  expand: [\r\n                    { from: / \\(\\d+\\)/g, replace: true },\r\n                    { from: \"District of \", replace: true },\r\n                    { from: \"Region of \", replace: true },\r\n                  ],\r\n                },\r\n              },\r\n            },\r\n            {\r\n              name: \"Municipality\",\r\n              value: {\r\n                level: \"Adm6\",\r\n                alternatives: {\r\n                  DEÇAN: [\"DEČANI\"],\r\n                  DRAGASH: [\"DRAGAŠ\"],\r\n                  FERIZAJ: [\"UROŠEVAC\"],\r\n                  \"FUSHË KOSOVË\": [\"KOSOVO POLJE\"],\r\n                  GJAKOVË: [\"GJAKOVA\", \"ĐAKOVICA\"],\r\n                  GJILAN: [\"GNJILANE\"],\r\n                  GLLOGOVC: [\"DRENAS\", \"GLOGOVAC\", \"GLLOGOC\"],\r\n                  GRACANICË: [\"GRAČANICA\", \"GRAÇANICË\", \"GRACANICA\"],\r\n                  \"HANI I ELEZIT\": [\"ELEZ HAN\"],\r\n                  ISTOG: [\"BURIM\", \"ISTOK\"],\r\n                  KAÇANIK: [\"KAČANIK\"],\r\n                  KAMENICA: [\"DARDANË\", \"KOSOVSKA KAMENICA\", \"KAMENICË\"],\r\n                  KLINA: [\"KLINË\"],\r\n                  KLOKOT: [\"KLLOKOT\", \"KLLOKOTI\"],\r\n                  LEPOSAVIQ: [\"LEPOSAVIĆ\"],\r\n                  LIPJAN: [\"LIPLJAN\"],\r\n                  MALISHEVË: [\"MALIŠEVO\"],\r\n                  MAMUSHË: [\"MAMUŠA\", \"MAMUSH\"],\r\n                  MITROVICA: [\"MITROVICË\", \"KOSOVSKA MITROVICA\"],\r\n                  \"MITROVICA E VERIUT\": [\r\n                    \"MITROVICA VERIORE\",\r\n                    \"NORTH MITROVICA\",\r\n                    \"SEVERNA KOSOVSKA MITROVICA\",\r\n                    \"SEVERNA MITROVICA\",\r\n                  ],\r\n                  \"NOVO BRDO\": [\"NOVOBËRDË\", \"NOVOBERDE\"],\r\n                  OBILIQ: [\"KASTRIOT\", \"OBILIĆ\", \"OBILIC\"],\r\n                  PARTESH: [\"PARTEŠ\", \"PARTES\"],\r\n                  PEJË: [\"PEĆ\"],\r\n                  PODUJEVË: [\"BESIANË\", \"PODUJEVO\"],\r\n                  PRISHTINË: [\"PRISHTINA\", \"PRISHTINE\", \"PRISTINA\", \"PRIŠTINA\"],\r\n                  RAHOVEC: [\"ORAHOVAC\"],\r\n                  RANILLUG: [\"RANILUG\", \"RANILLUK\"],\r\n                  SHTËRPCE: [\"SHTËRPCË\", \"ŠTRPCE\"],\r\n                  SHTIME: [\"ŠTIMLJE\"],\r\n                  SKENDERAJ: [\"SKËNDERAJ\", \"SRBICA\"],\r\n                  \"SUHA REKË\": [\"SUHAREKË\", \"THERANDË\", \"SUVA REKA\"],\r\n                  VITI: [\"VITINA\", \"VITIA\"],\r\n                  VUSHTRRI: [\"VUČITRN\"],\r\n                  \"ZUBIN POTOK\": [\"ZUBIN POTOKU\", \"ZUBİN POTOK\"],\r\n                  ZVEÇAN: [\"ZVEČAN\"],\r\n                  expand: [\r\n                    { from: / \\(\\d+\\)/g, replace: true },\r\n                    { from: \"Municipality of \", replace: true },\r\n                    { from: \"Region of \", replace: true },\r\n                  ],\r\n                },\r\n              },\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Latvia\",\r\n          options: [{ name: \"Municipality\", value: { level: \"Adm6\" } }],\r\n        },\r\n        {\r\n          name: \"Lithuania\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Macedonia\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            {\r\n              name: \"Municipality\",\r\n              value: {\r\n                level: \"Adm7\",\r\n                alternatives: { expand: [{ from: /MUNICIPALITY OF /g }] },\r\n              },\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Moldova\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Montenegro\",\r\n          options: [{ name: \"Municipality\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Netherlands\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm3\" } },\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Norway\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Poland\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"County\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Portugal\",\r\n          options: [\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Romania\",\r\n          options: [{ name: \"County\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Serbia\",\r\n          options: [\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n            { name: \"Municipality_City\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Slovakia\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Slovenia\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm5\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Spain\",\r\n          options: [\r\n            { name: \"Autonomous Community\", value: { level: \"Adm4\" } },\r\n            { name: \"Province\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Sweden\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Switzerland\",\r\n          options: [\r\n            { name: \"Canton\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Turkey\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm3\" } },\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Ukraine\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Raion\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"United Kingdom\",\r\n          options: [\r\n            { name: \"Country\", value: { level: \"Adm4\" } },\r\n            { name: \"County / Unitary authorities\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Middle East and North Africa\",\r\n      options: [\r\n        {\r\n          name: \"Algeria\", // NOT READY\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n            // { \"name\": \"Municipality\", \"value\": { \"level\": \"Adm8\"} }, // Not OSM-based\r\n          ],\r\n        },\r\n        {\r\n          name: \"Bahrain\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Egypt\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Iraq\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Iran\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"County\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Israel\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Jordan\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Kuwait\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Lebanon\",\r\n          options: [\r\n            { name: \"Governorate\", value: { level: \"Adm3\" } },\r\n            { name: \"District\", value: { level: \"Adm4\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Libya\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Morocco\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Profecture / Province\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Oman\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Palestine\",\r\n          options: [\r\n            { name: \"Territory\", value: { level: \"Adm3\" } },\r\n            { name: \"Governorate\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Qatar\",\r\n          options: [{ name: \"Municipality\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Saudi Arabia\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Syria\",\r\n          options: [\r\n            {\r\n              name: \"Governorate\",\r\n              value: { level: \"Adm4\", indexedProps: [\"PCODE\"] },\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Tunisia\",\r\n          options: [\r\n            { name: \"Governorate\", value: { level: \"Adm4\" } },\r\n            { name: \"Delegation\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"United Arab Emirates\",\r\n          options: [{ name: \"Emirate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Yemen\",\r\n          options: [\r\n            {\r\n              name: \"Governorate\",\r\n              value: {\r\n                level: \"Adm4\",\r\n                alternatives: { expand: [{ from: / GOVERNORATE/g }] },\r\n              },\r\n            },\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"North Ameria\",\r\n      options: [\r\n        {\r\n          name: \"Canada\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Mexico\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"United States\",\r\n          options: [\r\n            {\r\n              name: \"States\",\r\n              value: {\r\n                level: \"Adm4\",\r\n                indexedProps: [\"ISO3166_2\"],\r\n                alternatives: {\r\n                  expand: [{ from: \"US-\", replace: true }],\r\n                  // fips codes\r\n                  ALABAMA: [1, \"01\"],\r\n                  ALASKA: [2, \"02\"],\r\n                  ARIZONA: [4, \"04\"],\r\n                  ARKANSAS: [5, \"05\"],\r\n                  CALIFORNIA: [6, \"06\"],\r\n                  COLORADO: [8, \"08\"],\r\n                  CONNECTICUT: [9, \"09\"],\r\n                  DELAWARE: [10],\r\n                  \"DISTRICT OF COLUMBIA\": [11],\r\n                  FLORIDA: [12],\r\n                  GEORGIA: [13],\r\n                  HAWAII: [15],\r\n                  IDAHO: [16],\r\n                  ILLINOIS: [17],\r\n                  INDIANA: [18],\r\n                  IOWA: [19],\r\n                  KANSAS: [20],\r\n                  KENTUCKY: [21],\r\n                  LOUISIANA: [22],\r\n                  MAINE: [23],\r\n                  MARYLAND: [24],\r\n                  MASSACHUSETTS: [25],\r\n                  MICHIGAN: [26],\r\n                  MINNESOTA: [27],\r\n                  MISSISSIPPI: [28],\r\n                  MISSOURI: [29],\r\n                  MONTANA: [30],\r\n                  NEBRASKA: [31],\r\n                  NEVADA: [32],\r\n                  \"NEW HAMPSHIRE\": [33],\r\n                  \"NEW JERSEY\": [34],\r\n                  \"NEW MEXICO\": [35],\r\n                  \"NEW YORK\": [36],\r\n                  \"NORTH CAROLINA\": [37],\r\n                  \"NORTH DAKOTA\": [38],\r\n                  OHIO: [39],\r\n                  OKLAHOMA: [40],\r\n                  OREGON: [41],\r\n                  PENNSYLVANIA: [42],\r\n                  \"RHODE ISLAND\": [44],\r\n                  \"SOUTH CAROLINA\": [45],\r\n                  \"SOUTH DAKOTA\": [46],\r\n                  TENNESSEE: [47],\r\n                  TEXAS: [48],\r\n                  UTAH: [49],\r\n                  VERMONT: [50],\r\n                  VIRGINIA: [51],\r\n                  WASHINGTON: [53],\r\n                  \"WEST VIRGINIA\": [54],\r\n                  WISCONSIN: [55],\r\n                  WYOMING: [56],\r\n                  \"AMERICAN SAMOA\": [60],\r\n                  GUAM: [14, 66],\r\n                  \"NORTHERN MARIANA ISLANDS\": [69],\r\n                  \"PUERTO RICO\": [72],\r\n                  \"VIRGIN ISLANDS\": [78],\r\n                },\r\n                featureCb: (feature) => {\r\n                  var wrap = null,\r\n                    adj = 9;\r\n                  switch (feature.properties.name) {\r\n                    case 2:\r\n                    case \"AK\":\r\n                    case \"Alaska\":\r\n                    case \"Northern Mariana Islands\":\r\n                    case \"Guam\":\r\n                      wrap = (x) => x > 0;\r\n                      adj = -360;\r\n                      break;\r\n                  }\r\n                  if (wrap) {\r\n                    if (feature.geometry.coordinates[0][0][0][0]) {\r\n                      feature.geometry.coordinates.forEach((a, i1) => {\r\n                        a.forEach((b, i2) => {\r\n                          b.forEach((c, i3) => {\r\n                            if (wrap(c[0])) {\r\n                              feature.geometry.coordinates[i1][i2][i3][0] =\r\n                                c[0] += adj;\r\n                            }\r\n                          });\r\n                        });\r\n                      });\r\n                    } else {\r\n                      feature.geometry.coordinates.forEach((a, i1) => {\r\n                        a.forEach((b, i2) => {\r\n                          if (wrap(b[0])) {\r\n                            feature.geometry.coordinates[i1][i2][0] = b[0] +=\r\n                              adj;\r\n                          }\r\n                        });\r\n                      });\r\n                    }\r\n                  }\r\n                  return feature;\r\n                },\r\n              },\r\n            },\r\n            {\r\n              name: \"Counties\",\r\n              value: {\r\n                level: \"Adm6\",\r\n                indexedProps: [\"GEO_ID\"],\r\n                alternatives: {\r\n                  expand: [{ from: \"0500000US\", replace: true }],\r\n                },\r\n              },\r\n            },\r\n            {\r\n              name: \"Congressional Districts\",\r\n              options: [\r\n                {\r\n                  name: \"115th\",\r\n                  value: {\r\n                    level: \"CD115\",\r\n                    featureCb: (feature) => {\r\n                      var wrap = null,\r\n                        adj = 9;\r\n                      switch (feature.properties.id.substr(0, 2)) {\r\n                        case \"AK\":\r\n                          wrap = (x) => x > 0;\r\n                          adj = -360;\r\n                          break;\r\n                      }\r\n                      if (wrap) {\r\n                        feature.geometry.coordinates.forEach((a, i1) => {\r\n                          a.forEach((b, i2) => {\r\n                            b.forEach((c, i3) => {\r\n                              if (wrap(c[0]))\r\n                                feature.geometry.coordinates[i1][i2][i3][0] =\r\n                                  c[0] += adj;\r\n                            });\r\n                          });\r\n                        });\r\n                      }\r\n                      return feature;\r\n                    },\r\n                  },\r\n                },\r\n                {\r\n                  name: \"115th-Hexagon\",\r\n                  value: {\r\n                    level: \"CD115HEX\",\r\n                    indexedProps: [\"GEO_ID\"],\r\n                    featureCb: (feature) => {\r\n                      feature.properties.GEO_ID =\r\n                        feature.properties.STATEAB +\r\n                        \"-\" +\r\n                        feature.properties.CDLABEL.padStart(2, \"0\");\r\n                      return feature;\r\n                    },\r\n                  },\r\n                },\r\n              ],\r\n            },\r\n            {\r\n              name: \"DC\",\r\n              options: [\r\n                {\r\n                  name: \"Wards (2012)\",\r\n                  value: { level: \"Wards2012\", indexedProps: [\"WARD\"] },\r\n                },\r\n                {\r\n                  name: \"ANCs (2013)\",\r\n                  value: { level: \"ANC2013\", indexedProps: [\"ANC_ID\"] },\r\n                },\r\n                {\r\n                  name: \"Neighborhoods\",\r\n                  value: { level: \"Neighborhoods\", indexedProps: [\"subhood\"] },\r\n                },\r\n              ],\r\n            },\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"South America\",\r\n      options: [\r\n        {\r\n          name: \"Argentina\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Department\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Bolivia\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Province\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Brazil\",\r\n          options: [{ name: \"State\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Chile\",\r\n          options: [\r\n            { name: \"Regions\", value: { level: \"Adm4\" } },\r\n            { name: \"Province\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Colombia\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Ecuador\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Cantons\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Guyana\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Paraguay\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Peru\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Suriname\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Uruguay\",\r\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Venezuela\",\r\n          options: [{ name: \"State\", value: { level: \"Adm4\" } }],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"South Asia\",\r\n      options: [\r\n        {\r\n          name: \"Afghanistan\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Bangladesh\",\r\n          options: [\r\n            {\r\n              name: \"Divisions\",\r\n              value: { level: \"Adm4\", indexedProps: \"Division\" },\r\n            },\r\n            {\r\n              name: \"District\",\r\n              value: {\r\n                level: \"Adm5\",\r\n                indexedProps: \"District\",\r\n                alternatives: {\r\n                  NETRAKONA: [\"NETROKONA\"],\r\n                  BRAHAMANBARIA: [\"BRAHMANBARIA\"],\r\n                  NAWABGANJ: [\"CHAPAI NAWABGANJ\"],\r\n                },\r\n              },\r\n            },\r\n            {\r\n              name: \"Upazilas\",\r\n              value: {\r\n                level: \"Adm6\",\r\n                indexedProps: \"Upazila\",\r\n                alternatives: {\r\n                  NETRAKONA: [\"NETROKONA\"],\r\n                  BRAHAMANBARIA: [\"BRAHMANBARIA\"],\r\n                  NAWABGANJ: [\"CHAPAI NAWABGANJ\"],\r\n                },\r\n              },\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Bhutan\",\r\n          options: [\r\n            { name: \"District\", value: { level: \"Adm4\" } },\r\n            { name: \"Gewogs\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"India\",\r\n          options: [\r\n            { name: \"State_Union_Territory\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Nepal\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Zone\", value: { level: \"Adm5\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Pakistan\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm3\" } }],\r\n        },\r\n        {\r\n          name: \"Sri Lanka\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Sub-Saharan Africa\",\r\n      options: [\r\n        {\r\n          name: \"Angola\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Benin\",\r\n          options: [\r\n            { name: \"Department\", value: { level: \"Adm4\" } },\r\n            { name: \"Communes\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Botswana\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Burkina Faso\",\r\n          options: [\r\n            { name: \"Regions\", value: { level: \"Adm4\" } },\r\n            { name: \"Province\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Burundi\",\r\n          options: [{ name: \"Provices\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Cameroon\",\r\n          options: [\r\n            { name: \"Regions\", value: { level: \"Adm4\" } },\r\n            { name: \"Department\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Central African Republic\",\r\n          options: [{ name: \"Prefectures\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Chad\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Congo\",\r\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Djibouti\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"DR-Congo\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Eritrea\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Ethiopia\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Zone\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Gabon\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Ghana\",\r\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Gambia\",\r\n          options: [\r\n            { name: \"Regions\", value: { level: \"Adm4\" } },\r\n            { name: \"LGAs\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Guinea\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Ivory Coast\",\r\n          options: [\r\n            { name: \"District\", value: { level: \"Adm4\" } },\r\n            { name: \"Region\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Kenya\",\r\n          options: [{ name: \"County\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Lesotho\",\r\n          options: [{ name: \"District\", value: { level: \"Adm5\" } }],\r\n        },\r\n        {\r\n          name: \"Liberia\",\r\n          options: [\r\n            { name: \"County\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Madagascar\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Malawi\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm3\" } },\r\n            { name: \"District\", value: { level: \"Adm4\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Mali\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Cercle\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Mauritania\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Mozambique\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Namibia\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Niger\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Department\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Nigeria\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            { name: \"LGA\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Rwanda\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Senegal\",\r\n          options: [{ name: \"Region\", value: { level: \"Adm3\" } }],\r\n        },\r\n        {\r\n          name: \"Somalia\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Sierra Leone\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"South Africa\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"South Sudan\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            {\r\n              name: \"County\",\r\n              value: { level: \"Adm6\", indexedProps: [\"ADM2_EN\", \"ADM2_PCODE\"] },\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Sudan\",\r\n          options: [\r\n            { name: \"State\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Swaziland\",\r\n          options: [\r\n            { name: \"District\", value: { level: \"Adm4\" } },\r\n            { name: \"Inkhundla\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Tanzania\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm5\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Togo\",\r\n          options: [\r\n            { name: \"Region\", value: { level: \"Adm4\" } },\r\n            { name: \"Prefecture\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n        {\r\n          name: \"Uganda\",\r\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Zambia\",\r\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\r\n        },\r\n        {\r\n          name: \"Zimbabwe\",\r\n          options: [\r\n            { name: \"Province\", value: { level: \"Adm4\" } },\r\n            { name: \"District\", value: { level: \"Adm6\" } },\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n  ],\r\n};\r\n\r\nvar _mapShapesLoaded = false;\r\n\r\n/** -- */\r\nfunction loadMapStandards() {\r\n  if (_mapShapesLoaded) return;\r\n\r\n  // recursive call\r\n  function addMapIndex(obj, path) {\r\n    if (obj.value) {\r\n      var level = obj.value.level;\r\n      if (path[0] !== \"World\" && path[0] !== \"Custom\") path = path.slice(1);\r\n      var mapIndex = `Map_${path.map((_) => _.replace(/ /g, \"\").replace(/-/g, \"\")).join(\"_\")}_${level}`;\r\n      Base.maps.set(\r\n        mapIndex,\r\n        new MapData(\r\n          mapIndex,\r\n          `${Base.geoFileDir}${path.concat(level).join(\"/\")}.${\r\n            Base.geoFileExt\r\n          }`,\r\n          obj.value\r\n        )\r\n      );\r\n    } else if (obj.options) {\r\n      path = path.concat([obj.name]);\r\n      obj.options.forEach((_) => addMapIndex(_, path));\r\n    }\r\n  }\r\n\r\n  mapStandardsMenuOpts.options.forEach((region) => addMapIndex(region, []));\r\n\r\n  _mapShapesLoaded = true;\r\n}\r\n\r\nexport { mapStandardsMenuOpts, loadMapStandards };\r\n","import { Attrib } from \"../Attrib\";\r\nimport { Browser } from \"../Browser\";\r\nimport { SelectType } from \"../Types\";\r\nimport { Filter, Filter_Base } from \"../Filter\";\r\nimport { i18n } from \"../i18n\";\r\n\r\nexport class BreadCrumb {\r\n  private readonly browser: Browser;\r\n\r\n  public DOM: any = null; // d3-selection\r\n\r\n  /** -- */\r\n  constructor(browser: Browser, selectType: SelectType) {\r\n    this.browser = browser;\r\n    this.selectType = selectType;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Select type (Filter, Compare_X)\r\n  // ********************************************************************\r\n\r\n  public selectType: SelectType; // can be converted at runtime (Compare can become filter)\r\n\r\n  private timeoutHide: number;\r\n\r\n  /** -- */\r\n  showCrumb(selectType, filter: Filter_Base) {\r\n    this.selectType = selectType;\r\n\r\n    if (this.timeoutHide) window.clearTimeout(this.timeoutHide);\r\n\r\n    let attrib: Attrib = filter instanceof Filter ? filter.attrib : null;\r\n\r\n    if (!this.DOM) {\r\n      var parentDOM =\r\n        this.selectType === \"Filter\"\r\n          ? this.browser.DOM.breadCrumbs_Filter\r\n          : this.browser.DOM.breadCrumbs_Compare;\r\n\r\n      this.DOM = parentDOM\r\n        .append(\"span\")\r\n        .html(\r\n          `<span class='breadCrumbIcon'><i class='fa fa-filter'></i><i class='fa fa-times'></i></span>` +\r\n            `<span class='crumbText'><span class='crumbHeader blockName'></span><span class='crumbDetails'></span></span>`\r\n        )\r\n        .each((_, i, nodes) => {\r\n          if (this.selectType === \"Filter\") {\r\n            let DOM = nodes[i];\r\n            var l = DOM.parentNode.childNodes.length;\r\n            if (l > 1) {\r\n              DOM.parentNode.insertBefore(\r\n                DOM,\r\n                DOM.parentNode.childNodes[l - 2]\r\n              );\r\n            }\r\n          }\r\n        })\r\n        .on(\"mouseenter\", () => {\r\n          if (this.selectType !== \"Filter\") {\r\n            this.browser.refreshAllMeasureLabels(this.selectType);\r\n          }\r\n        })\r\n        .on(\"mouseleave\", () => {\r\n          if (this.selectType === \"Filter\") {\r\n            this.browser.refreshAllMeasureLabels(\"Active\");\r\n          }\r\n        })\r\n        .on(\"click\", () => {\r\n          if (this.selectType === \"Filter\") {\r\n            filter.clearFilter();\r\n          } else {\r\n            this.browser.clearSelect_Compare(this.selectType, true, true);\r\n            this.browser.refreshAllMeasureLabels(\"Active\");\r\n          }\r\n        });\r\n\r\n      this.DOM.style(\"opacity\", 0).transition().style(\"opacity\", 1);\r\n    }\r\n\r\n    this.DOM.attr(\"class\", \"breadCrumb crumbMode_\" + this.selectType)\r\n      .attr(\"data-summaryID\", attrib?.attribID ?? null)\r\n      .tooltip(\r\n        () => i18n[this.selectType === \"Filter\" ? \"RemoveFilter\" : \"Unlock\"]\r\n      );\r\n\r\n    if (this.selectType === \"Filter\") {\r\n      this.browser.DOM.breadCrumbs_Filter.node().appendChild(this.DOM.node());\r\n\r\n      var crumbHeader = this.DOM.select(\".crumbHeader\");\r\n      if (attrib) {\r\n        attrib.addDOMBlockName(crumbHeader);\r\n      } else {\r\n        crumbHeader.html(filter.title);\r\n      }\r\n      this.DOM.select(\".crumbDetails\").html(filter.filterView_Detail());\r\n    } else {\r\n      this.DOM.select(\".crumbDetails\").html(\r\n        this.browser.selectedAggrs[this.selectType]?.label || \"\"\r\n      );\r\n    }\r\n\r\n    this.browser.checkAndAdjustBreadcrumbs();\r\n  }\r\n\r\n  /** -- */\r\n  removeCrumb() {\r\n    if (!this.DOM) return;\r\n\r\n    if (this.timeoutHide) window.clearTimeout(this.timeoutHide);\r\n\r\n    this.timeoutHide = window.setTimeout(\r\n      () => {\r\n        this.timeoutHide = 0;\r\n        this.DOM.style(\"opacity\", 0)\r\n          .transition()\r\n          .delay(300)\r\n          .remove()\r\n          .on(\"end\", () => {\r\n            this.DOM.node().tippy?.hide();\r\n            this.browser.checkAndAdjustBreadcrumbs();\r\n            this.DOM = null;\r\n          });\r\n      },\r\n      // duration for timeout\r\n      this.selectType !== \"Filter\" &&\r\n        !this.browser.lockedCompare[this.selectType]\r\n        ? 1000\r\n        : 0\r\n    );\r\n  }\r\n}\r\n","import { Attrib } from \"../Attrib\";\r\nimport { Attrib_Categorical } from \"../Attrib_Categorical\";\r\nimport { Attrib_Numeric } from \"../Attrib_Numeric\";\r\nimport { Attrib_RecordGeo } from \"../Attrib_RecordGeo\";\r\nimport { Attrib_Timeseries } from \"../Attrib_Timeseries\";\r\nimport { Attrib_Timestamp } from \"../Attrib_Timestamp\";\r\n\r\nimport { Base } from \"../Base\";\r\nimport { Browser } from \"../Browser\";\r\nimport { i18n } from \"../i18n\";\r\nimport { mapStandardsMenuOpts } from \"../MapStandards\";\r\nimport { Modal } from \"./Modal\";\r\n\r\nexport var MenuOpts = {\r\n  /** -- */\r\n  AttribPanel: {\r\n    name: \"Options\",\r\n    items: [\r\n      {\r\n        id: \"CollapseAll\",\r\n        name: \"Collapse All\",\r\n        iconClass: \"fa fa-caret-up\",\r\n        do: (dashboard: Browser) => dashboard.collapseAttribListGroups(true),\r\n      },\r\n      {\r\n        id: \"ExpandAll\",\r\n        name: \"Expand All\",\r\n        iconClass: \"fa fa-caret-down\",\r\n        do: (dashboard: Browser) => dashboard.collapseAttribListGroups(false),\r\n      },\r\n      {\r\n        id: \"SetAttribPanelWidth\",\r\n        name: \"Set panel width\",\r\n        iconClass: \"fa fa-arrows-h\",\r\n        do: (dashboard: Browser) => {\r\n          var x = Modal.prompt(\r\n            \"Enter width in pixels (between 200 and 400)\",\r\n            dashboard.attribPanelWidth\r\n          );\r\n          if (x) dashboard.setAttribPanelWidth(x);\r\n        },\r\n      },\r\n    ],\r\n  },\r\n\r\n  /** -- */\r\n  Attrib_Grouping: {\r\n    name: \"Settings\",\r\n    items: [\r\n      {\r\n        id: \"createTimeseries\",\r\n        name: \"Create Timeseries\",\r\n        iconClass: \"fa fa-chart-line\",\r\n        when: () => true,\r\n        do: (groupInfo, action) => {\r\n          if (action === \"prompt()\") {\r\n            action = Modal.prompt(\"Enter time index format\");\r\n            if (!action) return;\r\n          }\r\n          // todo: update it to retrieve from parameter, not global space.\r\n          var dashboard = Base.browser;\r\n\r\n          var chain = groupInfo.parents.slice();\r\n          chain.push(groupInfo.name);\r\n\r\n          var pathStr = chain.join(\"->\");\r\n\r\n          dashboard.onLoad[pathStr] = `${pathStr}->\\${DATETIME(${action})}`;\r\n\r\n          var newConfig = dashboard.exportConfig();\r\n          // delete all the summaries which are indexed under this timeseries variable\r\n          newConfig.summaries = newConfig.summaries.filter((cfg) => {\r\n            var attrib = dashboard.attribWithName(cfg.name);\r\n            if (!attrib) return false;\r\n            if (attrib.block?.inDashboard) return true;\r\n            return pathStr !== attrib.template.pathStr;\r\n          });\r\n\r\n          dashboard = Base.reloadWithNewConfig(dashboard, newConfig);\r\n        },\r\n        options: [\r\n          { name: \"YYYY\", sampleValue: \"2019\", value: \"%Y\" },\r\n          { name: \"YYYY-MM\", sampleValue: \"2019-12\", value: \"%Y-%m\" },\r\n          {\r\n            name: \"YYYY-MM-DD\",\r\n            sampleValue: \"2019-12-30\",\r\n            value: \"%Y-%m-%d\",\r\n          },\r\n          {\r\n            name: \"MM/DD/YYYY\",\r\n            sampleValue: \"12/30/2019\",\r\n            value: \"%m/%d/%Y\",\r\n          },\r\n          { name: \"MM/DD/YY\", sampleValue: \"12/30/16\", value: \"%m/%d/%y\" },\r\n          {\r\n            name: \"YYYY-MM-DD\",\r\n            sampleValue: \"2019-12-30\",\r\n            value: \"%Y-%m-%d\",\r\n          },\r\n          { name: \"<i>Custom</i>\", value: \"prompt()\" },\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n\r\n  /** -- */\r\n  Attribute: {\r\n    name: \"Settings\",\r\n\r\n    items: [\r\n      // *************************\r\n      {\r\n        id: \"renameAttrib\",\r\n        name: \"Rename\",\r\n        iconClass: \"fa fa-pencil\",\r\n        helparticle: \"5ea92f902c7d3a5ea54a1c35\",\r\n        when: (attrib: Attrib) => !attrib.hasTimeSeriesParent(),\r\n        do: (attrib: Attrib) => {\r\n          var x = Modal.prompt(\r\n            \"Please enter the new attribute name.\",\r\n            attrib.attribName\r\n          );\r\n          if (x) attrib.attribName = x;\r\n        },\r\n      },\r\n\r\n      // *************************\r\n      {\r\n        id: \"setDescription\",\r\n        name: \"Set description\",\r\n        iconClass: \"fa fa-info\",\r\n        helparticle: \"5ea8b8dc2c7d3a5ea54a18ad\",\r\n        when: (attrib: Attrib) => !attrib.hasTimeSeriesParent(),\r\n        do: (attrib: Attrib) => {\r\n          var x = Modal.prompt(\r\n            \"Please enter a short description for this attribute.\",\r\n            attrib.description ? attrib.description : \"\"\r\n          );\r\n          if (x != null) attrib.description = x;\r\n        },\r\n      },\r\n\r\n      // ****************************\r\n      {\r\n        id: \"setUnitName\",\r\n        name: \"Set unit-name\",\r\n        iconClass: \"fa fa-ellipsis-h\",\r\n        helparticle: \"5e88f31404286364bc97d467\",\r\n        when: (attrib: Attrib) =>\r\n          (attrib.type === \"timeseries\" || attrib.type === \"numeric\") &&\r\n          !attrib.hasTimeSeriesParent(),\r\n        do: (attrib: Attrib) => {\r\n          var x = Modal.prompt(\r\n            \"Please enter the unit name\",\r\n            attrib.unitName || \"\"\r\n          );\r\n          if (x != null) attrib.unitName = x;\r\n        },\r\n      },\r\n\r\n      {\r\n        id: \"convertDataType\",\r\n        name: \"Convert data type\",\r\n        iconClass: \"fa fa-wrench\",\r\n        options: [\r\n          // SPLIT CATEGORIES\r\n          {\r\n            id: \"cat_splitCat\",\r\n            name: \"Multi-Cat. (Split by)\",\r\n            iconClass: \"fa fa-tags\",\r\n            helparticle: \"5e88d4172c7d3a7e9aea63ac\",\r\n            when: (attrib: Attrib) =>\r\n              attrib instanceof Attrib_Categorical && !attrib.isMultiValued,\r\n            do: (attrib: Attrib_Categorical, action) => {\r\n              if (action === \"prompt()\") {\r\n                action = Modal.prompt(\"Enter split format\");\r\n                if (!action) return;\r\n              }\r\n\r\n              attrib.browser.onLoad.main[\r\n                attrib.template.str\r\n              ] = `SPLIT(${action})`;\r\n\r\n              (window as any).dashboard = Base.reloadWithNewConfig(\r\n                attrib.browser,\r\n                attrib.browser.exportConfig()\r\n              );\r\n            },\r\n            options: [\r\n              {\r\n                name: \"Space\",\r\n                iconXML: \"_\",\r\n                value: \"\\\\s+\",\r\n                hint: \"Any whitespace\",\r\n              },\r\n              { name: \"Comma\", iconXML: \",\", value: \"\\\\s*,\\\\s*\" },\r\n              { name: \"Semicolumn\", iconXML: \";\", value: \"\\\\s*;\\\\s*\" },\r\n              { name: \"Vertical-bar\", iconXML: \"|\", value: \"\\\\s*\\\\|\\\\s*\" },\r\n              { name: \"Plus\", iconXML: \"+\", value: \"\\\\s*\\\\+\\\\s*\" },\r\n              { name: \"Star\", iconXML: \"*\", value: \"\\\\s*\\\\*\\\\s*\" },\r\n              { name: \"Custom\", iconXML: \"?\", value: \"prompt()\" },\r\n            ],\r\n          },\r\n\r\n          {\r\n            id: \"convertToCategorical\",\r\n            name: \"Categorical\",\r\n            iconClass: \"fa fa-tag\",\r\n            helparticle: \"5e890d9104286364bc97d4ff\",\r\n            when: (attrib: Attrib) => attrib instanceof Attrib_Numeric && !attrib.timeseriesParent,\r\n            do: (attrib: Attrib_Numeric) => {\r\n              Modal.confirm(\r\n                `Do you want to convert <i>${attrib.attribName}</i> to categorical data?`,\r\n                \"Convert\"\r\n              ).then(\r\n                () => {\r\n                  attrib.browser.onLoad.main[attrib.template.str] = \"STR()\";\r\n\r\n                  var newConfig = attrib.browser.exportConfig();\r\n                  newConfig.summaries\r\n                    .filter((s) => s.name === attrib.attribName)\r\n                    .forEach((s) => {\r\n                      s.type = \"categorical\";\r\n                    });\r\n                  if (\r\n                    newConfig.metric &&\r\n                    newConfig.metric.summary === attrib.attribName\r\n                  ) {\r\n                    delete newConfig.metric;\r\n                  }\r\n                  (window as any).dashboard = Base.reloadWithNewConfig(\r\n                    attrib.browser,\r\n                    newConfig\r\n                  );\r\n                },\r\n                () => {}\r\n              );\r\n            },\r\n          },\r\n          {\r\n            id: \"num_convertToTimestamp\",\r\n            name: \"Timestamp\",\r\n            iconClass: \"fa fa-calendar-alt\",\r\n            helparticle: \"5e88ec2c04286364bc97d44b\",\r\n            when: (attrib: Attrib) => attrib instanceof Attrib_Numeric && !attrib.timeseriesParent,\r\n            do: (attrib: Attrib_Numeric, action) => {\r\n              if (action === \"prompt()\") {\r\n                action = Modal.prompt(\r\n                  \"Enter datetime format, using https://github.com/d3/d3-time-format#locale_format\"\r\n                );\r\n                if (!action) return;\r\n              }\r\n              attrib.browser.onLoad.main[\r\n                attrib.template.str\r\n              ] = `DATETIME(${action})`;\r\n\r\n              var newConfig = attrib.browser.exportConfig();\r\n              newConfig.summaries\r\n                .filter((s) => s.name === attrib.attribName)\r\n                .forEach((s) => {\r\n                  delete s.type;\r\n                  delete s.showPercentiles;\r\n                  delete s.skipZero;\r\n                });\r\n\r\n              (window as any).dashboard = Base.reloadWithNewConfig(\r\n                attrib.browser,\r\n                newConfig\r\n              );\r\n            },\r\n            options: [\r\n              { \r\n                name: \"YYYY\",\r\n                sampleValue: \"2019\",\r\n                value: \"%Y\"\r\n              },\r\n              {\r\n                name: \"Serial/Sheet date\",\r\n                sampleValue: \"42010.2\",\r\n                value: \"%sn\",\r\n              },\r\n              // seconds since UNIX epoch\r\n              {\r\n                name: \"UNIX epoch-sec\",\r\n                sampleValue: \"1499310012\",\r\n                value: \"%s\",\r\n              },\r\n              // milliseconds since UNIX epoch\r\n              {\r\n                name: \"UNIX epoch-ms\",\r\n                sampleValue: \"1499310012000\",\r\n                value: \"%Q\",\r\n              },\r\n              { name: \"<i>Custom</i>\", sampleValue: \"?\", value: \"prompt()\" },\r\n            ],\r\n          },\r\n          {\r\n            id: \"cat_convertToTimestamp\",\r\n            name: \"Timestamp\",\r\n            iconClass: \"fa fa-calendar\",\r\n            helparticle: \"5e88ec2304286364bc97d44a\",\r\n            when: (attrib: Attrib) =>\r\n              attrib instanceof Attrib_Categorical &&\r\n              !attrib.isMultiValued &&\r\n              !attrib.catGeo,\r\n            do: (attrib: Attrib_Categorical, action) => {\r\n              if (action === \"prompt()\") {\r\n                action = Modal.prompt(\r\n                  \"Enter datetime format, using https://github.com/d3/d3-time-format#locale_format\"\r\n                );\r\n                if (!action) return;\r\n              }\r\n              attrib.browser.onLoad.main[\r\n                attrib.template.str\r\n              ] = `DATETIME(${action})`;\r\n\r\n              var newConfig = attrib.browser.exportConfig();\r\n              // Existing summary will have a \"categorical\" type. delete the type...\r\n              newConfig.summaries\r\n                .filter((s) => s.name === attrib.attribName)\r\n                .forEach((c) => {\r\n                  delete c.type;\r\n                  delete c.catLabel;\r\n                  delete c.catSortBy;\r\n                  delete c.catGeo;\r\n                  delete c.barHeight;\r\n                  delete c.showSetMatrix;\r\n                });\r\n\r\n              (window as any).dashboard = Base.reloadWithNewConfig(\r\n                attrib.browser,\r\n                newConfig\r\n              );\r\n            },\r\n            options: [\r\n              {\r\n                name: \"YYYY\",\r\n                sampleValue: \"2019\",\r\n                value: \"%Y\"\r\n              },\r\n              {\r\n                name: \"MM/DD/YYYY\",\r\n                sampleValue: \"12/30/2019\",\r\n                value: \"%m/%d/%Y\",\r\n              },\r\n              {\r\n                name: \"DD/MM/YYYY\",\r\n                sampleValue: \"30/12/2019\",\r\n                value: \"%d/%m/%Y\",\r\n              },\r\n              {\r\n                name: \"MM/DD/YY\",\r\n                sampleValue: \"12/30/16\",\r\n                value: \"%m/%d/%y\",\r\n              },\r\n              {\r\n                name: \"YYYY-MM-DD\",\r\n                sampleValue: \"2019-12-30\",\r\n                value: \"%Y-%m-%d\",\r\n              },\r\n              {\r\n                name: \"MM/DD/YYYY hh:mm\",\r\n                sampleValue: \"12/30/2019 13:10\",\r\n                value: \"%m/%d/%Y %H:%M\",\r\n              },\r\n              {\r\n                name: \"DD/MM/YYYY hh:mm\",\r\n                sampleValue: \"30/12/2019 13:10\",\r\n                value: \"%d/%m/%Y %H:%M\",\r\n              },\r\n              {\r\n                name: \"Date-Time-Z\",\r\n                sampleValue: \"2018-07-02T16:24:36Z\",\r\n                value: \"%Y-%m-%dT%H:%M:%S%Z\",\r\n              },\r\n              { name: \"<i>Custom</i>\", value: \"prompt()\" },\r\n            ],\r\n          },\r\n        ],\r\n      },\r\n\r\n      // ****************************\r\n      // ADD MAP TO CATEGORY\r\n      mapStandardsMenuOpts,\r\n\r\n      // Extract single time key\r\n      {\r\n        id: \"extractTimeKey\",\r\n        name: \"Extract time key\",\r\n        iconClass: \"fa fa-calendar-day\",\r\n        when: (attrib: Attrib) => attrib instanceof Attrib_Timeseries,\r\n        options: (attrib: Attrib_Timeseries) =>\r\n          attrib.timeKeys\r\n            .filter((timeKey) => !attrib.timeKeyAttribs[timeKey._time_src])\r\n            .map((timeKey) => ({ name: timeKey._time_src, value: timeKey })),\r\n        do: (attrib: Attrib_Timeseries, action) => {\r\n          var _ = attrib.getTimepointSummary(action);\r\n          _.block.addToPanel(attrib.browser.panels.left);\r\n          attrib.browser.updateLayout();\r\n        },\r\n      },\r\n\r\n      // *************************************\r\n      // DERIVE\r\n      {\r\n        id: \"deriveMenuOpt\",\r\n        name: \"Generate\",\r\n        iconClass: \"fa fa-share\",\r\n        when: (attrib: Attrib) => attrib.template.str, // not a custom function\r\n        options: [\r\n          {\r\n            id: \"deriveChangeOverTime\",\r\n            name: \"Change over time\",\r\n            when: (attrib: Attrib) => {\r\n              return (\r\n                attrib instanceof Attrib_Timeseries &&\r\n                !attrib.parent &&\r\n                (!attrib.derivatives[\"TimeseriesChange-%\"] ||\r\n                  !attrib.derivatives[\"TimeseriesChange-#\"])\r\n              );\r\n            },\r\n            do: (attrib: Attrib_Timeseries, action) => {\r\n              attrib.createDerivedAttrib(\r\n                `Change(${action})`,\r\n                `${attrib.attribName} - ${\r\n                  action === \"%\" ? \"Percent\" : \"Absolute\"\r\n                } Change`\r\n              );\r\n            },\r\n            options: (attrib: Attrib_Timeseries) => {\r\n              var r = [];\r\n              if (!attrib.derivatives[\"TimeseriesChange-%\"]) {\r\n                r.push({ name: \"% Percent change\", value: \"%\" });\r\n              }\r\n              if (!attrib.derivatives[\"TimeseriesChange-#\"]) {\r\n                r.push({ name: \"# Absolute change\", value: \"#\" });\r\n              }\r\n              return r;\r\n            },\r\n          },\r\n\r\n          {\r\n            id: \"time_deriveComponent\",\r\n            name: \"Time unit\",\r\n            iconClass: \"fa fa-calendar\",\r\n            when: (attrib: Attrib) => attrib instanceof Attrib_Timestamp,\r\n            do: (attrib: Attrib_Timestamp, action) =>\r\n              attrib.createDerivedAttrib(action),\r\n            // and time-typed in selected resolution,\r\n            // and not have the specific derived summary\r\n            options: [\r\n              {\r\n                id: \"time_deriveYear\",\r\n                name: \"Year\",\r\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.year && !attrib.derivatives.Year,\r\n                value: \"Year()\",\r\n              },\r\n              {\r\n                id: \"time_deriveMonth\",\r\n                name: \"Month\",\r\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.month && !attrib.derivatives.Month,\r\n                value: \"Month()\",\r\n              },\r\n              {\r\n                id: \"time_deriveDayOfMonth\",\r\n                name: \"Day of Month\",\r\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.day && !attrib.derivatives.DayOfMonth,\r\n                value: \"DayOfMonth()\",\r\n              },\r\n              {\r\n                id: \"time_deriveWeekday\",\r\n                name: \"Weekday\",\r\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.day && !attrib.derivatives.WeekDay,\r\n                value: \"WeekDay()\",\r\n              },\r\n              {\r\n                id: \"time_deriveHour\",\r\n                name: \"Hour\",\r\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.hour && !attrib.derivatives.Hour,\r\n                value: \"Hour()\",\r\n              },\r\n            ],\r\n          },\r\n\r\n          {\r\n            id: \"cat_deriveDegree\",\r\n            name: \"Degree (# of)\",\r\n            iconClass: \"fa fa-hashtag\",\r\n            when: (attrib: Attrib) =>\r\n              attrib instanceof Attrib_Categorical && attrib.isMultiValued && !attrib.derivatives.Degree,\r\n            do: (attrib: Attrib_Categorical) => attrib.createDerivedAttrib(\"Degree()\"),\r\n          },\r\n        ],\r\n      },\r\n\r\n      // Positive\r\n      {\r\n        id: \"num_keepPositive\",\r\n        name: \"Keep positive (>0) values\",\r\n        iconClass: \"fa fa-plus\",\r\n        when: (attrib: Attrib) =>\r\n          attrib instanceof Attrib_Numeric &&\r\n          attrib.rangeOrg[0] <= 0,\r\n        do: (attrib: Attrib_Numeric) => {\r\n          Modal.confirm(\r\n            `Do you want to remove zero-values from <i>${attrib.attribName}</i>?`,\r\n            \"Remove\"\r\n          ).then(\r\n            () => {\r\n              attrib.browser.onLoad.main[attrib.template.str] = \"POSITIVE()\";\r\n              (window as any).dashboard = Base.reloadWithNewConfig(\r\n                attrib.browser,\r\n                attrib.browser.exportConfig()\r\n              );\r\n            },\r\n            () => {}\r\n          );\r\n        },\r\n      },\r\n\r\n      // ****************************\r\n      {\r\n        id: \"CompareSelectionControl\",\r\n        name: \"Comparable\",\r\n        iconClass: \"fa fa-clone\",\r\n        do: (attrib: Attrib, action: boolean) => attrib.isComparable.set(action),\r\n        options: [\r\n          {\r\n            name: \"Enable\",\r\n            value: true,\r\n            iconClass: \"fa fa-check\",\r\n            active: (attrib: Attrib) => attrib.isComparable.is(true),\r\n          },\r\n          {\r\n            name: \"Disable\",\r\n            value: false,\r\n            iconClass: \"fa fa-times\",\r\n            active: (attrib: Attrib) => !attrib.isComparable.is(true),\r\n          },\r\n        ],\r\n      },\r\n      // ****************************\r\n      {\r\n        id: \"aggregateFunctions\",\r\n        name: \"Aggregation\",\r\n        iconClass: \"fa fa-cubes\",\r\n        helparticle: \"5e8944dd04286364bc97d5f0\",\r\n        when: (attrib: Attrib) => attrib.canHaveMetricFuncs && !attrib.hasTimeSeriesParent(),\r\n        options: [\r\n          {\r\n            name: \"Average\",\r\n            do: (attrib: Attrib, action: boolean) => {\r\n              if (action) {\r\n                attrib.addSupportedMetricFunc(\"Avg\");\r\n              } else {\r\n                attrib.removeSupportedMetricFunc(\"Avg\");\r\n              }\r\n            },\r\n            options: [\r\n              {\r\n                name: \"Enabled\",\r\n                value: true,\r\n                iconClass: \"fa fa-check\",\r\n                active: (attrib: Attrib) => attrib.supportedMetricFuncs.includes(\"Avg\"),\r\n              },\r\n              {\r\n                name: \"Disabled\",\r\n                value: false,\r\n                iconClass: \"fa fa-times\",\r\n                active: (attrib: Attrib) => !attrib.supportedMetricFuncs.includes(\"Avg\"),\r\n              },\r\n            ],\r\n          },\r\n          {\r\n            name: \"Sum\",\r\n            do: (attrib: Attrib, action: boolean) => {\r\n              if (action) {\r\n                attrib.addSupportedMetricFunc(\"Sum\");\r\n              } else {\r\n                attrib.removeSupportedMetricFunc(\"Sum\");\r\n              }\r\n            },\r\n            options: [\r\n              {\r\n                name: \"Enabled\",\r\n                value: true,\r\n                iconClass: \"fa fa-check\",\r\n                active: (attrib: Attrib) => attrib.supportedMetricFuncs.includes(\"Sum\"),\r\n              },\r\n              {\r\n                name: \"Disabled\",\r\n                value: false,\r\n                iconClass: \"fa fa-times\",\r\n                active: (attrib: Attrib) => !attrib.supportedMetricFuncs.includes(\"Sum\"),\r\n              },\r\n            ],\r\n          },\r\n        ],\r\n      },\r\n\r\n      // Delete map modification\r\n      {\r\n        id: \"removeMap\",\r\n        name: \"Remove map\",\r\n        iconClass: \"fa fa-undo\",\r\n        when: (attrib: Attrib) =>\r\n          attrib instanceof Attrib_Categorical && attrib.catGeo !== null,\r\n        do: (attrib: Attrib_Categorical) => attrib.removeCatGeo(),\r\n      },\r\n\r\n      // Delete derivative\r\n      {\r\n        id: \"removeDerive\",\r\n        name: \"Remove derivation\",\r\n        iconClass: \"fa fa-undo\",\r\n        when: (attrib: Attrib) => attrib.template.special,\r\n        do: (attrib: Attrib) => attrib.destroy(),\r\n      },\r\n\r\n      // Delete derived information\r\n      {\r\n        id: \"removeRecordGeo\",\r\n        name: \"Remove record geography\",\r\n        iconClass: \"fa fa-undo\",\r\n        when: (attrib: Attrib) => attrib instanceof Attrib_RecordGeo,\r\n        do: (attrib: Attrib_RecordGeo) => {\r\n          attrib.destroy();\r\n          (window as any).dashboard = Base.reloadWithNewConfig(\r\n            attrib.browser,\r\n            attrib.browser.exportConfig()\r\n          );\r\n        },\r\n      },\r\n\r\n      // Delete onLoad modification\r\n      {\r\n        id: \"removeModification\",\r\n        name: \"Remove modification\",\r\n        iconClass: \"fa fa-undo\",\r\n        when: (attrib: Attrib) => !!attrib.browser.onLoad.main[attrib.template.str],\r\n        do: (attrib: Attrib) => {\r\n          var name = attrib.template.str;\r\n          Modal.confirm(\r\n            `Do you want to delete the modification ${attrib.browser.onLoad.main[name]} ?`,\r\n            i18n.Delete\r\n          ).then(() => {\r\n            delete attrib.browser.onLoad.main[name];\r\n            (window as any).dashboard = Base.reloadWithNewConfig(\r\n              attrib.browser,\r\n              attrib.browser.exportConfig()\r\n            );\r\n          });\r\n        },\r\n      },\r\n\r\n      {\r\n        id: \"setAsRecordID\",\r\n        name: \"Set as record ID\",\r\n        iconClass: \"fa fa-fingerprint\",\r\n        when: (attrib: Attrib) => {\r\n          if (attrib.attribName === attrib.browser.idSummaryName)\r\n            return false;\r\n          return (\r\n            attrib._aggrs &&\r\n            attrib._aggrs.length === attrib.browser.records.length &&\r\n            !attrib.template.special\r\n          );\r\n        },\r\n        do: (attrib: Attrib) => {\r\n          if (!attrib.template.str) {\r\n            Modal.alert(\"Not supported. [756]\");\r\n            return;\r\n          }\r\n          var newConfig = attrib.browser.exportConfig();\r\n          newConfig.source[0].id = attrib.template.str;\r\n          newConfig.summaries = newConfig.summaries.filter(\r\n            (s) => s.name !== attrib.browser.idSummaryName\r\n          );\r\n\r\n          (window as any).dashboard = Base.reloadWithNewConfig(attrib.browser, newConfig);\r\n        },\r\n      },\r\n    ],\r\n  },\r\n};\r\n","import { select, pointer } from \"../d3_select\";\r\nimport { min, max } from \"d3-array\";\r\n\r\nimport { Browser } from \"../Browser\";\r\nimport { Base } from \"../Base\";\r\nimport { PanelName, PanelSpec } from \"../Types\";\r\nimport { Block } from \"../Block\";\r\nimport { Attrib } from \"../Attrib\";\r\nimport { Attrib_Categorical } from \"../Attrib_Categorical\";\r\nimport { Block_Categorical } from \"../Block_Categorical\";\r\nimport { i18n } from \"../i18n\";\r\nimport { Attrib_Interval } from \"../Attrib_Interval\";\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  min,\r\n  max,\r\n};\r\n\r\nexport class Panel {\r\n  private readonly browser: Browser;\r\n  private readonly _name: PanelName;\r\n\r\n  // ********************************************************************\r\n  // Attributes (/ blocks) in the panel\r\n  // ********************************************************************\r\n\r\n  public attribs: Attrib[] = [];\r\n\r\n  hasBlocks() {\r\n    return this.attribs.length > 0;\r\n  }\r\n  isEmpty() {\r\n    return this.attribs.length === 0;\r\n  }\r\n  get blocks(): Block[] {\r\n    return this.attribs.map((attrib) => attrib.block);\r\n  }\r\n\r\n  private get attribs_Categorical(): Attrib_Categorical[] {\r\n    return this.attribs.filter(\r\n      (_): _ is Attrib_Categorical => _ instanceof Attrib_Categorical\r\n    );\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Constructor\r\n  // ********************************************************************\r\n\r\n  public DOM: { root: any };\r\n\r\n  /** -- */\r\n  constructor(browser: Browser, name: PanelName, parentDOM) {\r\n    this.browser = browser;\r\n    this._name = name;\r\n\r\n    this.DOM = {\r\n      root: parentDOM\r\n        .append(\"div\")\r\n        .attr(\"class\", \"panel panel_\" + this.name)\r\n        .classed(\"panel_side\", this.name === \"left\" || this.name === \"right\")\r\n        .classed(\"hasBlocks\", false),\r\n    };\r\n    this.initDOM_AdjustWidth();\r\n    this.addDOM_DropZone();\r\n    this.refreshBlocksDropZonesOrder();\r\n\r\n    this.setWidth(this.browser.width_Canvas / 3);\r\n  }\r\n\r\n  public get name(): PanelName {\r\n    return this._name;\r\n  }\r\n\r\n  /** -- If there's enough space, the panel welcomes new blocks */\r\n  welcomesNewBlock() {\r\n    if (this.isEmpty()) return true;\r\n    if (this.blocks.length < Math.floor(this.height / 150)) return true;\r\n    return this.heightRemaining >= 0;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Height, width...\r\n  // ********************************************************************\r\n\r\n  public height: number; // height of panel in pixels\r\n\r\n  private _width_CatBars: number = 0; // placeholder value\r\n  private _width_CatMeasureLabel: number = 10; // placeholder values\r\n  private _width_CatText: number = 175; // placeholder value\r\n\r\n  /** -- */\r\n  get width_CatText() {\r\n    return this._width_CatText;\r\n  }\r\n  /** -- */\r\n  get width_CatLabel() {\r\n    return (\r\n      this.width_CatText -\r\n      (this.browser.stackedCompare.is(true) && !this.hiddenCatBars()\r\n        ? 0\r\n        : this.width_CatMeasureLabel)\r\n    );\r\n  }\r\n  /** -- */\r\n  get width_CatMeasureLabel() {\r\n    return this._width_CatMeasureLabel;\r\n  }\r\n  get width_Real_withGap() {\r\n    if (this.width_Real === 0) return 0;\r\n    if (this.name === \"left\" || this.name === \"right\") {\r\n      return this.hasBlocks() ? this.width_Real + Base.width_PanelGap : 0;\r\n    }\r\n    return this.width_Real;\r\n  }\r\n  /** -- */\r\n  get width_Real() {\r\n    if (this.name === \"middle\") {\r\n      return (\r\n        this.browser.width_Canvas -\r\n        this.browser.panels.left.width_Real_withGap -\r\n        this.browser.panels.right.width_Real_withGap\r\n      );\r\n    }\r\n    if (this.name === \"bottom\") {\r\n      return this.browser.width_Canvas;\r\n    }\r\n    if (this.isEmpty()) return 0;\r\n    if (this.isCollapsed()) {\r\n      return this.DOM.root.node().offsetWidth;\r\n    }\r\n    return this.width_CatText + this.width_CatBars + Base.width_ScrollBar; // 8 pixels of gap\r\n  }\r\n\r\n  /** Adjusts width_CatBar based on previous size as well */\r\n  set width_CatText(_w_) {\r\n    _w_ = Math.max(Base.width_CatLabelMin, _w_); // use at least 110 pixels for the category label.\r\n    if (_w_ === this.width_CatText) return;\r\n    var widthDif = this.width_CatText - _w_;\r\n    this._width_CatText = _w_;\r\n    this.attribs_Categorical.forEach((attrib) =>\r\n      attrib.block.refreshLabelWidth()\r\n    );\r\n    // updates category bar widths\r\n    this.width_CatBars = this.width_CatBars + widthDif;\r\n  }\r\n  /** -- */\r\n  get width_CatBars() {\r\n    return this._width_CatBars;\r\n  }\r\n  /** -- */\r\n  set width_CatBars(_w_) {\r\n    _w_ = Math.max(_w_, 0); // cannot be negative\r\n    this._width_CatBars = _w_;\r\n    this.DOM.root.classed(\"hideCatBars\", this.hiddenCatBars() ? true : false);\r\n    this.refreshWidth();\r\n  }\r\n\r\n  /** -- */\r\n  setWidth(_w_) {\r\n    this.width_CatBars = _w_ - this.width_CatText - Base.width_ScrollBar;\r\n  }\r\n\r\n  /** --- */\r\n  refreshWidth() {\r\n    this.DOM.root.style(\"width\", this.width_Real + \"px\");\r\n    this.attribs.forEach((_) => _.block.refreshWidth());\r\n  }\r\n\r\n  /** --- */\r\n  updateWidth_CatMeasureLabels() {\r\n    // even if width is the same, stacked/not-stacked may have changed\r\n    this._width_CatMeasureLabel = this.calcWidth_MeasureLabel();\r\n    this.attribs_Categorical.forEach((attrib) =>\r\n      attrib.block.refreshLabelWidth()\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  hiddenCatBars() {\r\n    return this.width_CatBars <= 20;\r\n  }\r\n\r\n  /** -- */\r\n  initDOM_AdjustWidth() {\r\n    if (this.name === \"middle\" || this.name === \"bottom\") {\r\n      return; // not supported\r\n    }\r\n    this.DOM.root\r\n      .append(\"span\")\r\n      .attr(\"class\", \"panelAdjustWidth\")\r\n      .tooltip(i18n[\"Adjust Panel Width\"])\r\n      .on(\"mousedown\", (event) => {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        var mouseDown_x = d3.pointer(event, document.body)[0];\r\n        var mouseDown_width = this.width_CatBars;\r\n\r\n        this.browser.activateWidthDrag(event.currentTarget, event, (event2) => {\r\n          var mouseMove_x = d3.pointer(event2, document.body)[0];\r\n          var mouseDif = mouseMove_x - mouseDown_x;\r\n          if (this.name === \"right\") mouseDif *= -1;\r\n          this.width_CatBars = mouseDown_width + mouseDif;\r\n          this.browser.updateMiddlePanelWidth();\r\n          this.browser.updateLayout_Height();\r\n        });\r\n      })\r\n      .on(\"click\", (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      });\r\n  }\r\n\r\n  /** --- */\r\n  private calcWidth_MeasureLabel(): number {\r\n    if (this.isEmpty()) return 0;\r\n\r\n    var activeAggrMax, activeAggrMin;\r\n\r\n    if (this.browser.percentBreakdown) {\r\n      // 100 / %\r\n      activeAggrMax = 99; // 2 digits\r\n      activeAggrMin = 0; // 1 digit\r\n    } else {\r\n      activeAggrMax = d3.max(this.attribs, (_: Attrib) =>\r\n        _.getPeakAggr(d3.max, \"Active\")\r\n      );\r\n      activeAggrMin = d3.max(this.attribs, (_: Attrib) =>\r\n        _.getPeakAggr(d3.min, \"Active\")\r\n      );\r\n      if (activeAggrMax === 0 && activeAggrMin === 0) return 0;\r\n    }\r\n\r\n    var _w_ = 2;\r\n\r\n    // compute number of digits\r\n    var digits = 1;\r\n    while (activeAggrMax > 9) {\r\n      digits++;\r\n      activeAggrMax = Math.floor(activeAggrMax / 10);\r\n    }\r\n    if (!this.browser.hasIntOnlyMeasure()) {\r\n      digits += 2;\r\n      _w_ += 8; // Space for \",\"\r\n    }\r\n    if (digits > 4) {\r\n      digits = 3;\r\n      _w_ += 3; // Space for the splitting \".\" character (e.q. 3.2k)\r\n      _w_ += 10; // M, k, B, etc.\r\n    }\r\n    _w_ += digits * 6.5;\r\n\r\n    if (this.browser.percentBreakdown) {\r\n      if (Base.percentDecimal) {\r\n        _w_ += 24; // \"%\" character + \".\" character + 1 significant digit\r\n      } else {\r\n        _w_ += 13; // \"%\" character + \".\" character + 1 significant digit\r\n      }\r\n    } else {\r\n      // Account for the unitName displayed\r\n      var unitName = this.browser.measureSummary.get()?.unitName;\r\n      if (unitName) {\r\n        // TO-DO: Use the rendered width, instead of fixed multiplier, \"11\"\r\n        _w_ += 2 + unitName.length * 7;\r\n      }\r\n    }\r\n\r\n    // negative values have \"-\" character\r\n    if (activeAggrMin < 0) _w_ += 5;\r\n\r\n    return _w_;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Add / remove blocks\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  addBlock(block: Block, index) {\r\n    block.panel = this;\r\n    var beforeDOM = this.DOM.root.selectAll(\".dropZone\").nodes()[index];\r\n    if (block.DOM.root && beforeDOM) {\r\n      block.DOM.root.style(\"display\", \"\");\r\n      this.DOM.root.node().insertBefore(block.DOM.root.node(), beforeDOM);\r\n    } else {\r\n      if (!block.initDOM(beforeDOM)) return;\r\n    }\r\n\r\n    this.DOM.root.classed(\"hasBlocks\", true);\r\n\r\n    var curIndex = -1;\r\n    this.attribs.forEach((attrib, i) => {\r\n      if (attrib.block === block) curIndex = i;\r\n    });\r\n    if (curIndex === -1) {\r\n      // block is new to this panel\r\n      if (index >= this.attribs.length) this.attribs.push(block.attrib);\r\n      else this.attribs.splice(index, 0, block.attrib);\r\n\r\n      this.updateWidth_CatMeasureLabels();\r\n      if (block instanceof Block_Categorical) {\r\n        block.refreshLabelWidth();\r\n        if (block.viewType === \"map\") {\r\n          block.catViewAs(\"map\"); // donno why this is needed for now.\r\n        }\r\n      }\r\n      //\r\n    } else {\r\n      // block was in the panel. Change position\r\n      this.attribs.splice(curIndex, 1);\r\n      this.attribs.splice(index, 0, block.attrib);\r\n    }\r\n\r\n    if (this.attribs.length === 1) this.refreshWidth();\r\n    this.refreshCollapsed();\r\n\r\n    this.addDOM_DropZone(block.DOM.root.node());\r\n\r\n    this.addRemove_Finalize();\r\n  }\r\n\r\n  /** -- */\r\n  removeBlock(block: Block) {\r\n    block.panel = undefined;\r\n    // remove the drop zone that this block created\r\n    var dropZoneDOM = this.DOM.root.selectAll(\".dropZone\").nodes()[\r\n      block.orderInPanel\r\n    ];\r\n    dropZoneDOM.parentNode.removeChild(dropZoneDOM);\r\n\r\n    this.attribs.splice(block.orderInPanel, 1);\r\n\r\n    this.updateWidth_CatMeasureLabels();\r\n    this.DOM.root.classed(\"hasBlocks\", this.hasBlocks());\r\n    if (!this.hasBlocks()) this.refreshCollapsed();\r\n\r\n    this.addRemove_Finalize();\r\n  }\r\n\r\n  private addRemove_Finalize() {\r\n    this.refreshBlocksDropZonesOrder();\r\n\r\n    if (this.name === \"bottom\") {\r\n      this.browser.DOM.panel_Wrapper.classed(\r\n        \"panel_bottom_empty\",\r\n        !this.hasBlocks()\r\n      );\r\n    }\r\n\r\n    this.refreshSharedMeasureExtent();\r\n    this.attribs.forEach((attrib) => attrib.updateChartScale_Measure());\r\n  }\r\n\r\n  /** -- */\r\n  refreshBlocksDropZonesOrder() {\r\n    this.attribs.forEach((attrib, i) => {\r\n      attrib.block.orderInPanel = i;\r\n    });\r\n    this.DOM.root.selectAll(\".dropZone\").each(function (d, i) {\r\n      this.__data__ = i;\r\n    });\r\n  }\r\n\r\n  /** Adds the dropZone DOM BEFORE the provided dom-- */\r\n  addDOM_DropZone(beforeDOM = null) {\r\n    var zone;\r\n    if (beforeDOM) {\r\n      zone = this.DOM.root.insert(\"div\", () => beforeDOM); // must be a function returning a dom object...\r\n    } else {\r\n      zone = this.DOM.root.append(\"div\");\r\n    }\r\n    zone\r\n      .attr(\"class\", \"dropZone\")\r\n      .on(\"mouseenter\", function () {\r\n        this.classList.add(\"onHover\");\r\n        this.children[0].classList.add(\"onReadyToDrop\");\r\n      })\r\n      .on(\"mouseleave\", function () {\r\n        this.classList.remove(\"onHover\");\r\n        this.children[0].classList.remove(\"onReadyToDrop\");\r\n      })\r\n      .on(\"mouseup\", (event) => {\r\n        var attrib = this.browser.movedAttrib;\r\n        if (!attrib) return;\r\n        if (attrib.block.panel) {\r\n          // if the block was in the panels already\r\n          attrib.block.DOM.root.node().nextSibling.style.display = \"\";\r\n          attrib.block.DOM.root.node().previousSibling.style.display = \"\";\r\n        }\r\n        attrib.block.addToPanel(this, event.currentTarget.__data__);\r\n        this.browser.updateLayout();\r\n      })\r\n      .call((dropZone) => {\r\n        dropZone.append(\"div\").attr(\"class\", \"dropIcon fa fa-chart-bar\");\r\n        dropZone\r\n          .append(\"div\")\r\n          .attr(\"class\", \"dropZoneText\")\r\n          .text(i18n[\"Drop Chart\"]);\r\n      });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Updating layout\r\n  // ********************************************************************\r\n\r\n  private heightRemaining: number = 0;\r\n\r\n  /** -- */\r\n  setHeightAndLayout(targetHeight: number) {\r\n    this.height = targetHeight;\r\n\r\n    this.heightRemaining = targetHeight;\r\n\r\n    var finalPass = false,\r\n      lastRound = false;\r\n\r\n    // initialize all blocks as not yet processed.\r\n    this.blocks.forEach((block) => {\r\n      block.dueForLayout = true;\r\n    });\r\n\r\n    var dueBlockCount = this.attribs.length;\r\n\r\n    var markDone = (block: Block) => {\r\n      if (!block.dueForLayout) return;\r\n      this.heightRemaining -= block.height_withMargin;\r\n      // see if the panel is on the bottom\r\n      setTimeout(() => {\r\n        var node = block.DOM.root.node();\r\n        var top = node.getBoundingClientRect().top;\r\n        var pos = \"onBottom\";\r\n        if (top > 300) {\r\n          pos = \"onTop\";\r\n        }\r\n        if (top < 300 || this.width_Real < 400) {\r\n          if (this.name === \"left\") {\r\n            pos = \"onRight\";\r\n          } else if (this.name === \"right\") {\r\n            pos = \"onLeft\";\r\n          }\r\n        }\r\n        block.DOM.root\r\n          .select(\".summaryConfig\")\r\n          .classed(\"onBottom\", pos === \"onBottom\")\r\n          .classed(\"onTop\", pos === \"onTop\")\r\n          .classed(\"onRight\", pos === \"onRight\")\r\n          .classed(\"onLeft\", pos === \"onLeft\");\r\n      }, 1000);\r\n      delete block.dueForLayout;\r\n      dueBlockCount--;\r\n    };\r\n\r\n    this.blocks\r\n      .filter(\r\n        (block) =>\r\n          !block.isVisible() || // Empty or collapsed\r\n          block.hasStaticHeight()\r\n      )\r\n      .forEach((block) => markDone(block));\r\n\r\n    while (true) {\r\n      if (dueBlockCount === 0) break;\r\n      var dueBlockCount_Pre = dueBlockCount;\r\n\r\n      // Distribute remaining space\r\n      this.blocks\r\n        .filter((block) => block.dueForLayout)\r\n        .forEach((block) => {\r\n          // in last round, if _block can expand, expand it further\r\n          if (finalPass && block.attrib.type == \"content\") {\r\n            if (block.height_RangeMin < this.heightRemaining) {\r\n              block.setHeight(this.heightRemaining);\r\n            } else {\r\n              block.setCollapsed(true);\r\n            }\r\n            markDone(block);\r\n            return;\r\n          }\r\n          if (lastRound === true) {\r\n            if (block.height_RangeMax > block.getHeight()) {\r\n              this.heightRemaining += block.getHeight();\r\n              block.setHeight(this.heightRemaining);\r\n              this.heightRemaining -= block.getHeight();\r\n              return;\r\n            }\r\n          }\r\n          if (dueBlockCount === 0) return;\r\n\r\n          // Fairly distribute remaining size across all remaining\r\n          var _heightRemaining = Math.floor(\r\n            this.heightRemaining / dueBlockCount\r\n          );\r\n\r\n          if (_heightRemaining >= block.height_RangeMax) {\r\n            // Panel has more space than what the block needs\r\n            block.setHeight(block.height_RangeMax);\r\n            markDone(block);\r\n          } else if (finalPass) {\r\n            if (_heightRemaining >= block.height_RangeMin) {\r\n              // Use whatever space\r\n              block.setHeight(_heightRemaining);\r\n              markDone(block);\r\n            } else {\r\n              // auto-collapse block if you do not have enough space\r\n              if (block.attrib.type !== \"content\") {\r\n                block.setCollapsed(true);\r\n                markDone(block);\r\n              }\r\n            }\r\n          }\r\n        });\r\n\r\n      finalPass = dueBlockCount_Pre === dueBlockCount;\r\n      if (lastRound === true) break;\r\n      if (dueBlockCount === 0) lastRound = true;\r\n    }\r\n\r\n    if (this.name === \"left\" || this.name === \"right\") {\r\n      this.refreshCollapsed();\r\n    }\r\n\r\n    if (this.name === \"bottom\" || this.name === \"middle\") {\r\n      this.height = this.height - this.heightRemaining;\r\n      this.heightRemaining = 0;\r\n    }\r\n\r\n    this.attribs.forEach((attrib, i) => {\r\n      attrib.block.DOM.root.style(\r\n        \"margin-bottom\",\r\n        i === this.attribs.length - 1 ? \"0\" : null\r\n      );\r\n    });\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Collapsing panel\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  collapseAllSummaries(exceptThisOne) {\r\n    this.attribs.forEach((_) => _.block.setCollapsed(_ !== exceptThisOne));\r\n    this.browser.updateLayout_Height();\r\n  }\r\n\r\n  /** -- */\r\n  isCollapsed() {\r\n    if (this.name === \"bottom\") return false;\r\n    return this.hasBlocks() && this.attribs.every((_) => _.block.collapsed);\r\n  }\r\n\r\n  /** -- */\r\n  refreshCollapsed() {\r\n    var _old = this.DOM.root.classed(\"collapsed\");\r\n    var _new = this.isCollapsed();\r\n    this.DOM.root.classed(\"collapsed\", _new);\r\n    this.refreshWidth();\r\n    if (_old !== _new) {\r\n      this.browser.updateLayout();\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Synced scales\r\n  // ********************************************************************\r\n\r\n  private _syncedMeasureExtent = [0, 1]; // temp init value\r\n\r\n  /** -- */\r\n  refreshSharedMeasureExtent() {\r\n    var scales = this.attribs\r\n      .filter(\r\n        (s) =>\r\n          (s instanceof Attrib_Categorical && s.block.isView_List) ||\r\n          (s instanceof Attrib_Interval && s.block.showHistogram.is(true))\r\n      )\r\n      .map((s) => s.measureExtent_Self);\r\n\r\n    this._syncedMeasureExtent = [\r\n      d3.min(scales, (_) => _[0]),\r\n      d3.max(scales, (_) => _[1]),\r\n    ];\r\n  }\r\n  /** -- */\r\n  get syncedMeasureExtent() {\r\n    return this._syncedMeasureExtent;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Export / import\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  exportConfig(): PanelSpec {\r\n    return {\r\n      catBarWidth: this.name !== \"bottom\" && this.width_CatBars,\r\n      catLabelWidth: this.width_CatText,\r\n    };\r\n  }\r\n\r\n  importConfig(config: PanelSpec) {\r\n    if (!config) return;\r\n    if (config.catLabelWidth) {\r\n      this.width_CatText = config.catLabelWidth;\r\n    }\r\n    if (config.catBarWidth && this.name !== \"bottom\") {\r\n      this.width_CatBars = config.catBarWidth;\r\n    }\r\n  }\r\n}\r\n","import { DataTable } from \"../DataTable\";\r\n\r\nexport class DataLoader_FetchURL {\r\n  accepts(dt: DataTable) {\r\n    return dt.fileExt;\r\n  }\r\n\r\n  // can be extended by sub-classes to customize http request headers\r\n  defaultFetchConfig() {\r\n    return {\r\n      credentials: \"same-origin\",\r\n      method: \"GET\",\r\n    };\r\n  }\r\n\r\n  async load(dt: DataTable) {\r\n    // Lets Papaparse handle the streaming data loading\r\n    if (dt.isCSV && dt.stream) {\r\n      return dt.parseData_CSV(dt.sourceURL);\r\n    }\r\n\r\n    return fetch(\r\n      dt.sourceURL,\r\n      Object.assign({}, this.defaultFetchConfig(), dt.fetchConfig)\r\n    )\r\n      .then((response) => response.text())\r\n      .then((data: any) => {\r\n        if (data.error) {\r\n          return Promise.reject(data.error);\r\n        }\r\n        return dt.parseData(data);\r\n      });\r\n  }\r\n}\r\n","import { Base } from \"../Base\";\r\nimport { DataTable } from \"../DataTable\";\r\n\r\nexport class DataLoader_GoogleSheets {\r\n  constructor() {}\r\n\r\n  accepts(dt: DataTable) {\r\n    return dt.type === \"GoogleSheets\";\r\n  }\r\n\r\n  async load(dt: DataTable) {\r\n\r\n    await import(\"https://apis.google.com/js/platform.js\");\r\n    \r\n    var gapi = (window as any).gapi;\r\n\r\n    await new Promise((resolve, reject) => {\r\n      gapi.load(\"client\", () => {\r\n        gapi.client\r\n          .init({\r\n            discoveryDocs: [\r\n              \"https://sheets.googleapis.com/$discovery/rest?version=v4\",\r\n              \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\r\n            ],\r\n            apiKey: Base.gapi.gKey,\r\n            clientId: Base.gapi.clientId,\r\n            scope: 'profile email',\r\n          })\r\n          .then(\r\n            () => {\r\n              console.log(\"✓ gapi.client.init\");\r\n              resolve(true);\r\n            },\r\n            (error) => {\r\n              console.log(error);\r\n              reject();\r\n            }\r\n          );\r\n      });\r\n    });\r\n\r\n    // Supporting custom data loading proxy\r\n    gapi.client.setToken(null);\r\n\r\n    return new Promise((resolve, reject) => {\r\n      gapi.client.sheets.spreadsheets.values.get({\r\n        spreadsheetId: dt.gdocId,\r\n        range: dt.name + \"!\" + (dt.range ? dt.range : \"1:300000\"),\r\n        valueRenderOption: \"UNFORMATTED_VALUE\",\r\n        dateTimeRenderOption: \"SERIAL_NUMBER\", // vs. \"FORMATTED_STRING\"\r\n      }).then(\r\n        (response) => {\r\n          if (!response.result && response.data) {\r\n            // node API returns a different structure\r\n            response.result = { values: response.data.data.values };\r\n          }\r\n\r\n          var header = response.result.values[0];\r\n          var hasIDcolumn =\r\n            header.filter((columnName) => columnName === dt.id).length > 0;\r\n\r\n          for (var row = 1; row < response.result.values.length; row++) {\r\n            var c = {};\r\n            for (var col = 0; col < header.length; col++) {\r\n              c[header[col]] = response.result.values[row][col];\r\n            }\r\n            if (!hasIDcolumn) c[dt.id] = \"\" + (row - 1);\r\n            dt.createRecord(c);\r\n          }\r\n\r\n          dt.processHeaderHierarchy(header);\r\n          resolve(true);\r\n        },\r\n        (err) => {\r\n          reject(err);\r\n        }\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { TableSpec } from \"./Types\";\r\nimport { Record } from \"./Record\";\r\nimport { Base } from \"./Base\";\r\n\r\n// Static data loader\r\nvar DataLoaderRegistry = [];\r\n\r\n/** -- */\r\nexport class DataTable {\r\n  readonly name: string;\r\n\r\n  // ********************************************************************\r\n  // Records\r\n  // ********************************************************************\r\n\r\n  records: Record[] = [];\r\n\r\n  private _byKey: { [index: string]: Record } = {};\r\n\r\n  getRecord(key: string): Record {\r\n    return this._byKey[key];\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Loading data\r\n  // ********************************************************************\r\n\r\n  onLoad: ((this: DataTable) => boolean) = null;\r\n\r\n  postLoad: ((this: DataTable) => boolean) = null;\r\n\r\n  private _isLoaded: boolean = false;\r\n\r\n  get isLoaded() {\r\n    return this._isLoaded;\r\n  }\r\n\r\n  async load() {\r\n    if (this._isLoaded)\r\n      return;\r\n\r\n    if (this.onLoad){\r\n      this._isLoaded = this.onLoad();\r\n      if(!this._isLoaded){\r\n        return Promise.reject(\"Cannot load data via custom loader\");\r\n      }\r\n      return;\r\n    }\r\n\r\n    // check loaders, and if loader accepts descriptor, try to load with the loader\r\n    for (const loader of DataLoaderRegistry) {\r\n      if (loader.accepts(this)) {\r\n        var result = await loader.load(this);\r\n        if (result) {\r\n          if (this.postLoad){\r\n            this.postLoad();\r\n          }\r\n          this._isLoaded = true;\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    return Promise.reject(\"Cannot find data loader\");\r\n  }\r\n\r\n  createRecord(_data: any) {\r\n    var record = new Record(_data, this.id);\r\n    this.records.push(record);\r\n    this._byKey[record.id] = record;\r\n  }\r\n\r\n  /** -- */\r\n  static registerLoader(loader) {\r\n    DataLoaderRegistry.push(loader);\r\n  }\r\n\r\n  type: \"file\" | \"GoogleSheets\" | any;\r\n\r\n  // name of the ID column in dataset\r\n  id?: string;\r\n\r\n  file?: File;\r\n\r\n  gdocId?: string;\r\n  range?: null; // used by google sheet\r\n\r\n  dirPath?: string;\r\n  fullURL?: string;\r\n\r\n  // CSV parsin settings with defaults\r\n  header: boolean = true;\r\n  fastMode: boolean = false;\r\n  dynamicTyping: boolean = true;\r\n  download: boolean = false;\r\n  stream: boolean = false;\r\n\r\n  // fetch configuration\r\n  fetchConfig?: any;\r\n\r\n  /** -- */\r\n  constructor(dataDescr: TableSpec) {\r\n    if (dataDescr instanceof File) {\r\n      this.type = \"file\";\r\n      this.name = dataDescr.name;\r\n      this.file = dataDescr;\r\n      return;\r\n    }\r\n    if (typeof dataDescr === \"string\") {\r\n      dataDescr = { name: dataDescr };\r\n    }\r\n\r\n    dataDescr = Object.assign({}, dataDescr);\r\n\r\n    for (var x in dataDescr) {\r\n      this[x] = dataDescr[x];\r\n    }\r\n\r\n    if (this.gdocId) {\r\n      this.type = \"GoogleSheets\";\r\n    }\r\n\r\n    this.id = this.id ?? \"id\";\r\n\r\n    Base.tables.set(this.name, this);\r\n  }\r\n\r\n  fileType?: \"csv\" | \"tsv\" | \"json\";\r\n\r\n  get fileExt() {\r\n    return this.fileType ? \".\" + this.fileType.toLowerCase() : \"\";\r\n  }\r\n  get isCSV() {\r\n    return this.fileExt === \".csv\" || this.fileExt === \".tsv\";\r\n  }\r\n\r\n  get isGoogleFile() {\r\n    return (\r\n      this.dirPath === \"GoogleDrive\" ||\r\n      this.dirPath === \"https://drive.google.com/file/d/\"\r\n    );\r\n  }\r\n\r\n  get sourceURL() {\r\n    if (this.fullURL) return this.fullURL;\r\n    if (this.isGoogleFile)\r\n      return `https://www.googleapis.com/drive/v3/files/${this.name}?alt=media&key=${Base.gapi.gKey}`;\r\n    return (this.dirPath || \"\") + this.name + this.fileExt;\r\n  }\r\n\r\n  get linkToData() {\r\n    if (this.gdocId) {\r\n      return \"https://docs.google.com/spreadsheets/d/\" + this.gdocId;\r\n    }\r\n    return this.sourceURL;\r\n  }\r\n\r\n  /** -- */\r\n  async parseData(rawData) {\r\n    if (this.isCSV) {\r\n      return await this.parseData_CSV(rawData);\r\n    } else {\r\n      return await this.parseData_JSON(rawData);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  async parseData_JSON(data) {\r\n    if (typeof data === \"string\") {\r\n      data = JSON.parse(data);\r\n    }\r\n\r\n    var idColumn = this.id;\r\n\r\n    data.forEach((_d, i) => {\r\n      if (_d[idColumn] === undefined) _d[idColumn] = \"\" + i;\r\n      this.createRecord(_d);\r\n    });\r\n\r\n    return true;\r\n  }\r\n\r\n  /** -- */\r\n  async parseData_CSV(data) {\r\n    let Papa = (window as any).Papa;\r\n    if (!Papa) {\r\n      // Sets window.Papa / Not a proper ES6 module\r\n      await import(\"papaparse\");\r\n      Papa = (window as any).Papa;\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      let _i = 0;\r\n\r\n      Papa.parse(data, {\r\n        header: this.header === false ? false : true,\r\n\r\n        fastMode: this.fastMode !== undefined ? this.fastMode : false,\r\n\r\n        dynamicTyping:\r\n          this.dynamicTyping !== undefined ? this.dynamicTyping : true, // true unless disabled\r\n\r\n        download: this.stream === true,\r\n\r\n        chunk: (_rows) => {\r\n          _rows.data.forEach((row) => {\r\n            if (row[this.id] === undefined) {\r\n              row[this.id] = \"\" + _i++;\r\n            }\r\n            this.createRecord(row);\r\n          });\r\n        },\r\n\r\n        complete: () => {\r\n          this.processHeaderHierarchy();\r\n          resolve?.(true);\r\n        },\r\n\r\n        error: (error) => {\r\n          console.log(error);\r\n          reject?.(\"CSV parsing error.\");\r\n        },\r\n      });\r\n    });\r\n  }\r\n\r\n  /** Helper function to process column name header hierarchies (..->..->..) */\r\n  processHeaderHierarchy(columns: any = null) {\r\n    if (!columns) {\r\n      columns = Object.keys(this.records[0].data);\r\n    }\r\n\r\n    columns.forEach((flatColName) => {\r\n      if (typeof flatColName !== \"string\") return;\r\n      var keys = flatColName.split(\"->\");\r\n      if (keys.length === 1) {\r\n        return; // no hierarchy\r\n      }\r\n      keys = keys.map((_) => _.trim()); // trim keys\r\n      var lastKey = keys.pop();\r\n      this.records.forEach((rec) => {\r\n        var _data = rec.data;\r\n        var _value = _data[flatColName];\r\n        if (_value != null) {\r\n          keys.forEach((key) => {\r\n            _data = _data[key] = _data[key] || {};\r\n          });\r\n          _data[lastKey] = _value;\r\n        }\r\n        delete rec.data[flatColName];\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { Attrib_Content } from \"./Attrib_Content\";\r\nimport { Block } from \"./Block\";\r\nimport { i18n } from \"./i18n\";\r\n\r\nexport class Block_Content extends Block {\r\n  public readonly attrib: Attrib_Content;\r\n  constructor(attrib: Attrib_Content) {\r\n    super(attrib);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  private height_content: number = 0;\r\n  public height_max: number = 10000;\r\n  public height_min: number = 100;\r\n\r\n  hasStaticHeight(): boolean {\r\n    return false;\r\n  }\r\n\r\n  get height_Content(): number {\r\n    return this.isVisible() ? this.height_content : 0;\r\n  }\r\n  get height_RangeMin(): number {\r\n    if (this.attrib.isEmpty()) return this.height_Header;\r\n    return this.height_min;\r\n  }\r\n  get height_RangeMax(): number {\r\n    if (this.attrib.isEmpty()) return this.height_Header;\r\n    return this.height_max;\r\n  }\r\n  setHeight(targetHeight: number): void {\r\n    this.height_content =\r\n      Math.min(targetHeight, this.height_max) - this.height_Header;\r\n  }\r\n  refreshWidth(): void {}\r\n\r\n  // ********************************************************************\r\n  // ********************************************************************\r\n\r\n  private curStep: number = -1;\r\n  public onStep: Function = null;\r\n\r\n  /** -- */\r\n  onCollapse(): void {\r\n    if (this.collapsed) return;\r\n    this.displayStep(0);\r\n  }\r\n\r\n  /** -- */\r\n  initDOM(beforeDOM): boolean {\r\n    if (this.attrib.isEmpty()) return false;\r\n    if (this.DOM.inited) return true;\r\n\r\n    this.insertRoot(beforeDOM);\r\n\r\n    this.setCollapsed(this.collapsed);\r\n\r\n    this.DOM.contentWrapper = this.DOM.wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"contentWrapper\");\r\n\r\n    this.DOM.contentBlock = this.DOM.contentWrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"contentBlock\");\r\n\r\n    if (this.attrib.isMultiStep()) {\r\n      var stepControls = this.DOM.contentWrapper\r\n        .append(\"div\")\r\n        .attr(\"class\", \"stepControls\");\r\n      stepControls\r\n        .append(\"div\")\r\n        .attr(\"class\", \"stepDots\")\r\n        .selectAll(\"div\")\r\n        .data([...Array(this.attrib.content.length).keys()])\r\n        .enter()\r\n        .append(\"div\")\r\n        .attr(\"class\", \"stepDot\")\r\n        .html(\"●\")\r\n        .tooltip(i18n[\"Jump to step\"])\r\n        .on(\"click\", (_event, i) => this.displayStep(i));\r\n\r\n      stepControls\r\n        .append(\"div\")\r\n        .attr(\"class\", \"dismissButton\")\r\n        .html(i18n.Close)\r\n        .on(\"click\", () => this.setCollapsedAndLayout(true));\r\n\r\n      stepControls.append(\"div\").attr(\"class\", \"stepControlGap\");\r\n\r\n      this.DOM.stepPrev = stepControls\r\n        .append(\"div\")\r\n        .attr(\"class\", \"stepButton stepPrev\")\r\n        .html(\"<i class='fa fa-angle-double-left'></i>\" + i18n.Previous)\r\n        .on(\"click\", () => this.displayStep(this.curStep - 1));\r\n\r\n      this.DOM.stepNext = stepControls\r\n        .append(\"div\")\r\n        .attr(\"class\", \"stepButton stepNext\")\r\n        .html(i18n.Next + \"<i class='fa fa-angle-double-right'></i>\")\r\n        .on(\"click\", () => this.displayStep(this.curStep + 1));\r\n\r\n      this.DOM.stepClose = stepControls\r\n        .append(\"div\")\r\n        .attr(\"class\", \"stepButton stepClose\")\r\n        .html(i18n.Close + \"<i class='fa fa-compress-alt'></i>\")\r\n        .on(\"click\", () => this.setCollapsedAndLayout(true));\r\n    }\r\n\r\n    this.DOM.inited = true;\r\n\r\n    this.displayStep(0);\r\n\r\n    return true;\r\n  }\r\n\r\n  /** -- */\r\n  displayStep(stepIndex) {\r\n    if (!this.DOM.inited) return;\r\n    if (this.attrib.content.length == 0) return;\r\n    stepIndex = Math.min(\r\n      Math.max(0, stepIndex),\r\n      this.attrib.content.length - 1\r\n    );\r\n    if (this.curStep === stepIndex) return;\r\n\r\n    this.curStep = stepIndex;\r\n    var content = this.attrib.content[stepIndex];\r\n    if (typeof content === \"string\") {\r\n      this.DOM.contentBlock.html(content);\r\n      this.DOM.contentWrapper.classed(\"fullIframe\", false);\r\n    } else if (content.youtube) {\r\n      this.DOM.contentBlock.html(\r\n        `<iframe ` +\r\n          `src='https://www.youtube-nocookie.com/embed/${content.youtube}?controls=0` +\r\n          `frameborder=0 allow=\"autoplay; encrypted-media; picture-in-picture\"`\r\n      );\r\n      this.DOM.contentWrapper.classed(\"fullIframe\", true);\r\n    }\r\n\r\n    if (this.onStep) {\r\n      this.onStep.call(this);\r\n    }\r\n\r\n    this.DOM.contentBlock.node().scrollTop = 0;\r\n\r\n    this.DOM.contentWrapper\r\n      .classed(\"firstStep\", this.curStep === 0)\r\n      .classed(\"lastStep\", this.curStep === this.attrib.content.length - 1);\r\n\r\n    this.DOM.contentWrapper\r\n      .selectAll(\".stepDot\")\r\n      .classed(\"active\", (i) => this.curStep === i);\r\n  }\r\n\r\n  refreshViz_Axis() {\r\n  }\r\n\r\n  refreshViz_Active(): void {\r\n    return; // no action\r\n  }\r\n  refreshViz_Compare(\r\n    cT: any,\r\n    curGroup: any,\r\n    totalGroups: any,\r\n    prevCts: any\r\n  ): void {\r\n    return; // no action\r\n  }\r\n  chartAxis_Measure_TickSkip(): number {\r\n    return; // no action\r\n  }\r\n  updateAfterFilter(refreshViz: boolean): void {\r\n    return; // no action\r\n  }\r\n}\r\n","import { Attrib } from \"./Attrib\";\r\nimport { BlockContentSpec } from \"./Types\";\r\nimport { Browser } from \"./Browser\";\r\nimport { Block_Content } from \"./Block_Content\";\r\n\r\n/** -- */\r\nexport class Attrib_Content extends Attrib {\r\n  protected _block: Block_Content;\r\n  public get block(): Block_Content {\r\n    return this._block;\r\n  }\r\n\r\n  /** -- */\r\n  private _content: BlockContentSpec[] = [];\r\n  get content() {\r\n    return this._content;\r\n  }\r\n\r\n  /** -- */\r\n  constructor(browser: Browser, name: string) {\r\n    super(\r\n      browser,\r\n      name,\r\n      null,\r\n      \"content\",\r\n      \"kshfBlock_Content\",\r\n      \"fa fa-file-alt\"\r\n    );\r\n\r\n    this._block = new Block_Content(this);\r\n  }\r\n\r\n  /** -- */\r\n  isEmpty(): boolean {\r\n    return this._content.length > 0;\r\n  }\r\n  isMultiStep(): boolean {\r\n    return this._content.length > 1;\r\n  }\r\n\r\n  /** -- */\r\n  async applyConfig(blockCfg) {\r\n    super.applyConfig(blockCfg);\r\n\r\n    this.setContent(blockCfg._content);\r\n\r\n    this.block.height_max = blockCfg.maxHeight;\r\n    this.block.height_min = blockCfg.minHeight;\r\n\r\n    this.block.onStep = blockCfg.onStep;\r\n  }\r\n\r\n  /** -- */\r\n  setContent(v: BlockContentSpec[] = []): void {\r\n    this._content = v;\r\n    this.block?.displayStep(0);\r\n  }\r\n\r\n  initializeAggregates(): void {}\r\n  updateChartScale_Measure(): void {}\r\n\r\n  get measureRangeMax(): number {\r\n    throw new Error(\"Not supported\");\r\n  }\r\n\r\n}\r\n","import { Browser } from \"../Browser\";\r\nimport { TimeKey } from \"../TimeSeriesData\";\r\nimport { Record } from \"../Record\";\r\nimport { i18n } from \"../i18n\";\r\nimport { Util } from \"../Util\";\r\nimport { Attrib } from \"../Attrib\";\r\n\r\nimport { max } from \"d3-array\";\r\nimport { select } from \"../d3_select\";\r\nimport { scaleLinear } from \"d3-scale\";\r\nimport { Attrib_Timeseries } from \"../Attrib_Timeseries\";\r\nimport { Modal } from \"./Modal\";\r\nimport { RecordDetailSpec } from \"../Types\";\r\n\r\nconst d3 = {\r\n  select,\r\n  max,\r\n  scaleLinear,\r\n};\r\n\r\nexport class RecordDetailPopup {\r\n  browser: Browser;\r\n  recordInDetail?: Record;\r\n\r\n  timeKeyInDetail?: TimeKey;\r\n  recordDetailTimeKeys?: TimeKey[];\r\n\r\n  recordDetailAttribs?: string[] = [];\r\n  recordDetailAttribs_Hidden?: string[];\r\n\r\n  constructor(browser: Browser) {\r\n    this.browser = browser;\r\n\r\n    if (this.browser.options.recordDetailAttribs) {\r\n      this.recordDetailAttribs = Array.from(\r\n        this.browser.options.recordDetailAttribs\r\n      );\r\n    }\r\n  }\r\n\r\n  get DOM() {\r\n    return this.browser.DOM;\r\n  }\r\n\r\n  initDOM() {\r\n    var overlay_recordDetails = this.DOM.overlay_wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_content overlay_recordDetails\");\r\n    overlay_recordDetails.append(\"div\").attr(\"class\", \"overlay_Header\");\r\n    overlay_recordDetails\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_Close fa fa-window-close\")\r\n      .tooltip(i18n.Close, { placement: \"bottom\" })\r\n      .on(\"click\", () => this.closeRecordDetailPanel());\r\n    overlay_recordDetails\r\n      .append(\"div\")\r\n      .attr(\"class\", \"filterOutRecord fa fa-filter\")\r\n      .tooltip(i18n[\"Filter out\"], { placement: \"bottom\" })\r\n      .on(\"click\", () => {\r\n        this.browser.recordDisplay.recordFilter.removeRecord(\r\n          this.recordInDetail\r\n        );\r\n        this.DOM.overlay_wrapper.attr(\"show\", \"none\");\r\n      });\r\n    this.DOM.overlay_recordDetails_content = overlay_recordDetails\r\n      .append(\"div\")\r\n      .attr(\"class\", \"content\");\r\n  }\r\n\r\n  /** -- */\r\n  prepareRecordDetailColumns() {\r\n    this.browser.attribs.forEach((attrib) => {\r\n      if (attrib.hasTimeSeriesParent()) return;\r\n      if (attrib.attribName === \"_Records\") return;\r\n      attrib.initializeAggregates();\r\n      this.recordDetailAttribs.push(attrib.attribName);\r\n    });\r\n\r\n    this.recordDetailAttribs.sort((name1, name2) => {\r\n      var s1 = this.browser.attribWithName(name1);\r\n      var s2 = this.browser.attribWithName(name2);\r\n      if (!s1) return -1;\r\n      if (!s2) return 1;\r\n      var diff =\r\n        Util.getAttribTypeOrder(s1.type) - Util.getAttribTypeOrder(s2.type);\r\n      return diff\r\n        ? diff\r\n        : Util.sortFunc_List_String(s1.attribName, s2.attribName);\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  updateRecordDetailPanel_Header(record) {\r\n    var idSummary = this.browser.attribWithName(this.browser.idSummaryName);\r\n    idSummary.initializeAggregates();\r\n\r\n    var overlay_Header = this.DOM.overlay_wrapper.select(\r\n      \".overlay_recordDetails > .overlay_Header\"\r\n    );\r\n    overlay_Header.html(\"\");\r\n\r\n    overlay_Header\r\n      .append(\"span\")\r\n      .attr(\"class\", \"idSummaryName\")\r\n      .html(idSummary.attribName);\r\n\r\n    var disableRecordSelectBox = this.browser.records.length >= 2500;\r\n    var _ = overlay_Header\r\n      .append(\"span\")\r\n      .attr(\"class\", \"idContentWrapper\")\r\n      .classed(\"disabled\", disableRecordSelectBox);\r\n    _.append(\"span\")\r\n      .attr(\"class\", \"theText\")\r\n      .html(idSummary.getRecordValue(record));\r\n\r\n    if (!disableRecordSelectBox) {\r\n      _.append(\"select\").on(\"change\", (event) => {\r\n        this.updateRecordDetailPanel(\r\n          event.currentTarget.selectedOptions[0].__data__[0]\r\n        );\r\n      });\r\n      _.select(\"select\").selectAll(\"option\").remove();\r\n\r\n      _.select(\"select\")\r\n        .selectAll(\"option\")\r\n        .data(\r\n          this.browser.records\r\n            .map((r) => [r, idSummary.getRecordValue(r)])\r\n            .sort((a, b) => Util.sortFunc_List_String(a[1], b[1]))\r\n        )\r\n        .enter()\r\n        .append(\"option\")\r\n        .attr(\"selected\", (r) => (r[0].id === record.id ? true : null))\r\n        .html((r) => r[1]);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  closeRecordDetailPanel() {\r\n    if (!this.recordInDetail) return;\r\n    this.recordInDetail = null;\r\n\r\n    this.browser.options.onRecordClose?.call(this);\r\n\r\n    this.DOM.overlay_wrapper.attr(\"show\", \"none\");\r\n  }\r\n  /** -- */\r\n  updateRecordDetailPanel(record: Record) {\r\n    this.recordInDetail = record;\r\n\r\n    this.DOM.overlay_wrapper\r\n      .attr(\"show\", \"recordDetails\")\r\n      .classed(\"easyDismiss\", true);\r\n\r\n    this.updateRecordDetailPanel_Header(record);\r\n\r\n    if (this.browser.options.onRecordView) {\r\n      this.DOM.overlay_recordDetails_content.html(\r\n        this.browser.options.onRecordView.call(record.data, record)\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (this.recordDetailAttribs.length === 0) {\r\n      this.prepareRecordDetailColumns();\r\n    }\r\n\r\n    // extend the \"hidden\" list based on what this record also contains\r\n    this.recordDetailAttribs_Hidden = [];\r\n    this.browser.attribs.forEach((attrib) => {\r\n      attrib.initializeAggregates();\r\n\r\n      if (attrib.hasTimeSeriesParent()) return;\r\n      if (this.recordDetailAttribs.indexOf(attrib.attribName) >= 0) return;\r\n      if (attrib.getRecordValue(record) == null) return;\r\n\r\n      this.recordDetailAttribs_Hidden.push(attrib.attribName);\r\n    });\r\n\r\n    var menuOpt = {\r\n      name: \"Edit order\",\r\n      items: [\r\n        {\r\n          name: \"▲ Move up\",\r\n          do: (summary) => {\r\n            var movedSummaryName = summary.summaryName;\r\n            var _i = this.recordDetailAttribs.indexOf(movedSummaryName);\r\n            if (_i == -1 || _i === 0) return;\r\n            this.recordDetailAttribs.splice(_i, 1);\r\n            this.recordDetailAttribs.splice(_i - 1, 0, movedSummaryName);\r\n            this.updateRecordDetailPanel(record);\r\n          },\r\n        },\r\n        {\r\n          name: \"▼ Move down\",\r\n          do: (summary) => {\r\n            var movedSummaryName = summary.summaryName;\r\n            var _i = this.recordDetailAttribs.indexOf(movedSummaryName);\r\n            if (_i == -1 || _i === this.recordDetailAttribs.length - 1) return;\r\n            this.recordDetailAttribs.splice(_i, 1);\r\n            this.recordDetailAttribs.splice(_i + 1, 0, movedSummaryName);\r\n            this.updateRecordDetailPanel(record);\r\n          },\r\n        },\r\n        {\r\n          name: \"Remove\",\r\n          iconClass: \"fa fa-minus-square\",\r\n          do: (a) => {\r\n            this.recordDetailAttribs = this.recordDetailAttribs.filter(\r\n              (c) => c !== a.attribName\r\n            );\r\n            this.updateRecordDetailPanel(record);\r\n          },\r\n        },\r\n        {\r\n          name: \"Add below\",\r\n          iconClass: \"fa fa-plus-square\",\r\n          when: () => this.recordDetailAttribs_Hidden.length > 0,\r\n          do: (selectedSummary, summaryNameToAdd) => {\r\n            // add to visible list\r\n            var pos = this.recordDetailAttribs.indexOf(\r\n              selectedSummary.attribName\r\n            );\r\n            if (pos === -1) return;\r\n            this.recordDetailAttribs.splice(pos + 1, 0, summaryNameToAdd);\r\n            // remove from hidden list\r\n            this.recordDetailAttribs_Hidden =\r\n              this.recordDetailAttribs_Hidden.filter(\r\n                (hc) => hc !== summaryNameToAdd\r\n              );\r\n            this.updateRecordDetailPanel(record);\r\n          },\r\n          options: this.recordDetailAttribs_Hidden.map((c) => ({\r\n            name: c,\r\n            value: c,\r\n          })),\r\n        },\r\n      ],\r\n    };\r\n\r\n    // create the hierarchical outline!\r\n    var outline = {\r\n      _basic: [],\r\n      _timeseries: [],\r\n    };\r\n\r\n    this.recordDetailAttribs.forEach((attribName) => {\r\n      if (attribName === this.browser.idSummaryName) return;\r\n      var attrib = this.browser.attribWithName(attribName);\r\n      if (!attrib) return;\r\n      var v = attrib.getRecordValue(record);\r\n      if (v == null) return;\r\n      if (v.length === 0) return;\r\n\r\n      var _outline =\r\n        attrib.type === \"timeseries\" ? outline._timeseries : outline._basic;\r\n\r\n      attrib.pathName.forEach((path) => {\r\n        if (\r\n          !_outline.some((item) => {\r\n            if (item instanceof Attrib) return false;\r\n            if (item.path === path) {\r\n              _outline = item.items;\r\n              return true;\r\n            }\r\n            return false;\r\n          })\r\n        ) {\r\n          // path not found\r\n          var _ = {\r\n            path: path,\r\n            items: [],\r\n          };\r\n          _outline.push(_);\r\n          _outline = _.items;\r\n        }\r\n      });\r\n\r\n      _outline.push(attrib);\r\n    });\r\n\r\n    // if a summary has a printName same as its last path name, move it under to last path\r\n    [\"_basic\", \"_timeseries\"].forEach((p) => {\r\n      var proc = (_outline) =>\r\n        _outline.filter((item) => {\r\n          if (item.path) {\r\n            item.items = proc(item.items);\r\n            return true;\r\n          }\r\n          return !_outline.some((item2, i) => {\r\n            if (item2 instanceof Attrib) return false;\r\n            if (item2.path === item.printName) {\r\n              item2.items.unshift(item);\r\n              return true;\r\n            }\r\n            return false;\r\n          });\r\n        });\r\n      outline[p] = proc(outline[p]);\r\n    });\r\n\r\n    var getMaxDepth = (_outline) =>\r\n      _outline.reduce((accum, item) => {\r\n        return !item.path\r\n          ? accum\r\n          : 1 + d3.max(item.items, (_) => (_.items ? getMaxDepth(_.items) : 1));\r\n      }, 0);\r\n\r\n    var maxDepth = getMaxDepth(outline._timeseries);\r\n\r\n    // removes any content that was here previously.\r\n    this.DOM.overlay_recordDetails_content.html(\"\");\r\n\r\n    var _table = this.DOM.overlay_recordDetails_content\r\n      .append(\"table\")\r\n      .attr(\"class\", \"recordAttribTable\");\r\n\r\n    var renderRecordValues = (tbody, items, prevPath) => {\r\n      var rowsDOM = tbody\r\n        .selectAll(\"tr.nonexistent\")\r\n        .data(items)\r\n        .enter()\r\n        .append(\"tr\");\r\n\r\n      var lastPath = prevPath[prevPath.length - 1] || \"\";\r\n\r\n      var addHWrapper = (_td) => {\r\n        _td\r\n          .append(\"div\")\r\n          .attr(\"class\", \"attribHierarchyWrapper\")\r\n          .call((_div) => {\r\n            _div\r\n              .filter((s) => !s.printName || s.printName === lastPath)\r\n              .append(\"span\")\r\n              .attr(\"class\", \"hrchyItem collapseArrow\")\r\n              .on(\"click\", () =>\r\n                _td.node().parentNode.parentNode.classList.toggle(\"collapsed\")\r\n              )\r\n              .append(\"span\")\r\n              .attr(\"class\", \"fa fa-caret-down\")\r\n              .tooltip(\"Show/Hide components\");\r\n            _div\r\n              .selectAll(\"span.extendLine\")\r\n              .data((s) => Array.from(prevPath).filter((_) => _ != s.printName))\r\n              .enter()\r\n              .append(\"span\")\r\n              .attr(\"class\", \"hrchyItem extendLine\");\r\n          });\r\n      };\r\n\r\n      var addRecAttribName = (_tr) => {\r\n        _tr\r\n          .append(\"td\")\r\n          .attr(\"class\", \"recAttribName\")\r\n          .call((recAttribName) => {\r\n            recAttribName\r\n              .filter((attrib) => attrib.description)\r\n              .append(\"span\")\r\n              .attr(\"class\", \"summaryDescription fa fa-info-circle\")\r\n              .tooltip((_) => _.description, { placement: \"bottom\" });\r\n            recAttribName\r\n              .append(\"span\")\r\n              .attr(\"class\", \"TheName\")\r\n              .style(\r\n                \"font-size\",\r\n                Math.pow(1.1, maxDepth - prevPath.length) + \"em\"\r\n              )\r\n              .html((attrib) => attrib.printName.trim()); //+(\"<i class='fa fa-level-up'></i>\").repeat(prevPath.length));\r\n            recAttribName\r\n              .append(\"span\")\r\n              .attr(\"class\", \"modifyAttribPos fa fa-bars\")\r\n              .on(\"click\", (event, attrib) =>\r\n                Modal.popupMenu(event, menuOpt, attrib)\r\n              );\r\n            addHWrapper(recAttribName);\r\n          });\r\n      };\r\n\r\n      rowsDOM\r\n        .filter((_) => !(_ instanceof Attrib_Timeseries))\r\n        .attr(\"class\", \"attribRow basicAttrib\")\r\n        .classed(\"groupTitle\", (s) => s.printName === lastPath)\r\n        .attr(\"summaryID\", (s) => s.attribID)\r\n        .each((attrib, i, nodes) => {\r\n          if (!(attrib instanceof Attrib)) return;\r\n\r\n          var _tr = d3.select(nodes[i]);\r\n\r\n          attrib.initializeAggregates();\r\n\r\n          addRecAttribName(_tr);\r\n\r\n          var _recAttribVal = _tr\r\n            .append(\"td\")\r\n            .attr(\"class\", \"recAttribVal\")\r\n            .attr(\"colspan\", 5);\r\n\r\n          attrib.renderRecordValue(record, _recAttribVal);\r\n        });\r\n\r\n      rowsDOM\r\n        .filter((_) => _ instanceof Attrib_Timeseries)\r\n        .attr(\"class\", \"attribRow timeseriesAttrib\")\r\n        .classed(\"groupTitle\", (s) => s.printName === lastPath)\r\n        .attr(\"summaryID\", (s) => s.attribID)\r\n        .call((_tr) => {\r\n          addRecAttribName(_tr);\r\n\r\n          _tr\r\n            .append(\"td\")\r\n            .attr(\"class\", \"recTimeKeyValue\")\r\n            .call((td) => {\r\n              td.append(\"div\").attr(\"class\", \"ValueText\");\r\n              td.filter((s) => s.isComparable.val)\r\n                .append(\"div\")\r\n                .attr(\"class\", \"ValueBar\")\r\n                .append(\"div\")\r\n                .attr(\"class\", \"TheBar\");\r\n            });\r\n          _tr\r\n            .append(\"td\")\r\n            .attr(\"class\", \"recTimeKeyChange\")\r\n            .tooltip(\"\", { placement: \"bottom\" })\r\n            .html(\"<i class='fa fa-angle-right'></i>\");\r\n          _tr.append(\"td\").attr(\"class\", \"recTimeKeyRank\");\r\n\r\n          _tr\r\n            .append(\"td\")\r\n            .attr(\"class\", \"recAttribVal\")\r\n            .each((attrib: Attrib_Timeseries, i, nodes) => {\r\n              attrib.renderRecordValue(\r\n                record,\r\n                d3.select(nodes[i]),\r\n                this.recordDetailTimeKeys\r\n              );\r\n            });\r\n        });\r\n\r\n      rowsDOM\r\n        .filter((_) => !(_ instanceof Attrib))\r\n        .attr(\"class\", \"groupedTableWrapper\")\r\n        .append(\"td\")\r\n        .append(\"table\")\r\n        .append(\"tbody\")\r\n        .attr(\"class\", \"groupedTable collapsed\")\r\n        .each((_item, i, nodes) => {\r\n          var _tbody = d3.select(nodes[i]);\r\n          if (_item.items[0].printName !== _item.path) {\r\n            var _tr = _tbody.append(\"tr\").attr(\"class\", \"groupTitle\");\r\n            _tr\r\n              .append(\"td\")\r\n              .attr(\"class\", \"recAttribName\")\r\n              .call((groupName) => {\r\n                groupName\r\n                  .append(\"span\")\r\n                  .attr(\"class\", \"TheName\")\r\n                  .style(\r\n                    \"font-size\",\r\n                    Math.pow(1.1, maxDepth - prevPath.length) + \"em\"\r\n                  )\r\n                  .on(\"click\", () =>\r\n                    _tbody.node().classList.toggle(\"collapsed\")\r\n                  )\r\n                  .html(_item.path.trim());\r\n                addHWrapper(groupName);\r\n              });\r\n            _tr.append(\"td\").attr(\"class\", \"groupNameGap\");\r\n          }\r\n\r\n          renderRecordValues(\r\n            _tbody,\r\n            _item.items,\r\n            prevPath.concat([_item.path])\r\n          );\r\n\r\n          //_tbody.append(\"tr\").attr(\"class\",\"groupCloseRow\").append(\"td\");\r\n        });\r\n    };\r\n\r\n    renderRecordValues(\r\n      _table.append(\"tbody\").attr(\"class\", \"basicAttribs\"),\r\n      outline._basic,\r\n      []\r\n    );\r\n\r\n    if (outline._timeseries.length > 0) {\r\n      _table\r\n        .append(\"tr\")\r\n        .style(\"height\", \"0.5em\")\r\n        .style(\"grid-column\", \"1 / span 5\");\r\n\r\n      var _tbody = _table.append(\"tbody\").attr(\"class\", \"timeseriesAttribs\");\r\n\r\n      this.recordDetailTimeKeys = record.getTimeKeys();\r\n\r\n      this.browser.recordDisplay.config.timeseriesWidth = Math.min(\r\n        (this.recordDetailTimeKeys.length - 1) * 70,\r\n        400\r\n      );\r\n\r\n      var _tr = _tbody.append(\"tr\");\r\n      _tr.append(\"td\");\r\n      var timeKeySelect = _tr\r\n        .append(\"td\")\r\n        .attr(\"colspan\", 3)\r\n        .attr(\"class\", \"timeKeySelect\");\r\n\r\n      timeKeySelect\r\n        .append(\"i\")\r\n        .attr(\"class\", \"prevTimeKey fa fa-caret-left\")\r\n        .tooltip(i18n.Previous)\r\n        .on(\"click\", () =>\r\n          this.updateFocusedTimeKey(this.timeKey_Step(\"previous\"))\r\n        );\r\n      timeKeySelect\r\n        .append(\"select\")\r\n        .on(\"change\", (event) =>\r\n          this.updateFocusedTimeKey(\r\n            event.currentTarget.selectedOptions[0].__data__\r\n          )\r\n        )\r\n        .selectAll(\"option\")\r\n        .data(this.recordDetailTimeKeys, (x) => x._time)\r\n        .enter()\r\n        .append(\"option\")\r\n        .text((k) => k._time_src);\r\n      timeKeySelect\r\n        .append(\"i\")\r\n        .attr(\"class\", \"nextTimeKey fa fa-caret-right\")\r\n        .tooltip(i18n.Next)\r\n        .on(\"click\", () =>\r\n          this.updateFocusedTimeKey(this.timeKey_Step(\"next\"))\r\n        );\r\n\r\n      _tr.append(\"td\").attr(\"class\", \"timeseriesEditView\");\r\n\r\n      var _tr = _tbody.append(\"tr\").attr(\"class\", \"columnHead\");\r\n      _tr.append(\"td\");\r\n      _tr.append(\"td\").attr(\"class\", \"columnHead_Value\").text(\"Value\");\r\n      _tr.append(\"td\").attr(\"class\", \"columnHead_Change\").text(\"Change\");\r\n      _tr.append(\"td\").attr(\"class\", \"columnHead_Rank\").text(\"Rank\");\r\n      _tr\r\n        .append(\"td\")\r\n        .attr(\"class\", \"columnHead_TimeTrends\")\r\n        .text(\"Time Trends\");\r\n\r\n      renderRecordValues(_tbody, outline._timeseries, []);\r\n\r\n      this.updateFocusedTimeKey(this.recordDetailTimeKeys[0]);\r\n    }\r\n\r\n    // Some random Keshif project uses this to inject some code after main record display view. Hmmm...\r\n    this[\"updateRecordDetailPanel_custom\"]?.call(this, record);\r\n  }\r\n\r\n  /** -- */\r\n  updateFocusedTimeKey(timeKey: TimeKey) {\r\n    if (!this.recordInDetail || !timeKey) return;\r\n\r\n    var _time_src: string = timeKey._time_src;\r\n\r\n    var timeKeyPos: number = this.getTimeKey_Index(timeKey);\r\n    if (timeKeyPos < 0) return; // cannot find the timeKey within the record\r\n\r\n    this.timeKeyInDetail = timeKey;\r\n\r\n    var prevTimeKey: TimeKey =\r\n      timeKeyPos >= this.recordDetailTimeKeys.length - 1\r\n        ? null\r\n        : this.recordDetailTimeKeys[timeKeyPos + 1];\r\n\r\n    d3.select(\".timeKeySelect > .nextTimeKey\").classed(\r\n      \"active\",\r\n      timeKeyPos !== 0\r\n    );\r\n    d3.select(\".timeKeySelect > .prevTimeKey\").classed(\r\n      \"active\",\r\n      timeKeyPos !== this.recordDetailTimeKeys.length - 1\r\n    );\r\n\r\n    var _table = this.DOM.overlay_recordDetails_content.select(\r\n      \"table.recordAttribTable\"\r\n    );\r\n\r\n    _table\r\n      .selectAll(\".timeseriesAttribs tr:first-child > td > select > option\")\r\n      .data([timeKey], (x) => x._time)\r\n      .node().selected = true;\r\n\r\n    _table\r\n      .selectAll(\".timeseriesAttribs .recTimeKeyValue\")\r\n      .each((attrib: Attrib_Timeseries) => attrib.computeRecordRanks());\r\n    _table\r\n      .selectAll(\".timeseriesAttribs .recTimeKeyValue > .ValueText\")\r\n      .html((attrib: Attrib_Timeseries) => {\r\n        var ts = attrib.getRecordValue(this.recordInDetail);\r\n        if (!ts) return \"-\";\r\n        let v = ts._keyIndex[_time_src];\r\n        if (!v) return \"-\";\r\n        return attrib.getFormattedValue(v._value);\r\n      });\r\n\r\n    var clampScale = d3\r\n      .scaleLinear()\r\n      .domain([0, 100])\r\n      .range([0, 100])\r\n      .clamp(true);\r\n\r\n    _table\r\n      .selectAll(\".timeseriesAttribs .recTimeKeyValue > .ValueBar > .TheBar\")\r\n      .style(\"width\", (attrib: Attrib_Timeseries) => {\r\n        var ts = attrib.getRecordValue(this.recordInDetail);\r\n        if (!ts) return null;\r\n        var v = ts._keyIndex[_time_src];\r\n        if (!v) return null;\r\n        if (attrib.unitName === \"%\") {\r\n          // value is measured in percentage anyway, and width is percentage of the box!\r\n          return clampScale(v._value) + \"%\";\r\n        }\r\n        return clampScale(attrib.timeSeriesScale_Value(v._value) * 100) + \"%\"; // cannot exceed 100%\r\n      });\r\n\r\n    _table\r\n      .selectAll(\".timeseriesAttribs .recTimeKeyChange\")\r\n      .attr(\"data-status\", (attrib: Attrib_Timeseries, i, nodes) => {\r\n        var DOM = nodes[i];\r\n        var diff: number = null,\r\n          disp = \"-\",\r\n          _title = \"-\",\r\n          status = \"noValue\";\r\n        var ts = attrib.getRecordValue(this.recordInDetail);\r\n        if (!ts || ts.isEmpty()) {\r\n          nodes[i].tippy.setContent(\"No data\");\r\n          return \"\";\r\n        }\r\n        if (prevTimeKey) {\r\n          var prev = ts._keyIndex[prevTimeKey._time_src];\r\n          var cur = ts._keyIndex[_time_src];\r\n          if (prev && cur) diff = cur._value - prev._value;\r\n          if (attrib.hasFlippedDomain()) diff *= -1; // flip\r\n        }\r\n        if (diff !== null) {\r\n          var threshold = attrib.timeSeriesScale_Value.domain();\r\n          threshold = Math.abs(threshold[1] - threshold[0]) / 50; // 1/50th of the range is the signal of change\r\n          // TODO: make this a parameter\r\n          if (diff > threshold) {\r\n            status = \"improve\";\r\n          } else if (diff < -threshold) {\r\n            status = \"decline\";\r\n          } else {\r\n            status = \"steady\";\r\n          }\r\n          _title =\r\n            `<b>Change from<br>${prevTimeKey._time_src} to ${_time_src}</b>:<br>` +\r\n            attrib.getFormattedValue(diff);\r\n        }\r\n        nodes[i].tippy.setContent(_title);\r\n        return status;\r\n      });\r\n\r\n    _table\r\n      .selectAll(\".timeseriesAttribs .recTimeKeyRank\")\r\n      .html((attrib: Attrib_Timeseries, i, nodes) => {\r\n        var DOM = nodes[i];\r\n        DOM.__NumRecords = 0;\r\n        var ts = attrib.getRecordValue(this.recordInDetail);\r\n        if (!ts || ts.isEmpty()) return \"-\";\r\n        let v = ts._keyIndex[_time_src];\r\n        if (!v || v._rank == 0) return \"-\";\r\n\r\n        DOM.__NumRecords = this.browser.records.reduce(\r\n          (accumulator, rec: Record) => {\r\n            if (rec.filteredOut) return accumulator;\r\n\r\n            var ts = attrib.getRecordValue(rec);\r\n            if (!ts || ts.isEmpty()) return accumulator;\r\n\r\n            let _val = ts._keyIndex[_time_src];\r\n            if (_val == null) return accumulator;\r\n\r\n            return accumulator + 1;\r\n          },\r\n          0\r\n        );\r\n\r\n        return `<span class='rankValue'>${v._rank}</span><span class='rankOutOf'>${DOM.__NumRecords}</span>`;\r\n      })\r\n      .tooltip(\"\")\r\n      .on(\"mouseover\", (event) => {\r\n        var DOM = event.currentTarget;\r\n        // TODO: consider only records that have valid values\r\n        // need to process per each row/attribute -\r\n        // of the ones that are active, do not consider those that do not have a value for the\r\n        DOM.tippy.setContent(\r\n          \"Ranking among \" +\r\n            DOM.__NumRecords +\r\n            (this.browser.isFiltered() ? \" filtered \" : \" \") +\r\n            this.browser.recordName\r\n        );\r\n      });\r\n\r\n    var DOMdots = _table.selectAll(\".recordTimeseriesDot\");\r\n\r\n    var refreshedCurrentKeyClass = (altKey) => {\r\n      DOMdots.classed(\r\n        \"currentKey\",\r\n        (d) => d._time.getTime() === altKey._time.getTime()\r\n      );\r\n    };\r\n\r\n    _table\r\n      .selectAll(\".recordTimeseriesDot\")\r\n      .classed(\r\n        \"currentKey\",\r\n        (d) => d._time.getTime() === timeKey._time.getTime()\r\n      )\r\n      .on(\"mouseover\", (_event, x) => refreshedCurrentKeyClass(x))\r\n      .on(\"mouseout\", () => refreshedCurrentKeyClass(timeKey));\r\n\r\n    refreshedCurrentKeyClass(timeKey);\r\n\r\n    // Another project-specific customization that should be in the core in a different way\r\n    this[\"updateFocusedTimeKey_custom\"]?.();\r\n  }\r\n\r\n  getTimeKey_Index(timeKey) {\r\n    return this.recordDetailTimeKeys.findIndex(\r\n      (tK) => tK._time.getTime() == timeKey._time.getTime()\r\n    );\r\n  }\r\n\r\n  /** next or previous */\r\n  timeKey_Step(sequence) {\r\n    if (!(sequence === \"next\" || sequence === \"previous\")) return null;\r\n    var timeKeyPos = this.getTimeKey_Index(this.timeKeyInDetail);\r\n    if (timeKeyPos < 0) return null;\r\n    return (\r\n      this.recordDetailTimeKeys[timeKeyPos + (sequence === \"next\" ? -1 : 1)] ||\r\n      null\r\n    );\r\n  }\r\n\r\n  exportConfig(): RecordDetailSpec {\r\n    return {\r\n      recordInDetail: this.recordInDetail?.id,\r\n      recordDetailAttribs: this.recordDetailAttribs\r\n        ? Array.from(this.recordDetailAttribs)\r\n        : undefined,\r\n    };\r\n  }\r\n}\r\n","import DOMPurify from \"dompurify/dist/purify.es\";\r\n\r\nimport { select, pointer } from \"./d3_select\";\r\nimport { rgb } from \"d3-color\";\r\nimport { max } from \"d3-array\";\r\nimport { scaleLinear } from \"d3-scale\";\r\nimport * as d3Chromatic from \"d3-scale-chromatic\";\r\n\r\nimport { RecordDisplay } from \"./RecordDisplay\";\r\n\r\nimport {\r\n  Aggregate_Interval,\r\n  Aggregate_Interval_Numeric,\r\n} from \"./Aggregate_Interval\";\r\nimport { Aggregate } from \"./Aggregate\";\r\n\r\nimport { loadMapStandards } from \"./MapStandards\";\r\n\r\nimport { ConfigPanel } from \"./UI/ConfigPanel\";\r\nimport { BreadCrumb } from \"./UI/Breadcrumb\";\r\nimport { MenuOpts } from \"./UI/MenuOpts\";\r\nimport { Modal } from \"./UI/Modal\";\r\nimport { Panel } from \"./UI/Panel\";\r\n\r\nimport { Config } from \"./Config\";\r\nimport { i18n } from \"./i18n\";\r\nimport { Util } from \"./Util\";\r\nimport { Base } from \"./Base\";\r\n\r\n// Standarad fetch and googlesheet loaders are included by default.\r\nimport { DataLoader_FetchURL } from \"./DataLoader/FetchURL\";\r\nimport { DataLoader_GoogleSheets } from \"./DataLoader/GoogleSheets\";\r\nimport { DataTable } from \"./DataTable\";\r\n\r\nimport { Filter_Base } from \"./Filter\";\r\n\r\nimport { Attrib } from \"./Attrib\";\r\nimport { Record } from \"./Record\";\r\nimport { Block } from \"./Block\";\r\n\r\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\r\nimport { Attrib_Timestamp } from \"./Attrib_Timestamp\";\r\nimport { Attrib_RecordGeo } from \"./Attrib_RecordGeo\";\r\nimport { Attrib_Interval } from \"./Attrib_Interval\";\r\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\r\nimport { Attrib_Content } from \"./Attrib_Content\";\r\nimport { AttribTemplate } from \"./AttribTemplate\";\r\n\r\nimport {\r\n  BlockType,\r\n  CompareType,\r\n  ConfigSpec,\r\n  DashboardMode,\r\n  IntervalT,\r\n  MeasureFunc,\r\n  MeasureType,\r\n  PanelName,\r\n  RecordDisplayType,\r\n  SummarySpec,\r\n} from \"./Types\";\r\n\r\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\r\n\r\nimport { TimeSeriesData } from \"./TimeSeriesData\";\r\n\r\nimport { Block_Categorical } from \"./Block_Categorical\";\r\nimport { RecordDetailPopup } from \"./UI/RecordDetailsPopup\";\r\n\r\nconst d3 = {\r\n  select,\r\n  pointer,\r\n  rgb,\r\n  max,\r\n  scaleLinear,\r\n  ...d3Chromatic, // all values in chromatic module\r\n};\r\n\r\nexport type ColorThemeType = \"sequential\" | \"diverging\";\r\n\r\nexport type BreakdownType = \"absolute\" | \"dependent\" | \"relative\" | \"total\";\r\n\r\ntype DataTypeDescr = {\r\n  name: string;\r\n  icon: string;\r\n  member: (a: Attrib) => boolean;\r\n  active: boolean;\r\n};\r\n\r\n/** \r\n    Detected transformations:\r\n    > STR\r\n    > JSON\r\n    > POSITIVE\r\n    > DATETIME\r\n    > DELETE\r\n    > LAT_LONG(lat,long)\r\n    > MULTIVAL(a;b;c;d;...)\r\n    > ${DATETIME}\r\n    > SPLIT\r\n   */\r\nfunction applyPreProc(_key: string, _transform: string, recordList: Record[]) {\r\n  var keySequence = _key.split(\"->\");\r\n\r\n  var keyIndex = keySequence[keySequence.length - 1];\r\n  var keyHostFunc = (v) => {\r\n    for (var i = 0; i < keySequence.length - 1; i++) {\r\n      v = v[keySequence[i]];\r\n      if (v == null) return;\r\n    }\r\n    return v;\r\n  };\r\n\r\n  if (_transform === \"DELETE()\") {\r\n    recordList.forEach((r) => {\r\n      var host = keyHostFunc(r.data);\r\n      if (host) delete host[keyIndex];\r\n    });\r\n    return;\r\n  }\r\n\r\n  let transformFunc: Function = null;\r\n\r\n  /* jshint ignore:start */\r\n  var isTimeseries = RegExp(/(.+)->\\$\\{(.+)\\}/).exec(_transform);\r\n  var isDateTime = RegExp(\"DATETIME\\\\((.+)\\\\)\").exec(_transform);\r\n  var isMultiVal = RegExp(\"MULTIVAL\\\\((.+)\\\\)\").exec(_transform);\r\n  var isSplit = RegExp(\"SPLIT\\\\((.+)\\\\)\").exec(_transform);\r\n  var isLatLong = RegExp(\"LAT_LONG\\\\((.+),(.+)\\\\)\").exec(_transform);\r\n  /* jshint ignore:end */\r\n\r\n  if (_transform === \"STR()\") {\r\n    // convert value to string\r\n    transformFunc = (v) => (v == null ? null : \"\" + v);\r\n    //\r\n  } else if (_transform === \"JSON()\") {\r\n    // parse value as JSON string\r\n    transformFunc = (v) => (v == null ? null : JSON.parse(v));\r\n    //\r\n  } else if (_transform === \"POSITIVE()\") {\r\n    // keep only positive values\r\n    transformFunc = (v) => (v && typeof v === \"number\" && v > 0 ? v : null);\r\n    //\r\n  } else if (!isTimeseries && isDateTime && isDateTime.length > 1) {\r\n    // parse the date given a string\r\n    var _timeParse = Util.getTimeParseFunc(isDateTime[1]);\r\n    transformFunc = (v) => (v == null ? null : _timeParse(v));\r\n    //\r\n  } else if (isSplit && isSplit.length > 1) {\r\n    // split values in a string into multiple string\r\n    var splitExpr = RegExp(isSplit[1]);\r\n\r\n    transformFunc = (v): string[] => {\r\n      if (v == null) return null;\r\n      if (typeof v === \"number\") {\r\n        return [\"\" + v];\r\n      }\r\n      if (Array.isArray(v)) {\r\n        if (v.length === 1) {\r\n          v = v[0]; // try to split the first/only element\r\n        } else {\r\n          return v;\r\n        }\r\n      }\r\n\r\n      // split, trim and cleanup\r\n      return v\r\n        .split(splitExpr)\r\n        .map((x) => x.trim())\r\n        .filter((x) => x !== \"\");\r\n    };\r\n  } else if (isMultiVal && isMultiVal.length > 1) {\r\n    // merge data from multiple columns\r\n    var splitExpr = RegExp(\"\\\\s*;\\\\s*\");\r\n\r\n    var colNames = isMultiVal[1]\r\n      .split(splitExpr)\r\n      .map((x) => x.trim())\r\n      .filter((x) => x !== \"\");\r\n\r\n    if (colNames.length >= 2) {\r\n      transformFunc = (v, r) => {\r\n        var _return = [];\r\n        colNames.forEach((c) => {\r\n          if (r[c]) {\r\n            _return.push(r[c]);\r\n            delete r[c];\r\n          }\r\n        });\r\n        return _return;\r\n      };\r\n    }\r\n  } else if (isTimeseries && isTimeseries.length > 1) {\r\n    // prepare timeseries structure\r\n    var _isDateTime = RegExp(\"DATETIME\\\\((.+)\\\\)\").exec(isTimeseries[2]);\r\n\r\n    if (_isDateTime && _isDateTime.length > 1) {\r\n      var __timeParse = Util.getTimeParseFunc(_isDateTime[1]);\r\n\r\n      var valueKey = null;\r\n      var hasValueKey = RegExp(\"::(.+)\").exec(isTimeseries[2]);\r\n      if (hasValueKey && hasValueKey.length > 1) {\r\n        valueKey = hasValueKey[1];\r\n      }\r\n\r\n      transformFunc = (v) => {\r\n        if (v == null) return null;\r\n\r\n        let _ts = new TimeSeriesData();\r\n\r\n        for (var timeKey in v) {\r\n          var _value = v[timeKey];\r\n          if (typeof _value !== \"number\") {\r\n            continue; // Must be numeric value\r\n          }\r\n          var _time = __timeParse(timeKey.trim());\r\n          if (_time == null) {\r\n            continue; // cannot parse the string key to date object\r\n          }\r\n          _ts.addTimeData({\r\n            _time: _time,\r\n            _time_src: timeKey,\r\n            _value: valueKey ? _value[valueKey] : _value,\r\n          });\r\n        }\r\n\r\n        // merge timeseries data with object\r\n        return _ts;\r\n      };\r\n    }\r\n  }\r\n\r\n  if (transformFunc) {\r\n    recordList.forEach((r) => {\r\n      var host = keyHostFunc(r.data);\r\n      if (host == null) return;\r\n      try {\r\n        host[keyIndex] = transformFunc(host[keyIndex], r.data);\r\n      } catch (e) {\r\n        console.log(\"onLoad _transform error: \" + e);\r\n      }\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (isLatLong && isLatLong.length > 1) {\r\n    var latAttrib = isLatLong[1];\r\n    var lonAttrib = isLatLong[2];\r\n    recordList.forEach((r) => {\r\n      var host = keyHostFunc(r.data);\r\n      if (!host) return;\r\n      var _lat = r.data[latAttrib];\r\n      var _lng = r.data[lonAttrib];\r\n      if (\r\n        _lat &&\r\n        _lng &&\r\n        typeof _lat === \"number\" &&\r\n        typeof _lng === \"number\"\r\n      ) {\r\n        host[keyIndex] = {\r\n          type: \"Point\",\r\n          coordinates: [_lng, _lat],\r\n        };\r\n      }\r\n      delete r.data[latAttrib];\r\n      delete r.data[lonAttrib];\r\n    });\r\n    return;\r\n  }\r\n}\r\n\r\nexport class Browser {\r\n  records: Record[] = [];\r\n\r\n  recordName: string = \"\";\r\n\r\n  idSummaryName: string = null;\r\n  primaryTableName: string = null;\r\n\r\n  recordDisplay: RecordDisplay = null;\r\n\r\n  recordDetailsPopup: RecordDetailPopup;\r\n\r\n  allRecordsAggr: Aggregate = null;\r\n  allAggregates: Aggregate[] = [];\r\n\r\n  public measureSummary: Config<Attrib_Numeric>;\r\n  public breakdownMode: Config<BreakdownType>;\r\n  public dashboardMode: Config<DashboardMode>;\r\n  public mouseOverCompare: Config<boolean>;\r\n  public measureFunc: Config<MeasureFunc>;\r\n  public stackedCompare: Config<boolean>;\r\n  public recordChartType: Config<RecordDisplayType>;\r\n  public showWholeAggr: Config<boolean>;\r\n  public filteringMode: Config<string>;\r\n\r\n  private configs: { [key: string]: Config<any> } = {};\r\n\r\n  // TODO: review & improve\r\n  options: ConfigSpec;\r\n\r\n  private dashboardConfigPanel: ConfigPanel;\r\n\r\n  private domID: string;\r\n\r\n  public DOM: { [index: string]: any } = {};\r\n\r\n  panels: { [key in PanelName]?: Panel } = {};\r\n\r\n  flexAggrs: { [key in CompareType]?: Aggregate_Interval<any> } = {};\r\n\r\n  addedCompare: boolean = false;\r\n\r\n  // ********************************************************************\r\n  // Attributes\r\n  // ********************************************************************\r\n\r\n  attribs: Attrib[] = [];\r\n\r\n  attribCounter = 0;\r\n\r\n  get attribsInDashboard(): Attrib[] {\r\n    return this.attribs.filter((attrib) => attrib.block?.inDashboard);\r\n  }\r\n  // always in dashboard\r\n  get blocks(): Block[] {\r\n    return this.attribsInDashboard.map((attrib) => attrib.block);\r\n  }\r\n  // query by attribute name\r\n  attribWithName(name: string): Attrib {\r\n    return this.attribs.find((attrib) => name === attrib?.attribName || name === attrib?.template?.str) || null;\r\n  }\r\n  get _attribs() {\r\n    var r = {};\r\n    this.attribs.forEach((attrib) => {\r\n      r[attrib.attribName] = attrib;\r\n      if (attrib.template.str) {\r\n        r[attrib.template.str] = attrib;\r\n      }\r\n    });\r\n    return r;\r\n  }\r\n\r\n  // used to render attribute list hierarchy\r\n  private attribs_by_group = {};\r\n\r\n  // ********************************************************************\r\n  //\r\n  // ********************************************************************\r\n\r\n  finalized: boolean = false;\r\n\r\n  // the shared color scape options in the browser (themes)\r\n  colorTheme: any; // TODO\r\n  // active color theme\r\n  activeColorTheme: ColorThemeType = \"sequential\";\r\n\r\n  preventAxisScaleTransition: boolean = true;\r\n\r\n  onLoad: {\r\n    callback?: (this: Browser) => void;\r\n    main: { [index: string]: string };\r\n  } = { callback: null, main: {} };\r\n\r\n  onModeChange: () => void = null;\r\n\r\n  readonly dataTypeDescrs: DataTypeDescr[] = [\r\n    {\r\n      name: \"Categorical\",\r\n      icon: \"fa fa-font\",\r\n      member: (attrib: Attrib) => attrib instanceof Attrib_Categorical,\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"MultiValued\",\r\n      icon: \"fa fa-tags\",\r\n      member: (attrib: Attrib) =>\r\n        attrib instanceof Attrib_Categorical && attrib.isMultiValued,\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Numeric\",\r\n      icon: \"fa fa-hashtag\",\r\n      member: (attrib: Attrib) => attrib instanceof Attrib_Numeric,\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Timestamp\",\r\n      icon: \"fa fa-calendar-day\",\r\n      member: (attrib: Attrib) => attrib instanceof Attrib_Timestamp,\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Timeseries\",\r\n      icon: \"fa fa-chart-line\",\r\n      member: (attrib: Attrib) => attrib instanceof Attrib_Timeseries,\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Location\",\r\n      icon: \"fa fa-map-marker\",\r\n      member: (attrib) =>\r\n        attrib instanceof Attrib_RecordGeo ||\r\n        (attrib instanceof Attrib_Categorical && attrib.hasMap()),\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Unique\",\r\n      icon: \"fa fa-fingerprint\",\r\n      member: (attrib: Attrib) => attrib.uniqueCategories(),\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Function\",\r\n      icon: \"fa fa-function\",\r\n      member: (attrib: Attrib) => !attrib.template.str,\r\n      active: false,\r\n    },\r\n    {\r\n      name: \"Content\",\r\n      icon: \"fa fa-file-alt\",\r\n      member: (attrib: Attrib) => attrib instanceof Attrib_Content,\r\n      active: false,\r\n    },\r\n  ];\r\n\r\n  constructor(options: ConfigSpec) {\r\n    \"use strict\";\r\n    this.options = options;\r\n\r\n    // TODO: Cannot do await here since this is constructor\r\n    // but it'd be nice to wait until everything is loaded\r\n    Base.loadResources();\r\n\r\n    this.domID = this.options.domID || Base.defaultDOM;\r\n\r\n    // BASIC OPTIONS\r\n\r\n    Base.Compare_List.forEach((cT) => {\r\n      this.lockedCompare[cT] = false;\r\n      this.selectedAggrs[cT] = null;\r\n      this.crumbs[cT] = new BreadCrumb(this, cT);\r\n    });\r\n\r\n    this.measureFunc = new Config<MeasureFunc>({\r\n      parent: this,\r\n      cfgTitle: \"Measure Function\",\r\n      cfgClass: \"measureFunc\",\r\n      iconClass: \"fa fa-cubes\",\r\n      UISeperator: {\r\n        title: \"Analytics\",\r\n      },\r\n      default: \"Count\",\r\n      tooltip: \"The metric that aggregates values in each category / range.\",\r\n      helparticle: \"5e9516452c7d3a7e9aeae06e\",\r\n      itemOptions: [\r\n        // TODO: implement deactive / empty options\r\n        // see: addMeasureOptions_Func\r\n        { name: \"measure_Count\", value: \"Count\" },\r\n        {\r\n          name: \"measure_Sum\",\r\n          value: \"Sum\",\r\n          activeWhen: () => this.getMeasurableSummaries(\"Sum\").length > 0,\r\n        },\r\n        {\r\n          name: \"measure_Avg\",\r\n          value: \"Avg\",\r\n          activeWhen: () => this.getMeasurableSummaries(\"Avg\").length > 0,\r\n        },\r\n      ],\r\n      onRefreshDOM: (cfg: Config<MeasureFunc>) => {\r\n        // Update text\r\n        this.DOM.metricFuncText\r\n          .select(\".measureFuncText\")\r\n          .html(i18n[\"measure_\" + cfg.get()]);\r\n        // Update select box\r\n        this.addMeasureOptions_Func(\r\n          this.DOM.metricFuncText.select(\".measureFuncOptions\")\r\n        );\r\n      },\r\n      preSet: async (v: MeasureFunc) => {\r\n        if (v === \"Count\") return v;\r\n        // v is Sum or Avg - we need to make sure measureSummary is valid.\r\n        if (!this.measureSummary?.get()) {\r\n          let attrib = this.getMeasurableSummaries(v)[0];\r\n          if (!attrib) {\r\n            throw Error(`No numeric data attribute supports ${v} measure function.`);\r\n          }\r\n          await this.measureSummary?.set(attrib as Attrib_Numeric);\r\n        }\r\n        return v;\r\n      },\r\n      onSet: async () => {\r\n        await this.refreshMeasureMetric();\r\n      },\r\n    });\r\n\r\n    this.measureSummary = new Config<Attrib_Numeric>({\r\n      parent: this,\r\n      cfgTitle: \"Measure Attribute\",\r\n      cfgClass: \"measureSummary\",\r\n      iconClass: \"fa fa-cube\",\r\n      default: null, // not set\r\n      helparticle: \"5e9516452c7d3a7e9aeae06e\",\r\n      onDOM: (DOM) => {\r\n        var _ = DOM.root.select(\".configItem_Options\");\r\n        DOM.mainSelect = _.append(\"select\").attr(\"class\", \"mainSelect\");\r\n        DOM.timeKeys = _.append(\"select\")\r\n          .attr(\"class\", \"timeKeys\")\r\n          .on(\"input\", (event) => {\r\n            var selectedKey = event.currentTarget.selectedOptions[0].__data__;\r\n            this.measureSummary.set(\r\n              this.measureSummary.get().timeseriesParent.getTimepointSummary(\r\n                selectedKey\r\n              ));\r\n          });\r\n      },\r\n      onRefreshDOM: (cfg: Config<Attrib_Numeric>) => {\r\n        if (!cfg.get()) return; // nothing to do!\r\n        var attrib = this.measureSummary.get();\r\n        this.addMeasureOptions_Summaries(cfg.DOM.mainSelect);\r\n\r\n        this.addMeasureOptions_Summaries(\r\n          this.DOM.metricFuncText.select(\"select.measureSummary\")\r\n        );\r\n\r\n        // If measureSummary is timeseries, we need to show the keys\r\n        var withKeys = attrib.timeseriesParent;\r\n        cfg.DOM.timeKeys.classed(\"hide\", !withKeys);\r\n\r\n        this.DOM.metricFuncText\r\n          .select(\".timeKeys.metricOptionWrapper\")\r\n          .classed(\"hide\", !withKeys);\r\n        this.DOM.metricFuncText\r\n          .select(\".measureSummaryName\")\r\n          .html((withKeys ? attrib.timeseriesParent : attrib).attribNameHTML);\r\n\r\n        if (withKeys) {\r\n          this.addMeasureOptions_Keys(cfg.DOM.timeKeys);\r\n          this.addMeasureOptions_Keys(\r\n            this.DOM.metricFuncText.select(\"select.timeKeys\")\r\n          );\r\n          this.DOM.metricFuncText\r\n            .select(\".timeKeyText\")\r\n            .html(attrib.timeKey._time_src);\r\n        }\r\n      },\r\n      preSet: async (v) => {\r\n        var attrib: Attrib = v;\r\n        if (typeof attrib === \"string\") {\r\n          attrib = this.attribWithName(v);\r\n          if (!attrib) attrib = this.createAttrib(v);\r\n        }\r\n\r\n        if (attrib instanceof Attrib_Timeseries) {\r\n          // First, try to use the timeKey of current measure attrib\r\n          attrib.initializeAggregates(); // before this, timeKeys is not computed.\r\n          var key =\r\n            this.measureSummary.get()?.timeKey ||\r\n            this.recordDisplay.currentTimeKey.get() ||\r\n            attrib.timeKeys[attrib.timeKeys.length - 1];\r\n          attrib = attrib.getTimepointSummary(key);\r\n        }\r\n\r\n        if (!attrib || !(attrib instanceof Attrib_Numeric)) return; // not a valid value\r\n\r\n        // make sure attrib caches are initialized...\r\n        attrib.initializeAggregates();\r\n\r\n        return attrib; // allright\r\n      },\r\n      onSet: async (v) => {\r\n        if (!v || this.measureFunc_Count) return;\r\n        await this.refreshMeasureMetric();\r\n      },\r\n    });\r\n\r\n    this.breakdownMode = new Config<BreakdownType>({\r\n      parent: this,\r\n      cfgTitle: \"Breakdown\",\r\n      cfgClass: \"breakdownMode\",\r\n      iconClass: \"fa fa-percent\",\r\n      default: \"absolute\",\r\n      helparticle: \"5e89445604286364bc97d5eb\",\r\n      tooltip: `How to compute and compare data groups`,\r\n      itemOptions: [\r\n        { name: \"# Absolute\", value: \"absolute\" },\r\n        { name: \"% of Compared\", value: \"dependent\" },\r\n        { name: \"% of Groups\", value: \"relative\" },\r\n        { name: \"% of All\", value: \"total\" },\r\n      ],\r\n      forcedValue: () => {\r\n        if (!this.measureWithPositiveValues()) return \"absolute\";\r\n      },\r\n      preSet: async (v: BreakdownType) => {\r\n        if (v !== \"absolute\" && this.measureFunc_Avg) {\r\n          throw Error(`You cannot analyze data by ${i18n.DialogComparisonSelection} when<br>\r\n            using <i>average</i> as aggregation function for <i>${this.measureSummary.get().attribName}</i>.`);\r\n        }\r\n        if (v !== \"absolute\" && this.measureSumWithNegativeValues()) {\r\n          throw Error(i18n.DialogCompareForRelative);\r\n        }\r\n\r\n        return v;\r\n      },\r\n      onSet: async (v) => {\r\n        this.preventAxisScaleTransition = true;\r\n        this.addedCompare = false;\r\n        for(let attrib of this.attribsInDashboard){\r\n          await attrib.axisScaleType.set(v === \"relative\" ? \"full\" : \"fit\");\r\n          attrib.refreshScale_Measure();\r\n        }\r\n        await this.refreshAnalytics();\r\n        this.preventAxisScaleTransition = false;\r\n      },\r\n    });\r\n\r\n    this.stackedCompare = new Config<boolean>({\r\n      parent: this,\r\n      cfgTitle: \"GroupView\",\r\n      cfgClass: \"stackedCompare\",\r\n      iconClass: \"CompareModeIcon\", // will add sub-elements to this\r\n      UISeperator: {\r\n        title: \"Visualization\",\r\n      },\r\n      default: true,\r\n      helparticle: \"5e88ff692c7d3a7e9aea6475\",\r\n      tooltip: `The comparison view mode<br><br>\r\n        <b>Side-by-side</b>: Compare on shared baseline<br><br>\r\n        <b>Stacked</b>: Compare on stacked baseline`,\r\n      itemOptions: [\r\n        { name: \"SideBySide\", value: false },\r\n        { name: \"Stacked\", value: true },\r\n      ],\r\n      onDOM: (DOM) => {\r\n        DOM.root\r\n          .select(\".CompareModeIcon\")\r\n          .selectAll(\"div\")\r\n          .data([0, 1, 2])\r\n          .enter()\r\n          .append(\"div\")\r\n          .attr(\"class\", \"CompareModeIcon-block\");\r\n      },\r\n      forcedValue: () => {\r\n        if (this.dependentBreakdown) {\r\n          return false;\r\n        }\r\n\r\n        if (this.relativeBreakdown) {\r\n          if (!this.comparedAttrib) return false;\r\n          return !this.isComparedSummaryMultiValued(); // stack if it's not multi-valued\r\n        }\r\n\r\n        if (this.totalBreakdown) {\r\n          if (!this.comparedAttrib) return false;\r\n          if (this.isComparedSummaryMultiValued()) return false;\r\n        }\r\n\r\n        // absoluteBreakdown from now on\r\n\r\n        // detect cases when you cannot stack\r\n        if (this.comparedAttrib && this.isComparedSummaryMultiValued())\r\n          return false;\r\n        if (!this.measureWithPositiveValues()) return false;\r\n      },\r\n      preSet: async (v) => {\r\n        if (v !== true && v !== false) return; // not valid input\r\n\r\n        if (v && this.comparedAttrib && this.isComparedSummaryMultiValued()) {\r\n          throw i18n.DialogStackedMultiValue(this.comparedAttrib.attribName);\r\n        }\r\n        if (\r\n          !v &&\r\n          this.comparedAttrib &&\r\n          !this.isComparedSummaryMultiValued() &&\r\n          this.relativeBreakdown\r\n        ) {\r\n          throw i18n.DialogSideBySideSingleValue(\r\n            this.comparedAttrib.attribName\r\n          );\r\n        }\r\n        if (v && this.measureFunc_Avg) {\r\n          throw (\r\n            i18n.DialogStackedCharts +\r\n            \" cannot be used with <i>average</i> measure function.\"\r\n          );\r\n        }\r\n        if (v && this.dependentBreakdown) {\r\n          throw (\r\n            i18n.DialogStackedCharts +\r\n            \" cannot be used with \" +\r\n            i18n.DialogDependentBreakdown\r\n          );\r\n        }\r\n        if (v && this.measureSumWithNegativeValues()) {\r\n          throw (\r\n            i18n.DialogStackedCharts +\r\n            \" cannot be used with measuring totals with negative values.\"\r\n          );\r\n        }\r\n\r\n        return v;\r\n      },\r\n      onSet: async () => {\r\n        this.attribsInDashboard.forEach((attrib) =>\r\n          attrib.refreshScale_Measure()\r\n        );\r\n        await this.refreshAnalytics();\r\n      },\r\n    });\r\n\r\n    this.showWholeAggr = new Config<boolean>({\r\n      parent: this,\r\n      cfgTitle: \"Whole Distribution\",\r\n      cfgClass: \"showWholeAggr\",\r\n      iconClass: \"fa fa-square\", // will add sub-elements to this\r\n      default: true,\r\n      tooltip: `When you have two or more compare selections, \r\n                you can choose to show the whole value of the aggreagates.`,\r\n      helparticle: \"5e893d7a2c7d3a7e9aea656f\",\r\n      itemOptions: [\r\n        { name: \"Show\", value: true },\r\n        { name: \"Hide\", value: false },\r\n      ],\r\n      forcedValue: () => {\r\n        if (this.activeComparisonsCount === 0) return true;\r\n\r\n        if (this.dependentBreakdown) {\r\n          return false;\r\n        }\r\n\r\n        if (this.relativeBreakdown) {\r\n          if (!this.comparedAttrib) return false;\r\n          return !this.isComparedSummaryMultiValued();\r\n        }\r\n\r\n        if (this.totalBreakdown) {\r\n          if (!this.comparedAttrib) return false;\r\n          return;\r\n          //if(this.comparedSummary.isMultiValued) return false;\r\n        }\r\n\r\n        // of-total or absolute breakdown, with comparisons\r\n\r\n        if (this.stackedCompare.is(true)) {\r\n          var totalOfCompared = this.activeComparisons.reduce((accum, val) => {\r\n            if (this.selectedAggrs[val]) {\r\n              return accum + this.selectedAggrs[val][val].measure;\r\n            }\r\n            return accum;\r\n          }, 0);\r\n\r\n          if (totalOfCompared === this.allRecordsAggr.measure(\"Active\"))\r\n            return false;\r\n        }\r\n\r\n        if (!this.measureWithPositiveValues()) return false;\r\n      },\r\n      onSet: async () => await this.refreshAnalytics(),\r\n    });\r\n\r\n    this.filteringMode = new Config<string>({\r\n      parent: this,\r\n      cfgTitle: \"Filtering\",\r\n      cfgClass: \"filteringMode\",\r\n      iconClass: \"fa fa-filter\", // will add sub-elements to this\r\n      UISeperator: {\r\n        title: \"Selections\",\r\n      },\r\n      default: \"chained\",\r\n      tooltip: `<b>Combined</b> allows combining multiple filters together<br><br>\r\n        <b>Single</b> forces to have at most one active filter.`,\r\n      helparticle: \"5e88eff404286364bc97d459\",\r\n      itemOptions: [\r\n        { name: \"Chained\", value: \"chained\" },\r\n        { name: \"Single\", value: \"single\" },\r\n      ],\r\n      preSet: async (v) => {\r\n        v = v.toLowerCase();\r\n        if (v === \"combined\") v = \"chained\";\r\n        return v;\r\n      },\r\n      onSet: (v) => {\r\n        if (v === \"single\" && this.numOfActiveFilters > 1) {\r\n          this.clearFilters_All(this.filters.find((_) => _.isFiltered)); // remove our all but one\r\n        }\r\n      },\r\n    });\r\n\r\n    this.mouseOverCompare = new Config<boolean>({\r\n      parent: this,\r\n      cfgTitle: \"Hover Highlight\",\r\n      cfgClass: \"mouseOverCompare\",\r\n      iconClass: \"fa fa-mouse-pointer\", // will add sub-elements to this\r\n      default: true,\r\n      helparticle: \"5e8905c52c7d3a7e9aea6489\",\r\n      itemOptions: [\r\n        { name: \"Enabled\", value: true },\r\n        { name: \"Disabled\", value: false },\r\n      ],\r\n    });\r\n\r\n    this.recordChartType = new Config<RecordDisplayType>({\r\n      parent: this,\r\n      cfgTitle: \"Record Chart Type\",\r\n      cfgClass: \"recordChartType\",\r\n      iconClass: \"fa fa-bullseye\", // will add sub-elements to this\r\n      UISeperator: {\r\n        title: \"Record Chart\",\r\n      },\r\n      default: \"none\",\r\n      helparticle: \"5eadcca72c7d3a5ea54a59e9\",\r\n      noExport: true,\r\n      itemOptions: [\r\n        { name: \"None\", value: \"none\" },\r\n        {\r\n          name: \"ListButton\",\r\n          value: \"list\",\r\n          activeWhen: () => true, // always visible\r\n        },\r\n        {\r\n          name: \"MapButton\",\r\n          value: \"map\",\r\n          activeWhen: () => {\r\n            return this.recordDisplay?.getRecordGeoAttributes().length > 0;\r\n          },\r\n        },\r\n        {\r\n          name: \"TimeSeriesButton\",\r\n          value: \"timeseries\",\r\n          activeWhen: () => {\r\n            if (this.records?.length < 2) return false;\r\n            return this.recordDisplay?.getAttribOptions_UI(\"timeSeries\").length > 0;\r\n          },\r\n        },\r\n        {\r\n          name: \"ScatterButton\",\r\n          value: \"scatter\",\r\n          activeWhen: () => {\r\n            if (this.records?.length < 5) return false;\r\n            return this.recordDisplay?.getAttribOptions_UI(\"scatterX\").length > 1;\r\n          },\r\n        },\r\n      ],\r\n\r\n      preSet: async (v : RecordDisplayType) => {\r\n        if (!this.records) return; // data not loaded yet\r\n        if (!this.recordDisplay) return;\r\n\r\n        if (this.records.length > 5000 && ![\"list\", \"none\"].includes(v)) {\r\n          await Modal.confirm(\r\n            \"<div style='text-align:center;''>There are more than 2,000 records.<br>\" +\r\n              `The ${v} chart will be crowded and potentially slow.<br><Br>` +\r\n              `Are you sure you want to change to ${v} chart?</div>`,\r\n            \"Change chart type\"\r\n          );\r\n        }\r\n\r\n        if (v === \"map\") {\r\n          // Make sure recordDisplay.config.geo is set.\r\n          if (!this.recordDisplay.config.geo) {\r\n            var _ = this.recordDisplay.getRecordGeoAttributes()[0];\r\n            if (!_) throw \"Geo attribute not found\";\r\n          }\r\n        }\r\n\r\n        return v;\r\n      },\r\n\r\n      onSet: async (_type: RecordDisplayType) => {\r\n        try {\r\n          if(!this.recordDisplay) return;\r\n\r\n          if (_type === \"map\") {\r\n            // Make sure recordDisplay.config.geo is set.\r\n            if (!this.recordDisplay.config.geo) {\r\n              var _ = this.recordDisplay.getRecordGeoAttributes()[0];\r\n              if (!_) throw \"Geo attribute not found\";\r\n              this.recordDisplay.config.geo = _.attribName;\r\n            }\r\n          }\r\n\r\n          // setting the css style here so that the UI can prepare the layout\r\n          this.DOM.root?.attr(\"recordChartType\", _type);\r\n\r\n          await this.recordDisplay.setView(_type);\r\n\r\n          this.refreshIsEmpty();\r\n          this.updateLayout_Height();\r\n\r\n        } catch (e) {\r\n          console.log(e);\r\n          this.recordChartType?.undoChange();\r\n        }\r\n      },\r\n    });\r\n\r\n    this.dashboardMode = new Config<DashboardMode>({\r\n      parent: this,\r\n      cfgTitle: \"Dashboard Mode\",\r\n      cfgClass: \"dashboardMode\",\r\n      iconClass: \"fa fa-wrench\", // temporary\r\n      UI: { disabled: true },\r\n      default: \"Explore\",\r\n      helparticle: \"5e8943d504286364bc97d5e6\",\r\n      itemOptions: [\r\n        { name: \"Explore\", value: \"Explore\" },\r\n        { name: \"Author\", value: \"Author\" },\r\n        { name: \"Adjust\", value: \"Adjust\" },\r\n        { name: \"Capture\", value: \"Capture\" },\r\n        { name: \"Save\", value: \"Save\" },\r\n      ],\r\n      preSet: async (v) => {\r\n        if (v === \"Print\") return \"Capture\";\r\n        return v;\r\n      },\r\n      onSet: async (v, cfg) => {\r\n        if (this.finalized) {\r\n          this.setNoAnim(true);\r\n\r\n          if (v === \"Author\")\r\n            this.refreshAttribList();\r\n\r\n          this.panels.bottom.setWidth(this.width_Canvas);\r\n          this.panels.bottom.refreshWidth();\r\n\r\n          this.updateLayout();\r\n          //updateLayout may not be \"effective\" if loading is not finalized...\r\n          this.updateMiddlePanelWidth();\r\n\r\n          setTimeout(() => this.setNoAnim(false), 500);\r\n\r\n          this.onModeChange?.();\r\n        }\r\n        await cfg.refresh();\r\n      },\r\n      onRefreshDOM: (cfg: Config<DashboardMode>) => {\r\n        if (!this.DOM.panel_Footer) return;\r\n        this.DOM.panel_Footer\r\n          .selectAll(\".dashSelectMode\")\r\n          .classed(\"active\", (_) => cfg.is(_.name));\r\n        this.DOM.root\r\n          .attr(\"data-dashboardMode\", cfg.get());\r\n      },\r\n    });\r\n\r\n    [\r\n      \"measureFunc\",\r\n      \"measureSummary\",\r\n      \"breakdownMode\",\r\n      \"stackedCompare\",\r\n      \"showWholeAggr\",\r\n      \"filteringMode\",\r\n      \"mouseOverCompare\",\r\n      \"recordChartType\",\r\n    ].forEach((_) => {\r\n      this.configs[_] = this[_];\r\n    });\r\n\r\n    var me = this;\r\n\r\n    this.colorTheme = {\r\n      browser: this,\r\n      // defaults\r\n      sequential: \"YlGnBu\",\r\n      diverging: \"Spectral\",\r\n      getDiscrete(bins = 9) {\r\n        let _theme = me.activeColorTheme;\r\n        let scale = d3[\"scheme\" + this[_theme]];\r\n        if (scale && scale[bins]) {\r\n          return scale[bins].slice(); // return a copy in case someone wants to edit\r\n        }\r\n        scale = d3[\"interpolate\" + this[_theme]];\r\n        var colors = [];\r\n        if (bins === 1) {\r\n          colors.push(d3.rgb(scale(0.8)).hex());\r\n        } else if (bins === 2) {\r\n          colors.push(d3.rgb(scale(0.8)).hex());\r\n          colors.push(d3.rgb(scale(0.2)).hex());\r\n        } else {\r\n          for (let i = 0; i < bins; ++i) {\r\n            colors.push(d3.rgb(scale(i / (bins - 1))).hex());\r\n          }\r\n        }\r\n        return colors.reverse(); // cividis, etc, need to reverse from light to dark\r\n      },\r\n      getContinuous() {\r\n        return d3[\"interpolate\" + this[me.activeColorTheme]];\r\n      },\r\n      exportConfig() {\r\n        var _: any = {};\r\n        if (this.sequential !== \"YlGnBu\") _.sequential = this.sequential;\r\n        if (this.diverging !== \"Spectral\") _.diverging = this.diverging;\r\n        return _;\r\n      },\r\n    };\r\n\r\n    this.allRecordsAggr = new Aggregate(null); // not placed in an attribute\r\n    this.allAggregates.push(this.allRecordsAggr);\r\n\r\n    Base.browsers[this.getDashboardID()] = this;\r\n    Base.browser = this;\r\n\r\n    if (this.options.onLoad) {\r\n      // callback\r\n      if (this.options.onLoad.callback) {\r\n        if (this.options.onLoad.callback instanceof Function) {\r\n          this.onLoad.callback = this.options.onLoad.callback;\r\n        } else {\r\n          delete this.options.onLoad;\r\n        }\r\n      }\r\n      // main keys\r\n      for (var key in this.options.onLoad) {\r\n        this.onLoad.main[key] = this.options.onLoad[key];\r\n      }\r\n    }\r\n\r\n    let lastMouseMoveEvent: MouseEvent = null;\r\n\r\n    this.DOM.root = d3\r\n      .select(this.domID)\r\n      .classed(\"kshf\", true)\r\n      .classed(\"noAnim\", true)\r\n      .attr(\"data-dashboardMode\", this.dashboardMode.get())\r\n      .attr(\"recordChartType\", \"none\")\r\n      .on(\"mousemove\", (event: MouseEvent) => {\r\n        // Compute mouse moving speed, to adjust repsonsiveness\r\n        if (!lastMouseMoveEvent) {\r\n          lastMouseMoveEvent = event;\r\n          return;\r\n        }\r\n        var timeDif = event.timeStamp - lastMouseMoveEvent.timeStamp;\r\n        if (timeDif === 0) return;\r\n\r\n        var xDif = Math.abs(event.x - lastMouseMoveEvent.x);\r\n        var yDif = Math.abs(event.y - lastMouseMoveEvent.y);\r\n\r\n        // controls highlight selection delay\r\n        this.mouseSpeed = Math.min((xDif + yDif) / timeDif, 2);\r\n\r\n        lastMouseMoveEvent = event;\r\n      });\r\n\r\n    if (this.dashZoomLevel != \"1.00\") {\r\n      this.attemptToFixBrowserZoomLevel(this.dashZoomLevel);\r\n    }\r\n\r\n    this.updateWidth_Total();\r\n\r\n    this.recordName = this.options.recordName || \"\";\r\n\r\n    // remove any DOM elements under this domID, kshf takes complete control over what's inside\r\n    var rootDomNode = this.DOM.root.node();\r\n    while (rootDomNode.hasChildNodes())\r\n      rootDomNode.removeChild(rootDomNode.lastChild);\r\n\r\n    this.DOM.pointerBlock = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"pointerBlock\");\r\n    this.DOM.attribDragBox = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attribDragBox\");\r\n\r\n    this.insertDOM_WarningBox();\r\n\r\n    //this.DOM.mainWrapper = this.DOM.root.append(\"div\").attr(\"class\",\"mainWrapper\");\r\n\r\n    this.recordDetailsPopup = new RecordDetailPopup(this);\r\n\r\n    this.insertDOM_Panel_Overlay();\r\n\r\n    this.insertDOM_AttribPanel();\r\n\r\n    this.DOM.panel_Wrapper = this.DOM.root\r\n      //.append(\"div\").attr(\"class\",\"panel_Data_Wrapper\")\r\n      .append(\"div\")\r\n      .attr(\"class\", \"panel_Wrapper\")\r\n      .classed(\"emptyDashboard\", true) // empty dashboard by default on initialization.\r\n      .classed(\"panel_bottom_empty\", true);\r\n\r\n    this.insertDOM_PanelBasic();\r\n\r\n    this.dashboardConfigPanel = new ConfigPanel(\r\n      this.DOM.panel_Wrapper,\r\n      \"DashboardAnalyticsConfig\",\r\n      \"DashboardAnalyticsConfig\",\r\n      Object.values(this.configs),\r\n      this,\r\n      this.DOM.metricFuncSelectButton\r\n    );\r\n\r\n    this.panels.left = new Panel(this, \"left\", this.DOM.panel_Wrapper);\r\n    this.panels.right = new Panel(this, \"right\", this.DOM.panel_Wrapper);\r\n\r\n    this.DOM.middleColumn = this.DOM.panel_Wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"middleColumn\");\r\n\r\n    this.panels.middle = new Panel(this, \"middle\", this.DOM.middleColumn);\r\n    this.DOM.middleColumn.append(\"div\").attr(\"class\", \"recordDisplay\");\r\n\r\n    this.panels.bottom = new Panel(this, \"bottom\", this.DOM.panel_Wrapper);\r\n\r\n    this.DOM.panelEmpty = this.DOM.panel_Wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"panelEmpty\")\r\n      .append(\"div\")\r\n      .attr(\"class\", \"actionInfo\")\r\n      .html(i18n.EmptyDashboardNotice);\r\n\r\n    this.insertDOM_Panel_Footer();\r\n\r\n    this.DOM.root.selectAll(\".panel\").on(\"mouseleave\", () => {\r\n      setTimeout(() => {\r\n        if (!this.needToRefreshLayout) return;\r\n        this.updateLayout_Height();\r\n        this.needToRefreshLayout = false;\r\n      }, 1500); // update layout after 1.5 seconds\r\n    });\r\n\r\n    this.loadDataSources();\r\n  }\r\n\r\n  needToRefreshLayout: boolean = false;\r\n\r\n  /** -- */\r\n  refreshConfigs() {\r\n    Object.values(this.configs).forEach((cfg) => cfg.refresh());\r\n\r\n    this.attribsInDashboard.forEach((attrib) => attrib.refreshConfigs());\r\n\r\n    this.refreshAnalytics();\r\n  }\r\n\r\n  /** -- */\r\n  activateWidthDrag(DOM, event, onMove) {\r\n    DOM.classList.add(\"dragging\");\r\n    this.setNoAnim(true);\r\n\r\n    this.DOM.root\r\n      .style(\"cursor\", \"ew-resize\")\r\n      .on(\"mousemove.temp\", onMove)\r\n      .on(\"mouseup.temp\", () => {\r\n        DOM.classList.remove(\"dragging\");\r\n        this.setNoAnim(false);\r\n      });\r\n\r\n    event.preventDefault();\r\n  }\r\n\r\n  blockWithOpenConfig: Block = null;\r\n\r\n  /** -- */\r\n  closeConfigPanels() {\r\n    this.blockWithOpenConfig?.DOM?.root.classed(\"showConfig\", false);\r\n    this.blockWithOpenConfig = undefined;\r\n    this.dashboardConfigPanel.hide();\r\n    this.recordDisplay.recordConfigPanel.hide();\r\n  }\r\n\r\n  /** -- */\r\n  noAnim: boolean = false;\r\n  setNoAnim(v) {\r\n    if (!this.finalized) return;\r\n    this.noAnim = v;\r\n    this.DOM.root.classed(\"noAnim\", this.noAnim);\r\n    this.DOM.pointerBlock.attr(\"active\", this.noAnim ? \"\" : null);\r\n    if (!this.noAnim) {\r\n      this.DOM.root\r\n        .style(\"cursor\", null)\r\n        .on(\"mousemove.temp\", null)\r\n        .on(\"mouseup.temp\", null);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  refreshIsEmpty() {\r\n    this.DOM.panel_Wrapper.classed(\r\n      \"emptyDashboard\",\r\n      this.attribsInDashboard.length === 0 && this.recordChartType.is(\"none\")\r\n    );\r\n  }\r\n\r\n  /** Returns data type based on first found valid value, null if type not detected */\r\n  getAttribTypeFromFunc(func: Function): BlockType {\r\n    var type = null;\r\n\r\n    this.records.some((record) => {\r\n      var _val = func.call(record.data, record);\r\n      if (_val == null || _val == \"\") return false; // cannot infer type\r\n\r\n      var v_type = typeof _val;\r\n      if (v_type === \"object\" && _val._timeseries_) {\r\n        type = \"timeseries\";\r\n      } else if (v_type === \"object\" && _val.coordinates) {\r\n        type = \"recordGeo\";\r\n      } else if (v_type === \"number\") {\r\n        type = \"numeric\";\r\n      } else if (_val instanceof Date) {\r\n        type = \"timestamp\";\r\n      } else if (v_type === \"string\" || v_type === \"boolean\") {\r\n        // TO-DO: Think about boolean summaries (?)\r\n        type = \"categorical\";\r\n      } else if (Array.isArray(_val)) {\r\n        type = \"categorical\";\r\n      }\r\n\r\n      return type ? true : false;\r\n    });\r\n\r\n    return type;\r\n  }\r\n\r\n  /** -- */\r\n  createAttrib(\r\n    name: string,\r\n    func = undefined,\r\n    type: BlockType = undefined\r\n  ): Attrib {\r\n    if (!name) return;\r\n\r\n    // return existing block with same name\r\n    if (this.attribWithName(name)) {\r\n      return this.attribWithName(name);\r\n    }\r\n\r\n    var attrib: Attrib;\r\n\r\n    if (type === \"content\") {\r\n      attrib = new Attrib_Content(this, name);\r\n    } else {\r\n      if (func == null) {\r\n        func = name;\r\n      }\r\n      var _v = new AttribTemplate(func, this);\r\n\r\n      type = type ?? _v.blockType;\r\n\r\n      if (!type) {\r\n        type = this.getAttribTypeFromFunc(_v.func);\r\n      }\r\n\r\n      if (!type) {\r\n        console.log(`Summary data type could not be detected for: ${name}`);\r\n        return;\r\n      }\r\n\r\n      if (type === \"categorical\") {\r\n        attrib = new Attrib_Categorical(this, name, _v);\r\n        //\r\n      } else if (type === \"timeseries\") {\r\n        attrib = new Attrib_Timeseries(this, name, _v);\r\n        //\r\n      } else if (type === \"recordGeo\") {\r\n        attrib = new Attrib_RecordGeo(this, name, _v);\r\n        //\r\n      } else if (type === \"timestamp\") {\r\n        attrib = new Attrib_Timestamp(this, name, _v);\r\n        //\r\n      } else if (type === \"numeric\") {\r\n        attrib = new Attrib_Numeric(this, name, _v);\r\n      }\r\n    }\r\n\r\n    this.insertAttribIntoGroupIndex(attrib);\r\n\r\n    return attrib;\r\n  }\r\n\r\n  /** -- */\r\n  destroyAttrib(attrib: Attrib) {\r\n    attrib?.block?.removeFromPanel();\r\n\r\n    var indexFrom = -1;\r\n    this.attribs.forEach((a, i) => {\r\n      if (a === attrib) indexFrom = i;\r\n    });\r\n    if (indexFrom === -1) return;\r\n\r\n    this.attribs.splice(indexFrom, 1);\r\n\r\n    // if the attrib is within the record display sorting list, remove!\r\n    this.recordDisplay?.refreshAttribOptions(\"sort\");\r\n\r\n    this.removeAttribFromGroupIndex(attrib);\r\n    this.refreshAttribList();\r\n  }\r\n\r\n  /** -- */\r\n  insertAttribIntoGroupIndex(attrib: Attrib) {\r\n    var target = this.attribs_by_group;\r\n    // find position in hierarchy\r\n    attrib.groupPath.forEach((_key, i, list) => {\r\n      if (!target[_key]) {\r\n        // \"group\" node (simple string, not a summary group)\r\n        target[_key] = {\r\n          name: _key,\r\n          item: _key,\r\n          parents: list.slice(0, i),\r\n          sub: {},\r\n        };\r\n      }\r\n      target = target[_key].sub;\r\n    });\r\n    var _key = attrib.printName;\r\n    if (!target[_key]) {\r\n      target[_key] = {\r\n        name: _key,\r\n        parents: attrib.groupPath,\r\n        sub: {},\r\n      };\r\n    } // if new, establish \"sub\".\r\n    target[_key].item = attrib;\r\n  }\r\n\r\n  /** -- */\r\n  removeAttribFromGroupIndex(attrib: Attrib) {\r\n    var target = this.attribs_by_group;\r\n    attrib.groupPath.forEach((_key) => {\r\n      // when changing timeseries, the key numeric summaries get updated after timeseries name is updated\r\n      // target[_key] may be indexing old stuff that's no longer valid\r\n      target = target && target[_key] && target[_key].sub;\r\n    });\r\n    if (target) delete target[attrib.printName];\r\n    delete attrib?.block?.DOM.nugget;\r\n    this.removeEmptySubs();\r\n  }\r\n\r\n  /** -- */\r\n  removeEmptySubs() {\r\n    function recurse(obj) {\r\n      for (let [key, value] of Object.entries(obj)) {\r\n        let v = value as any;\r\n        if (typeof v.item === \"string\" && Object.entries(v.sub).length === 0) {\r\n          // not a block, doesn't have sub-blocks\r\n          delete obj[key];\r\n        } else {\r\n          recurse(v.sub);\r\n        }\r\n      }\r\n    }\r\n    recurse(this.attribs_by_group);\r\n  }\r\n\r\n  /** -- */\r\n  setRecordName(v) {\r\n    this.recordName = v;\r\n    this.DOM.root.selectAll(\".recordName\").html(this.recordName);\r\n  }\r\n  /** -- */\r\n  setDescription(t) {\r\n    this.options.description = t;\r\n    this.DOM.browserDescription\r\n      .select(\".customDescription\")\r\n      .style(\"display\", t ? \"inline-block\" : null);\r\n    this.DOM.browserDescription.select(\".customDescriptionText\").html(t);\r\n  }\r\n\r\n  private divWidth: number;\r\n  /** -- */\r\n  updateWidth_Total() {\r\n    this.divWidth = this.DOM.root.node().clientWidth;\r\n  }\r\n  /** -- */\r\n  getWidth_Total() {\r\n    return this.divWidth;\r\n  }\r\n  /** This also considers if the available attrib panel is shown */\r\n  get width_Canvas() {\r\n    return (\r\n      this.divWidth -\r\n      (this.authorMode ? this._attribPanelWidth : 0) -\r\n      2 * Base.width_PanelGap\r\n    ); // 8 pixels on both sides are gone\r\n  }\r\n\r\n  /** -- */\r\n  get height_PanelHeader() {\r\n    var _ = parseInt(this.DOM.panel_DataStatus.style(\"height\"));\r\n    return isNaN(_) ? 0 : _;\r\n  }\r\n  /** -- */\r\n  get height_PanelFooter() {\r\n    var _ = parseInt(this.DOM.panel_Footer.style(\"height\"));\r\n    return isNaN(_) ? 0 : _;\r\n  }\r\n\r\n  /** -- */\r\n  getDashboardID() {\r\n    return window.location.pathname + this.domID;\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Warning panel\r\n  // ********************************************************************\r\n\r\n  panel_warningBox = null;\r\n\r\n  /* -- */\r\n  insertDOM_WarningBox() {\r\n    this.panel_warningBox = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"warningBox_wrapper\");\r\n    var x = this.panel_warningBox.append(\"span\").attr(\"class\", \"warningBox\");\r\n    this.DOM.warningText = x.append(\"span\").attr(\"class\", \"warningText\");\r\n    x.append(\"span\")\r\n      .attr(\"class\", \"dismiss fa fa-times\")\r\n      .tooltip(i18n.Close)\r\n      .on(\"click\", () => this.hideWarning());\r\n  }\r\n  showWarning(v) {\r\n    this.panel_warningBox.classed(\"active\", true);\r\n    this.DOM.warningText.html(v);\r\n    setTimeout(() => this.hideWarning(), 5000); // auto-hide after 5 seconds\r\n  }\r\n  hideWarning() {\r\n    if (this.panel_warningBox) this.panel_warningBox.classed(\"active\", null);\r\n  }\r\n\r\n  private mouseSpeed: number = 0;\r\n  get movingMouseDelay() {\r\n    return this.mouseSpeed < 0.2 ? 0 : this.mouseSpeed * 500;\r\n  }\r\n\r\n  /** -- */\r\n  getMeasurableSummaries(_t): Attrib[] {\r\n    return this.attribs\r\n      .filter(\r\n        (attrib) =>\r\n          attrib.supportedMetricFuncs.includes(_t) &&\r\n          !attrib.isEmpty() &&\r\n          !attrib.hasTimeSeriesParent()\r\n      )\r\n      .sort((s1, s2) =>\r\n        Util.sortFunc_List_String(s1.attribName, s2.attribName)\r\n      );\r\n  }\r\n\r\n  /** -- */\r\n  addMeasureOptions_Summaries(dom) {\r\n    dom\r\n      .on(\"change\", async (event) => await this.measureSummary.set(event.currentTarget.selectedOptions[0].__data__) )\r\n      .selectAll(\"option\")\r\n      .remove();\r\n\r\n    if (this.measureFunc.is(\"Count\")) return;\r\n\r\n    dom\r\n      .selectAll(\"option\")\r\n      .data(this.getMeasurableSummaries(this.measureFunc.get()))\r\n      .enter()\r\n      .append(\"option\")\r\n      .attr(\"selected\", (s) => s.attribID === this.measureSummary.get()?.attribID ? true : null )\r\n      .html((s) => s.attribName);\r\n  }\r\n\r\n  /** -- */\r\n  addMeasureOptions_Keys(dom) {\r\n    dom.selectAll(\"option\").remove();\r\n\r\n    dom // slice creates a copy, reverse in-place updates this copy\r\n      .selectAll(\"option\")\r\n      .data(this.measureSummary.get().timeseriesParent.timeKeys.slice().reverse())\r\n      .enter()\r\n      .append(\"option\")\r\n      .attr(\"value\", (timeKey) => timeKey._time_src)\r\n      .attr(\"selected\", (timeKey) =>\r\n        timeKey._time_src === this.measureSummary.get().timeKey._time_src\r\n          ? \"true\"\r\n          : null\r\n      )\r\n      .html((timeKey) => timeKey._time_src);\r\n  }\r\n\r\n  /** -- */\r\n  addMeasureOptions_Func(dom) {\r\n    dom\r\n      .on(\"change\", async (event) => await this.measureFunc.set(event.currentTarget.selectedOptions[0].__data__.v) )\r\n      .selectAll(\"option\")\r\n      .remove();\r\n\r\n    var opts = [{ v: \"Count\", l: i18n.measure_Count, active: true }];\r\n\r\n    [\"Sum\", \"Avg\"].forEach((_t) => {\r\n      opts.push({\r\n        v: _t,\r\n        l: i18n[\"measure_\" + _t],\r\n        active: this.getMeasurableSummaries(_t).length > 0,\r\n      });\r\n    });\r\n\r\n    dom\r\n      .selectAll(\"option\")\r\n      .data(opts)\r\n      .enter()\r\n      .append(\"option\")\r\n      .attr(\"disabled\", (d) => (d.active ? null : true))\r\n      .attr(\"selected\", (d) => (d.v === this.measureFunc.get() ? true : null))\r\n      .html((d) => d.l);\r\n  }\r\n\r\n  /** -- */\r\n  insertDOM_Panel_DatasetInfo() {\r\n    this.DOM.datasource = this.DOM.browserDescription\r\n      .append(\"a\")\r\n      .attr(\"class\", \"fa fa-table datasource\")\r\n      .attr(\"target\", \"_blank\")\r\n      .tooltip(i18n.OpenDataSource);\r\n\r\n    var _ = this.DOM.browserDescription\r\n      .append(\"div\")\r\n      .attr(\"class\", \"DataPrivacy\")\r\n      .html(\r\n        '<span class=\"DataPrivacy-Public\">Public data</span>' +\r\n          '<span class=\"DataPrivacy-Private\">Private data</span>'\r\n      );\r\n\r\n    var x = this.DOM.browserDescription\r\n      .append(\"span\")\r\n      .attr(\"class\", \"customDescription\");\r\n    x.append(\"span\")\r\n      .attr(\"class\", \"customDescriptionButton\")\r\n      .tooltip(\"Edit\")\r\n      .on(\"click\", () => {\r\n        var _descr = Modal.prompt(\r\n          \"Provide a short description or credit for the dataset\",\r\n          this.options.description\r\n        );\r\n        if (_descr === \"\") {\r\n          this.setDescription(null);\r\n          return;\r\n        }\r\n        if (!_descr) return;\r\n        var _url = Modal.prompt(\"Provide the link for credit\", \"\");\r\n        if (_url) {\r\n          // if _url doesn't start with http, add http://\r\n          if (_url.substr(0, 4) !== \"http\") _url = \"http://\" + _url;\r\n          _descr =\r\n            \"<a target='_blank' rel='noopener noreferrer' href='\" +\r\n            _url +\r\n            \"'>\" +\r\n            _descr +\r\n            \"</a>\";\r\n        }\r\n        this.setDescription(_descr);\r\n      })\r\n      .html(\"<i class='fa fa-info-circle'></i> \");\r\n    x.append(\"span\").attr(\"class\", \"customDescriptionText\");\r\n\r\n    this.setDescription(this.options.description);\r\n  }\r\n\r\n  /** -- */\r\n  insertDOM_Panel_Footer() {\r\n    this.DOM.panel_Footer = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"panel_Footer\");\r\n\r\n    var x = this.DOM.panel_Footer\r\n      .append(\"div\")\r\n      .attr(\"class\", \"dashboardModeSelect\");\r\n    x.append(\"div\")\r\n      .attr(\"class\", \"dashboardModeSelectTitle\")\r\n      .attr(\"data-helparticle\", \"5e8943d504286364bc97d5e6\")\r\n      .html(i18n.Mode);\r\n\r\n    Modal.createHelpScoutLinks(x, true);\r\n\r\n    x.selectAll(\"div.dashSelectMode\")\r\n      .data([\r\n        {\r\n          name: \"Explore\",\r\n          class: \"fa fa-compass\",\r\n        },\r\n        {\r\n          name: \"Author\",\r\n          class: \"fa fa-pen-fancy\",\r\n        },\r\n        {\r\n          name: \"Adjust\",\r\n          class: \"fa fa-sliders-h\",\r\n        },\r\n        {\r\n          name: \"Capture\",\r\n          class: \"fa fa-draw-square\",\r\n        },\r\n        {\r\n          name: \"Save\",\r\n          class: \"fa fa-bookmark\",\r\n        },\r\n      ])\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", (_) => `dashSelectMode dashSelectMode-${_.name}`)\r\n      .classed(\"active\", (_) => this.dashboardMode.is(_.name))\r\n      .on(\"click\", async (_event, _) => await this.dashboardMode.set(_.name) )\r\n      .tooltip((_) => i18n[`${_.name} Mode`])\r\n      .call((dashSelectMode) => {\r\n        dashSelectMode.append(\"div\").attr(\"class\", (_) => _.class);\r\n        dashSelectMode\r\n          .append(\"div\")\r\n          .attr(\"class\", \"theText\")\r\n          .html((_) => i18n[_.name]);\r\n      });\r\n\r\n    this.DOM.browserDescription = this.DOM.panel_Footer\r\n      .append(\"span\")\r\n      .attr(\"class\", \"browserDescription\");\r\n\r\n    // Info & Credits\r\n    var x = this.DOM.panel_Footer\r\n      .append(\"span\")\r\n      .attr(\"class\", \"logoHost\")\r\n      .tooltip(i18n.ShowInfoCredits)\r\n      .on(\"click\", () => {\r\n        this.showCredits();\r\n        this.DOM.overlay_wrapper\r\n          .attr(\"show\", \"infobox\")\r\n          .classed(\"easyDismiss\", true);\r\n      })\r\n      .html(\r\n        `<span class='keshifSVG'>Keshif<img></span>\r\n        <span class='theDataMadeExplorable'>Data Made Explorable</span>\r\n        `\r\n      );\r\n    x.select(\"svg\")\r\n      .style(\"width\", \"20px\")\r\n      .style(\"width\", \"18px\")\r\n      .style(\"height\", \"19px\");\r\n  }\r\n  /** -- */\r\n  insertDOM_PanelBasic() {\r\n    var me = this;\r\n\r\n    this.DOM.panel_DataStatus = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"panel_DataStatus\");\r\n\r\n    this.DOM.metricFuncSelectButton = this.DOM.panel_DataStatus\r\n      .append(\"span\")\r\n      .attr(\"class\", \"metricFuncSelectButton basicIcon fa fa-cog\")\r\n      .tooltip(i18n.DashboardAnalyticsConfig)\r\n      .on(\"click\", () => this.dashboardConfigPanel.showAtPos(8, 8));\r\n\r\n    this.DOM.recordInfo = this.DOM.panel_DataStatus\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordInfo\");\r\n\r\n    this.DOM.activeRecordMeasure = this.DOM.recordInfo\r\n      .append(\"span\")\r\n      .attr(\"class\", \"activeRecordMeasure\");\r\n    this.DOM.metricFuncText = this.DOM.recordInfo\r\n      .append(\"span\")\r\n      .attr(\"class\", \"metricFuncText\");\r\n    this.DOM.metricFuncText.html(\r\n      \"\" +\r\n        \"<span class='measureFunc metricOptionWrapper'>\" +\r\n        \"<span class='measureFuncText metricOptionWrapper_Text'></span>\" +\r\n        \"<select class='measureFuncOptions metricOptionWrapper_Opts'></select>\" +\r\n        \"</span>\" +\r\n        \"<span class='timeKeys metricOptionWrapper'>\" +\r\n        \"<i class='fa fa-calendar'></i>\" +\r\n        \"<span class='timeKeyText metricOptionWrapper_Text'></span>\" +\r\n        \"<select class='timeKeys metricOptionWrapper_Opts'></select>\" +\r\n        \"</span>\" +\r\n        \"<span class='measureSummary metricOptionWrapper'>\" +\r\n        \"<span class='measureSummaryName metricOptionWrapper_Text'></span>\" +\r\n        \"<select class='measureSummary metricOptionWrapper_Opts'></select>\" +\r\n        \"</span>\" +\r\n        `<span class='Of_NumberRecord'>${i18n.Of_NumberRecord}</span>`\r\n    );\r\n\r\n    this.DOM.metricFuncText.select(\"select.timeKeys\").on(\"input\", async (event) => {\r\n      await this.measureSummary.set(\r\n        this.measureSummary.get().timeseriesParent.getTimepointSummary(\r\n          event.currentTarget.selectedOptions[0].__data__\r\n        )\r\n      );\r\n    });\r\n\r\n    this.DOM.recordName = this.DOM.recordInfo\r\n      .append(\"span\")\r\n      .attr(\"class\", \"recordName\")\r\n      .tooltip(\"\")\r\n      .on(\"mouseenter\", function (event) {\r\n        this.tippy.setContent(this.isContentEditable ? \"OK\" : i18n.EditTitle);\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      })\r\n      .on(\"focus\", function () {\r\n        this.tippy.hide();\r\n        this._initValue = DOMPurify.sanitize(this.innerHTML);\r\n      })\r\n      .on(\"blur\", function () {\r\n        this.tippy.hide();\r\n        this.contentEditable = false;\r\n      })\r\n      .on(\"keyup\", (event) => event.stopPropagation())\r\n      .on(\"keypress\", (event) => event.stopPropagation())\r\n      .on(\"keydown\", function (event) {\r\n        if (event.keyCode === 27) {\r\n          // Escape : Do not apply the new label\r\n          this.blur();\r\n          this.innerHTML = DOMPurify.sanitize(this._initValue);\r\n          return;\r\n        }\r\n        if (event.keyCode === 13) {\r\n          // ENTER\r\n          me.setRecordName(this.textContent);\r\n          this.blur();\r\n        }\r\n        event.stopPropagation();\r\n      })\r\n      .on(\"click\", function () {\r\n        if (!this.isContentEditable) {\r\n          this.contentEditable = true;\r\n          this.focus();\r\n        } else {\r\n          this.contentEditable = false;\r\n          me.setRecordName(DOMPurify.sanitize(this.innerHTML));\r\n        }\r\n      });\r\n\r\n    var dashboardSettings = this.DOM.panel_DataStatus\r\n      .append(\"span\")\r\n      .attr(\"class\", \"iconGroup dashboardSettings\");\r\n\r\n    this.DOM.panel_Basic_In = this.DOM.panel_DataStatus\r\n      .append(\"div\")\r\n      .attr(\"class\", \"panel_Basic_In\");\r\n\r\n    this.DOM.panel_DataStatus\r\n      .append(\"div\")\r\n      .attr(\"class\", \"iconGroup rightSideIcons\")\r\n      .call((rightSideIcons) => {\r\n        rightSideIcons\r\n          .append(\"div\")\r\n          .attr(\"class\", \"viewFullscreen basicIcon fa fa-expand-arrows-alt\")\r\n          .tooltip(i18n.ShowFullscreen)\r\n          .on(\"click\", () => this.showFullscreen());\r\n\r\n        if (this.dashZoomLevel !== \"1.00\") {\r\n          rightSideIcons\r\n            .append(\"div\")\r\n            .attr(\"class\", \"basicIcon fa fa-window-restore\")\r\n            .tooltip(i18n[\"Reset Zoom Level\"])\r\n            .on(\"click\", () => this.attemptToFixBrowserZoomLevel(\"1.00\", true));\r\n        }\r\n\r\n        rightSideIcons\r\n          .append(\"div\")\r\n          .attr(\"class\", \"showHelpIn basicIcon fa fa-question-circle\")\r\n          .tooltip(i18n.Help)\r\n          .on(\"click\", () => Modal.helpUI());\r\n      });\r\n\r\n    dashboardSettings\r\n      .append(\"span\")\r\n      .attr(\"class\", \"dashboardSetting breakdownModeIcon fa fa-percent\")\r\n      .tooltip(\"\", {\r\n        onShow: (instance) => {\r\n          instance.reference.tippy.setContent(\r\n            `<div>${i18n[\"Breakdown\"]}</div>\r\n          <b>${this.breakdownMode}</b><br>\r\n          <i>${i18n[\"Click to change\"]}</i>`\r\n          );\r\n        },\r\n      })\r\n      .on(\"click\", (event) => {\r\n        Modal.popupMenu(\r\n          event,\r\n          {\r\n            name: \"Breakdown\",\r\n            items: [\r\n              {\r\n                id: \"absoluteBreakdown\",\r\n                name: \"Absolute\",\r\n                iconClass: \"fa fa-hashtag\",\r\n                helparticle: \"5e8944682c7d3a7e9aea659a\",\r\n                active: this.breakdownMode.is(\"absolute\"),\r\n                do: async () => await this.breakdownMode.set(\"absolute\"),\r\n              },\r\n              {\r\n                id: \"percentBreakdown\",\r\n                name: \"Percentage\",\r\n                iconClass: \"fa fa-percent\",\r\n                expanded: true,\r\n                options: [\r\n                  {\r\n                    id: \"dependentBreakdown\",\r\n                    name: \"% of Compared\",\r\n                    helparticle: \"5e8944812c7d3a7e9aea659b\",\r\n                    active: this.breakdownMode.is(\"dependent\"),\r\n                    do: async () => await this.breakdownMode.set(\"dependent\"),\r\n                  },\r\n                  {\r\n                    id: \"relativeBreakdown\",\r\n                    name: \"% of Groups\",\r\n                    helparticle: \"5e8944932c7d3a7e9aea659c\",\r\n                    active: this.breakdownMode.is(\"relative\"),\r\n                    do: async () => await this.breakdownMode.set(\"relative\"),\r\n                  },\r\n                  {\r\n                    id: \"totalBreakdown\",\r\n                    name: \"% of All\",\r\n                    helparticle: \"5e94ff6904286364bc984a7a\",\r\n                    active: this.breakdownMode.is(\"total\"),\r\n                    do: async () => await this.breakdownMode.set(\"total\"),\r\n                  },\r\n                ],\r\n              },\r\n            ],\r\n          },\r\n          this,\r\n          { placement: \"bottom-start\" }\r\n        );\r\n      });\r\n\r\n    dashboardSettings\r\n      .append(\"span\")\r\n      .attr(\"class\", \"dashboardSetting lockCrumbMode\")\r\n      .tooltip(\"\", {\r\n        onShow: (instance) => {\r\n          instance.reference.tippy.setContent(\r\n            `<div>${i18n[\"Group View\"]}</div> <b>${this.stackedCompare}</b><br> <i>${i18n[\"Click to change\"]}</i>`\r\n          );\r\n        },\r\n      })\r\n      .on(\"click\", async () => await this.stackedCompare.set(!this.stackedCompare.get()) )\r\n      .append(\"div\")\r\n      .attr(\"class\", \"CompareModeIcon\")\r\n      .selectAll(\"div\")\r\n      .data([0, 1, 2])\r\n      .enter()\r\n      .append(\"div\")\r\n      .attr(\"class\", \"CompareModeIcon-block\");\r\n\r\n    this.DOM.breadCrumbs_Filter = this.DOM.panel_Basic_In\r\n      .append(\"div\")\r\n      .attr(\"class\", \"breadCrumbs breadCrumbs_Filter\")\r\n      .call((breadCrumbs_Filter) => {\r\n        breadCrumbs_Filter\r\n          .append(\"div\")\r\n          .attr(\"class\", \"breadCrumbHeader\")\r\n          .tooltip(i18n.RemoveAllFilters)\r\n          .text(i18n.Filters)\r\n          .on(\"click\", () => this.clearFilters_All());\r\n        breadCrumbs_Filter\r\n          .append(\"div\")\r\n          .attr(\"class\", \"breadCrumbCollapseControl fa fa-angle-double-right\")\r\n          .tooltip(\"\", {\r\n            onTrigger: (instance) => {\r\n              instance.reference.tippy.setContent(\r\n                i18n[\r\n                  (breadCrumbs_Filter.node().classList.contains(\"collapsed\")\r\n                    ? \"Show\"\r\n                    : \"Hide\") + \" Filters\"\r\n                ]\r\n              );\r\n            },\r\n          })\r\n          .on(\"click\", () => {\r\n            var cl = breadCrumbs_Filter.node().classList;\r\n            cl.toggle(\"collapsed\");\r\n            if (!cl.contains(\"collapsed\")) {\r\n              this.filters_wrap_letItWrap = true;\r\n            }\r\n          });\r\n      });\r\n\r\n    this.DOM.breadCrumbs_Compare = this.DOM.panel_Basic_In\r\n      .append(\"div\")\r\n      .attr(\"class\", \"breadCrumbs breadCrumbs_Compare\")\r\n      .call((breadCrumbs_Compare) => {\r\n        breadCrumbs_Compare\r\n          .append(\"span\")\r\n          .attr(\"class\", \"breadCrumbHeader\")\r\n          .tooltip(i18n.Unlock)\r\n          .text(i18n.Compare)\r\n          .on(\"click\", () => this.clearSelect_Compare(this.activeComparisons, true, true) )\r\n          .append(\"span\")\r\n          .attr(\"class\", \"lockCrumbSummary blockName\");\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  async applyConfig(config) {\r\n    // Import panel config\r\n    Base.Panel_List.forEach((p) =>\r\n      this.panels[p].importConfig({\r\n        ...config.panels[p],\r\n        ...config.panels.default,\r\n      })\r\n    );\r\n\r\n    config.summaries = config.summaries || [];\r\n\r\n    for(let cfg of config.summaries){\r\n      await this.applyBlockConfig(cfg);\r\n    }\r\n\r\n    if (config.recordName && this.recordName !== config.recordName) {\r\n      this.setRecordName(config.recordName);\r\n    }\r\n\r\n    if (config.metric) {\r\n      var a = this.attribWithName(config.metric.summary);\r\n      if (a instanceof Attrib_Numeric) {\r\n        await this.measureSummary.set(a);\r\n        await this.measureFunc.set(config.metric.type);\r\n      }\r\n    } else {\r\n      await this.measureFunc.set(\"Count\");\r\n    }\r\n\r\n    await this.breakdownMode.set(config.breakdownMode);\r\n    await this.stackedCompare.set(config.stackedCompare);\r\n    await this.filteringMode.set(config.filteringMode);\r\n    await this.showWholeAggr.set(config.showWholeAggr);\r\n    await this.mouseOverCompare.set(config.mouseOverCompare);\r\n\r\n    await this.recordDisplay.importConfig(config.recordDisplay);\r\n\r\n    this.records.forEach((rec) => rec.refreshFilterCache());\r\n    this.updateRecordCount_Active();\r\n\r\n    this.updateAfterFilter();\r\n\r\n    this.updateLayout();\r\n  }\r\n\r\n  /* -- */\r\n  insertDOM_Panel_Overlay() {\r\n    this.DOM.overlay_wrapper = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_wrapper\");\r\n\r\n    // BACKGROUND\r\n    this.DOM.overlay_wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"fullBackground\")\r\n      .on(\"click\", (event) => {\r\n        if (!event.currentTarget.parentNode.classList.contains(\"easyDismiss\"))\r\n          return;\r\n\r\n        this.DOM.overlay_wrapper.attr(\"show\", \"none\");\r\n\r\n        this.recordDetailsPopup.closeRecordDetailPanel();\r\n\r\n        Modal._removeModal(this.DOM.overlay_wrapper);\r\n      });\r\n\r\n    // LOADING BOX\r\n    this.DOM.loadingBox = this.DOM.overlay_wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_content overlay_loading\");\r\n    var ssdsd = this.DOM.loadingBox\r\n      .append(\"span\")\r\n      .attr(\"class\", \"spinner\")\r\n      .selectAll(\".spinner_x\")\r\n      .data([1, 2, 3, 4, 5])\r\n      .enter()\r\n      .append(\"span\")\r\n      .attr(\"class\", (d) => \"spinner_x spinner_\" + d);\r\n    var hmmm = this.DOM.loadingBox.append(\"div\").attr(\"class\", \"status_text\");\r\n    hmmm\r\n      .append(\"span\")\r\n      .attr(\"class\", \"status_text_sub info\")\r\n      .html(i18n.LoadingData);\r\n    this.DOM.status_text_sub_dynamic = hmmm\r\n      .append(\"span\")\r\n      .attr(\"class\", \"status_text_sub dynamic\");\r\n\r\n    // CREDITS\r\n    this.DOM.overlay_infobox = this.DOM.overlay_wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_content overlay_infobox\");\r\n    this.DOM.overlay_infobox\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_Close fa fa-times fa-times-circle\")\r\n      .tooltip(i18n.Close)\r\n      .on(\"click\", () => this.DOM.overlay_wrapper.attr(\"show\", \"none\"));\r\n\r\n    // RECORD DETAILS\r\n    this.recordDetailsPopup.initDOM();\r\n\r\n    // HELP\r\n    this.DOM.overlay_wrapper\r\n      .append(\"div\")\r\n      .attr(\"class\", \"overlay_content overlay_help\");\r\n  }\r\n\r\n  // prevents inserting credits, which sets img src tags and adds image requests, until it is shown\r\n  creditsInserted = false;\r\n  showCredits() {\r\n    if (this.creditsInserted) return;\r\n    this.DOM.overlay_infobox\r\n      .append(\"div\")\r\n      .attr(\"class\", \"creditsBox\")\r\n      .html(\r\n        `<div style=\"text-align: center;\">\r\n  <a target='_blank' href='https://keshif.me'><img class='kshfLogo'></a>\r\n</div>\r\n<div>\r\n  <a class='creditsLink' target='_blank' href='https://keshif.me/Terms'>Terms of Use</a>\r\n  <a class='creditsLink' target='_blank' href='https://keshif.me/Privacy'>Privacy Policy</a>\r\n  <a class='creditsLink' target='_blank' href='https://keshif.me/License'>Other Licenses</a>\r\n</div>\r\n<div class='copyright'>© Keshif, LLC 2022. All rights reserved.</div>\r\n`\r\n      );\r\n    this.creditsInserted = true;\r\n  }\r\n\r\n  /** -- */\r\n  helper_AddSidePanelGroup(className, _title, _tooltip) {\r\n    this.DOM[className] = this.DOM.authoringPanel\r\n      .append(\"div\")\r\n      .attr(\"class\", \"sidePanelGroup \" + className);\r\n\r\n    var xx = this.DOM[className]\r\n      .append(\"div\")\r\n      .attr(\"class\", \"sidePanelGroupHeader\");\r\n    xx.append(\"span\").html(_title);\r\n    xx.select(\".fa\").tooltip(_tooltip);\r\n    xx.append(\"span\")\r\n      .attr(\"class\", \"closeAttribPanel fa fa-window-close\")\r\n      .tooltip(i18n.Close)\r\n      .on(\"click\", async () => await this.dashboardMode.set(\"Explore\"));\r\n\r\n    return this.DOM[className]\r\n      .append(\"div\")\r\n      .attr(\"class\", \"sidePanelGroupContent\");\r\n  }\r\n\r\n  /** -- */\r\n  refreshAttibFilterState() {\r\n    this.DOM.dataTypeFilters.classed(\"active\", (_) => _.active);\r\n    var filterActive = this.dataTypeDescrs.some((_) => _.active);\r\n\r\n    var filterLevel;\r\n\r\n    var isExcluded = (_) => {\r\n      var visibleSubItems = filterLevel(Object.values(_.sub));\r\n      if (visibleSubItems > 0) return false;\r\n      if (typeof _.item === \"string\") {\r\n        return visibleSubItems === 0; // no visible items in the sub-tree\r\n      }\r\n      _ = _.item;\r\n      if (this.attribTextQuery) {\r\n        // also searches the query in descriptions\r\n        var searchIn = (\r\n          _.attribName + (_.description ? \" \" + _.description : \"\")\r\n        ).toLowerCase();\r\n        if (searchIn.indexOf(this.attribTextQuery) === -1) return true; // not found\r\n      }\r\n      if (!filterActive) return false;\r\n      return !this.dataTypeDescrs.some(\r\n        (descr) => descr.active && descr.member(_)\r\n      );\r\n    };\r\n\r\n    filterLevel = (items) => {\r\n      var visibleCount = 0;\r\n      items.forEach((_) => {\r\n        var s = isExcluded(_);\r\n        d3.select(_.DOM).classed(\"filtered\", s);\r\n        if (!s) visibleCount++;\r\n      });\r\n      return visibleCount;\r\n    };\r\n\r\n    this.removeEmptySubs();\r\n    filterLevel(Object.values(this.attribs_by_group));\r\n  }\r\n\r\n  /** -- */\r\n  refreshAttibButtonState() {\r\n    this.DOM.dataTypeFilters.classed(\"hidden\", (_) =>\r\n      this.attribs.every(\r\n        (attrib) => !attrib?.block?.hasNugget || !_.member(attrib)\r\n      )\r\n    );\r\n  }\r\n\r\n  private _attribPanelWidth: number = Base.width_AttribPanelDefault;\r\n  get attribPanelWidth() {\r\n    return this._attribPanelWidth;\r\n  }\r\n\r\n  /** -- */\r\n  setAttribPanelWidth(v) {\r\n    v = Number(v);\r\n    if (typeof v !== \"number\" || isNaN(v)) return;\r\n    v = Math.max(Math.min(v, 400), 200);\r\n    if (v === this._attribPanelWidth) return;\r\n    this._attribPanelWidth = v;\r\n    this.DOM.authoringPanel.style(\"width\", this._attribPanelWidth + \"px\");\r\n    this.updateLayout();\r\n  }\r\n\r\n  attribTextQuery: string = null;\r\n\r\n  /** -- */\r\n  insertDOM_AttribPanel() {\r\n    this.DOM.authoringPanel = this.DOM.root\r\n      .append(\"div\")\r\n      .attr(\"class\", \"authoringPanel\");\r\n\r\n    this.DOM.authoringPanel.style(\"width\", this._attribPanelWidth + \"px\");\r\n\r\n    // ****************************************************************************\r\n    // ***************************************************************************\r\n\r\n    var attributeInfo = this.helper_AddSidePanelGroup(\r\n      \"attributePanel\",\r\n      `<i class='panelIcon fa fa-cube'></i> ${i18n.Attributes}`,\r\n      \"<b>Author</b> your dashboard<br> using dataset attributes\"\r\n    );\r\n\r\n    attributeInfo\r\n      .append(\"div\")\r\n      .attr(\"class\", \"panelAdjustWidth\")\r\n      .tooltip(i18n[\"Adjust Panel Width\"])\r\n      .on(\"mousedown\", (event) => {\r\n        if (event.which !== 1) return; // only respond to left-click\r\n        var mouseDown_width =\r\n          this._attribPanelWidth - d3.pointer(event, document.body)[0];\r\n\r\n        this.activateWidthDrag(event.currentTarget, event, (event2) => {\r\n          this.setAttribPanelWidth(\r\n            mouseDown_width + d3.pointer(event2, document.body)[0]\r\n          );\r\n        });\r\n      })\r\n      .on(\"click\", (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      });\r\n\r\n    var attributePanelFilters = attributeInfo\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attributePanelFilters\");\r\n\r\n    this.DOM.dataTypeFilters = attributePanelFilters\r\n      .append(\"div\")\r\n      .attr(\"class\", \"dataTypeFilters\")\r\n      .selectAll(\"div\")\r\n      .data(this.dataTypeDescrs)\r\n      .enter()\r\n      .append(\"div\")\r\n      .each((_) => {\r\n        _.active = false;\r\n      })\r\n      .attr(\"class\", (_) => \"filterTypeButton \" + _.icon)\r\n      .html((_) => _.iconDiv)\r\n      .tooltip((_) => i18n[_.name + \"Attribute\"], { placement: \"bottom\" })\r\n      .on(\"click\", (event, _) => {\r\n        _.active = !_.active;\r\n        this.refreshAttibFilterState();\r\n      });\r\n\r\n    var attributePanelControl;\r\n\r\n    attributePanelFilters\r\n      .append(\"div\")\r\n      .attr(\"class\", \"filterTypeButton attribTextSearchIcon fa fa-search\")\r\n      .on(\"click\", (event) => {\r\n        event.currentTarget.classList.toggle(\"active\");\r\n        attributePanelControl.node().classList.toggle(\"active\");\r\n        this.DOM.attribTextSearch.select(\"input\").node().focus();\r\n      });\r\n\r\n    attributePanelFilters\r\n      .append(\"div\")\r\n      .attr(\"class\", \"filterTypeButton attribListConfiguration fa fa-cog\")\r\n      .tooltip(i18n.Configure, { placement: \"bottom\" })\r\n      .on(\"click\", (event) =>\r\n        Modal.popupMenu(event, MenuOpts.AttribPanel, this)\r\n      );\r\n\r\n    attributePanelControl = attributeInfo\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attributePanelControl\");\r\n\r\n    // *******************************************************\r\n    // TEXT SEARCH\r\n    // *******************************************************\r\n\r\n    this.DOM.attribTextSearch = attributePanelControl\r\n      .append(\"span\")\r\n      .attr(\"class\", \"textSearchBox attribTextSearch\");\r\n    this.DOM.attribTextSearch\r\n      .append(\"input\")\r\n      .attr(\"class\", \"textSearchInput\")\r\n      .attr(\"type\", \"text\")\r\n      .attr(\"placeholder\", i18n.Search)\r\n      .on(\"keydown\", (event) => event.stopPropagation())\r\n      .on(\"keypress\", (event) => event.stopPropagation())\r\n      .on(\"keyup\", (event) => event.stopPropagation())\r\n      .on(\"input\", (event) => {\r\n        var DOM = event.currentTarget;\r\n        if (DOM.timer) clearTimeout(DOM.timer);\r\n        this.attribTextQuery = DOM.value.toLowerCase();\r\n        this.DOM.attribTextSearch.classed(\r\n          \"showClear\",\r\n          this.attribTextQuery !== \"\"\r\n        );\r\n        DOM.timer = setTimeout(() => this.refreshAttibFilterState(), 250);\r\n      });\r\n    this.DOM.attribTextSearch\r\n      .append(\"span\")\r\n      .attr(\"class\", \"fa fa-times-circle\")\r\n      .tooltip(i18n.ClearTextSearch)\r\n      .on(\"click\", () => {\r\n        this.attribTextQuery = \"\";\r\n        this.DOM.attribTextSearch\r\n          .classed(\"showClear\", false)\r\n          .select(\"input\")\r\n          .property(\"value\", \"\");\r\n        this.refreshAttibFilterState();\r\n      });\r\n\r\n    this.DOM.attributeList = attributeInfo\r\n      .append(\"div\")\r\n      .attr(\"class\", \"attributeList\");\r\n\r\n    this.DOM.boostButton = attributeInfo\r\n      .append(\"div\")\r\n      .attr(\"class\", \"boostButton\")\r\n      .html(\"<i class='fa fa-rocket-launch'></i> Boost\")\r\n      .tooltip(\"Auto-boost dashboard\")\r\n      .on(\"click\", () => this.runMagic());\r\n  }\r\n\r\n  /** -- */\r\n  collapseAttribListGroups(v = true) {\r\n    this.DOM.root\r\n      .selectAll(\".AttribListItem.hasSubItems\")\r\n      .nodes()\r\n      .forEach((node) => {\r\n        node.classList[v ? \"add\" : \"remove\"](\"collapsed\");\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  refreshAttribList() {\r\n    if (!this.finalized) return;\r\n\r\n    var recurse = (_selection, level) =>\r\n      _selection.each((_item, i, nodes) => {\r\n        refreshLevel(\r\n          d3.select(nodes[i]).select(\".subItems\"),\r\n          _item.sub,\r\n          level + 1\r\n        );\r\n      });\r\n\r\n    var refreshLevel = (_dom, _data, level) => {\r\n      _data = Object.values(_data).sort((a: any, b: any) => {\r\n        var isGroup_A =\r\n          Object.keys(a.sub).length > 0 && typeof a.item === \"string\";\r\n        var isGroup_B =\r\n          Object.keys(b.sub).length > 0 && typeof b.item === \"string\";\r\n\r\n        // folders first\r\n        if (isGroup_A !== isGroup_B) return +isGroup_B - +isGroup_A;\r\n\r\n        // first by type, then by name\r\n        var diff =\r\n          Util.getAttribTypeOrder(a.item.type) -\r\n          Util.getAttribTypeOrder(b.item.type);\r\n        return diff ? diff : Util.sortFunc_List_String(a.name, b.name);\r\n      });\r\n\r\n      _dom.selectAll(\"div.AttribListItem-Level\" + level).remove();\r\n\r\n      _dom\r\n        .selectAll(\"div.AttribListItem-Level\" + level)\r\n        .data(_data, (_) => _.name + \"_\" + typeof _.item)\r\n        .join(\r\n          (enter) => {\r\n            var listItems = enter\r\n              .append(\"div\")\r\n              .attr(\"class\", \"AttribListItem AttribListItem-Level\" + level)\r\n              .classed(\"hasSubItems\", (_) => Object.entries(_.sub).length > 0)\r\n              .classed(\"collapsed\", true);\r\n\r\n            listItems\r\n              .append(\"div\")\r\n              .attr(\"class\", \"nugget\")\r\n              //.attr(\"tempColumnName\",   _ => _.item.template.str || null)\r\n              .classed(\"inDashboard\", (_) => _.item?.block?.inDashboard)\r\n              .classed(\"condensedText\", (_) => _.name?.length > 30)\r\n              .each((_, i, nodes) => {\r\n                _.DOM = nodes[i];\r\n\r\n                var isGroup = typeof _.item === \"string\";\r\n                let _dom = d3.select(nodes[i]);\r\n\r\n                _dom.on(\"click\", (event) => {\r\n                  if (event.which !== 1) return; // only respond to left-click\r\n                  nodes[i].parentNode.classList.toggle(\"collapsed\");\r\n                });\r\n\r\n                _dom\r\n                  .append(\"div\")\r\n                  .attr(\"class\", \"groupControl\")\r\n                  .tooltip(i18n[\"Open/Close\"])\r\n                  .on(\"click\", (event) => {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                    nodes[i].parentNode.classList.toggle(\"collapsed\");\r\n                  })\r\n                  .append(\"div\")\r\n                  .attr(\"class\", \"fa fa-caret-down\");\r\n\r\n                _dom\r\n                  .append(\"span\")\r\n                  .attr(\"class\", \"nuggetIcon\")\r\n                  .append(\"div\")\r\n                  .attr(\r\n                    \"class\",\r\n                    isGroup ? \"fa fa-circle\" : _.item?.nuggetClassName\r\n                  );\r\n\r\n                _dom\r\n                  .append(\"span\")\r\n                  .attr(\"class\", \"summaryName\")\r\n                  .html(_.name)\r\n                  .tooltip(i18n.EditTitle);\r\n\r\n                var Y = _dom\r\n                  .append(\"div\")\r\n                  .attr(\"class\", \"iconWrapper\")\r\n                  .on(\"dblclick\", (event) => {\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                  });\r\n\r\n                if (!isGroup) {\r\n                  let a: Attrib = _.item;\r\n                  if (a.attribName === this.idSummaryName) {\r\n                    Y.append(\"div\")\r\n                      .attr(\"class\", \"summaryRecordIDIcon fa fa-fingerprint\")\r\n                      .tooltip(i18n[\"Record ID\"], { placement: \"bottom\" });\r\n                  }\r\n\r\n                  if (a.type === \"categorical\") {\r\n                    Y.append(\"div\")\r\n                      .attr(\"class\", \"summaryMultiCat fa fa-tags\")\r\n                      .tooltip(i18n.MultiValued, { placement: \"bottom\" });\r\n                  }\r\n\r\n                  // no descriptions of simple groups currently\r\n                  Y.append(\"div\")\r\n                    .attr(\"class\", \"summaryDescription fa fa-info-circle\")\r\n                    .classed(\"active\", !!a.description)\r\n                    .tooltip(a.description, { placement: \"bottom\" })\r\n                    .on(\"click\", function () {\r\n                      this.tippy.show();\r\n                    });\r\n\r\n                  a.block?.refreshNugget(_dom);\r\n                }\r\n\r\n                Y.append(\"div\")\r\n                  .attr(\"class\", \"showDeriveMenu fa fa-ellipsis-v\")\r\n                  .tooltip(i18n.Settings, { placement: \"bottom\" })\r\n                  .on(\"mousedown\", (event) => event.stopPropagation())\r\n                  .on(\"click\", (event) => {\r\n                    event.currentTarget.parentNode.parentNode.classList.add(\r\n                      \"popupVisible\"\r\n                    );\r\n                    if (isGroup) {\r\n                      Modal.popupMenu(event, MenuOpts.Attrib_Grouping, _);\r\n                    } else {\r\n                      _.item.initializeAggregates();\r\n                      Modal.popupMenu(event, MenuOpts.Attribute, _.item);\r\n                    }\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                  });\r\n              });\r\n\r\n            listItems.append(\"div\").attr(\"class\", \"subItems\");\r\n\r\n            recurse(listItems, level);\r\n            return listItems;\r\n          },\r\n          (update) => recurse(update, level),\r\n          (exit) => exit.remove()\r\n        )\r\n        .order();\r\n    };\r\n\r\n    this.removeEmptySubs();\r\n\r\n    refreshLevel(this.DOM.attributeList, this.attribs_by_group, 0);\r\n\r\n    this.refreshAttibButtonState();\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Full screen control\r\n  // ********************************************************************\r\n\r\n  private isFullscreen = false;\r\n\r\n  /** -- */\r\n  showFullscreen() {\r\n    this.isFullscreen = this.isFullscreen ? false : true;\r\n    var elem = this.DOM.root.node();\r\n    if (this.isFullscreen) {\r\n      if (elem.requestFullscreen) {\r\n        elem.requestFullscreen();\r\n      } else if (elem.msRequestFullscreen) {\r\n        elem.msRequestFullscreen();\r\n      } else if (elem.mozRequestFullScreen) {\r\n        elem.mozRequestFullScreen();\r\n      } else if (elem.webkitRequestFullscreen) {\r\n        elem.webkitRequestFullscreen();\r\n      }\r\n    } else {\r\n      if (document.exitFullscreen) {\r\n        document.exitFullscreen();\r\n      } else if ((document as any).msExitFullscreen) {\r\n        (document as any).msExitFullscreen();\r\n      } else if ((document as any).mozCancelFullScreen) {\r\n        (document as any).mozCancelFullScreen();\r\n      } else if ((document as any).webkitExitFullscreen) {\r\n        (document as any).webkitExitFullscreen();\r\n      }\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Data loading\r\n  // ********************************************************************\r\n\r\n  _loadedTableCount = 0;\r\n  _totalTableCount = 0;\r\n\r\n  /** Setter & getter accecss so that UI can be updated when data is updated */\r\n  set loadedTableCount(v) {\r\n    this._loadedTableCount = v;\r\n    this.DOM.status_text_sub_dynamic?.text(\r\n      `(${this._loadedTableCount} / ${this._totalTableCount})`\r\n    );\r\n  }\r\n  get loadedTableCount() {\r\n    return this._loadedTableCount;\r\n  }\r\n\r\n  /** -- */\r\n  loadDataSources() {\r\n    \"use strict\";\r\n\r\n    this.DOM.overlay_wrapper.attr(\"show\", \"loading\");\r\n\r\n    DataTable.registerLoader(new DataLoader_FetchURL());\r\n    DataTable.registerLoader(new DataLoader_GoogleSheets());\r\n\r\n    this.insertDOM_Panel_DatasetInfo();\r\n\r\n    var tableLoadPromises = [];\r\n\r\n    if (this.options.source) {\r\n      let tableSpecs = this.options.source;\r\n      if (!Array.isArray(tableSpecs)) {\r\n        tableSpecs = [tableSpecs];\r\n      }\r\n\r\n      this.loadedTableCount = 0;\r\n      this._totalTableCount = tableSpecs.length;\r\n\r\n      tableLoadPromises = tableSpecs.map(async (tableDescr, i) => {\r\n        var dt = new DataTable(tableDescr);\r\n\r\n        await dt.load();\r\n        this._loadedTableCount++;\r\n\r\n        if (i === 0) {\r\n          this.primaryTableName = dt.name;\r\n          this.idSummaryName = dt.id || \"id\";\r\n\r\n          if (dt.linkToData) {\r\n            this.DOM.datasource\r\n              .style(\"display\", \"inline-block\")\r\n              .attr(\"href\", dt.linkToData);\r\n          }\r\n        }\r\n        return true;\r\n      });\r\n    }\r\n\r\n    // Execute async data loading on multiple tables\r\n    Promise.all(tableLoadPromises)\r\n      // load charts\r\n      .then(() => {\r\n        if (!this.primaryTableName) {\r\n          Modal.alert(\"Cannot load dashboard. Please define primaryTableName.\");\r\n          return;\r\n        }\r\n\r\n        this.records = Base.tables.get(this.primaryTableName)?.records || [];\r\n        this.records.forEach((record, i) => {\r\n          record.recordOrder = i;\r\n        });\r\n\r\n        this.setRecordName(this.recordName || this.primaryTableName);\r\n\r\n        // uses setTimeout to be able to render the updated \"Creating browser...\" text.\r\n        this.DOM.overlay_wrapper\r\n          .select(\"div.status_text .info\")\r\n          .text(i18n.CreatingBrowser);\r\n        this.DOM.overlay_wrapper.select(\"div.status_text .dynamic\").text(\"\");\r\n        window.setTimeout(async () => this._loadCharts(), 20);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        Modal.alert(\"Error in loading data.<br><br> Error: \" + err);\r\n      });\r\n  }\r\n\r\n  /** -- */\r\n  prepBlockConfig(blockCfg) {\r\n    // **************************************************\r\n    // Deprecated/renamed configurations\r\n\r\n    if (blockCfg.showPercentile)\r\n      blockCfg.showPercentiles = blockCfg.showPercentile;\r\n    if (blockCfg.intervalScale)\r\n      blockCfg.valueScaleType = blockCfg.intervalScale;\r\n    if (blockCfg.scaleType) blockCfg.valueScaleType = blockCfg.scaleType;\r\n    if (blockCfg.minAggrValue) blockCfg.minAggrSize = blockCfg.minAggrValue;\r\n\r\n    if (blockCfg.supportsCompareLock === false) {\r\n      blockCfg.isComparable = false;\r\n    }\r\n\r\n    // Set type of summary automatically if type-specific attributes have been defined\r\n    if (!blockCfg.type) {\r\n      if (\r\n        blockCfg.catLabel ||\r\n        blockCfg.catTooltip ||\r\n        blockCfg.catSortBy ||\r\n        blockCfg.catGeo ||\r\n        blockCfg.barHeight ||\r\n        blockCfg.showSetMatrix\r\n      ) {\r\n        blockCfg.type = \"categorical\";\r\n      } else if (blockCfg.showPercentile || blockCfg.skipZero) {\r\n        blockCfg.type = \"numeric\";\r\n      } else if (blockCfg.recordGeo) {\r\n        blockCfg.type = \"recordGeo\";\r\n      } else if (blockCfg.content) {\r\n        blockCfg.type = \"content\";\r\n      }\r\n    }\r\n  }\r\n  /** -- */\r\n  async applyBlockConfig(attribCfg: SummarySpec) {\r\n    \"use strict\";\r\n\r\n    if (Object.keys(attribCfg).length === 0) return; // NO-OP\r\n    if (attribCfg.skipConfig) return;\r\n\r\n    this.prepBlockConfig(attribCfg);\r\n\r\n    var attrib = this.attribWithName(attribCfg.name);\r\n\r\n    var _byValue = null;\r\n    if (typeof attribCfg.value === \"string\" && attribCfg.type !== \"recordGeo\") {\r\n      _byValue = this.attribWithName(attribCfg.value);\r\n    }\r\n\r\n    if (!attrib && _byValue) {\r\n      // converting name from \"value\" to \"name\"\r\n      attrib = _byValue;\r\n      attrib.attribName = attribCfg.name;\r\n    } else {\r\n      if (\r\n        attrib &&\r\n        attribCfg.value &&\r\n        attribCfg.value !== attribCfg.name &&\r\n        attrib.template.str !== attribCfg.value\r\n      ) {\r\n        // redefining the attrib with the requested name using the new value function\r\n        attrib.destroy();\r\n      }\r\n      attrib = this.createAttrib(attribCfg.name, attribCfg.value, attribCfg.type);\r\n    }\r\n\r\n    // handle summary/attribCfg type mismatch...\r\n    if (attribCfg.type && attribCfg.type !== attrib.type) {\r\n      attrib.destroy();\r\n      attribCfg.value = attribCfg.value || attribCfg.name;\r\n\r\n      if (typeof attribCfg.value === \"string\") {\r\n        attrib = this.createAttrib(attribCfg.value, null, attribCfg.type);\r\n        attrib.attribName = attribCfg.name;\r\n      } else if (typeof attribCfg.value === \"function\") {\r\n        attrib = this.createAttrib(\r\n          attribCfg.name,\r\n          attribCfg.value,\r\n          attribCfg.type\r\n        );\r\n      }\r\n    }\r\n\r\n    // If attrib object is not found/created, nothing else to do\r\n    if (!attrib) return;\r\n\r\n    await attrib.applyConfig(attribCfg);\r\n\r\n    if (\r\n      attrib.isEmpty() &&\r\n      (attrib instanceof Attrib_Categorical ||\r\n        attrib instanceof Attrib_Interval)\r\n    ) {\r\n      attrib.destroy();\r\n      return;\r\n    }\r\n\r\n    if (attribCfg.panel) {\r\n      attrib.block?.addToPanel(this.panels[attribCfg.panel], undefined, true);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  runMagic() {\r\n    var newConfig: any = this.exportConfig();\r\n\r\n    var potentialChanges = [];\r\n\r\n    // See if we can detect some auto-conversions!\r\n    var recordKeys = Object.keys(this.records[0].data);\r\n\r\n    // LAT_LONG conversion\r\n    var latKey, longKey;\r\n    var hasLat = recordKeys.some((k) => {\r\n      latKey = k;\r\n      var _ = k.toUpperCase();\r\n      return [\"LAT\", \"LATITUDE\"].includes(_);\r\n    });\r\n    var hasLong = recordKeys.some((k) => {\r\n      longKey = k;\r\n      var _ = k.toUpperCase();\r\n      return [\"LON\", \"LONGITUDE\", \"LNG\", \"LONG\"].includes(_);\r\n    });\r\n    if (hasLat && hasLong && !this.options.onLoad[\"_POINT\"]) {\r\n      potentialChanges.push({\r\n        i: '<i class=\"fa fa-map-marker\"></i>',\r\n        q: `(<b>${latKey}</b>, <b>${longKey}</b>) is the point location.`,\r\n        a: () => {\r\n          this.options.onLoad[\"_POINT\"] = `LAT_LONG(${latKey},${longKey})`;\r\n          // delete lat/long summaries\r\n          newConfig.summaries = newConfig.summaries.filter((cfg) => {\r\n            return cfg.name !== latKey && cfg.name !== longKey;\r\n          });\r\n          if (!newConfig.recordDisplay.geo)\r\n            newConfig.recordDisplay.geo = \"_POINT\";\r\n          if (newConfig.recordDisplay.viewAs === \"none\")\r\n            newConfig.recordDisplay.viewAs = \"map\";\r\n        },\r\n      });\r\n    }\r\n\r\n    // Derive time feature\r\n    var timeStampSummaries = this.attribs.filter(\r\n      (attrib) => attrib instanceof Attrib_Timestamp\r\n    ) as Attrib_Timestamp[];\r\n\r\n    timeStampSummaries.forEach((attrib) => {\r\n      [\r\n        { typed: \"month\", derivative: \"Month\" },\r\n        { typed: \"day\", derivative: \"DayOfMonth\" },\r\n        { typed: \"day\", derivative: \"WeekDay\" },\r\n        { typed: \"hour\", derivative: \"Hour\" },\r\n      ].forEach((_opt) => {\r\n        if (\r\n          !attrib.timeTyped[_opt.typed] ||\r\n          attrib.derivatives[_opt.derivative]\r\n        ) {\r\n          return;\r\n        }\r\n        potentialChanges.push({\r\n          i: '<i class=\"fa fa-calendar-day\"></i>',\r\n          q: `Derive ${_opt.derivative} of <b>${attrib.attribName}</b>`,\r\n          a: () => {\r\n            newConfig.summaries.push({\r\n              name: attrib.attribName + \"->\" + _opt.derivative,\r\n              value: attrib.template.str + \"->\" + _opt.derivative + \"()\",\r\n              panel: \"none\",\r\n            });\r\n          },\r\n        });\r\n      });\r\n    });\r\n\r\n    // Detect TIMESERIES\r\n    // Merge first ten records\r\n    var _mergedRecData = {};\r\n    this.records.slice(0, 10).forEach((rec: Record) => {\r\n      for (var k in rec.data) {\r\n        _mergedRecData[k] = _mergedRecData[k] || [];\r\n        _mergedRecData[k].push(rec.data[k]);\r\n      }\r\n    });\r\n\r\n    recordKeys.forEach((k) => {\r\n      var _values: any = _mergedRecData[k];\r\n      _values.some((v) => {\r\n        if (v == null || typeof v !== \"object\" || Array.isArray(v))\r\n          return false;\r\n\r\n        // TO-DO: Process non-number, string types time series field info (\"2017-05\",\"2017-04\", etc)\r\n        // both keys and values must be numbers\r\n        if (\r\n          Object.entries(v).every(([key, val]) => {\r\n            return !isNaN(Number(key)) && val !== null && !isNaN(Number(val));\r\n          })\r\n        ) {\r\n          potentialChanges.push({\r\n            i: '<i class=\"fa fa-chart-line\"></i>',\r\n            q: `<b>${k}</b> is timeseries by year/order.`,\r\n            a: () => {\r\n              this.options.onLoad[k] = k + \"->${DATETIME(%Y)}\";\r\n              // Remove summaries of individual time keys\r\n              newConfig.summaries = newConfig.summaries.filter(\r\n                (s: SummarySpec) => {\r\n                  if (s.panel !== \"none\") return true;\r\n                  var _t = new AttribTemplate(s.name, this);\r\n                  return !(_t && _t.pathStr === k);\r\n                }\r\n              );\r\n            },\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n    });\r\n\r\n    // ZIPCODE?\r\n    var isZipCode = (attrib: Attrib) => {\r\n      var _ = attrib.attribName;\r\n      return _.toUpperCase() === \"ZIP\" || _.toUpperCase() === \"ZIPCODE\";\r\n    };\r\n\r\n    // Convert from integer to string\r\n    this.attribs.forEach((attrib) => {\r\n      if (attrib instanceof Attrib_Numeric && isZipCode(attrib)) {\r\n        potentialChanges.push({\r\n          i: '<i class=\"fa fa-map-marker\"></i>',\r\n          q: `<b>${attrib.attribName}</b> is zipcode.`,\r\n          a: () => {\r\n            this.options.onLoad[attrib.template.str] = \"STR()\";\r\n            newConfig.summaries = newConfig.summaries.filter((_) => {\r\n              return _.name !== attrib.attribName;\r\n            });\r\n            attrib.destroy();\r\n          },\r\n        });\r\n      }\r\n    });\r\n\r\n    var numToDateMagic = [\r\n      {\r\n        // Serial dates\r\n        filter: (attrib: Attrib) => {\r\n          return (\r\n            attrib instanceof Attrib_Numeric &&\r\n            attrib.aggr_initialized &&\r\n            !attrib.unitName &&\r\n            attrib.rangeOrg[0] >= 18264 && // =DATEVALUE(\"1/1/1950\")\r\n            attrib.rangeOrg[1] <= 54789 && // =DATEVALUE(\"1/1/2050\")\r\n            !isZipCode(attrib)\r\n          );\r\n        },\r\n        i: \"hashtag\",\r\n        convert: \"DATETIME(%sn)\",\r\n        message: \" is a spreadsheet date field?\",\r\n      },\r\n      {\r\n        // Year only\r\n        filter: (attrib: Attrib) => {\r\n          return (\r\n            attrib instanceof Attrib_Numeric &&\r\n            attrib.aggr_initialized &&\r\n            !attrib.unitName &&\r\n            attrib.rangeOrg[0] >= 1950 && // =DATEVALUE(\"1/1/1950\")\r\n            attrib.rangeOrg[1] <= 2050 && // =DATEVALUE(\"1/1/2050\")\r\n            !isZipCode(attrib)\r\n          );\r\n        },\r\n        convert: \"DATETIME(%Y)\",\r\n        message: \" stores year values?\",\r\n      },\r\n      // Timestamp: -631152000 ... 2524608000\r\n      // Range too wide. Need more complex analysis to detect if fields are potentially dates\r\n    ];\r\n\r\n    this.attribs.forEach((attrib: Attrib) => {\r\n      numToDateMagic.some((_) => {\r\n        if (_.filter(attrib)) {\r\n          potentialChanges.push({\r\n            i: '<i class=\"fa fa-calendar-day\"></i>',\r\n            q: attrib.attribName + _.message,\r\n            a: () => {\r\n              this.options.onLoad[attrib.template.str] = _.convert;\r\n              // delete the type of existing attrib\r\n              newConfig.summaries\r\n                .filter((s) => s.name === attrib.attribName)\r\n                .forEach((c) => delete c.type);\r\n            },\r\n          });\r\n        }\r\n        return false;\r\n      });\r\n    });\r\n\r\n    // SPLIT CATEGORIES\r\n    this.attribs.forEach((attrib) => {\r\n      if (!(attrib instanceof Attrib_Categorical) || attrib.isEmpty()) return;\r\n\r\n      var allText = \"\";\r\n      attrib._aggrs.forEach((aggr) => {\r\n        allText += aggr.id;\r\n      });\r\n\r\n      [\r\n        { char: \",\", convert: \"SPLIT(\\\\s*,\\\\s*)\" },\r\n        { char: \";\", convert: \"SPLIT(\\\\s*;\\\\s*)\" },\r\n        { char: \"|\", convert: \"SPLIT(\\\\s*\\\\|\\\\s*)\" },\r\n        { char: \"+\", convert: \"SPLIT(\\\\s*\\\\+\\\\s*)\" },\r\n      ].forEach((_) => {\r\n        var n = allText.split(_.char).length - 1;\r\n        if (n <= allText.length / 20) return;\r\n        potentialChanges.push({\r\n          i: '<i class=\"fa fa-tags\"></i>',\r\n          q: `<b>${attrib.attribName}</b> has multiple categories split by <b>${_.char}</b>`,\r\n          a: () => {\r\n            this.options.onLoad[attrib.template.str] = _.convert;\r\n          },\r\n        });\r\n      });\r\n    });\r\n\r\n    // Detect ID field\r\n    var recordTextCandidate = null;\r\n\r\n    if (this.idSummaryName === \"id\") {\r\n      let candidateSummaries: Attrib[] = this.attribs.filter((attrib) => {\r\n        if (\r\n          attrib instanceof Attrib_Categorical &&\r\n          attrib.uniqueCategories() &&\r\n          attrib.template.str &&\r\n          attrib.template.str !== \"id\"\r\n        ) {\r\n          var allText = \"\";\r\n          attrib._aggrs.forEach((aggr) => {\r\n            allText += aggr.id;\r\n          });\r\n          attrib[\"___temp\"] = allText.length;\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n\r\n      candidateSummaries.sort((a, b) => a[\"___temp\"] - b[\"___temp\"]); // shortest first\r\n\r\n      var idCandidate = candidateSummaries[0];\r\n      if (idCandidate) {\r\n        potentialChanges.push({\r\n          i: \"<i class='fa fa-fingerprint'></i>\",\r\n          q: `<b>${idCandidate.attribNameHTML}</b> is the unique fingerprint (ID) of the ${this.recordName}`,\r\n          a: () => {\r\n            newConfig.source.tables[0].id = idCandidate.template.str;\r\n            if (this.attribWithName(\"id\")) this.attribWithName(\"id\").destroy();\r\n            newConfig.summaries = newConfig.summaries.filter((_) => {\r\n              return _.name !== \"id\";\r\n            });\r\n          },\r\n        });\r\n      }\r\n\r\n      recordTextCandidate = candidateSummaries[1] || candidateSummaries[0];\r\n    }\r\n\r\n    if (!this.recordDisplay.codeBy.text) {\r\n      if (!recordTextCandidate) {\r\n        let candidateSummaries = this.attribs\r\n          .filter((attrib) => {\r\n            if (\r\n              attrib.type === \"categorical\" &&\r\n              attrib.template.str &&\r\n              attrib.template.str !== \"id\" &&\r\n              attrib._aggrs\r\n            ) {\r\n              attrib[\"___temp\"] = attrib._aggrs.length;\r\n              return true;\r\n            }\r\n            return false;\r\n          })\r\n          .sort((a, b) => b[\"___temp\"] - a[\"___temp\"]); // longest first\r\n        recordTextCandidate = candidateSummaries[0];\r\n      }\r\n      if (recordTextCandidate) {\r\n        potentialChanges.push({\r\n          i: '<i class=\"fa fa-font\"></i>',\r\n          q: `<b>${recordTextCandidate.summaryName}</b> can be used as record text.`,\r\n          a: () => {\r\n            newConfig.recordDisplay.textBy = recordTextCandidate.summaryName;\r\n            if (newConfig.recordDisplay.viewAs === \"none\") {\r\n              newConfig.recordDisplay.viewAs = \"list\";\r\n            }\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    if (\r\n      timeStampSummaries.length > 0 &&\r\n      timeStampSummaries.length < 3 &&\r\n      this.panels.bottom.isEmpty()\r\n    ) {\r\n      let attrib = timeStampSummaries[0];\r\n      if (!attrib.block?.inDashboard) {\r\n        potentialChanges.push({\r\n          i: '<i class=\"fa fa-th\"></i>',\r\n          q: `Place <b>${attrib.attribName}</b> on dashboard bottom`,\r\n          a: () => {\r\n            newConfig.summaries.forEach((s) => {\r\n              if (s.name === attrib.attribName) s.panel = \"bottom\";\r\n            });\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    this.attribs.forEach((attrib) => {\r\n      delete attrib[\"___temp\"];\r\n    });\r\n\r\n    if (potentialChanges.length === 0) {\r\n      Modal.alert(i18n.Boost_NoSuggestions);\r\n    } else {\r\n      // set change by default\r\n      potentialChanges.forEach((c) => {\r\n        if (c.change === undefined) c.change = true;\r\n      });\r\n      Modal.autoChanges(potentialChanges).then(\r\n        (potentialChanges: any[]) => {\r\n          var reloadDashboard = false;\r\n          potentialChanges.forEach((_) => {\r\n            if (_.change) {\r\n              _.a();\r\n              reloadDashboard = true;\r\n            } // apply\r\n          });\r\n\r\n          if (reloadDashboard) {\r\n            // delete the loaded dataset, so onLoad work correctly\r\n            Base.tables.delete(this.primaryTableName);\r\n\r\n            (window as any).dashboard = new Browser(newConfig);\r\n          } else {\r\n            // No changes applied. Remove animation.\r\n            if (this.DOM.boostButton)\r\n              this.DOM.boostButton.classed(\"animate\", false);\r\n          }\r\n        },\r\n        () => {\r\n          // Cancel changes\r\n          if (this.DOM.boostButton)\r\n            this.DOM.boostButton.classed(\"animate\", false);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  public chartsLoaded = false;\r\n\r\n  /** -- */\r\n  async _loadCharts() {\r\n    if (this.chartsLoaded) return;\r\n\r\n    this.DOM.root.classed(\"dataLoaded\", true);\r\n\r\n    if (this.records.length === 0) {\r\n      Modal.alert(`Dataset (${this.recordName}) includes no records.`);\r\n      return;\r\n    }\r\n\r\n    // process non-function specifications.\r\n    for (var _key in this.onLoad.main) {\r\n      applyPreProc(_key, this.onLoad.main[_key], this.records);\r\n    }\r\n    this.onLoad.callback?.call(this);\r\n\r\n    loadMapStandards();\r\n\r\n    // apply panel layout\r\n    if (!this.options.panels) {\r\n      this.options.panels = {};\r\n    }\r\n    if (!this.options.panels.default) {\r\n      this.options.panels.default = {};\r\n    }\r\n    if (this.options.panels.default.catBarWidth == null) {\r\n      this.options.panels.default.catBarWidth = (() => {\r\n        var totalWidth = this.divWidth;\r\n        [\"left\", \"middle\", \"right\"].forEach((panelName) => {\r\n          if (this.panels[panelName].isEmpty()) return;\r\n          totalWidth -=\r\n            this.panels[panelName].width_Real -\r\n            this.panels[panelName].width_CatBars;\r\n        });\r\n        return Math.floor(totalWidth / 8);\r\n      })();\r\n    }\r\n    [\"left\", \"middle\", \"right\"].forEach((side) => {\r\n      if (this.options[side + \"PanelLabelWidth\"]) {\r\n        if (!this.options.panels[side]) this.options.panels[side] = {};\r\n        this.options.panels[side].catLabelWidth =\r\n          this.options[side + \"PanelLabelWidth\"];\r\n      }\r\n    });\r\n\r\n    await this.breakdownMode.set(this.options.breakdownMode);\r\n    await this.stackedCompare.set(this.options.stackedCompare);\r\n    await this.filteringMode.set(this.options.filteringMode);\r\n    await this.showWholeAggr.set(this.options.showWholeAggr);\r\n    await this.mouseOverCompare.set(this.options.mouseOverCompare);\r\n\r\n    this.records.forEach((rec) => this.allRecordsAggr.addRecord(rec));\r\n\r\n    if (this.options.attribPanelWidth) {\r\n      this.setAttribPanelWidth(this.options.attribPanelWidth);\r\n    }\r\n\r\n    if (this.options.colorTheme) {\r\n      this.colorTheme = Object.assign(this.colorTheme, this.options.colorTheme);\r\n    }\r\n\r\n    Base.Panel_List.forEach((p) =>\r\n      this.panels[p].importConfig(this.options.panels[p])\r\n    );\r\n\r\n    // look at first \"autoDetect_RowCount\" rows to identify the column names\r\n    var firstFiveRow_Cols = {};\r\n    function _recurse(_src, _trgt) {\r\n      if (!_src) return;\r\n      for (var _key in _src) {\r\n        var _v = _src[_key];\r\n        if (_v == null) continue;\r\n        if (\r\n          _v != null &&\r\n          typeof _v === \"object\" &&\r\n          !(_v instanceof Date) &&\r\n          !Array.isArray(_v) &&\r\n          !_v._timeseries_ &&\r\n          !_v.geometry &&\r\n          !_v.coordinates // map\r\n        ) {\r\n          // Object index\r\n          _trgt[_key] = _trgt[_key] || {};\r\n          _recurse(_v, _trgt[_key]);\r\n        } else {\r\n          _trgt[_key] = _v;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.records\r\n      .slice(0, Base.autoDetect_RowCount)\r\n      .forEach((rec) => _recurse(rec.data, firstFiveRow_Cols));\r\n\r\n    // Create a summary for each existing column in the data\r\n    // Separated to a function to work recursively\r\n    var addAttribs = (parentPath, _obj, timeSeriesParent = false) => {\r\n      for (var attribName in _obj) {\r\n        if (typeof attribName !== \"string\") {\r\n          continue;\r\n        }\r\n\r\n        var _v = _obj[attribName];\r\n\r\n        if (_v != null && _v._timeseries_) {\r\n          let s = this.createAttrib(parentPath + attribName);\r\n          if (s) {\r\n            s.initializeAggregates();\r\n          }\r\n          // addAttribs(parentPath + attribName + \"->\", _v, true);\r\n          //\r\n        } else if (\r\n          _v != null &&\r\n          typeof _v === \"object\" &&\r\n          !(_v instanceof Date) &&\r\n          !Array.isArray(_v) &&\r\n          !_v.geometry &&\r\n          !_v.coordinates // map\r\n        ) {\r\n          addAttribs(parentPath + attribName + \"->\", _v);\r\n        } else {\r\n          if (!timeSeriesParent) {\r\n            let s = this.createAttrib(parentPath + attribName);\r\n            if (s) {\r\n              s.initializeAggregates();\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    addAttribs(\"\", firstFiveRow_Cols);\r\n\r\n    this.recordDisplay = new RecordDisplay(\r\n      this,\r\n      this.options.recordDisplay || {}\r\n    );\r\n\r\n    if (this.options.metric) {\r\n      var metric = this.options.metric;\r\n      if (typeof metric === \"string\") metric = { type: \"Sum\", summary: metric };\r\n      let a = this.attribWithName(metric.summary);\r\n      if (a instanceof Attrib_Numeric) {\r\n        await this.measureSummary.set(a);\r\n        await this.measureFunc.set(metric.type);\r\n      }\r\n    }\r\n\r\n    this.options.summaries = this.options.summaries || [];\r\n\r\n    for(let cfg of this.options.summaries){\r\n      await this.applyBlockConfig(cfg);\r\n    }\r\n\r\n    await this.recordDisplay.initialize();\r\n\r\n    this.panels.bottom.refreshWidth();\r\n\r\n    this.updateMiddlePanelWidth();\r\n\r\n    this.records.forEach((rec) => rec.refreshFilterCache());\r\n    this.updateRecordCount_Active();\r\n\r\n    this.updateAfterFilter();\r\n\r\n    // Load compare selections\r\n    if (this.options.selections && !this.options.selections.auto) {\r\n      var summary = this.attribWithName(this.options.selections.summary);\r\n      Base.Compare_List.forEach((cT) => {\r\n        var selection = this.options.selections[cT];\r\n        if (!selection) return;\r\n        if (!summary) return;\r\n\r\n        summary.initializeAggregates();\r\n\r\n        var aggr: Aggregate;\r\n        if (summary instanceof Attrib_Categorical) {\r\n          aggr = summary.getAggrWithLabel(selection.id);\r\n        } else if (summary instanceof Attrib_Numeric) {\r\n          this.flexAggrs[cT] = new Aggregate_Interval_Numeric(\r\n            summary,\r\n            selection.min as number,\r\n            selection.max as number\r\n          );\r\n          aggr = this.flexAggrs[cT];\r\n        }\r\n        if (!aggr) return;\r\n\r\n        if (this.setSelect_Compare(aggr, cT, false)) {\r\n          this.lockSelect_Compare(false);\r\n        }\r\n      });\r\n    }\r\n\r\n    this.enableAnalytics = true; // before this, do not run analytics computations\r\n\r\n    this.refreshConfigs();\r\n\r\n    // This needs to be called after analytics mode and configs are set-up.\r\n    // Auto-compare works on \"top\" categories, which depend on various analytics & chart modes.\r\n    if (this.options.selections && this.options.selections.auto) {\r\n      this.attribWithName(this.options.selections.summary)?.autoCompare();\r\n    }\r\n\r\n    this.checkBrowserZoomLevel();\r\n\r\n    // hide overlay\r\n    if (\r\n      this.DOM.overlay_wrapper.selectAll(\".overlay_modal\").nodes().length === 0\r\n    ) {\r\n      this.DOM.overlay_wrapper.attr(\"show\", \"none\");\r\n    }\r\n\r\n    await this.dashboardMode.set(this.options.dashboardMode);\r\n\r\n    this.options.onReady?.call(this);\r\n\r\n    this.finalized = true;\r\n\r\n    if (this.authorMode) this.refreshAttribList();\r\n\r\n    // height of histograms depend on dashboard width, which depends on mode.\r\n    this.updateLayout();\r\n\r\n    setTimeout(() => this.setNoAnim(false), 1000);\r\n\r\n    this.chartsLoaded = true;\r\n\r\n    if (this.options.recordInDetail) {\r\n      var record = Base.tables\r\n        .get(this.primaryTableName)\r\n        .getRecord(this.options.recordInDetail);\r\n      if (record) this.recordDetailsPopup.updateRecordDetailPanel(record);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  unregisterBodyCallbacks() {\r\n    d3.select(\"body\")\r\n      .on(\"mousemove.layout\", null)\r\n      .on(\"mouseup.layout\", null)\r\n      .on(\"keydown.layout\", null);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Moving blocks across panels\r\n  // ********************************************************************\r\n\r\n  movedAttrib: Attrib = null;\r\n\r\n  private showDropZones = false;\r\n\r\n  /** -- */\r\n  prepareDropZones(attrib: Attrib, dropSource) {\r\n    this.movedAttrib = attrib;\r\n    this.showDropZones = true;\r\n    this.DOM.root.classed(\"showDropZone\", true).attr(\"dropSource\", dropSource);\r\n    this.DOM.attribDragBox.style(\"display\", \"block\").html(attrib.attribName);\r\n  }\r\n\r\n  /** -- */\r\n  clearDropZones() {\r\n    this.movedAttrib = null;\r\n    this.showDropZones = false;\r\n    this.unregisterBodyCallbacks();\r\n    this.DOM.root\r\n      .classed(\"showDropZone\", false)\r\n      .attr(\"dropattrtype\", null)\r\n      .attr(\"dropSource\", null);\r\n    this.DOM.attribDragBox.style(\"display\", \"none\");\r\n  }\r\n\r\n  /** -- */\r\n  autoAddAttib(attrib: Attrib): void {\r\n    if (attrib?.block?.inDashboard) return; //\r\n\r\n    if (attrib instanceof Attrib_Timeseries) {\r\n      this.recordDisplay.setAttrib(\"timeSeries\", attrib)\r\n        .then(async () => await this.recordChartType.set(\"timeseries\"));\r\n      return;\r\n    }\r\n\r\n    if (attrib instanceof Attrib_RecordGeo) {\r\n      this.recordDisplay.setAttrib(\"geo\", attrib)\r\n        .then(async () => await this.recordChartType.set(\"map\"));\r\n      return;\r\n    }\r\n\r\n    if (attrib instanceof Attrib_Categorical && attrib.uniqueCategories()) {\r\n      this.recordDisplay.setAttrib(\"text\", attrib)\r\n        .then(async () => await this.recordChartType.set(\"list\"));\r\n      return;\r\n    }\r\n\r\n    var target_panel: PanelName =\r\n      {\r\n        timestamp: \"bottom\",\r\n        categorical: \"left\",\r\n        numeric: \"right\",\r\n      }[attrib.type] || \"left\";\r\n\r\n    if (!this.panels[target_panel].welcomesNewBlock()) {\r\n      target_panel = \"middle\";\r\n    }\r\n\r\n    attrib?.block?.addToPanel(this.panels[target_panel]);\r\n  }\r\n\r\n  /** -- */\r\n  getGlobalActiveMeasure() {\r\n    if (this.allRecordsAggr.recCnt(\"Active\") === 0) return i18n[\"No [Record]\"];\r\n    var numStr = this.allRecordsAggr.measure(\"Active\").toLocaleString();\r\n    return this.getMeasureFormattedValue(numStr);\r\n  }\r\n\r\n  /** -- */\r\n  updateRecordCount_Active() {\r\n    this.DOM.activeRecordMeasure.html(this.getGlobalActiveMeasure());\r\n  }\r\n\r\n  /**************************************************************\r\n   * FILTERS\r\n   **************************************************************/\r\n\r\n  filters: Filter_Base[] = [];\r\n  filterCounter = 0;\r\n\r\n  /** -- */\r\n  get numOfActiveFilters() {\r\n    return this.filters.filter((filter) => filter.isFiltered).length;\r\n  }\r\n\r\n  /** -- */\r\n  isFiltered() {\r\n    return this.numOfActiveFilters > 0;\r\n  }\r\n\r\n  /** -- */\r\n  getFilteredSummaryText() {\r\n    if (this.numOfActiveFilters === 0) return \"\";\r\n    if (this.numOfActiveFilters > 1) return \"filtered\";\r\n    var f = this.filters.find((filter) => filter.isFiltered);\r\n    return f.getRichText_flipped();\r\n  }\r\n\r\n  /** -- */\r\n  refresh_filterClearAll() {\r\n    this.DOM.breadCrumbs_Filter.classed(\"isActive\", this.isFiltered());\r\n  }\r\n\r\n  skipSortingSummary: Attrib_Categorical = null;\r\n\r\n  /** -- */\r\n  clearFilters_All(exceptThis: Filter_Base = null) {\r\n    if (this.numOfActiveFilters === 0) return;\r\n    // sometimes, it looks like the exceptThis selection is already filtered. Skip in that case\r\n    if (\r\n      this.numOfActiveFilters === 1 &&\r\n      this.filters.filter((filter) => filter.isFiltered)[0] === exceptThis\r\n    )\r\n      return;\r\n    if (this.skipSortingSummary) {\r\n      // you can now sort the last filtered summary, attention is no longer there.\r\n      this.skipSortingSummary.dirtySort = false;\r\n    }\r\n\r\n    // clear all registered filters\r\n    this.filters.forEach(\r\n      (filter) => filter !== exceptThis && filter.clearFilter(false)\r\n    );\r\n\r\n    // Only update records which were not wanted before.\r\n    this.records.forEach((rec) => rec.filteredOut && rec.refreshFilterCache());\r\n    this.updateRecordCount_Active();\r\n    this.updateAfterFilter(true); // more results\r\n\r\n    setTimeout(() => this.updateLayout_Height(), 1000); // update layout after 1 seconds\r\n  }\r\n\r\n  /** -- */\r\n  updateAfterFilter(how = false) {\r\n    Base.browser = this;\r\n\r\n    Base.Compare_List.forEach((cT) => {\r\n      var compared_Aggr = this.selectedAggrs[cT];\r\n      if (compared_Aggr) this.refresh_Compare_Measures(compared_Aggr, cT);\r\n    });\r\n\r\n    this.refreshPanelsSyncedMeasureExtend();\r\n\r\n    this.blocks.forEach((block) => block.updateAfterFilter(true)); // refresh viz\r\n    this.recordDisplay.updateAfterFilter(how);\r\n\r\n    this.updateWidth_CatMeasureLabels();\r\n    this.refreshAllMeasureLabels();\r\n    this.refresh_filterClearAll();\r\n\r\n    this.filteringMode.refresh();\r\n\r\n    this.needToRefreshLayout = true;\r\n  }\r\n\r\n  /**************************************************************\r\n   * ANALYTICS MODES\r\n   **************************************************************/\r\n\r\n  enableAnalytics: boolean = false;\r\n\r\n  private refreshAnalytics() {\r\n    if (!this.enableAnalytics) return;\r\n\r\n    this.DOM?.root\r\n      ?.classed(\"stackedCompare\", this.stackedCompare.is(true))\r\n      .classed(\"stackedChart\", this.stackedChart)\r\n      .classed(\"showWholeAggr\", this.showWholeAggr.is(true))\r\n      .attr(\"breakdownMode\", this.breakdownMode.get())\r\n      .attr(\"measureFunc\", this.measureFunc.get());\r\n\r\n    this.updateWidth_CatMeasureLabels();\r\n\r\n    if (this.stackedCompare.is(true)) {\r\n      this.attribs.forEach((attrib) => {\r\n        if (attrib.measureScale_Log) attrib.measureScaleType.set(\"linear\");\r\n      });\r\n    }\r\n\r\n    this.refreshPanelsSyncedMeasureExtend();\r\n\r\n    this.attribsInDashboard.forEach((attrib) => {\r\n      attrib.updateChartScale_Measure(true); // skip refresh viz\r\n      attrib.block.refreshViz_All();\r\n      attrib.block.refreshMeasureDescrLabel();\r\n\r\n      if (attrib instanceof Attrib_Categorical) {\r\n        if (attrib.catOrder_Dynamic && attrib.catSortBy !== \"Active\") {\r\n          attrib.block.updateCatSorting(); // delay, with animation\r\n        }\r\n      }\r\n    });\r\n\r\n    this.recordDisplay.View?.refreshSelect_Compare();\r\n\r\n    this.refreshAllMeasureLabels();\r\n  }\r\n\r\n  /** -------------------------------------------------- */\r\n  // Auto-computed from stacked compare setting\r\n  get stackedChart() {\r\n    if (this.stackedCompare.is(false)) return false;\r\n    if (this.activeComparisonsCount >= 1) return true;\r\n    if (this.activeComparisonsCount === 0) return false;\r\n    return this.lockedCompare[this.activeComparisons[0]]; // single comparison\r\n  }\r\n\r\n  /** -------------------------------------------------- */\r\n  get exploreMode() {\r\n    return this.dashboardMode.is(\"Explore\");\r\n  }\r\n  get adjustMode() {\r\n    return this.dashboardMode.is(\"Adjust\");\r\n  }\r\n  get authorMode() {\r\n    return this.dashboardMode.is(\"Author\");\r\n  }\r\n  get captureMode() {\r\n    return this.dashboardMode.is(\"Capture\");\r\n  }\r\n  get saveMode() {\r\n    return this.dashboardMode.is(\"Save\");\r\n  }\r\n\r\n  /** -------------------------------------------------- */\r\n  get measureFunc_Count() {\r\n    return this.measureFunc.is(\"Count\");\r\n  }\r\n  get measureFunc_Avg() {\r\n    return this.measureFunc.is(\"Avg\");\r\n  }\r\n  get measureFunc_Sum() {\r\n    return this.measureFunc.is(\"Sum\");\r\n  }\r\n\r\n  /** -------------------------------------------------- */\r\n  get singleFiltering() {\r\n    return this.filteringMode.is(\"single\");\r\n  }\r\n  get chainedFiltering() {\r\n    return this.filteringMode.is(\"chained\");\r\n  }\r\n\r\n  /** -------------------------------------------------- */\r\n  get absoluteBreakdown() {\r\n    return this.breakdownMode.is(\"absolute\");\r\n  }\r\n  get percentBreakdown() {\r\n    return this.breakdownMode.get() != \"absolute\";\r\n  }\r\n  get relativeBreakdown() {\r\n    return this.breakdownMode.is(\"relative\");\r\n  }\r\n  get dependentBreakdown() {\r\n    return this.breakdownMode.is(\"dependent\");\r\n  }\r\n  get totalBreakdown() {\r\n    return this.breakdownMode.is(\"total\");\r\n  }\r\n\r\n  /** Updates shared (synced) measure extent within the panel (so bar charts can share the same scale) */\r\n  private refreshPanelsSyncedMeasureExtend() {\r\n    Object.values(this.panels).forEach((panel) =>\r\n      panel.refreshSharedMeasureExtent()\r\n    );\r\n  }\r\n\r\n  /** -- */\r\n  refreshAllMeasureLabels(t: MeasureType = null, _fixed = false) {\r\n    if (!t) {\r\n      // no mode specified, go through it all\r\n      this.refreshAllMeasureLabels(\"Active\", true);\r\n      this.activeComparisons.forEach((cT) =>\r\n        this.refreshAllMeasureLabels(cT, true)\r\n      );\r\n      return;\r\n    }\r\n    this.blocks.forEach((block) => {\r\n      block.refreshMeasureLabelText(t);\r\n      if (block instanceof Block_Categorical) {\r\n        // refresh map visualization (TODO: fix/improve this part)\r\n        if (!_fixed && block.isView_Map) block.refreshViz(t);\r\n      }\r\n    });\r\n  }\r\n\r\n  /** -- */\r\n  updateWidth_CatMeasureLabels() {\r\n    Base.Panel_List.forEach((p) =>\r\n      this.panels[p].updateWidth_CatMeasureLabels()\r\n    );\r\n  }\r\n\r\n  /**************************************************************\r\n   * COMPARISONS\r\n   **************************************************************/\r\n\r\n  /** True if given compare type is locked */\r\n  lockedCompare: { [key in CompareType]?: boolean } = {};\r\n\r\n  /** Returns selected aggregate, if selection is active on given compare type */\r\n  selectedAggrs: { [key in CompareType]?: Aggregate } = {};\r\n\r\n  /** True if selected comparison is active (checks selected aggregate)  */\r\n  vizActive(key: CompareType) {\r\n    return this.selectedAggrs[key] !== null;\r\n  }\r\n\r\n  /** Locked attribute - equal to compared attribute, unless the compared one is not locked */\r\n  get lockedAttrib(): Attrib {\r\n    var cT = Base.Compare_List.find((cT) => this.lockedCompare[cT]);\r\n    return cT ? this.selectedAggrs[cT].attrib : null;\r\n  }\r\n\r\n  /** -- */\r\n  get comparedAttrib(): Attrib | null {\r\n    var cT = Base.Compare_List.find((cT) => this.selectedAggrs[cT]);\r\n    return cT ? this.selectedAggrs[cT].attrib : null;\r\n  }\r\n\r\n  /** Can select aggregate only with current active compared attribute */\r\n  can_setSelect_Compare(aggr: Aggregate) {\r\n    return !this.comparedAttrib || this.comparedAttrib === aggr.attrib;\r\n  }\r\n\r\n  /** -- */\r\n  refresh_Compare_Measures(aggr, cT) {\r\n    this.resetAllAggrMeasures(cT);\r\n    aggr.records.forEach((record) => record.addToAggrMeasure(cT));\r\n  }\r\n\r\n  get activeComparisonsCount() {\r\n    return this.activeComparisons.length;\r\n  }\r\n  get activeComparisons(): CompareType[] {\r\n    return Base.Compare_List.filter((cT) => this.vizActive(cT));\r\n  }\r\n  isCompared() {\r\n    return this.activeComparisonsCount > 0;\r\n  }\r\n\r\n  /** Which Comparison (Compare_X) to use as highlighting */\r\n  get Compare_Highlight(): CompareType {\r\n    return Base.Compare_List.find((cT) => {\r\n      if (!this.lockedCompare[cT]) return cT;\r\n    });\r\n  }\r\n\r\n  /** Return the name for remaining \"other\" selection. Only valid if using categorical */\r\n  get otherNameInCompare(): string {\r\n    if (!this.comparedAttrib) return;\r\n    if (this.comparedAttrib.type === \"categorical\") {\r\n      var notCompared = this.comparedAttrib._aggrs.filter((_) => !_.compared);\r\n      // only one other unselected option, no missing values, all that remains fall into one category\r\n      if (\r\n        notCompared.length === 1 &&\r\n        this.comparedAttrib.noValueAggr.recCnt(\"Total\") === 0\r\n      ) {\r\n        return notCompared[0].label;\r\n      }\r\n    }\r\n    return i18n.Other;\r\n  }\r\n\r\n  /** -- */\r\n  crumbs: { [key in CompareType]?: BreadCrumb } = {};\r\n\r\n  // creates a new breadcrumb for active highlight, and returns the previous crumb\r\n  createNewCrumb(): BreadCrumb {\r\n    let cT: CompareType = this.Compare_Highlight;\r\n    var r = this.crumbs[cT] || new BreadCrumb(this, cT);\r\n    this.crumbs[cT] = new BreadCrumb(this, cT);\r\n    return r;\r\n  }\r\n\r\n  isComparedSummaryMultiValued(): boolean {\r\n    var a = this.comparedAttrib;\r\n    if (a instanceof Attrib_Categorical) {\r\n      return a.isMultiValued;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /** -- */\r\n  get flexAggr_Highlight(): Aggregate_Interval<IntervalT> {\r\n    return this.flexAggrs[Base.Compare_List.find((cT) => !this.vizActive(cT))];\r\n  }\r\n\r\n  /** -- */\r\n  set flexAggr_Highlight(aggr: Aggregate_Interval<IntervalT>) {\r\n    this.flexAggrs[Base.Compare_List.find((cT) => !this.vizActive(cT))] = aggr;\r\n  }\r\n\r\n  /** -- */\r\n  refreshViz_Compare_All() {\r\n    this.recordDisplay.refreshViz_Compare_All();\r\n    this.blocks.forEach((block) => block.refreshViz_Compare_All());\r\n  }\r\n\r\n  /** -- */\r\n  refreshComparedSummary() {\r\n    if (!this.comparedAttrib) return;\r\n\r\n    this.comparedAttrib.addDOMBlockName(\r\n      this.DOM.breadCrumbs_Compare.select(\".lockCrumbSummary\")\r\n    );\r\n\r\n    this.comparedAttrib.block.DOM.root?.classed(\"comparedSummary\", true);\r\n  }\r\n\r\n  /** -- */\r\n  lockSelect_Compare(refreshAnalytics = true) {\r\n    var cT = this.Compare_Highlight;\r\n    if (!cT) return false; // cannot, sorry\r\n\r\n    if (!this.vizActive(cT)) return false;\r\n    if (this.lockedCompare[cT]) return false;\r\n    if (!this.selectedAggrs[cT]) return false;\r\n\r\n    if (this.selectedAggrs[cT].attrib?.isComparable.is(false)) {\r\n      return false;\r\n    }\r\n\r\n    this.selectedAggrs[cT].lockSelection();\r\n    this.lockedCompare[cT] = true;\r\n\r\n    this.lockedAttrib?.block?.DOM.root?.classed(\"lockedAttrib\", true);\r\n\r\n    if (refreshAnalytics) this.refreshAnalytics();\r\n\r\n    return true;\r\n  }\r\n\r\n  selectTimeouts: { [key in CompareType]?: number } = {};\r\n\r\n  /** -- */\r\n  setSelect_Compare(\r\n    selAggregate: Aggregate,\r\n    cT: CompareType = null,\r\n    refreshAnalytics = true\r\n  ) {\r\n    if (!selAggregate) return false;\r\n\r\n    if (!cT) cT = this.Compare_Highlight;\r\n    if (!cT) return false; // cT must be set beyond this point\r\n\r\n    if (this.selectTimeouts[cT]) {\r\n      window.clearTimeout(this.selectTimeouts[cT]);\r\n      this.clearSelect_Compare(cT, false, true);\r\n      delete this.selectTimeouts[cT];\r\n    }\r\n\r\n    // If there's active compared summary, cannot compare aggregate from another summary\r\n    if (\r\n      this.comparedAttrib &&\r\n      selAggregate.attrib &&\r\n      this.comparedAttrib !== selAggregate.attrib\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    if (selAggregate !== this.flexAggr_Highlight) {\r\n      // Already comparing that aggregate, nothing else to do\r\n      if (this.vizActive(cT)) return cT;\r\n      if (selAggregate.compared) return cT;\r\n    }\r\n\r\n    this.addedCompare = true;\r\n\r\n    this.DOM.root\r\n      .classed(\"select\" + cT, true)\r\n      .classed(\"comparedMultiValue\", this.isComparedSummaryMultiValued());\r\n\r\n    this.DOM.breadCrumbs_Compare.classed(\"isActive\", true);\r\n\r\n    this.selectedAggrs[cT] = selAggregate;\r\n    this.selectedAggrs[cT].selectCompare(cT);\r\n\r\n    this.crumbs[cT].showCrumb(cT, selAggregate.attrib?.summaryFilter);\r\n\r\n    this.refreshComparedSummary();\r\n\r\n    if (selAggregate.attrib instanceof Attrib_Interval) {\r\n      selAggregate.attrib.block.refreshIntervalSlider([cT]);\r\n    }\r\n\r\n    this.blocks.forEach((block) => {\r\n      if (block instanceof Block_Categorical) {\r\n        if (block.isView_Dropdown) block.dropdown_refreshCategories();\r\n      }\r\n    });\r\n\r\n    if (refreshAnalytics) {\r\n      this.refreshConfigs();\r\n    }\r\n\r\n    return cT;\r\n  }\r\n\r\n  /** -- */\r\n  clearSelect_Compare(\r\n    cT: CompareType | CompareType[] = this.Compare_Highlight,\r\n    finalize = true,\r\n    noWait = false\r\n  ) {\r\n    if (!cT) return;\r\n\r\n    if (!noWait && !Array.isArray(cT)) {\r\n      if (this.selectTimeouts[cT]) window.clearTimeout(this.selectTimeouts[cT]);\r\n      this.selectTimeouts[cT] = window.setTimeout(() => {\r\n        this.clearSelect_Compare(cT, finalize, true);\r\n        delete this.selectTimeouts[cT];\r\n      }, 750);\r\n      return;\r\n    }\r\n\r\n    var comparedSummary_old = this.comparedAttrib;\r\n    var lockedSummary_old = this.lockedAttrib;\r\n\r\n    var finishClearSelect = () => {\r\n      this.recordDisplay.refreshCompareLegend();\r\n\r\n      this.blocks.forEach((block) => {\r\n        if (block instanceof Block_Categorical && block.isView_Dropdown) {\r\n          block.dropdown_refreshCategories();\r\n        }\r\n      });\r\n\r\n      if (this.comparedAttrib !== comparedSummary_old) {\r\n        comparedSummary_old.block.DOM.root?.classed(\"comparedSummary\", false);\r\n      }\r\n\r\n      if (this.lockedAttrib !== lockedSummary_old) {\r\n        lockedSummary_old.block?.DOM.root?.classed(\"lockedAttrib\", false);\r\n      }\r\n\r\n      if (finalize) {\r\n        this.refreshConfigs();\r\n      }\r\n    };\r\n\r\n    if (Array.isArray(cT)) {\r\n      cT.forEach((_) => this.clearSelect_Compare(_, false, noWait));\r\n      finishClearSelect();\r\n      return;\r\n    }\r\n\r\n    if (typeof cT !== \"string\") return;\r\n    if (!this.vizActive(cT)) return;\r\n\r\n    this.addedCompare = false;\r\n\r\n    this.crumbs[cT].removeCrumb();\r\n    this.lockedCompare[cT] = false;\r\n\r\n    if (this.selectedAggrs[cT]) {\r\n      let a = this.selectedAggrs[cT].attrib;\r\n      if (a instanceof Attrib_Interval) {\r\n        a.block.refreshIntervalSlider([cT]);\r\n      }\r\n      this.selectedAggrs[cT].clearCompare(cT);\r\n      this.selectedAggrs[cT] = null;\r\n    }\r\n\r\n    this.DOM.root.classed(\"select\" + cT, this.vizActive(cT));\r\n    this.DOM.breadCrumbs_Compare.classed(\r\n      \"isActive\",\r\n      this.activeComparisonsCount !== 0\r\n    );\r\n\r\n    this.resetAllAggrMeasures(cT);\r\n\r\n    if (finalize) {\r\n      finishClearSelect();\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  private resetAllAggrMeasures(t) {\r\n    this.allAggregates.forEach((aggr) => aggr.resetMeasure(t));\r\n  }\r\n\r\n  /**************************************************************\r\n   * MEASUREMENTS\r\n   **************************************************************/\r\n\r\n  /** -- */\r\n  hasIntOnlyMeasure(): boolean {\r\n    return (\r\n      this.measureFunc_Count ||\r\n      (this.measureFunc_Sum && !this.measureSummary.get().hasFloat)\r\n    );\r\n  }\r\n  /** --*/\r\n  measureSumWithNegativeValues(): boolean {\r\n    return this.measureFunc_Sum && this.measureSummary.get().hasNegativeValues();\r\n  }\r\n  /** --*/\r\n  measureWithPositiveValues(): boolean {\r\n    if (this.measureFunc_Count) return true;\r\n    // TODO: This may return true, but other code relies on disabling when using avg measures\r\n    if (this.measureFunc_Avg) return false;\r\n    return this.measureSummary.get()?.hasNegativeValues();\r\n  }\r\n\r\n  /** funcType: \"Count\", Sum\" or \"Avg\" */\r\n  private async refreshMeasureMetric() {\r\n    if (!this.records) return; // if calling the function too early in initialization\r\n    let attrib = this.measureSummary?.get();\r\n    if (!attrib) return;\r\n\r\n    this.records.forEach(\r\n      this.measureFunc_Count\r\n        ? (rec: Record) => {\r\n            rec.measure_Self = 1;\r\n          }\r\n        : (rec: Record) => {\r\n            rec.measure_Self = attrib.getRecordValue(rec);\r\n          }\r\n    );\r\n\r\n    this.allAggregates.forEach((aggr) => aggr.resetAggregateMeasures());\r\n    this.blocks.forEach((block) => block.updateAfterFilter(false));\r\n\r\n    this.recordDisplay.refreshRecordVis();\r\n\r\n    this.updateRecordCount_Active();\r\n\r\n    this.refreshAnalytics();\r\n\r\n    if (attrib.hasTimeSeriesParent()) {\r\n      await this.recordDisplay.currentTimeKey.set(attrib.timeKey);\r\n    }\r\n  }\r\n\r\n  /**************************************************************\r\n   * ZOOM LEVELS (UI)\r\n   **************************************************************/\r\n\r\n  /** -- */\r\n  get dashZoomLevel() {\r\n    var r = \"1.00\";\r\n    try {\r\n      r = window.localStorage.getItem(\"kshfZoom\") || \"1.00\";\r\n    } catch (error) {}\r\n    return r;\r\n  }\r\n\r\n  /** -- */\r\n  attemptToFixBrowserZoomLevel(\r\n    multiplier = \"1.00\" /*reset*/,\r\n    forceReload = false\r\n  ) {\r\n    // Doesn't apply in firefox.\r\n    this.DOM.root.style(\"zoom\", multiplier);\r\n    try {\r\n      window.localStorage.setItem(\"kshfZoom\", multiplier);\r\n    } catch (error) {}\r\n    if (forceReload) window.location.reload();\r\n  }\r\n  /** -- */\r\n  detectPageZoom() {\r\n    // Other page size detection approaches:\r\n    // document.documentElement.clientWidth;\r\n    // document.documentElement.scrollWidth;\r\n\r\n    // CONSTANT - Does not seem to be affected by zoom level. Thus, serves as the \"default\" (100%) zoom\r\n    var windowOuterWidth = window.outerWidth;\r\n\r\n    // On safari,\r\n    // - Page zoomed in: innerWidth < outerwidth.\r\n    // - Page zoomed out: innerWidth > outerWidth\r\n    var windowInnerWidth = window.innerWidth;\r\n\r\n    if (window.parent) {\r\n      try {\r\n        // if placed inside an iframe, window.outerWidth measures the size of the top window, not the current frame.\r\n        // so, instead, when there's access to parent, I am using parent's zoom level detection.\r\n        windowOuterWidth = window.parent.outerWidth;\r\n        windowInnerWidth = window.parent.innerWidth;\r\n      } catch (exception) {\r\n        console.log(\"page detect zoom exception: \" + exception);\r\n        // use pageZoom URL parameter (TEMP - TODO. Not documented, may be removed in future)\r\n        let URLparams = new URL((document as any).location).searchParams;\r\n        if (URLparams && URLparams.get(\"pageZoom\")) {\r\n          return Number(URLparams.get(\"pageZoom\")) || 1;\r\n        }\r\n        return 1;\r\n      }\r\n\r\n      // visualViewport: Generally not useful. It reacts to pinch zoom and such.\r\n      // Didn't find a useful case where it's needed\r\n      // window.visualViewport.scale = Chrome only, pinch effect (not useful for detecting zoom level)\r\n      //windowOuterWidth = window.visualViewport.width;\r\n      // on safari, visualViewport.width is the window.innerWidth,\r\n    }\r\n\r\n    var pageZoomLevel_num = 1;\r\n\r\n    if (windowInnerWidth !== windowOuterWidth) {\r\n      pageZoomLevel_num = windowInnerWidth / windowOuterWidth;\r\n    } else {\r\n      // On chrome, changing zoom level changes devicePixelRatio, BUT it also changes inner/outer width\r\n      // and that change is captured in the code above before it comes here...\r\n      // devicePixelRatio\r\n      // - Not very helpful\r\n      // - On Safari, devicePixelRatio is CONSTANT (independent of zoom level). Cannot be used for detection.\r\n      // - On Firefox & Chrome, it is dependent on zoom level\r\n      //   - It can be \"2\" by default (retina displays, for example).\r\n      //   - Then what does a value of 1.5 mean? There's no way to know \"native\" zoom level, thus is not reliable.\r\n      /*\r\n      var devicePixelRatio = window.devicePixelRatio ? window.devicePixelRatio : 1;\r\n      if(devicePixelRatio!==undefined && devicePixelRatio!==1 && devicePixelRatio!==2){\r\n        if(devicePixelRatio>2) devicePixelRatio = devicePixelRatio / 2; \r\n        var multiplier = 1/devicePixelRatio;\r\n      }\r\n      */\r\n    }\r\n\r\n    return pageZoomLevel_num;\r\n  }\r\n  /** -- */\r\n  checkBrowserZoomLevel() {\r\n    var pageZoomLevel_num = this.detectPageZoom();\r\n\r\n    // If diff between detected ideal and current is less than 1%, no need to change\r\n    if (Math.abs(pageZoomLevel_num - parseFloat(this.dashZoomLevel)) < 0.01) {\r\n      return;\r\n    }\r\n\r\n    setTimeout(() => {\r\n      this.showWarning(i18n.ZoomLevelWarning);\r\n      this.DOM.warningText\r\n        .select(\".attemptToFix\")\r\n        .on(\"click\", () =>\r\n          this.attemptToFixBrowserZoomLevel(pageZoomLevel_num.toFixed(2), true)\r\n        );\r\n      this.DOM.warningText\r\n        .selectAll(\".dismiss\")\r\n        .on(\"click\", () => this.hideWarning());\r\n    }, 1000);\r\n  }\r\n\r\n  /**************************************************************\r\n   * UPDATING LAYOUT\r\n   **************************************************************/\r\n\r\n  /** -- */\r\n  updateLayout() {\r\n    if (this.finalized !== true) return;\r\n    this.updateWidth_Total();\r\n    this.updateLayout_Height();\r\n    this.updateMiddlePanelWidth();\r\n    this.panels.bottom.refreshWidth();\r\n  }\r\n  /** -- */\r\n  filters_wrap_letItWrap = false;\r\n  checkAndAdjustBreadcrumbs() {\r\n    if (this.filters_wrap_letItWrap) return;\r\n    var wrapped = this.isBreadcrumbAreaWrapped();\r\n    if (wrapped) {\r\n      this.DOM.breadCrumbs_Filter.classed(\"collapsed\", true);\r\n      this.filters_wrap_letItWrap = true;\r\n    }\r\n  }\r\n  /** -- */\r\n  isBreadcrumbAreaWrapped() {\r\n    var DOM = this.DOM.breadCrumbs_Filter.node();\r\n    if (DOM.classList.contains(\"collapsed\")) return false; // not wrapped\r\n    var _top = null,\r\n      _height = null;\r\n    var DOM_items = this.DOM.panel_Basic_In.selectAll(\".breadCrumb\").nodes();\r\n    return DOM_items.some((DOM_item) => {\r\n      if (_top != null && DOM_item.offsetTop > _top + _height * 0.7) {\r\n        return true;\r\n      }\r\n      _height = DOM_item.offsetHeight;\r\n      _top = DOM_item.offsetTop;\r\n      return false;\r\n    });\r\n  }\r\n  /** -- */\r\n  updateLayout_Height() {\r\n    if (!this.recordDisplay) {\r\n      return; // dashboard not initialized yet\r\n    }\r\n\r\n    let divHeight = this.DOM.root.nodes()[0].offsetHeight;\r\n\r\n    var divHeight_Total =\r\n      divHeight -\r\n      this.height_PanelHeader -\r\n      this.height_PanelFooter -\r\n      2 * Base.width_PanelGap;\r\n\r\n    // ****************************************************************\r\n    // BOTTOM PANEL\r\n    var targetHeight_bottom = divHeight_Total;\r\n    // In case there is something above the bottom panel, target half the size\r\n    if (\r\n      this.panels.left.hasBlocks() ||\r\n      this.panels.right.hasBlocks() ||\r\n      this.panels.middle.hasBlocks() ||\r\n      this.recordChartType.get() !== \"none\"\r\n    ) {\r\n      // maximum half height if there is any other content\r\n      targetHeight_bottom *= 0.5;\r\n    }\r\n    this.panels.bottom.setHeightAndLayout(targetHeight_bottom);\r\n\r\n    var topPanelsHeight = divHeight_Total - this.panels.bottom.height;\r\n\r\n    // ****************************************************************\r\n    // LEFT PANEL\r\n    this.panels.left.setHeightAndLayout(topPanelsHeight);\r\n\r\n    // ****************************************************************\r\n    // RIGHT PANEL\r\n    this.panels.right.setHeightAndLayout(topPanelsHeight);\r\n\r\n    // ****************************************************************\r\n    // MIDDLE PANEL\r\n    var targetHeight_middle = topPanelsHeight;\r\n    if (this.recordChartType.get() !== \"none\") {\r\n      targetHeight_middle -= this.recordDisplay.collapsed\r\n        ? this.recordDisplay.height_Header + 4\r\n        : 200;\r\n      targetHeight_middle -= Base.width_PanelGap;\r\n    }\r\n    this.panels.middle.setHeightAndLayout(targetHeight_middle);\r\n\r\n    // The part where summary DOM is updated\r\n    this.blocks.forEach((block) => block.refreshHeight());\r\n\r\n    if (!this.recordDisplay.collapsed && this.recordChartType.get() !== \"none\") {\r\n      var listDisplayHeight =\r\n        topPanelsHeight -\r\n        this.recordDisplay.height_Header -\r\n        this.panels.middle.height;\r\n      if (this.showDropZones && this.panels.middle.isEmpty())\r\n        listDisplayHeight *= 0.5;\r\n      this.recordDisplay.setHeight(listDisplayHeight);\r\n    }\r\n  }\r\n\r\n  /** -- */\r\n  updateMiddlePanelWidth() {\r\n    // for some reason, on page load, this variable may be null. urgh.\r\n    var widthMiddlePanel =\r\n      this.width_Canvas -\r\n      this.panels.left.width_Real_withGap -\r\n      this.panels.right.width_Real_withGap;\r\n\r\n    this.panels.middle.setWidth(widthMiddlePanel);\r\n    this.panels.middle.refreshWidth();\r\n    // set summaries are also always placed in middle panel.\r\n    this.blocks\r\n      .filter((block) => block.attrib.type === \"setpair\")\r\n      .forEach((block) => block.refreshWidth());\r\n\r\n    if (this.recordDisplay) {\r\n      this.recordDisplay.setWidth(widthMiddlePanel);\r\n    }\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Value access\r\n  // ********************************************************************\r\n\r\n  /**  */\r\n  getPercentageValue(_val: number, sT, breakMode = null, aggr = null) {\r\n    breakMode = breakMode || this.breakdownMode.get();\r\n    if (breakMode === \"absolute\") {\r\n      return _val;\r\n    }\r\n    if (breakMode === \"relative\" && aggr) {\r\n      if (!this.isCompared()) {\r\n        return (100 * _val) / this.allRecordsAggr[\"Active\"].measure;\r\n      }\r\n      if (aggr.Active.measure === 0) return 0;\r\n      return (100 * _val) / aggr.Active.measure; // divide by aactive measure of aggregate\r\n    }\r\n    if (breakMode === \"dependent\") {\r\n      return (100 * _val) / this.allRecordsAggr[sT].measure; // divide by total's compared measure\r\n    }\r\n    if (breakMode === \"total\") {\r\n      return (100 * _val) / this.allRecordsAggr[\"Active\"].measure; // divide by total's Active measure\r\n    }\r\n  }\r\n  /** -- */\r\n  getChartValue(aggr: Aggregate, sT) {\r\n    return this.getPercentageValue(aggr.measure(sT), sT, null, aggr);\r\n  }\r\n  /** -- */\r\n  getMeasureValue(\r\n    aggr: Aggregate,\r\n    sT: MeasureType = \"Active\",\r\n    breakMode = null,\r\n    offset: MeasureType[] = []\r\n  ) {\r\n    var _val = aggr.measure(sT);\r\n\r\n    if (sT === \"Active\" && offset) {\r\n      offset.forEach((t: MeasureType) => {\r\n        _val -= aggr.measure(t);\r\n      });\r\n    }\r\n\r\n    return this.getPercentageValue(_val, sT, breakMode, aggr);\r\n  }\r\n  /** -- */\r\n  getMeasureFormattedValue(_val, isSVG = false) {\r\n    return this.measureFunc.get() !== \"Count\"\r\n      ? this.measureSummary.get().getFormattedValue(_val, isSVG)\r\n      : _val;\r\n  }\r\n  /** -- */\r\n  getValueLabel(_val, isSVG = false, decimals = 1, withPercentage = null) {\r\n    withPercentage =\r\n      withPercentage != null ? withPercentage : this.percentBreakdown;\r\n    if (withPercentage) {\r\n      if (_val !== 100 && _val !== 0) _val = _val.toFixed(decimals);\r\n      return _val + (isSVG ? \"%\" : \"<span class='unitName'>%</span>\");\r\n    }\r\n\r\n    if (this.measureFunc_Count) {\r\n      return Util.formatForItemCount(_val);\r\n    }\r\n\r\n    const measureSummary = this.measureSummary.get();\r\n\r\n    if (\r\n      this.measureFunc_Sum &&\r\n      !measureSummary.hasNegativeValues() &&\r\n      !measureSummary.hasFloat\r\n    ) {\r\n      return Util.formatForItemCount(_val, measureSummary.unitName);\r\n    }\r\n\r\n    if (_val <= -1000 || _val >= 1000) {\r\n      return Util.formatForItemCount(_val, measureSummary.unitName);\r\n    }\r\n\r\n    if (this.measureFunc_Avg) {\r\n      _val = _val.toFixed(decimals);\r\n    }\r\n\r\n    return this.measureSummary.get().getFormattedValue(_val);\r\n  }\r\n\r\n  // ********************************************************************\r\n  // Export & import\r\n  // ********************************************************************\r\n\r\n  /** -- */\r\n  exportData() {\r\n    var out = [];\r\n    var _clear = (_data) => {\r\n      for (let attribName in _data) {\r\n        var attr = _data[attribName];\r\n        if (typeof attr !== \"object\") continue;\r\n        if (attr == null) continue;\r\n        if (attribName === \"_timeseries_\") {\r\n          delete _data[attribName];\r\n        }\r\n        if (attr._timeseries_) {\r\n          delete attr._timeseries_;\r\n        }\r\n        for (let key in attr) {\r\n          if (attr[key] === \"\") delete attr[key];\r\n          if (typeof attr[key] == \"object\") _clear(attr[key]);\r\n        }\r\n      }\r\n    };\r\n    this.records.forEach((record) => {\r\n      if (record.filteredOut) return;\r\n      let dataCopy = Object.assign({}, record.data);\r\n      _clear(dataCopy);\r\n      out.push(dataCopy);\r\n    });\r\n    return out;\r\n  }\r\n\r\n  exportConfig(): ConfigSpec {\r\n    var config: ConfigSpec = {\r\n      domID: this.domID !== Base.defaultDOM ? this.domID : undefined,\r\n      recordName: this.recordName,\r\n      source: Object.assign({}, this.options.source),\r\n      description: this.options.description || undefined,\r\n      attribPanelWidth:\r\n        this.attribPanelWidth !== Base.width_AttribPanelDefault\r\n          ? this.attribPanelWidth\r\n          : undefined,\r\n      summaries: [],\r\n      panels: {},\r\n      recordDisplay: this.recordDisplay.exportConfig() as any,\r\n\r\n      colorTheme: this.colorTheme.exportConfig(),\r\n    };\r\n\r\n    Object.values(this.configs).forEach((_cfg) => _cfg.exportConfigTo(config));\r\n\r\n    if (!this.measureFunc_Count && this.measureSummary.get()) {\r\n      config.metric = {\r\n        type: this.measureFunc.get(),\r\n        summary: this.measureSummary.get().template.str,\r\n      };\r\n    }\r\n\r\n    // ***********************************************\r\n    // Export summary configuration\r\n    var _exportAttrib = (attrib: Attrib) => {\r\n      if (attrib.isExportable()) {\r\n        var cfg = attrib.exportConfig() as SummarySpec;\r\n        Util.removeEmptyKeys(cfg);\r\n        config.summaries.push(cfg);\r\n      }\r\n    };\r\n    // export attribs within dashboard, ordered by block, in view order\r\n    Object.values(this.panels).forEach((panel) =>\r\n      panel.blocks.forEach((block) => _exportAttrib(block.attrib))\r\n    );\r\n    // exports attribs that are not within the panels already / not exported yet\r\n    this.attribs\r\n      .filter((attrib) => !attrib?.block?.inDashboard)\r\n      .forEach(_exportAttrib);\r\n\r\n    // Export panel configurations\r\n    for (let [name, panel] of Object.entries(this.panels)) {\r\n      if (panel.hasBlocks()) {\r\n        config.panels[name] = panel.exportConfig();\r\n      }\r\n    }\r\n\r\n    // Export selections\r\n    var comparedAttrib = this.comparedAttrib;\r\n    if (comparedAttrib) {\r\n      config.selections = {\r\n        summary: comparedAttrib.attribName,\r\n      };\r\n      Base.Compare_List.forEach((cT) => {\r\n        if (!this.selectedAggrs[cT] || !this.selectedAggrs[cT].locked) return;\r\n        config.selections[cT] = this.selectedAggrs[cT].exportAggregateInfo();\r\n      });\r\n    }\r\n\r\n    // remove all settings that are {}\r\n    let clearSetting = (_) => {\r\n      if (!Object.keys(config[_]).length) delete config[_];\r\n    };\r\n    clearSetting(\"panels\");\r\n    clearSetting(\"colorTheme\");\r\n\r\n    Util.removeEmptyKeys(config);\r\n\r\n    return config;\r\n  }\r\n}\r\n"],"names":["DOMPurify","roundArrow","d3","Popper.createPopper","scaleLinear","scaleLog","easeCubicOut","curveMonotoneX","d3.select","Filter_Geo","scaleTime","easePolyInOut","scaleQuantize","easeLinear","easePoly","easePolyOut","zoomTransform","zoomIdentity","scaleUtc","utcSecond","utcWeek","scaleSqrt","scaleThreshold"],"mappings":"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"}